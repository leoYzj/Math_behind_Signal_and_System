%================================
% note-setup.tex
% fenglielie@qq.com 2025-09-12
%================================
\documentclass{ctexbook}
\input{note-setup.tex}
%自行添加的包
\usepackage{wrapfig}
\usepackage{multicol}
\usepackage{paracol}
\usepackage{varwidth}
\usepackage{dsfont}
\usepackage{fix-cm}
\usepackage{array}
\usepackage{booktabs}
\usepackage{float}
\usepackage{pifont}
\usepackage{enumitem}
\usepackage{circuitikz}
\usepackage{tikz}
\usetikzlibrary{arrows.meta, positioning, shapes,calc}
\usepackage{standalone}
\usepackage{silence}
\usepackage{biblatex}
\addbibresource{reference.bib}
\usetikzlibrary{calc}
\allowdisplaybreaks
\raggedbottom
\usetikzlibrary{shapes,arrows,positioning,calc}
\usepackage{graphicx}
\usepackage{grffile}
\graphicspath{{D:/code_clone/Math_behind_Signal_and_System/Figures}}
\let\cleardoublepage\clearpage
\usepackage{url}
\renewcommand{\bibname}{参考文献}

% 调整目录（Table of Contents）中的字体以区分 chapter/section/subsection
\usepackage{tocloft}
\usepackage{etoc} % 用于局部控制目录深度并生成多份目录
% 目录字体设置：章节标题加粗并放大，节标题正常，子节斜体并缩小一点
\renewcommand{\cftchapfont}{\bfseries\Large}
\renewcommand{\cftchappagefont}{\bfseries\Large}
\renewcommand{\cftsecfont}{\mdseries\normalsize}
\renewcommand{\cftsecpagefont}{\mdseries\normalsize}
\renewcommand{\cftsubsecfont}{\itshape\small}
\renewcommand{\cftsubsecpagefont}{\itshape\small}
% 可根据需要调整间距（示例）
%\setlength{\cftbeforechapskip}{1ex}
%\setlength{\cftbeforesecskip}{0.5ex}

%自定义命令
\newcommand{\shah}{\operatorname{III}}
% 便捷命令：在文中书写原函数在上下限的取值，例如 \evalat{F(x)}{a}{b} 输出为 \left.F(x)\right|_{a}^{b}
\newcommand{\evalat}[3]{\left.#1\right|_{#2}^{#3}}
\newcommand{\lr}[2]{%
    \begin{center}
    \begin{minipage}[t]{0.45\textwidth}
        \centering
        \allowdisplaybreaks
        \textcolor{blue}{%
            \begin{varwidth}{\linewidth}
            $\begin{aligned}
            #1
            \end{aligned}$
            \end{varwidth}
        }
    \end{minipage}
    \hfill
    \begin{minipage}[t]{0.45\textwidth}
        \centering
        \allowdisplaybreaks
        \textcolor{red}{%
            \begin{varwidth}{\linewidth}
            $\begin{aligned}
            #2
            \end{aligned}$
            \end{varwidth}
        }
    \end{minipage}
\end{center}
}

% 新定义的lralign环境，支持分页，使用\switch分隔左右
% 用法:
% \begin{lralign}
% 左侧公式
% \switch
% 右侧公式
% \end{lralign}
\ExplSyntaxOn
\seq_new:N \l_lralign_left_rows_seq
\seq_new:N \l_lralign_right_rows_seq
\tl_new:N \l_lralign_left_body_tl
\tl_new:N \l_lralign_right_body_tl
\tl_new:N \l_lralign_final_body_tl
\seq_new:N \l_lralign_parts_seq
\int_new:N \l_lralign_max_rows_int
\seq_new:N \l_lralign_cell_seq
\tl_new:N \l_lralign_row_tl
\tl_new:N \l_lralign_amp_tl
\tl_set:Nn \l_lralign_amp_tl { & }

\NewDocumentEnvironment{lralign}{ +b }{
    % Split input at \switch
    \seq_set_split:Nnn \l_lralign_parts_seq { \switch } { #1 }
    
    % Extract Left and Right
    \seq_pop_left:NN \l_lralign_parts_seq \l_lralign_left_body_tl
    % Check if Right exists
    \seq_if_empty:NTF \l_lralign_parts_seq
    { \tl_clear:N \l_lralign_right_body_tl }
    { \seq_pop_left:NN \l_lralign_parts_seq \l_lralign_right_body_tl }
    
    % Split into rows (using \\ as delimiter)
    \seq_set_split:NnV \l_lralign_left_rows_seq { \\ } \l_lralign_left_body_tl
    \seq_set_split:NnV \l_lralign_right_rows_seq { \\ } \l_lralign_right_body_tl
    
    % Calculate max rows
    \int_set:Nn \l_lralign_max_rows_int { \int_max:nn { \seq_count:N \l_lralign_left_rows_seq } { \seq_count:N \l_lralign_right_rows_seq } }
    
    \tl_clear:N \l_lralign_final_body_tl
    
    % Loop and construct alignment body
    \int_step_inline:nn { \l_lralign_max_rows_int } {
        % Process Left Cell
        \tl_clear:N \l_lralign_row_tl
        \seq_pop_left:NN \l_lralign_left_rows_seq \l_tmpa_tl
        \quark_if_no_value:NTF \l_tmpa_tl
        { \tl_clear:N \l_tmpa_tl }
        { }
        % Replace & with & \color{blue}
        \tl_replace_all:Nnn \l_tmpa_tl { & } { & \color{blue} }
        % Prepend \color{blue}
        \tl_put_left:Nn \l_tmpa_tl { \color{blue} }
        \tl_put_right:NV \l_lralign_final_body_tl \l_tmpa_tl
        
        \tl_put_right:Nn \l_lralign_final_body_tl { & \qquad }
        
        % Process Right Cell
        \seq_pop_left:NN \l_lralign_right_rows_seq \l_tmpa_tl
        \quark_if_no_value:NTF \l_tmpa_tl
        { \tl_clear:N \l_tmpa_tl }
        { }
        
        % Replace & with & \color{red}
        \tl_replace_all:Nnn \l_tmpa_tl { & } { & \color{red} }
        % Prepend \color{red}
        \tl_put_left:Nn \l_tmpa_tl { \color{red} }
        \tl_put_right:NV \l_lralign_final_body_tl \l_tmpa_tl
        
        % Append \\ unless it's the last row
        \int_compare:nNnF { ##1 } = { \l_lralign_max_rows_int } {
            \tl_put_right:Nn \l_lralign_final_body_tl { \\ }
        }
    }
    
    % Output the align* environment
    \begin{align*}
    \l_lralign_final_body_tl
    \end{align*}
}{}
\ExplSyntaxOff

\title{信号与系统中的数学}
\author{严子竣}
\date{\today}

\begin{document}
\makecover{bnds2}
\frontmatter%前言
\chapter*{前言}
\addcontentsline{toc}{chapter}{前言}
信号与系统是电子信息等相关专业本科生的重要基础课，是后续课程“数字信号处理”“通信原理”“自动控制”“随机信号处理”“数字图像处理”“现代信号处理”等课程的基础，以确定信号通过线性时不变系统的过程为核心，综合运用多门数学课程的知识，尤其是傅里叶分析。

然而，国内外的信号与系统课程对于傅里叶变换的定义有所不同，国内的课程中所谓“频域分析”实际上指的是角频率域，而这种定义上的不同会导致诸多公式的内核相同但形式不同，使学习者感到困惑。我自学过斯坦福大学公开课EE261，同样面临着这个问题，所以希望尝试这种新的笔记形式，梳理信号与系统课程的理论部分，同时也使本书能够作为同学们学习信号与系统时的参考书。我们将看到，同时给出两种傅里叶变换，不仅方便我们对比、查找公式，理解傅里叶变换的本质，还能在必要时转向其中一种傅里叶变换，使得讨论更加简洁明快。

同时，我注意到现在的信号与系统教材中对很多数学上的内容的处理过于简单化，以至于同学们对一些公式感到不解，我希望结合《信号与系统》教材和实变函数、复变函数和傅里叶分析等教材，对这样的内容做一些补充和深化。对于其中比较复杂的内容，我会用“*”进行标注，以提示读者可以选择性地阅读。

本书将不会涉及信号与系统实践部分，对一些语文性质的概念从简处理，希望了解这些内容的读者可以自行查看信号与系统教材。对于两种不同的傅里叶变换，将并排给出两种公式，左侧为频率版本，右侧为角频率版本。为了逻辑的完整性和内容的精确性，本书会引入一些远超工科教学范围的内容，力求朴素平和却又不失深度，其中所涉及的技术细节不在我们的关注范围，读者也可以自行选择是否阅读这些内容。本书默认读者已经学习过一到两学期的数学分析（或高等数学/微积分）以及高等代数（或线性代数）课程，不过只要理解一元微积分，阅读前四章及就不会有问题；只要掌握复数运算、理解曲线积分，阅读后两章就不会有问题。

限于作者水平，书中难免存在不足之处，希望读者可以提出宝贵的意见或建议，可以反馈至我的电子邮箱：2024212622@bupt.cn。

{
\raggedleft{}
北京市十一学校2024届毕业生\\
严子竣\\
2025年秋\\
}

\chapter*{致谢}
\addcontentsline{toc}{chapter}{致谢}


% ===== 分为“简要目录”和“详尽目录” =====
% 使用 etoc 提供的局部控制目录深度，避免修改 \l@subsection 导致的副作用
\renewcommand{\contentsname}{简要目录}
\etocsetnexttocdepth{1}% 1=section
\tableofcontents

\clearpage

% 详尽目录：显示到 subsection（默认样式，使用全局 tocloft 设置）
\renewcommand{\contentsname}{详尽目录}
\setcounter{tocdepth}{2}
\tableofcontents%目录（详尽）
\mainmatter%正文
\chapter{预备知识}%第一章
\section{信号与系统简介}\label{sec:Introduction}

\subsection{基本概念}\label{sub:basic_concepts}
信号 (signal)是信息 (information)的表现形式与传送载体，信息是蕴含在信号中的具体内容。

在电学领域中，通过电压或电流对真是信号进行连续的记录，模拟其变化过程得到的信号称为模拟信号 (analog signal)或连续信号 (continuous signal)，但由于计算机中信号只能以有限位数的形式储存，往往需要将模拟信号转化为数字信号(digital siganal)。这个过程往往需要利用模数转换器 (analog-to-digital converter,ADC)，使用时再利用数模转换器 (digital-to-analog converter,DAC)将数字信号转化为模拟信号。

在信息科学与技术领域，系统指对信号产生影响的装置或算法，例如滤波系统、调制系统、发射系统，将这些系统组合起来就组成了无线电广播系统；例如通信系统由信源、发射机、信道、接收机和信宿五个部分组成。

电子信息系统的基本构件是传感器、处理器和激励器。传感器 (sensor)将物理量转化为电信号，处理器 (processor)对信号进行处理，激励器 (actuator)将处理后的电信号转化为物理量。其中，电路层面的处理器处理的是电信号，完成电信号处理的功能电路包括：\begin{itemize}
    \item 放大器(amplifier)：对信号进行放大处理，与之对应的是衰减器(attenuator)。
    \item 滤波器(filter)：传感器输出的电信号多是包含信息的低频电信号，又称为基带信号(baseband signal)；在信号传输过程中，信号往往被置于某个高频频段内，这个频带称为通带(passband)；在传输前后，都需要滤波器来排除所需频带之外信号的干扰。见\ref{sub:filter}、\ref{sub:distortion}。
    \item 调制器(modulator)与解调器(demodulator)：将基带信号转化为通带信号的过程称为调制\\
    (modulation)，将通带信号还原为基带信号的过程称为解调(demodulation)。见\ref{sec:modulation}。
    \item 振荡器(oscillator)：产生周期性信号的装置，常见的有正弦波振荡器、方波振荡器等，也用于产生高频载波信号进行调制。
    \item 模数转换器(ADC)与数模转换器(DAC)：将模拟信号转化为数字信号的装置称为模数转换器，将数字信号转化为模拟信号的装置称为数模转换器。所谓数字信号，是指在时间和幅值上均为离散的信号；而模拟信号则是在时间和幅值上均为连续的信号，用于模拟真实世界中的信号。
    \item 存储器(memory)：用于存储数字信号的装置，例如随机存取存储器(RAM)、只读存储器(RO\\
    M)等。
    \item 处理器(processor)：对数字信号进行处理的装置，例如数字信号处理器(DSP)、微控制器(MC\\
    U)等。
\end{itemize}
此外，还有整流器、稳压器、变压器等。其中，滤波器、调制解调器属于信号与系统课程的内容。

\subsection{连续信号与离散信号}\label{sub:signal}
信号的本质是函数，\textbf{连续信号}就是定义域“连续”的函数，例如一个时间的函数$f(t)$，一般要求定义域具有连续统的势。相应的，\textbf{离散信号}的定义域往往是至多可数集，于是我们常认为其定义域是整数集，并记离散信号为$x[n]$，用研究数列的方法研究离散信号。

从电学的经验来看，电压、电流信号的功率总为其幅值的平方乘以某个常数，于是对于一般的信号我们也采取此定义。真实的物理世界中的信号的能量总是有限的，但是，为了更好地研究它们，很多时候使用真实信号的一部分做适当延拓作为研究对象，因此课程中将遇到一些不满足“方均可积”性质$\int_{-\infty}^{\infty}| f(x)| ^2\,dx<\infty$的信号，于是定义：
\begin{definition}[功率信号与能量信号]
能量无限而功率有限的信号称为\textbf{功率信号}：\[\int_{-\infty}^{\infty}| f(x)| ^2\,dx\to\infty,\frac{1}{T}\int_{-\infty}^{\infty}| f(x)|^2  \,dx<\infty\]
而能量有限的信号称为\textbf{能量信号}：\[\int_{-\infty}^{\infty}| f(x)| ^2\,dx<\infty\]
\end{definition}

为了区分某段时间内和全时域上的能量和功率，又定义：\begin{definition}
\quad\newline
    \textbf{归一化能量}：$$E_T=\int_{-T/2}^{T/2}| f(x)| ^2\,dx$$
    \textbf{归一化功率}：$$P_T=\dfrac{1}{T}\int_{-T/2}^{T/2}| f(x)| ^2\,dx$$
\textbf{全时域能量}：$$E=\int_{-\infty}^{\infty}| f(x)| ^2\,dx$$
\textbf{全时域功率}：$$P=\lim_{T \to \infty}  \dfrac{1}{T}\int_{-T/2}^{T/2}| f(x)| ^2\,dx$$
\end{definition}

类似地，对于离散信号，定义：
\begin{definition}
    \quad\newline
    \textbf{归一化能量}：$$E_N=\sum_{n = -N}^{N}  |x[n]| ^2$$
    \textbf{归一化功率}：$$P_N=\dfrac{1}{2N+1}\sum_{n = -N}^{N}  |x[n]| ^2$$
\textbf{全时域能量}：$$E=\sum_{n = -\infty}^{\infty}  |x[n]| ^2$$
\textbf{全时域功率}：$$P=\lim_{N \to \infty}  \dfrac{1}{2N+1}\sum_{n = -N}^{N}  |x[n]| ^2$$
\end{definition}

\subsection{典型的连续与离散信号}\label{sub:ordinary_signal}
\begin{definition}[采样信号]
    \[\text{Sa}(t)=\frac{\sin(t)}{t}\]
\end{definition}
它在0处连续延拓为1，在$\pi$的整数倍处为0，是偶函数，在正半轴上的积分值为$\pi /2$（这个结果称为狄利克雷积分）。国外教材中采样信号一般为一个类似的信号
\[\text{sinc}(t)=\frac{\sin(\pi t)}{\pi t}=\text{Sa}(\pi t)\]
它们的参数不同但性质类似、本质相同。需要注意的是，在绘图时python和MATLAB中只有\text{sinc}信号，而且实际上指的是\text{Sa}信号。
\begin{definition}[钟形信号/高斯信号]
    \[f(t)=Ee^{-{\left(\frac{t}{\tau }\right)}^2}\]
    $\tau$为衰减速率或时间常数，$\tau$越大，函数值衰减越慢。
\end{definition}
\begin{definition}[单位脉冲函数/狄拉克函数]
    $$\delta (x)=\begin{cases}
        0      & x\neq 0 \\
        \infty & x=0
    \end{cases}$$满足：\ding{172} 采样性质：$f(x)\delta (x)=f(0)\delta (x)$\\
\ding{173} 积分性质：$\int_{-\infty}^{\infty}\delta (x)\,dx=1$，从而$\int_{-\infty}^{\infty}f(x)\delta (x)\,dx=f(0)$。\\
\ding{174} $\delta(x)$ 函数是偶函数：$\delta (-x)=\delta (x)$
\end{definition}
这个函数可视为一些性质较好的函数如高斯函数、采样函数集中到x=0附近时的极限情况，从而具备很多优美的性质，见\ref{sub:approach}。实际上，它应该作为一个分布（而不是函数）来理解，并且是无限阶可导的，我们将在\ref{sub:general_distributions}中详细讨论这一点。目前，我们仅能从形式和直观上定义这样一个函数。

根据以上定义中列举的性质，可以得到$\delta$函数的伸缩变换性质：$\delta(ax)=\dfrac{1}{|a|}\delta(x)$，这是因为我们需要保证：
\[\int_{-\infty}^{\infty}\delta(ax)\,d(ax)=a\int_{-\infty}^{\infty}\delta(y)\,dy=a\]
我们规定，$\delta_a(x)=\delta (x-a)$，即在$x=a$处采样的狄拉克函数。

\begin{definition}[单位阶跃函数]
    \[u(x)=
    \begin{cases}
        0 & x<0 \\
        1 & x>0
    \end{cases}\]
\end{definition}
\begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{Figure_1}
    \caption{采样函数、高斯函数、狄拉克函数、单位阶跃函数}
\end{figure}

这个函数在0处的值可以任意定义，一般取0、1或1/2，不会有影响，所以一般也不会讨论。由单位阶跃函数衍生出许多其他函数：
\begin{definition}
    \textbf{符号函数}\[sgn(x)=\begin{cases}
        -1 & x<0 \\
        1  & x>0
    \end{cases}=u(t)-u(-t)\]
\end{definition}
\begin{definition}
    \textbf{矩形脉冲、门函数（矩形函数、$\Pi $函数）}\[R_T(t)=u(t)-u(t-T),G_T(t)=u(t+T/2)-u(t-T/2)\]
这里T为脉冲宽度，不加角标时，默认为1。
\end{definition}

由于这些记号计较容易混淆，本书中不再使用它们，而是使用\textbf{特征函数}(indicator function)：
\begin{definition}
    设集合$A\subset\mathbb{R}$，其特征函数为
    \[\chi_A(x)=\begin{cases}
        1 & x\in A \\
        0 & x\notin A
    \end{cases}\]
\end{definition}
我们将在实变函数的理论中用到它。例如，狄利克雷函数$D(x)$可表示为$\chi_{\mathbb{Q}}(x)$。概率论中会定义连续性随机变量的特征函数(characteristic function)，指随机变量的矩母函数的傅里叶变换，本书中不会用到它，但请读者注意它们的区别。

单位阶跃函数的积分为单位斜变信号 (the unit ramp)，导数为狄拉克函数，从直观上这不难理解，在学习\ref{sub:general_distributions}之后，很容易自行验证它。

\begin{definition}[单边指数函数和双边指数函数]
    \begin{align*}
    f(t)=e^{-at}u(t)=\begin{cases}
        e^{-at}, & \text{if }t>0 \\
        0,       & \text{if }t<0
    \end{cases}
\end{align*}
称为单边按指数函数，
\begin{align*}g(t)=f(t)+f(-t)=\begin{cases}
        e^{-at}, & \text{if }t\geq 0 \\
        e^{at},  & \text{if }t<0
    \end{cases}
\end{align*}
称为双边指数函数
\end{definition}

下面介绍离散信号。
\begin{definition}[单位脉冲序列/克罗内克$\delta$函数]
    \[\delta[n]=\begin{cases}
        1, & \text{if }n=0     \\
        0, & \text{if }n\neq 0
    \end{cases}\]
\end{definition}
将它进行时移，可得\[\delta_k[n]=\delta[n-k]=\begin{cases}
        1, & \text{if }n=0     \\
        0, & \text{if }n\neq 0
    \end{cases}\]
它与狄拉克$\delta$函数一样，都具有采样性质：$x[n]\delta_k[n]=x[k]\delta_k[n],\forall n$.
\begin{definition}[单位阶跃序列]
    \[u[n]=\begin{cases}
        1, & \text{if }n\geq 0 \\
        0, & \text{if }n< 0
    \end{cases}\]
\end{definition}
类似连续信号，由它可以衍生出矩形窗序列：
\[R_N[n]=u[n]-u[n-N]=\begin{cases}
        1, & \text{if }0\leq n\leq N-1 \\
        0, & \text{otherwise}
    \end{cases}\]

\begin{definition}[指数序列]
    $x[n]=a^n u[n]$称为指数序列，其中$a\in\mathbb{R}$。
\end{definition}
\begin{definition}[复指数序列]
    $x[n]=e^{i\Omega_0 n}$称为复指数序列，其中$\Omega_0$称为数字角频率。
\end{definition}

\begin{definition}[正弦序列]
    $x[n]=\sin(\Omega_0n)$,其中$\Omega_0$称为数字角频率。
\end{definition}
\begin{figure}[H]
    \centering
    \includegraphics[width=0.5\textwidth]{disct_sin}
    \caption{的正弦序列}
\end{figure}

下面介绍离散信号的伸缩变换：
$$x[n]\to x[\alpha n],\alpha\in\mathbb{R}$$
如果$\alpha\in\mathbb{N}_+$，则伸缩后的信号仍为离散信号，只是遗漏了原信号的一些信息；如果$\alpha=\frac{1}{N},N\in\mathbb{N}_+$，则伸缩后的信号在$N$的倍数以外的点没有定义，我们必须人为规定它们的值，这就是\text{插值}。

最简单的处理方式是将这些点全部赋值为0。我们定义：
\begin{definition}[离散信号的伸缩]
    离散信号的伸缩分为两种：$$y[n]=x[Mn],M\in\mathbb{N}_+$$
    称为\textbf{降采样/下采样}，对应\textbf{抽取}；$$y[n]=\begin{cases}
    x\left[\dfrac{n}{N}\right],&n=Nk,N\in\mathbb{Z}\\
    0,&\text{otherwise}
    \end{cases}$$
    称为\textbf{升采样/上采样}，对应\textbf{插值}。
\end{definition}

如果离散信号本身是由连续信号采样得到的，例如$x[n]=f(T_s n)$，那么插值就对应于还原连续信号的过程，因此离散信号的伸缩相当于处理连续信号时增加或减少样值点。降采样、升采样的名称就来源于此。对于降采样、升采样，我们将在\ref{sub:interpolation}中详细讨论。

\section{线性代数}\label{sec:Linear_Algebra}

\subsection{线性空间}\label{sub:linear_space}

本书默认读者熟悉矩阵的基本运算，这里不再赘述。本小节来补充\textbf{线性空间}(linear space)及一些相关的概念\cite{linear_algebra}。

\begin{definition}[线性空间]
    给定集合$V$及数域$F$，如果定义了两个运算：
    \begin{itemize}
        \item 向量加法：$+:V\times V\rightarrow V$
        \item 数乘：$\cdot :F\times V\rightarrow V$
    \end{itemize}
    满足以下公理：
    \begin{enumerate}
        \item \textbf{加法封闭性}：$\forall \mathbf{u},\mathbf{v}\in V,\mathbf{u}+\mathbf{v}\in V$
        \item \textbf{加法交换律}：$\forall \mathbf{u},\mathbf{v}\in V,\mathbf{u}+\mathbf{v}=\mathbf{v}+\mathbf{u}$
        \item \textbf{加法结合律}：$\forall \mathbf{u},\mathbf{v},\mathbf{w}\in V,(\mathbf{u}+\mathbf{v})+\mathbf{w}=\mathbf{u}+(\mathbf{v}+\mathbf{w})$
        \item \textbf{存在加法单位元}：$\exists \mathbf{0}\in V,\forall \mathbf{v}\in V,\mathbf{v}+\mathbf{0}=\mathbf{v}$
        \item \textbf{存在加法逆元}：$\forall \mathbf{v}\in V,\exists -\mathbf{v}\in V,\mathbf{v}+(-\mathbf{v})=\mathbf{0}$
        \item \textbf{数乘封闭性}：$\forall \alpha\in F,\forall \mathbf{v}\in V,\alpha\cdot\mathbf{v}\in V$
        \item \textbf{数乘结合律}：$\forall \alpha,\beta\in F,\forall \mathbf{v}\in V,(\alpha\beta)\cdot\mathbf{v}=\alpha\cdot(\beta\cdot\mathbf{v})$
        \item \textbf{数乘分配律1}：$\forall \alpha\in F,\forall \mathbf{u},\mathbf{v}\in V,\alpha\cdot(\mathbf{u}+\mathbf{v})=\alpha\cdot\mathbf{u}+\alpha\cdot\mathbf{v}$
        \item \textbf{数乘分配律2}：$\forall \alpha,\beta\in F,\forall \mathbf{v}\in V,(\alpha+\beta)\cdot\mathbf{v}=\alpha\cdot\mathbf{v}+\beta\cdot\mathbf{v}$
        \item \textbf{数乘单位元}：$\forall \mathbf{v}\in V,1\cdot\mathbf{v}=\mathbf{v}$
    \end{enumerate}
    则称$V$为F-\textbf{线性空间}。特别地，当$F=\mathbb{C}$时，称$V$为\textbf{复线性空间}；当$F=\mathbb{R}$时，称$V$为\textbf{实线性空间}。
\end{definition}

线性空间是对向量的进一步抽象，使得向量的概念不再局限于几何意义上的有向线段，而是可以是任意满足上述公理的对象，例如函数、矩阵等都可以构成线性空间。线性空间中的元素称为\textbf{向量}。本书的后续内容中，将会涉及到许许多多的函数空间，例如连续函数空间、可积函数空间等，它们绝大多数都是线性空间。

\begin{definition}[子空间]
    线性空间中的子集如果本身也构成线性空间，则称为\textbf{子空间}(subspace)。
\end{definition}

\begin{example}
    设$V$为所有实值连续函数构成的线性空间，定义子集$W=\{f(x)\in V|f(0)=0\}$，则$W$为$V$的子空间。\\
    证明：$\forall f(x),g(x)\in W,\forall \alpha,\beta\in \mathbb{R}$，则有$(\alpha f+\beta g)(0)=\alpha f(0)+\beta g(0)=0$，所以$\alpha f+\beta g\in W$，因此$W$为$V$的子空间。
\end{example}

\begin{definition}[基]
    给定线性空间$V$，如果$V$中的向量组$\{\mathbf{v}_i\}$线性无关，且$V$中任意向量都可以由$\{\mathbf{v}_i\}$线性表示，则称$\{\mathbf{v}_i\}$为$V$的一组\textbf{基}(basis)。
\end{definition}

根据处理矩阵的经验，我们可以很容易地理解线性无关和线性表示的概念。线性无关指的是不存在非零系数使得向量组的线性组合为零向量；线性表示指的是任意向量都可以表示为基向量的线性组合。容易验证，线性空间的基不唯一，但所有基的向量个数相同。

\begin{definition}[维数]
    线性空间$V$的任意一组基的向量个数称为$V$的\textbf{维数}(dimension)，记为$\dim V$。如果$V$的维数为有限值，则称$V$为\textbf{有限维}线性空间，否则称为\textbf{无限维}线性空间。
\end{definition}

显然，子空间的维数低于母空间的维数。

我们将在\ref{sub:infinite_linear}中讨论无限维线性空间的内容。

\begin{example}
    设$V$为所有实值连续函数构成的线性空间，则$V$为无限维线性空间。\\
    证明：多项式函数构成一个线性空间。多项式空间是$V$的子空间，它已经是无限维的，因为它的基可以取为$\{1,x,x^2,x^3,\ldots\}$。
\end{example}

\begin{definition}[线性变换]
    设有线性空间$V$和$W$，如果映射$T:V\to W$满足：
    \[T(\alpha \mathbf{u}+\beta \mathbf{v})=\\alpha T(\mathbf{u})+\beta T(\mathbf{v}),\forall \mathbf{u},\mathbf{v}\in V,\forall \alpha,\beta\in F\]
    则称$T$为从$V$到$W$的\textbf{线性变换}(linear transformation)。
\end{definition}

\begin{example}
    对于向量$\mathbf{v}\in\mathbb{R}^n$，定义映射$T:\mathbb{R}^n\to\mathbb{R}^m$为矩阵$A\in\mathbb{R}^{m\times n}$与$\mathbf{v}$的乘积，即$T(\mathbf{v})=A\mathbf{v}$，则$T$为从$\mathbb{R}^n$到$\mathbb{R}^m$的线性变换。
\end{example}

\begin{example}
    设$V$为所有实值无限可微的函数构成的线性空间（记为$C^\infty(\mathbb{R})$），定义映射$T:V\to V$为微分算子，即$T(f)=f'$，则$T$为从$V$到$V$的线性变换。\\
    证明：$\forall f(x),g(x)\in V,\forall \alpha,\beta\in \mathbb{R}$，根据微分的线性性质，有
    \begin{align*}
        T(\alpha f+\beta g)&=(\alpha f+\beta g)'\\
                           &=\alpha f'+\beta g'\\
                           &=\alpha T(f)+\beta T(g)
    \end{align*}
    因此$T$为从$V$到$V$的线性变换。
\end{example}

对于有限维线性空间，取定一组基，线性变换可以用矩阵表示，这与我们处理矩阵的经验是一致的。但是，对于无限维线性空间，线性变换只能作为抽象的映射来处理，无法用矩阵表示。

在线性映射中，有一类特殊的线性映射，它将线性空间映射到数域，我们将这样的映射称为\textbf{线性函数}。

\begin{definition}[对偶空间]
    给定线性空间$V$，所有从$V$到数域$F$的线性函数构成的集合称为$V$的\textbf{对偶空间}(dual space)，记为$\mathcal{L} (V,F)$或$V^*$。线性映射的加法和数乘的定义是不言自明的，因此$\mathcal{L} (V,F)$本身也是一个线性空间。

    如果$V$是某种函数空间，则线性函数又称为\textbf{线性泛函}(linear functional)。一些文献中，不区分$V$是否为函数空间，而统一地将线性函数称为线性泛函。
\end{definition}
\begin{example}
    设$V$为所有实值连续函数构成的线性空间，定义映射$T:V\to \mathbb{R}$为积分算子，即$T(f)=\int_{a}^{b}f(x)\,dx$，则$T$为从$V$到$\mathbb{R}$的线性变换，因此$T\in \mathcal{L} (V,F)$。
\end{example}

对于有限维线性空间，它的对偶空间与它本身同构（或者说，定义$V$上的线性函数，就等价于对它的一组基定义函数值），因而具有相同的维度；对于无限维线性空间，它的对偶空间也是无限维的。

\subsection{度量、范数和内积}\label{sub:measurement}

本小节来介绍度量空间、线性赋范空间和内积空间\cite{linear_algebra}。
\begin{definition}[度量]
    在集合$V$中，如果定义了运算
$d(\cdot,\cdot):V\times V\rightarrow \mathbb{R}  $，满足\textbf{度量公理}：
\begin{enumerate}
    \item \textbf{非负性}：$d(x, y) \geq 0$
    \item \textbf{同一性}：$d(x, y) = 0$ 当且仅当 $x = y$
    \item \textbf{对称性}：$d(x, y) = d(y, x)$
    \item \textbf{三角不等式}：$d(x, z) \leq d(x, y) + d(y, z)$
\end{enumerate}
则称在$V$上定义了一种度量，称$V$为\textbf{度量空间}(metric space)。
\end{definition}

\begin{example}[离散度量]
    设$V$为任意集合，定义运算
    \[
    d(x,y) = \begin{cases}
    0, & \text{if } x = y \\
    1, & \text{if } x \neq y
    \end{cases}
    \]
    则$d$满足度量公理，称为离散度量。
\end{example}

\begin{definition}[范数]
    如果定义了运算
$\|\cdot \| :V\rightarrow \mathbb{R} $，满足\textbf{范数公理}
\begin{enumerate}
    \item \textbf{非负性}：$\|\mathbf{x}\| \geq 0$
    \item \textbf{同一性}：$\|\mathbf{x}\| = 0$ 当且仅当 $\mathbf{x} = \mathbf{0}$
    \item \textbf{齐次性}：$\|\alpha \mathbf{x}\| = |\alpha| \, \|\mathbf{x}\|$
    \item \textbf{三角不等式/次可加性}：$\|\mathbf{x} + \mathbf{y}\| \leq \|\mathbf{x}\| + \|\mathbf{y}\|$
\end{enumerate}
则称在$V$上定义了一种范数，称$V$为\textbf{线性赋范空间}(normed linear space)。
\end{definition}
特别地，在$\mathbb{C}$ -线性空间$V$上定义范数后，可以自然地诱导出一种度量：
$$d(\mathbf x,\mathbf y)=||\mathbf x-\mathbf y||$$
在线性赋范空间上可以定义极限：
\[\lim_{x \to x_0} f(x)=A:=\forall \epsilon>0\exists \delta>0(||x-x_0||<\delta\Rightarrow ||f(x)-f(x_0)||<\epsilon) \]
这就是数学分析中的极限定义，只是将绝对值改成了范数，其余类似的极限定义不再赘述。

\begin{definition}[完备的线性赋范空间]
    如果线性赋范空间中所有柯西列都有极限，那么这个空间称为\textbf{完备的线性赋范空间}，或称为巴拿赫空间（有限维）、希尔伯特空间（无限维）\cite{zorich}.
\end{definition}

\begin{example}
    连续函数空间$C[a,b]$是不完备的线性赋范空间：\\
    在1-范数
$\|f\|_1 =\int_{a}^{b}|f(t)|\,\text dt$下，其中的柯西列\begin{align*}
    f_n(t)=\begin{cases}
        0,&\text{if }-1\leq t <0\\
        nt,&\text{if }0\leq t <\frac{1}{n}\\
        1,&\text{if }\frac{1}{n}\leq t \leq 1
    \end{cases}
\end{align*}
的极限为单位阶跃函数$u(t)$（在0处取值为0），不属于$C[-1,1]$.
\end{example}

\begin{definition}[内积]
    如果定义了运算
$\langle \cdot,\cdot\rangle:V\times V\rightarrow \mathbb{C} $，满足\textbf{内积公理}
\begin{enumerate}
    \item \textbf{正定性}：$\langle \mathbf{v}, \mathbf{v} \rangle \geq 0$ 且 $\langle \mathbf{v}, \mathbf{v} \rangle = 0$ 当且仅当 $\mathbf{v} = \mathbf{0}$
    \item \textbf{共轭对称性}：$\langle \mathbf{v}, \mathbf{w} \rangle = \overline{\langle \mathbf{w}, \mathbf{v} \rangle}$
    \item \textbf{第一变元的线性性}：
          \begin{itemize}
              \item \textbf{齐性}：$\langle \alpha \mathbf{v}, \mathbf{w} \rangle = \alpha \langle \mathbf{v}, \mathbf{w} \rangle$
              \item \textbf{可加性}：$\langle \mathbf{v} + \mathbf{w}, \mathbf{u} \rangle = \langle \mathbf{v}, \mathbf{u} \rangle + \langle \mathbf{w}, \mathbf{u} \rangle$
          \end{itemize}
\end{enumerate}
则称在V上定义了一种内积 (inner product)，称V为内积空间。
\end{definition}
在内积空间上有著名的\textbf{柯西-施瓦兹不等式} (Cauchy-Shwartz inequality)：
\begin{theorem}[柯西-施瓦兹不等式]
    \[|\langle \mathbf{a,b}\rangle| \leq \| \mathbf{a}\| \| \mathbf{b}\| \]
\end{theorem}
\begin{proof}
不妨设$\mathbf{b}$不是零向量，任取$t\in \mathbb{R}$，有
\[0\leq \|\mathbf{a}+t\mathbf{b}\|^2=\|\mathbf{a}\|^2+2t\langle\mathbf{a,b}\rangle +t^2\|\mathbf{b}\|^2\]
令$t=-\dfrac{\langle\mathbf{a,b}\rangle}{\|\mathbf{b}\|^2}$，即得
\[0\leq \|\mathbf{a}\|^2-2\frac{\langle\mathbf{a,b}\rangle^2}{\|\mathbf{b}\|^2} +\frac{\langle\mathbf{a,b}\rangle^2}{\|\mathbf{b}\|^4}\|\mathbf{b}\|^2=\|\mathbf{a}\|^2-\frac{\langle\mathbf{a,b}\rangle^2}{\|\mathbf{b}\|^2}\]
这与要证明的不等式是等价的。
\end{proof} 
有了柯西-施瓦兹不等式，三角不等式就是显然的了，这里仅给出其表述，读者可以自行证明。
\begin{proposition}[三角不等式]
    \[\forall \mathbf{a,b}\in V,\|\mathbf{a+b}\|\leq\|\mathbf{a}\|+\|\mathbf{b}\|\]
\end{proposition}

不难发现，只要取$\|\mathbf{v}\|^2=\langle \mathbf{v}, \mathbf{v} \rangle$，就由内积导出了一种范数，并且这种范数具有比一般的范数更强的性质；只要取$d(\mathbf{x},\mathbf{y})=\|\mathbf{x-y}\|$，就由范数导出了一种度量，并且这种度量具有比一般的度量更强的性质。因此，可以说内积空间是特殊的线性赋范空间，线性赋范空间是特殊的度量空间。

\subsection{无穷维线性空间}\label{sub:infinite_linear}

\begin{definition}[无限维线性空间和基]
    如果一个线性空间V的维数是无限的，就称之为\textbf{无限维线性空间}。\\
对于V，我们称向量列
$\lbrace\mathbf{v_i}\rbrace_{i=1}^{\infty}$是V的一组基，如果
\begin{itemize}
    \item 线性无关性：任取基中的有限个向量，它们是线性无关的
    \item 有限生成性：任取向量$\mathbf{w} \in V$，存在有限个向量
          $V'=\lbrace\mathbf{v_1,v_2,\dots,v_r}\rbrace\subset V $，$\mathbf{w}$可以用$V'$线性表出
\end{itemize}
\end{definition}
这里要求“有限”是为了避免敛散性的问题：例如收敛的级数构成线性空间，如果我们声称取定了一组基（当然是无限的），并考察其中无限个基张成的空间，那么对于构成级数的每一项，均需要考察其敛散性。然而，级数的敛散性自然可以对前有限项不做要求，它们求和很可能不会收敛；从另一个角度来讲，一些更加抽象的线性空间中，也说不清楚基的无限和是否收敛。

\begin{example}
    数列空间$l^2$是所有平方可和数列构成的线性空间，即
    \[l^2=\left\{x=(x_1,x_2,\ldots)\left|\sum_{i=1}^{\infty}|x_i|^2<\infty\right.\right\}\]
    $l^2$空间几乎是行向量（或列向量）的推广，但向量列$\{e_i\}_{i=1}^{\infty}$，其中$e_i$表示第$i$个分量为1，其余分量为0的数列，不是$l^2$空间的基，因为它不满足有限生成性。对于任意一个无限项的数列$x\in l^2$，无法找到有限个$e_i$使得$x$可以由它们线性表示。
\end{example}
\begin{example}
    多项式空间$P$是所有实值多项式函数构成的线性空间，即
    \[P=\left\{f(x)=\sum_{i=0}^{n}a_i x^i|n\in \mathbb{N},a_i\in \mathbb{R}\right\}\]
    多项式空间的基可以取为$\{1,x,x^2,x^3,\ldots\}$，它满足线性无关性和有限生成性，因此$P$是无限维线性空间。
\end{example}

\begin{claim}
    只要承认选择公理（或左恩引理），无限维线性空间总存在基。
\end{claim}

在\ref{sec:Real_Analysis}中，我们将看到更多无穷维线性空间的例子，它们当中很多都是完备的线性赋范空间。寻找函数空间的基是困难的，但在某些情况下，我们可以找到一些特殊的正交函数系作为基函数系，从而将函数展开为这些基函数的线性组合，这就是傅里叶级数展开的基本思想，见\ref{sec:Orthognal}。

\section{特殊函数}\label{sec:special_function}

特殊函数是一类具有特殊性质的函数，由积分、级数等特殊的方式定义，且大多为非初等函数。本节介绍一些常用的特殊函数，用于简化后续的讨论和计算。这些特殊函数对于包括信号与系统在内的许多课程的学习都会有所帮助，因此读者至少应该接受其中的一些主要结果。

\subsection{伽马函数与贝塔函数}\label{sub:Gamma}

\begin{definition}
    \textbf{伽马函数}定义在复平面$\mathbb{C}$的右半平面上：
    \[\Gamma (z)=\int_{0}^{\infty}x^{z-1}e^{-x}\,dx,\text{Re}(z)>0\]
\end{definition}
注意到$\text{Re}(z)>0$时，$|x^{z-1}e^{-x}|<t^{\text{Re}(z)-1}$，而$t^{\text{Re}(z)-1}$在$[0,\infty)$上可积，因此伽马函数的积分定义在右半平面$\text{Re}(z)>0$上收敛。事实上它是$\text{Re}(z)>0$上的全纯函数，全纯的概念，见\ref{sec:Complex}。

初次接触这个函数时，最好将$z$作为实数来理解。伽马函数是阶乘函数的推广，因为对于正整数$n$，有$\Gamma (n)=(n-1)!$，这是因为伽马函数满足以下递推关系：
\begin{theorem}
    \[\Gamma (z+1)=z\Gamma (z)\]
\end{theorem}
\begin{proof}
    \begin{align*}
    \Gamma (z+1)&=\int_{0}^{\infty}t^{z}e^{-t}\,dt\\
                &=-\int_{0}^{\infty}t^{z}\,d(e^{-t})\\
                &=\evalat{-t^{z}e^{-t}}{0}{\infty}+\int_{0}^{\infty}e^{-t}\,d(t^{z})\\
                &=0+\int_{0}^{\infty}e^{-t}zt^{z-1}\,dt\\
                &=z\Gamma (z)
    \end{align*}
    因此，在n为正整数时，我们可以直接计算出$\Gamma(n)$的数值，因为：
    \begin{align*}
        \Gamma(1)=&\int_{0}^{\infty}e^{-t}\,dt=1\\
    \end{align*}
\end{proof}

尽管难以直接算出伽马函数在非整数点的值，但我们可以通过一些特殊值和性质来理解它。例如，$\Gamma(1/2)=\sqrt{\pi}$，并且由此可以算出$n+1/2$处的伽马函数值。$\Gamma(1/2)=\sqrt{\pi}$是通过以下公式推导出的：
\begin{claim}[余元公式]
    \[\Gamma (z)\Gamma (1-z)=\frac{\pi}{\sin(\pi z)},\quad z\notin \mathbb{Z}\]
\end{claim}

令$z=1/2$，就得到了刚才提到的结果。这个公式的证明必须借助复变函数中的留数定理，读者可以在复分析教材中找到相关内容，如\cite{Function_Theory}。不过，多数本科生的《复变函数》课程的教材并不涉及特殊函数，本书也将直接使用这一公式。
%folland给出了换元方法，转化为我积累过的特定形式，可以考虑补充

下面介绍一个与伽马函数有着紧密联系的特殊函数：\textbf{贝塔函数}。

\begin{definition}[贝塔函数]
    \[B(p,q)=\int_{0}^{1}x^{p-1}(1-x)^{q-1}\,dx,\text{Re}(p)>0,\text{Re}(q)>0\]
\end{definition}
贝塔函数又称\textbf{B函数}，或\textbf{欧拉第一积分}。只要做变量替换$y=1-x$，就可以看出它是对称的，即$B(p,q)=B(q,p)$。贝塔函数与伽马函数之间有如下关系：
\begin{theorem}
    \[B(p,q)=\frac{\Gamma (p)\Gamma (q)}{\Gamma (p+q)}\]
\end{theorem}
\begin{proof}
    \begin{align*}
    \Gamma (p)\Gamma (q)&=\int_{0}^{\infty}x^{p-1}e^{-x}\,dx\int_{0}^{\infty}y^{q-1}e^{-y}\,dy\\
                       &=\int_{0}^{\infty}\int_{0}^{\infty}x^{p-1}y^{q-1}e^{-(x+y)}\,dx\,dy\\
                       &=\int_{0}^{\infty}\int_{u}^{\infty}x^{p-1}(u-x)^{q-1}e^{-u}\,dx\,du&(u=x+y)\\
                       &=\int_{0}^{\infty}\int_{0}^{x}x^{p-1}(u-x)^{q-1}e^{-u}\,du\,dx\\
                       &=\int_{0}^{\infty}e^{-x}x^{p+q-1}\,dx\int_{0}^{1}t^{q-1}(1-t)^{p-1}\,dt&\left(t=\frac{u}{x}\right)\\
                       &=\Gamma (p+q)B(q,p)=\Gamma (p+q)B(p,q)
    \end{align*}
\end{proof}

在另一种变量替换下，可以得到贝塔函数的等价定义：
\begin{definition}[贝塔函数的等价定义]
    \[B(p,q)=\int_{0}^{\pi/2}\cos^{p-1}\theta\sin^{q-1}\theta\,d\theta\]
\end{definition}

\begin{proof}
    \begin{align*}
    \Gamma (p)\Gamma (q)&=\int_{0}^{\infty}x^{p-1}e^{-x}\,dx\int_{0}^{\infty}y^{q-1}e^{-y}\,dy\\
                       &=\int_{0}^{\infty}\int_{0}^{\infty}x^{p-1}y^{q-1}e^{-(x+y)}\,dx\,dy\\
                       &=\int_{0}^{\pi/2}\int_{0}^{\infty}(r\cos\theta)^{p-1}(r\sin\theta)^{q-1}e^{-r}r\,dr\,d\theta&\left((x,y)=(r\cos\theta,r\sin\theta)\right)\\
                       &=\int_{0}^{\pi/2}\cos^{p-1}\theta\sin^{q-1}\theta\,d\theta\int_{0}^{\infty}r^{p+q-1}e^{-r}\,dr\\
                       &=\Gamma (p+q)\int_{0}^{\pi/2}\cos^{p-1}\theta\sin^{q-1}\theta\,d\theta
    \end{align*}
\end{proof}

利用以上几个公式，可以快速计算定积分。

\begin{example}[伽马函数的变形]
    计算定积分$\int_{0}^{\infty}x^{n}e^{-ax}\,dx,a>0,n\in\mathbb{N}$。\\
解：可以利用分部积分求解，但更简便的方法是利用伽马函数的定义进行变量替换：
    \begin{align*}
        \int_{0}^{\infty}x^{n}e^{-ax}\,dx&=\frac{1}{a^{n+1}}\int_{0}^{\infty}(ax)^{n}e^{-ax}\,d(ax)\\
                                          &=\frac{\Gamma (n+1)}{a^{n+1}}\\
                                          &=\frac{n!}{a^{n+1}}
    \end{align*}
\end{example}

%下面是一个比较特殊的例子。
%\begin{example}[余元公式的使用]
%    计算定积分$\int_{0}^{\infty}\dfrac{x^{a-1}}{1+x}\,dx,0<a<1$。\\
%解：令$x=\dfrac{t}{1-t}$，则$dx=\dfrac{1}{(1-t)^2}dt$，积分变为
%    \begin{align*}
%        \int_{0}^{\infty}\frac{x^{a-1}}{1+x}\,dx&=\int_{0}^{1}t^{a-1}(1-t)^{-a}\,dt\\
%                                               &=B(a,1-a)\\
%                                               &=\frac{\Gamma (a)\Gamma (1-a)}{\Gamma (1)}\\
%                                               &=\frac{\pi}{\sin(\pi a)}
%    \end{align*}
%\end{example}

%比起将未知问题化归为已知问题，我们更愿意将大学问题化归为小学问题：
\begin{example}[贝塔函数的使用]
    计算定积分$\int_{0}^{1}x^2(1-x)^7\,dx$。\\
    解：利用二项式展开或者分部积分都可以计算出结果，但实际计算非常复杂且容易出错。更简便的方法是利用贝塔函数：\begin{align*}
        \int_{0}^{1}x^2(1-x)^7\,dx&=B(3,8)\\
                                 &=\frac{\Gamma (3)\Gamma (8)}{\Gamma (11)}\\
                                 &=\frac{2! \cdot 7!}{10!}\\
                                 &=\frac{1}{60}
    \end{align*}
\end{example}

利用贝塔函数的等价定义，还可以计算一些特定的三角函数的定积分：
\begin{proposition}
    设$m,n>-1$，则有
    \[\int_{0}^{\pi/2}\sin^m\theta\cos^n\theta\,d\theta=\frac{1}{2}B\left(\frac{m+1}{2},\frac{n+1}{2}\right)\]
    进一步，若$m,n$是奇数，设$m=2k-1,n=2l-1,k,l\in\mathbb{N}$，则
    \[\int_{0}^{\pi/2}\sin^{2k+1}\theta\cos^{2l+1}\theta\,d\theta=B(k,l)=\frac{(k-1)!(l-1)!}{(k+l-1)!}\]
    若$m,n$是偶数，设$m=2k,n=2l,k,l\in\mathbb{N}$，则
    \[\int_{0}^{\pi/2}\sin^{2k}\theta\cos^{2l}\theta\,d\theta=B\left(k+\frac{1}{2},l+\frac{1}{2}\right)=\pi\frac{(2k)!(2l)!}{4^{k+l}k!l!(k+l)!}=\pi\frac{(2k-1)!!(2l-1)!!}{((2k+2l)!!)}\]
    其中$k!!=k(k-2)(k-4)\cdots$表示双阶乘，是公差为2的\textbf{正整数}的连乘积。

    特别地，当$m=0$或$n=0$时，有
    \begin{align*}
        \int_{0}^{\pi/2}\sin^{2k}\theta\,d\theta=\int_{0}^{\pi/2}\cos^{2k}\theta\,d\theta&=B\left(\frac{1}{2},k+\frac{1}{2}\right)=\begin{cases}
            \frac{(k-1)!!}{k!!}, & k\text{为奇数} \\
            \frac{\pi}{2}\cdot\frac{(k-1)!!}{k!!}, & k\text{为偶数}
        \end{cases}
    \end{align*}
    这个结果称为\textbf{沃利斯公式}(Wallis formula)。
\end{proposition}
\begin{proof}
    我们仅对后两个公式进行一些说明。对于$m=2k,n=2l$的情况，有
    \begin{align*}
        B\left(k+\frac{1}{2},l+\frac{1}{2}\right)&=\frac{\Gamma \left(k+\frac{1}{2}\right)\Gamma \left(l+\frac{1}{2}\right)}{\Gamma \left(k+l+1\right)}\\
        &=\frac{\left(k-\frac{1}{2}\right)\left(k-\frac{3}{2}\right)\cdots\frac{1}{2}\cdot\sqrt{\pi}\cdot\left(l-\frac{1}{2}\right)\left(l-\frac{3}{2}\right)\cdots\frac{1}{2}\cdot\sqrt{\pi}}{(k+l)!}\\
        &=\frac{\pi(2k)!(2l)!}{4^{k+l}k!l!(k+l)!}\\
        &=\pi\frac{(2k-1)!!(2l-1)!!}{((2k+2l)!!)}
    \end{align*}
    其中我们用到了$\Gamma(1/2)=\sqrt{\pi}$以及伽马函数的递推关系$\Gamma(z+1)=z\Gamma(z)$。
    
    对于$m=0$或$n=0$的情况，有
    \begin{align*}
        B\left(\frac{1}{2},k+\frac{1}{2}\right)&=\frac{\Gamma \left(\frac{1}{2}\right)\Gamma \left(k+\frac{1}{2}\right)}{\Gamma \left(k+1\right)}\\
                                             &=\frac{\sqrt{\pi}\cdot\left(k-\frac{1}{2}\right)\left(k-\frac{3}{2}\right)\cdots\frac{1}{2}\cdot\sqrt{\pi}}{k!}\\
                                             &=\begin{cases}
            \frac{(k-1)!!}{k!!}, & k\text{为奇数} \\
            \frac{\pi}{2}\cdot\frac{(k-1)!!}{k!!}, & k\text{为偶数}
        \end{cases}
    \end{align*}
\end{proof}

初次接触双阶乘的读者，最好对照以上证明检查自己的运算结果作为练习。使用特殊函数的方法算出这样的结果后，相信任何一个理智的人都会采用特殊函数的方法进行计算。

\subsection{正弦积分函数}\label{sub:int_sin}

本小节介绍\textbf{正弦积分函数}及\textbf{狄利克雷积分}，后文中将多次使用它们。

\begin{definition}[正弦积分函数]
    \[\text{Si}(x)=\int_{0}^{x}\frac{\sin t}{t}\,dt\]    
\end{definition}
\begin{figure}[H]
    \centering
    \includegraphics[width=0.5\textwidth]{intsin}
    \caption{正弦积分函数$\text{Si}(x)$的图像}
\end{figure}
$\dfrac{\sin t}{t}$是\ref{sub:signal}中介绍的采样信号，在$t=0$处连续延拓为1。正弦积分函数在$x=0$处的值为0，并且是奇函数，因为它的导数是偶函数。

正弦积分函数是有界的。为估计$\lim_{x\to\infty}\text{Si}(x)$，我们考虑区间$[n\pi,(n+1)\pi]$上的积分：
\begin{align*}
    \int_{n\pi}^{(n+1)\pi}\frac{\sin t}{t}\,dt&=\int_{0}^{\pi}\frac{\sin(t+n\pi)}{t+n\pi}\,dt\\
    &=(-1)^n\int_{0}^{\pi}\frac{\sin t}{t+n\pi}\,dt
\end{align*}
由于$n\pi\leq t+n\pi\leq (n+1)\pi$，有
\begin{align*}
    \frac{1}{(n+1)\pi}\int_{0}^{\pi}\sin t\,dt&\leq \int_{0}^{\pi}\frac{\sin t}{t+n\pi}\,dt\leq \frac{1}{n\pi}\int_{0}^{\pi}\sin t\,dt\\
    \frac{2}{(n+1)\pi}&\leq \int_{0}^{\pi}\frac{\sin t}{t+n\pi}\,dt\leq \frac{2}{n\pi}
\end{align*}
因此，
\begin{align*}
    \int_{0}^{\infty}\frac{\sin t}{t}\,dt&=\sum_{n=0}^{\infty}\int_{n\pi}^{(n+1)\pi}\frac{\sin t}{t}\,dt\\
                                 &=\sum_{n=0}^{\infty}(-1)^n\int_{0}^{\pi}\frac{\sin t}{t+n\pi}\,dt
\end{align*}
是交错级数，其各项绝对值单调递减且趋于0，根据Leibniz判别法可知该级数收敛，即积分收敛。由于正弦积分函数是奇函数，$\text{Si}(-\infty)$也是收敛的，综上我们说明了正弦积分函数的有界性。

进一步，正弦积分函数在$\infty$处收敛于$\dfrac{\pi}{2}$，这个结果称为\textbf{狄利克雷积分}，它可以通过留数定理或傅里叶变换来证明，我们将在\ref{sub:fourier_of_signal}中给出基于傅里叶变换的证明。
\begin{theorem}[狄利克雷积分]
    \[\int_{0}^{\infty}\frac{\sin t}{t}\,dt=\text{Si}(\infty)=\frac{\pi}{2}\]
\end{theorem}

\begin{corollary}
    由于正弦积分函数是偶函数，有
    \[\int_{-\infty}^{\infty}\frac{\sin t}{t}\,dt=\pi\]
    做变量代换$t=ax(a>0)$，可得
    \[\int_{-\infty}^{\infty}\frac{\sin (ax)}{x}\,dx=\pi\]
    在$a<0$时，积分值为$-\pi$，因此上述积分的结果可统一表示为$\pi\text{sgn}(a)$。
\end{corollary}

然而，狄利克雷积分不是绝对收敛的。考虑$[0,\infty)$的等长的子区间族
$$I_n=\left[(n+\frac{1}{6})\pi,(n+\frac{5}{6})\pi\right],n=0,1,2,\cdots$$
在每个区间上，有
$$t\leq n+1,|\sin t|\geq \frac{1}{2},\int_{I_n}\left|\frac{\sin t}{t}\right|\,dt \geq \int_{I_n}\frac{1}{2t}\,dt\geq\frac{\pi}{3}\sum_{n=1}^{\infty}\frac{1}{n+1}$$
$\sum_{n=1}^{\infty}\frac{1}{n}$是发散的调和级数。综上，我们说明了狄利克雷积分条件收敛，但不绝对收敛：
$$\int_{0}^{\infty}\left|\frac{\sin t}{t}\right|\,dt=\infty$$

%\subsection{指数积分函数，误差函数}\label{sub:int_exp}

%\begin{definition}[指数积分函数]
%    n阶指数积分函数定义为
%    \[\text{E}_n(x)=\int_{1}^{\infty}\dfrac{e^{-xt}}{t^n}\,dt,\text{Re}(x)>0\]
%    特别地，\textbf{指数积分函数}常指$\text{E}_1(x)$，记为$\text{Ei}(x)$，它有等价的定义式
%    \[\text{Ei}(x)=\int_{x}^{\infty}\frac{e^{-t}}{t}\,dt\]
%\end{definition}
%\begin{figure}[H]
%    \centering
%    \includegraphics[width=0.5\textwidth]{Ei}
%    \caption{指数积分函数$\text{Ei}(x)$的图像}
%\end{figure}
%可以看到，指数积分函数在$x=0$处有一个奇点，并且在$x\to \infty$时发散到正无穷大，在$x\to -\infty$时趋于0。

%我们来验证两种定义的等价性。
%\begin{align*}
%    \text{E}_1(x)&=\int_{1}^{\infty}\frac{e^{-xt}}{t}\,dt\\
%                 &=\int_{x}^{\infty}\frac{e^{-u}}{u}\,du&(u=xt)\\
%                 &=\text{Ei}(x)
%\end{align*}
%误差函数、补误差函数

\subsection{*贝塞尔函数}\label{sub:bessel}

贝塞尔函数是研究物理和工程问题时时常遇到的一种特殊函数，尤其是在涉及圆柱对称问题时。贝塞尔函数是贝塞尔方程的解，贝塞尔方程定义为：
\begin{definition}[贝塞尔方程]
    形如
    \[x^2\frac{d^2y}{dx^2}+x\frac{dy}{dx}+(x^2-\nu^2)y=0\]
    的微分方程称为\textbf{贝塞尔方程}(Bessel equation)，其中常数$\nu\in\mathbb{C}$称为方程的\textbf{阶数}。
\end{definition}
\begin{definition}[贝塞尔函数]
    $\nu$阶贝塞尔微分方程的解称为$\nu$阶\textbf{贝塞尔函数}(Bessel function)。当$\nu\in\mathbb{N}$时，称为\textbf{第一类贝塞尔函数}，记为$J_n(x)$，他是我们本小节的主要研究对象。
\end{definition}

贝塞尔方程无法用初等积分法求解，但可以使用幂级数法求解，即假设解可以表示为幂级数的形式，带入方程中，比较各阶系数，从而确定幂级数的系数。取定常数项
$$a_0=\frac{1}{2^\nu\Gamma(\nu+1)}$$
则可唯一确定贝塞尔函数的幂级数展开式如下：
\begin{claim}
    贝塞尔函数的幂级数展开式为
    \[J_{\nu}(x)=\sum_{k=0}^{\infty}\frac{(-1)^k}{k!\Gamma(\nu+k+1)}\left(\frac{x}{2}\right)^{\nu+2k}\]
    特别地，第一类$n$阶贝塞尔函数为
    \[J_{n}(x)=\sum_{k=0}^{\infty}\frac{(-1)^k}{k!(n+k)!}\left(\frac{x}{2}\right)^{n+2k}\]
\end{claim}
其推导过程可以参考\cite{folland}。下面指出贝塞尔函数的一些性质：

\begin{proposition}[递推公式]
    任给$x,\nu$，有
    \begin{align*}
        &\frac{d}{dx}[x^{-\nu}J_{\nu}(x)]=-x^{-\nu}J_{\nu+1}(x)\\
        &\frac{d}{dx}[x^{\nu}J_{\nu}(x)]=x^{\nu}J_{\nu-1}(x)\\
        &xJ'_{\nu}(x)-\nu J_{\nu}(x)=-xJ_{\nu+1}(x)\\
        &xJ'_{\nu}(x)+\nu J_{\nu}(x)=xJ_{\nu-1}(x)\\
        &xJ_{\nu-1}(x)+xJ_{\nu+1}(x)=2\nu J_{\nu}(x)\\
        &J'_{\nu-1}(x)-J'_{\nu+1}(x)=2J_{\nu}(x)
    \end{align*}
\end{proposition}

这些性质是通过对贝塞尔函数的幂级数展开式逐项求导得到的。利用递推公式，可以计算出一些特殊值，例如：
\begin{align*}
    J_n(0)&=0,n\in\mathbb{N}\\
    J'_0(0)&=0\\
    J'_1(0)&=\frac{1}{2}\\
    J'_n(0)&=0,n\geq 2
\end{align*}

下面着重讨论第一类贝塞尔函数的性质。首先，贝塞尔函数满足公式：
\begin{proposition}
    任给$x$及$n\in\mathbb{N}$，有
    \[J_{-n}(x)=(-1)^n J_n(x)\]
\end{proposition}
\begin{proof}
    在$n<0$时，$n!$没有定义，但实际上，伽马函数可以延拓至$\mathbb{C}\setminus \mathbb{Z}^-$，而在负整数处趋于无穷，在这个意义下，我们说
    \[\frac{1}{\Gamma(z)}=0,z\in \mathbb{Z}^-\]
    因此，当$n$为正整数时，根据贝塞尔函数的级数形式的定义式，可以写出$J_{-n}(x)$的幂级数展开式：
    \[J_{-n}(x)=\sum_{k=0}^{\infty}\frac{(-1)^k}{k!\Gamma(-n+k+1)}\left(\frac{x}{2}\right)^{-n+2k}=\sum_{k=n}^{\infty}\frac{(-1)^k}{k!(k-n)!}\left(\frac{x}{2}\right)^{-n+2k}\]
    令$j=k-n$，则
    \begin{align*}
        J_{-n}(x)&=\sum_{j=0}^{\infty}\frac{(-1)^{j+n}}{(j+n)!j!}\left(\frac{x}{2}\right)^{-n+2(j+n)}\\
                 &=(-1)^n\sum_{j=0}^{\infty}\frac{(-1)^j}{(j+n)!j!}\left(\frac{x}{2}\right)^{n+2j}\\
                 &=(-1)^n J_n(x)
    \end{align*}
\end{proof}

\begin{proposition}
    第一类贝塞尔函数在$n$为偶数时是偶函数，在$n$为奇数时是奇函数。
\end{proposition}
\begin{proof}
    带入级数形式的定义式，有
    \begin{align*}
        J_n(-x)&=\sum_{k=0}^{\infty}\frac{(-1)^k}{k!(n+k)!}\left(\frac{-x}{2}\right)^{n+2k}\\
               &=(-1)^n\sum_{k=0}^{\infty}\frac{(-1)^k}{k!(n+k)!}\left(\frac{x}{2}\right)^{n+2k}\\
               &=(-1)^n J_n(x)
    \end{align*}
\end{proof}

下图给出了几个常见的第一类贝塞尔函数的图像。总体而言，贝塞尔函数以$\pi$为周期振荡，并且振幅随着$x$的增大而缓慢减小。
\begin{figure}[H]
        \centering
        \includegraphics[width=0.8\textwidth]{bessel}
        \caption{第一类贝塞尔函数$J_n(x),n=0,1,2,3$的图像}
\end{figure}

\begin{proposition}[贝塞尔积分公式]
    任给$x$及$n\in\mathbb{N}$，有
    \[J_n(x)=\frac{1}{2\pi}\int_{-\pi}^{\pi}\exp(ix\sin\theta - in\theta)\,d\theta=\frac{1}{\pi}\int_{0}^{\pi}\cos(x\sin\theta - n\theta)\,d\theta\]
    进一步，有
    \[J_n(x)=\frac{2}{\pi}\int_{0}^{\pi/2}\cos(x\sin\theta)\cos(n\theta)\,d\theta,\text{如果}n\text{为偶数}\]
    \[J_n(x)=\frac{2}{\pi}\int_{0}^{\pi/2}\sin(x\sin\theta)\sin(n\theta)\,d\theta,\text{如果}n\text{为奇数}\]
\end{proposition}
这个结果的证明需要用到生成函数及傅里叶级数的知识，见\cite{folland}。本书仅验证几个公式的等价性。
\begin{proof}
    做变量代换$\theta\to -\theta$，有
    \begin{align*}
        \frac{1}{2\pi}\int_{-\pi}^{0}\exp(ix\sin\theta - in\theta)\,d\theta&=\frac{1}{2\pi}\int_{0}^{\pi}\exp(-ix\sin\theta + in\theta)\,d\theta
    \end{align*}
    因此，
    \begin{align*}
        \frac{1}{2\pi}\int_{-\pi}^{\pi}\exp(ix\sin\theta - in\theta)\,d\theta&=\frac{1}{2\pi}\int_{0}^{\pi}[\exp(ix\sin\theta - in\theta)+\exp(-ix\sin\theta + in\theta)]\,d\theta\\
                                                                                     &=\frac{1}{\pi}\int_{0}^{\pi}\cos(x\sin\theta - n\theta)\,d\theta
    \end{align*}
    再做变量代换$\theta\to \pi-\theta$，利用诱导公式，有
    \begin{align*}
        J_n(x)=&\frac{1}{\pi}\int_{0}^{\pi}\cos(x\sin\theta - n\theta)\,d\theta\\
        =&\frac{1}{\pi}\int_{0}^{\pi}\cos(x\sin(\pi-\theta) - n(\pi-\theta))\,d\theta\\
        =&\frac{(-1)^n}{\pi}\int_{0}^{\pi}\cos(x\sin\theta + n\theta)\,d\theta
    \end{align*}
    因此，当$n$为偶数时，将上式与原式相加，利用和差化积公式，得到
    \begin{align*}
        J_n(x)&=\frac{1}{2\pi}\int_{0}^{\pi}[\cos(x\sin\theta - n\theta)+\cos(x\sin\theta + n\theta)]\,d\theta=\frac{1}{\pi}\int_{0}^{\pi}\cos(x\sin\theta)\cos(n\theta)\,d\theta
    \end{align*}
    类似地，当$n$为奇数时，将上式与原式相减，得到
    \begin{align*}
        J_n(x)&=\frac{1}{2\pi}\int_{0}^{\pi}[\cos(x\sin\theta - n\theta)-\cos(x\sin\theta + n\theta)]\,d\theta=\frac{1}{\pi}\int_{0}^{\pi}\sin(x\sin\theta)\sin(n\theta)\,d\theta
    \end{align*}
    再由被积函数关于$\theta=\pi/2$对称性即得出最后两个公式。
\end{proof}

\section{实变函数概要}\label{sec:Real_Analysis}

\subsection{勒贝格积分}\label{sub:lebesgue}
读者可能已经注意到，并不是所有的函数都是可积的，例如$e^x$即使视为功率信号，其能量和功率也不具有意义，因此它既不属于能量信号，也不属于功率信号；另一种情况是：
\begin{example}[狄利克雷函数]
    \[D(x)=
    \begin{cases}
        1 & x \in \mathbb{Q}    \\
        0 & x \in \mathbb{Q} ^C
    \end{cases}\]
（其中$\mathbb{Q}$ 表示有理数集，上标C在不引起歧义的前提下用来表示取补集）
\end{example}
它在黎曼积分（也就是数学分析或高等数学课程，以及多数工科课程中用的积分）的意义下是不可积的，因为它在所有点不连续，但是这样的函数在\textbf{勒贝格积分}的意义下可积，可以这样理解：勒贝格积分考察函数在某个值处的“区间长度”（严格来讲应为测度），狄利克雷函数在一个有限区间上取值1的长度为0，因为有理数是可数集，取值0的长度就是区间长度，所以其积分值为0。对于非反常积分，勒贝格积分是黎曼积分的推广，黎曼可积的函数一定是勒贝格可积的，并且在同样的区间上积分值相等。

本节就来介绍一些以勒贝格积分为基础的实变函数理论，以便后续学习中使用。阅读本小节有困难的读者，不妨先接受一些重要结论。

\subsection{单调收敛定理，控制收敛定理}\label{sub:swap}

\subsection{*函数空间}\label{sub:Lp_space}

%1.$L^p([0,T])(0<p\leq \infty)$空间表示在区间$[0,T]$上$p$次勒贝格可积的函数组成的函数空间，即
%\[L^p([0,T]):=\left\{f:[0,T]\rightarrow \mathbb{C} \left| \int_{T}|f(t)|^p\,\text dt<\infty\right.\right\}\]
%$L^p([0,T])$具有性质：
%\begin{itemize}
%    \item \raggedright{} $L^p([0,T])$是线性空间\\
%    \item 当$1\leq p \leq \infty$时，$L^p([0,T])$是线性赋范空间，
%          $\| f \|_{p} := \left( \int_{T} |f(t)|^p \, dt \right)^{1/p}$，
%          称之为$L^p$范数,次可加性由闵可夫斯基不等式保证
%\end{itemize}
%2.要求$f(t)$平方可积是为了保证$(f,f)=\int_{T}|f(t)|^2\,dt<\infty$，$f(t)$平
%方可积能够推出$f(t)$是绝对可积的，从而是可积的（有限区间I上有$L^p(I)\supset  L^q(I),p<q$，无限区间上它们互不包含）\\
%3.尽管对函数空间做了一些限制，我们研究的范围依旧是足够大的，闭区间上的平方可积是一个比较弱的条件\\
%4.柯西-施瓦兹不等式和三角不等式（它是闵可夫斯基不等式的特例）自然成立，它们证明的过程不涉及空间的维数是否有限。

%利用内积导出的范数，可以定义函数项级数依范数收敛的概念：
%\begin{definition}[依范数收敛]
%    如果\[\lim_{n \to \infty} \left\| f(t)-\sum_{i = 1}^{n}  a_i f_i(t)\right\|=0\]
%就认为级数$\sum_{i = 1}^{n}  a_i f_i(t)$是$f(t)$在这个正交函数系下的分解，此时记$f\sim\sum_{n=1}^{\infty}a_n f_n$
%\end{definition}
%
%注意，它并不意味着等式右侧的函数项级数在某一点收敛于$f$。
%在$L^2([0,T])$空间中，我们不区分仅在零测集（“区间长度”的总和总能取到任意小正数，例如至多可数集）上不相等的函数，换言之，$L^2([0,T])$空间不是常规意义下的函数的集合，而是\textbf{几乎处处}(almost every,a.e.)相等的函数构成的等价类，这里的$\sim$表示的是两侧的函数同属一个等价类，至于逐点收敛、一致收敛性，需要另作讨论。

%可以想象，依范数收敛要求极限内的函数相当接近于0，但如果在一个点处产生了误差，不论误差多大，都不会影响积分的值。事实上，只要存在误差的点构成零测集，就不会影响积分的值，这时我们称$\sum_{i = 1}^{n}  a_i f_i(t)$几乎处处收敛于$f(t)$，只是这样弱的要求有时会导致积分在黎曼积分的意义下不存在，但勒贝格积分可以处理这种情况，读者可以参考\ref{sec:signal}连续信号与离散信号中对勒贝格积分的讨论。

\chapter{傅里叶变换}%第二章
在数学分析课程中，我们都学习过傅里叶级数的计算，所以本书将直接回顾几种情况下的傅里叶级数展开公式，然后从正交函数系的观点出发构建傅里叶级数的理论，再从傅里叶级数过渡到傅里叶变换，从对周期现象的研究转向对非周期现象的研究，介绍其运算性质、卷积性质，最后介绍分布（也即广义函数）理论，从而研究常函数、狄拉克函数、正余弦函数等在常规意义下无法进行傅里叶变换，却又十分重要的函数。

\section{正交函数系}\label{sec:Orthognal}
\begin{definition}[正交基]
    如果有内积空间$V$的一组基$\{\mathbf{v_1},\mathbf{v_2},\dots ,\mathbf{v_n}\}$，满足$\langle \mathbf{v_i},\mathbf{v_j}\rangle =0,i \neq j$，则称这组基是一组\textbf{正交基}(orthognal bases)。\\如果对$V$中任一向量$\mathbf{w}$，均有以下分解式：
\[\mathbf{w}=\sum_{i = 1}^{n}  c_i \mathbf{v_i}\]
则这组基是\textbf{完备正交基}(complete orthognal bases)。\\
如果$\{\mathbf{v_1},\mathbf{v_2},\dots ,\mathbf{v_n}\}$还满足$\langle \mathbf{v_i},\mathbf{v_i}\rangle =1,i \in \{1,2,\dots ,n\}$，称这组基是\textbf{标准完备正交基} (complete othornormal bases)，此时空间中任意向量均有分解式
\begin{align*}
    \mathbf{w}=\sum_{i=1}^{n}\langle \mathbf{w},\mathbf{v_i}\rangle \mathbf{v_i}
\end{align*}
\end{definition}
我们对向量在标准正交基下的分解式做一些解释。在$\{\mathbf{v_1},\mathbf{v_2},\dots ,\mathbf{v_n}\}$是完备正交基的情况下，就可以将$\mathbf{w}=\sum_{i = 1}^{n}  c_i \mathbf{v_i}$两边同时对$\mathbf{v_j}$做内积，得到
\begin{align*}
    \langle \mathbf{w},\mathbf{v_j} \rangle=\left\langle \sum_{i = 1}^{n}  c_i \mathbf{v_i},\mathbf{v_j} \right\rangle =c_j\left\langle \mathbf{v_j},\mathbf{v_j} \right\rangle \\
    c_j=\frac{\langle \mathbf{w},\mathbf{v_j} \rangle}{\langle \mathbf{v_j},\mathbf{v_j} \rangle},
    \mathbf{w}=\sum_{j = 1}^{n}  \frac{\langle \mathbf{w},\mathbf{v_j} \rangle}{\langle \mathbf{v_j},\mathbf{v_j} \rangle} \mathbf{v_j}
\end{align*}
而标准正交基是$\langle \mathbf{v_j},\mathbf{v_j} \rangle=1$的情况。

给出了标准完备正交基后，就可以得到以下命题，它是勾股定理的高维推广。
\begin{proposition}[勾股定理/毕达哥拉斯恒等式]
    \[|\mathbf{w}|^2=\sum_{i=1}^{n}|\langle\mathbf{w,v_i}\rangle|^2|\mathbf{v_i}|^2=\sum_{i=1}^{n}|\langle\mathbf{w,v_i}\rangle|^2\]
\end{proposition}
直接将$\mathbf{w}$与自己做内积并将之前得到的分解式带入，很容易证明这个命题。
\begin{proof}\begin{align*}
    |\mathbf{w}|^2 & =\left\langle \sum_{i=1}^{n}\langle \mathbf{w},\mathbf{v_i}\rangle \mathbf{v_i},\sum_{i=1}^{n}\langle \mathbf{w},\mathbf{v_i}\rangle \mathbf{v_i}\right\rangle                                           \\
                   & =\sum_{i=1}^{n}|\langle\mathbf{w,v_i}\rangle|^2\langle\mathbf{v_i,v_i}\rangle+\sum_{1\leq i<j\leq n}\langle \mathbf{w,v_i}\rangle\langle \mathbf{w,v_j}\rangle\langle \mathbf{v_i,v_j}\rangle \\
                   & =\sum_{i=1}^{n}|\langle\mathbf{w,v_i}\rangle|^2|\mathbf{v_i}|^2=\sum_{i=1}^{n}|\langle\mathbf{w,v_i}\rangle|^2
\end{align*}\end{proof}
可见做正交基分解能够极大地简化对线性赋范空间的研究。

我们知道，$L^2([0,T])$空间是完备的内积空间（见\ref{sub:Lp_space}），在这个空间上可以定义内积：
\begin{definition}[函数空间上的内积]
    在空间\[L^2([0,T]):=\left\{f:[0,T]\rightarrow \mathbb{C} \left| \int_{T}|f(t)|^2\,\text dt<\infty\right.\right\}\]
上定义内积：
\[(f,g):=\int_{T}f(t)\overline{g(t)}\,dt \]
\end{definition}

有了内积，就可以定义正交性，从而有正交函数系的概念：
\begin{definition}[正交函数系]
    在$L^2([0,T])$空间中，如果函数列$\{f_i(t)\}_{i=1}^{\infty}$满足
\[(f_i,f_j)=\int_{T}f_i(t)f_j^*(t)\,dt=0,i\neq j\]
则称$\{f_i(t)\}_{i=1}^{\infty}$为$L^2([0,T])$空间中的一组\textbf{正交函数系}。
\end{definition}

\begin{definition}[完备正交函数系]
    对于一个正交函数系$\{f_i(t)\}_{i=1}^{\infty}$，如果不存在非零的函数$g(t)\notin\{f_i(t)\}_{i=1}^{\infty}$使得$g(t)$与$\{f_i(t)\}_{i=1}^{\infty}$中的所有函数正交，就称$\{f_i(t)\}_{i=1}^{\infty}$为\textbf{完备正交函数系}
\end{definition}

完备性意味着$L^2([0,T])$空间中的任一函数$f(t)$均可分解为这个函数系的级数$\sum_{i = 1}^{\infty}  a_i f_i(t)$，我们沿用前文中给出的公式计算这些系数：
\[a_i=\frac{(g,f_i)}{(f_i,f_i)}=\frac{\int_{T}g(t)f_i^*(t)\,dt}{\int_{T}|f_i(t)|^2\,dt}\]
细心的读者可能已经发现，这里得到的公式用到了有限维线性空间中的结论，但要推广到无限维线性空间并不是显然的。我们将在下一节给出帕塞瓦尔定理之后一并讨论这个问题。

在适当的伸缩变换下，\ref{sub:bessel}中介绍的贝塞尔函数就是一个完备正交函数。此外，典型的标准完备正交函数系还有勒让德多项式 (Legendre polynomials)、小波变换基函数 (wavelet basis functions)等，下面仅讨论三角函数系和指数函数系。

\section{傅里叶级数}\label{sec:Fourier_Series}

十九世纪初，傅里叶为了求解热传导问题中的偏微分方程，断言：任何周期函数都可以通过无穷多个正弦和余弦函数的线性组合来表示，即傅里叶级数。这一猜想引发了许多数学家的质疑，促进了分析学的发展，直到1829年，狄利克雷提出了傅里叶级数收敛的充分条件和严格证明。今天，傅里叶级数已经成为数学、物理中的重要工具。

\subsection{三角级数与复指数级数}\label{sub:tri_exp_series}
我们首先回顾数学分析中学过的几个计算傅里叶级数的公式。将周期为T的函数f展开为三角函数形式的傅里叶级数：
\begin{align*}
    f(t) & =\frac{a_0}{2}+\sum_{k = 1}^{\infty} a_k \cos(k\omega t)+b_k\sin(k\omega t) \\
         & =\frac{c_0}{2}+\sum_{k = 1}^{\infty} c_k\cos(k\omega t+\varphi _k)
\end{align*}
（其中$\omega =\frac{2\pi }{T}$为\textbf{基波角频率}，$k\omega (k>1,k\in \mathbb{Z} )$
为k次\textbf{谐波角频率}）
\begin{claim}[三角函数形式的傅里叶系数公式]
\[a_k=\frac{2}{T}\int_T f(t)\cos(k\omega t)\,dt\]
\[b_k=\frac{2}{T}\int_T f(t)\sin(k\omega t)\,dt\]
\[c_k=\sqrt{a_k^2+b_k^2}\]
\end{claim}
下面用完备标准正交函数系的观点来得到以上公式。在学习数学分析时，我们已经看到三角函数系$1,\sin(\omega t),\cos(\omega t),\sin(2\omega t),\cos(2\omega t),\dots(\omega =\frac{2\pi}{T})$是正交的（读者可以自行验证），但不是单位正交的，因为
\[(\sin(k\omega t),\sin(k\omega t))=\int_{T}\sin^2(k\omega t)\,dt=\int_{T}\frac{1-\cos(2k\omega t)}{2}=\frac{T}{2}\]
\[(\cos(k\omega t),\cos(k\omega t))=\int_{T}\cos^2(k\omega t)\,dt=\int_{T}\frac{1+\cos(2k\omega t)}{2}=\frac{T}{2}\]
可以将它们单位化，也可以直接采用完备正交基分解的公式，
\[a_k=\frac{(f(t),\cos(k\omega t))}{(\cos(k\omega t),\cos(k\omega t))}=\frac{\int_{T}f(t)\cos(k\omega t)^*(t)\,dt}{\int_{T}|\cos(k\omega t)|^2\,dt}
    =\frac{2}{T}\int_{T}f(t)\cos(k\omega t)(t)\,dt\]
\[b_k=\frac{(f(t),\sin(k\omega t))}{(\sin(k\omega t),\sin(k\omega t))}=\frac{\int_{T}f(t)\sin(k\omega t)^*(t)\,dt}{\int_{T}|\sin(k\omega t)|^2\,dt}
    =\frac{2}{T}\int_{T}f(t)\sin(k\omega t)(t)\,dt\]
\begin{claim}[偶函数的傅里叶展开]
当$f(t)$为偶函数，或者由$f(t)$做偶延拓时,展开式为
\[f(t)=\frac{a_0}{2}+\sum_{k = 1}^{\infty} a_k\cos(k\omega t)\]
其中
\[a_k=\frac{4}{T}\int_{0}^{\frac{T}{2}} f(t)\cos(k\omega t)\,dt\]
\[b_k=0\]
\end{claim}\begin{claim}[奇函数的傅里叶展开]
当$f(t)$为奇函数，或者由$f(t)$做奇延拓时,展开式为
\[f(t)=\sum_{k = 1}^{\infty} b_k \sin(k\omega t)\]
其中
\[a_k=0\]
\[b_k=\frac{4}{T}\int_{0}^{\frac{T}{2}} f(t)\sin(k\omega t)\,dt\]
\end{claim}
容易利用对称性得到这些公式。

如果将傅里叶级数展开式$f(t) =\frac{a_0}{2}+\sum_{k = 1}^{\infty} a_k \cos(k\omega t)+b_k\sin(k\omega t)$写为
\begin{align*}
    f(t) = & \frac{a_0}{2}+\sum_{k = 1}^{\infty} a_k \cos(k\omega t) \\
           & +\sum_{k = 1}^{\infty} b_k \sin(k\omega t)
\end{align*}
则前半部分为偶函数，称之为$f(t)$的\textbf{偶分量}$f_e(t)$;后半部分为奇函数，称之为$f(t)$的\textbf{奇分量}$f_o(t)$。高中数学中我们知道，函数的偶分量和奇分量都是唯一的，并且\begin{align*}
    f_e(t)=\frac{f(t)+f(-t)}{2} \\
    f_o(t)=\frac{f(t)-f(-t)}{2}
\end{align*}

除了奇偶性，还可以从奇次谐波、偶次谐波的角度来理解函数。
\begin{definition}[奇谐函数]
    函数$f(t)$称为
\textbf{奇谐函数}，如果后半个周期的函数是前半个周期的负镜像，即\begin{equation*}
    f\left(t+\frac{T}{2}\right)=-f(t)
\end{equation*}
\end{definition}
奇谐函数的傅里叶级数展开只有奇次谐波分量：
\begin{align*}
    a_k =&\frac{2}{T}\int_{T}f(t)\cos(k\omega t)\,dt\\
    &=\frac{2}{T}\int_{-T/2}^{0}f(t)\cos(k\omega t)\,dt+\frac{2}{T}\int_{0}^{T/2}f(t)\cos(k\omega t)\,dt\\
    &=\frac{2}{T}\int_{0}^{T/2}\left(f(t)\cos(k\omega t)+f(t-T/2)\cos(k\omega(t-T/2))\right)\,dt\\
    &=(1-\cos(k\pi))\frac{2}{T}\int_{0}^{T/2}f(t)\cos(k\omega t)\,dt\\
    &=\begin{cases}
        0,&\text{if }k\text{为偶数}\\
        \frac{4}{T}\int_{0}^{T/2}f(t)\cos(k\omega t)\,dt,&\text{if }k\text{为奇数}
    \end{cases}
\end{align*}
同理有\begin{align*}
    b_k=\begin{cases}
        0,&\text{if }k\text{为偶数}\\
        \frac{4}{T}\int_{0}^{T/2}f(t)\sin(k\omega t)\,dt,&\text{if }k\text{为奇数}
    \end{cases}
\end{align*}
有了奇谐函数自然也能够定义偶谐函数：$f\left(t+\frac{T}{2}\right)=f(t)$，容易验证它只有偶次谐波分量，但从定义式可以看出这只是周期减半的函数。

由欧拉公式$e^{ik\omega t}=\cos(k\omega t)+i\sin(k\omega t)$，得到
\[\cos(k\omega t)=\frac{e^{ik\omega t}+e^{-ik\omega t}}{2},\sin(k\omega t)=\frac{e^{ik\omega t}-e^{-ik\omega t}}{2i}\]
故函数$f(t)$也可在指数函数系下展开：\begin{definition}[指数形式傅里叶展开]
    \[f(t)=\sum_{k = 0}^{\infty}  c_k e^{ik\omega t} ,c_k=\frac{a_k-ib_k}{2},c_{-k}=\frac{a_k+ib_k}{2}=c_k^*,k\in \mathbb{N}\]
（特别地，$c_0=c_0^*\Rightarrow c_0\in\mathbb{R} $）
\end{definition}
容易验证$\{e^{ik\omega t}\}_{k=0}^{\infty}$是完备正交函数系：
\begin{align*}
    (e^{ik_1\omega t},e^{ik_2\omega t}) & =\int_{T}e^{ik_1\omega t}(e^{ik_2\omega t})^*\,dt                 \\
                                        & =\int_{T}e^{i(k_1-k_2)\omega t}                                   \\
                                        & =\frac{2}{i\omega (k_1-k_2)}\evalat{e^{i(k_1-k_2)\omega t}}{0}{T} \\
                                        & =0(k_1,k_2\in \mathbb{Z},k_1\neq k_2)                             \\
    (e^{ik\omega t},e^{ik\omega t})     & =\int_{T}e^{ik\omega t}(e^{ik\omega t})^*\,dt                     \\
                                        & =\int_{T}\,dt=T(k\in \mathbb{Z} )
\end{align*}
和三角函数系的情况一样，我们得到$c_k$的计算公式：
\begin{align*}
    c_k & =\frac{(f(t),e^{ik\omega t})}{(e^{ik\omega t},e^{ik\omega t})} \\
        & =\frac{1}{T}\int_{T}f(t)(e^{ik\omega t})^*\,dt                 \\
        & =\frac{1}{T}\int_{T}f(t)e^{-ik\omega t}\,dt
\end{align*}
有时也将$c_k$记作$\hat{f}(k\omega)$或$\hat{F}(k)$，表示f在频域中的点$k\omega$处的值。一般而言，我们只将最小正周期称为一个函数的周期，但周期为T的函数可以有多个频率$k\omega(k \in \mathbb{Z})$，绘制频谱时，由于难以画出复数，常用\textbf{幅度谱}$|\hat{f}(k\omega)|-\omega$和\textbf{相位谱}$\phi_k-\omega$来表征函数，其中$\phi_k=\arg\hat{f}(k\omega)$。对于实信号，
\[c_k=(c_{-k})^*,|\hat{f}(k\omega)|=|\hat{f}(-k\omega)|,\phi_{-k}=-\phi_k\]
即幅度谱为偶函数，相位谱为奇函数，所以实信号的频谱中有一半是冗余的，按照展开式
\[\frac{c_0}{2}+\sum_{k = 1}^{\infty} c_k\cos(k\omega t+\varphi _k)\]
绘制的频谱$c_k-\omega$（注意不是指数函数形式的傅里叶系数）和$\phi_k-\omega$称为\textbf{单边频谱}，而完整的频谱称为\textbf{双边频谱}，从
\[\cos(k\omega t+\varphi _k)=\frac{e^{i(k\omega t+\varphi_k)}+e^{-i(k\omega t+\varphi_k)}}{2}\]
可知单边频谱相比双边频谱，在给定正频率处的幅值加倍，相位不变。这里的频率实际上是角频率$\omega$，用频率f画频谱只涉及图像的横向伸缩，此处不再赘述。

\begin{example}[周期矩形脉冲信号的傅里叶级数展开和频谱图]
脉冲宽度为$\tau$，脉冲幅度为E，周期为$T (\tau<T)$的周期矩形脉冲信号$f(t)=E\chi_{[-\tau/2,\tau/2]}$，基波角频率
$\omega=\frac{2\pi}{T}$，傅里叶级数展开为
\[f(t)=\sum_{k = 1}^{\infty}  \frac{E\tau}{T}\text{Sa}\left(\frac{k\omega \tau}{2}\right)e^{ik\omega t}\]
\end{example}
\begin{figure}[H]
    \centering
    \includegraphics[width=0.6\textwidth]{Figure_2}
    \caption{周期矩形脉冲信号及其频谱}
\end{figure}
如图，可以看到，这个频谱与采样函数$\text{Sa}(\omega)$非常相似（为了体现这一点，绘制频谱时将基波角频率大幅减小，并不是第一张图直接做傅里叶级数展开的结果），原因将在\ref{sub:fourier_of_signal}中给出。

\textbf{带宽} (bandwidth)指最高频率与最低频率之差，表征信号频率的集中程度。对于实信号，有时仅考虑正频率\cite{signal_systems}，带宽减半。周期矩形脉冲信号的频谱是无限的，但能量基本集中在最靠近y轴的两个零点之间，此时可以将带宽定义为\textbf{第一过零点带宽}$B=\frac{2\pi}{\tau}$（仅考虑正频率）。

\subsection{傅里叶级数的收敛性}\label{sub:fourier_series_convergency}
我们根据内积空间的理论写出了函数的傅里叶级数展开式，但这并不能保证傅里叶级数存在且收敛（换言之，前文所述的展开式中等号不能保证相等，只能保证后者是前者的展开式，尽管在多数情况下等号是正确的），保证这一点需要\textbf{狄利克雷条件}：
\begin{definition}[狄利克雷条件]
    \quad
    \begin{itemize}[nosep, left=0pt]
    \item $\int_{T}|f(t)|\,dt<\infty$
    \item 在一个周期内f连续或有有限个第一类间断点，即\textbf{分段连续} (piecewise continuous)
    \item 在一个周期内，f的极值点个数有限
\end{itemize}
\end{definition}
\begin{theorem}[狄利克雷定理]
    满足狄利克雷条件时，f的傅里叶级数展开在在任意点收敛到其左右极限的平均值：
    \[\forall t\in \mathbb{R},\sum_{k=\infty}^{\infty}c_k e^{2\pi ikt}=\frac{f(t+)+f(t-)}{2}\]
\end{theorem}
最后一个条件实际上相当于要求f是有界变差函数(Bounded Variatioin Function)，感兴趣的读者可以在实变函数的教材（如\cite{real_analysis}）中了解这种函数。在\ref{sub:uniform_converge}中我们将讨论另外的更易理解的条件：
\begin{definition}[分段光滑]
    在区间$[a,b]$上，函数$f$称为\textbf{分段光滑} (piecewise smooth)，如果存在区间的划分$a=x_0<x_1<\dots <x_n=b$，使得在每个子区间$(x_{i-1},x_i)$上f可微，且区间端点处$f$的左右导数存在，记作$f\in PS[a,b]$。
\end{definition}
看起来，可导性比连续性强不少，但在大部分情况下，我们讨论的函数都是分段光滑。在分段光滑的条件下，我们可以证明傅里叶级数是一致收敛于原函数的。

\subsection{帕塞瓦尔恒等式}\label{sub:paseval}
类比有限维线性空间中的勾股定理，有\begin{claim}[帕塞瓦尔定理/瑞利恒等式]
    \[\|f\|_2=\sum_{k=1}^{\infty}c_k^2|e^{ik\omega t}|^2=T\sum_{k=1}^{\infty}c_k^2\]
即\[P=\frac{1}{T}\int_{T}|f(t)|^2\,dt=\sum_{k=1}^{\infty}c_k^2\]
其中P为平均功率。
\end{claim}

至此，我们得到了傅里叶系数的公式和帕塞瓦尔定理，但其实证明用到的结论是基于有限维线性空间的，现在就来填补这个逻辑漏洞，对此不感兴趣的读者可以忽略这部分内容。以下设$\{\phi_n\}_{n=1}^{\infty}$是$L^2(a,b)$的标准正交基,$f\in L^2(a,b)$（注意这里已经不局限于讨论傅里叶级数，并且与前文未标准化的正交基略有形式上的差别）。

\begin{lemma}[*贝塞尔不等式]
\[\sum_{n=1}^{\infty}|(f,\phi_n)|^2\leq\|f\|_2^2\]
\end{lemma}
\begin{proof}
    由勾股定理，
    \begin{flalign*}
     \left\|\sum_{n=1}^{N}(f,\phi_n)\phi_n\right\|_2^2= \sum_{n=1}^{N}\left(f,(f,\phi_n)\phi_n\right)=\sum_{n=1}^{N}\overline{(f,\phi_n)}(f,\phi_n)=\sum_{n=1}^{N}|(f,\phi_n)|^2
\end{flalign*}
因此，对任意正整数N，有
\begin{flalign*}
     0&\leq\left\|f-\sum_{n=1}^{N}(f,\phi_n)\phi_n\right\|_2^2\\
     &=\|f\|_2^2-2\text{Re}\ \left(f,\sum_{n=1}^{N}(f,\phi_n)\phi_n\right)+\left\|\sum_{n=1}^{N}(f,\phi_n)\phi_n\right\|_2^2                        \\
     &=\|f\|_2^2-2\sum_{n=1}^{N}|(f,\phi_n)|^2+\sum_{n=1}^{N}|(f,\phi_n)|^2=\|f\|_2^2-\sum_{n=1}^{N}|(f,\phi_n)|^2
\end{flalign*}
令$N\to\infty$即证。从第一行到第二行用到了恒等式$\|\mathbf{a+b}\|^2=\|\mathbf{a}\|^2+2\text{Re}\ \langle\mathbf{a,b}\rangle+\|\mathbf{b}\|^2$，Re表示取实部，这个结论十分简单，留予读者自证。
\end{proof}
在最终的结论帕塞瓦尔定理中这个不等号将变成等号，但它是不可或缺的，并且我们还将在\ref{sub:dirichlet_kernel}中见到它。

\begin{lemma}*
级数$\sum_{n=1}^{N}(f,\phi_n)\phi_n$依范数收敛，并且$\left\|\sum_{n=1}^{\infty}(f,\phi_n)\phi_n\right\|_2\leq\|f\|_2$
\end{lemma}
\begin{proof}
    由贝塞尔不等式，
\begin{flalign*}
     \sum_{n=1}^{\infty}|(f,\phi_n)|^2\leq\|f\|_2^2<\infty,n\to\infty\text{时}|(f,\phi_n)|\to 0
\end{flalign*}
任取$m_1,m_2\in\mathbb{N},m_1<m_2$，由勾股定理，
\begin{flalign*}
              \left\|\sum_{n=m_1}^{m_2}(f,\phi_n)\phi_n\right\|_2^2=\sum_{n=m_1}^{m_2}\left|(f,\phi_n)\right|^2\to 0
\end{flalign*}
因此$\sum_{n=1}^{\infty}(f,\phi_n)\phi_n$构成柯西列。

令$m_1=1,m_2\to\infty$，即得
\begin{flalign*}
\left\|\sum_{n=1}^{\infty}(f,\phi_n)\phi_n\right\|_2 =\sum_{n=1}^{\infty}\left|(f,\phi_n)\phi_n\right|^2\leq\|f\|_2^2
\end{flalign*}
\end{proof}
柯西列能够推出收敛是因为$L^2(a,b)$是无限维的完备度量空间，即\textbf{希尔伯特空间} (Hilbert space)，见\ref{sub:Lp_space}。构建这个引理是为了使用希尔伯特空间中内积的连续性，其表述见下一个命题。

\begin{proposition}[*希尔伯特空间H中的内积的连续性]
如果级数$\sum_{n=1}^{\infty}\phi_n$的部分和$S_N$依范数收敛到S，则任给$y\in H$，总有
\[\lim_{N\to\infty}\left\langle S_n,y\right\rangle=\langle S,y\rangle\]
\end{proposition}
\begin{proof}
\begin{align*}
     & \langle S,y\rangle-\lim_{N\to\infty}\left\langle S_n,y\right\rangle=\lim_{N\to\infty}\langle S-S_n,y\rangle                                     \\
     & \lim_{N\to\infty}\|S-S_N\|=0\implies \lim_{N\to\infty}|\left\langle S-S_n,y\right\rangle|\leq\lim_{N\to\infty}\left\|S-S_N\right\|\|y\|=0               \\
     & \hspace{3cm}\implies \lim_{N\to\infty}\langle S-S_n,y\rangle=0\implies\lim_{N\to\infty}\left\langle S_n,y\right\rangle=\langle S,y\rangle
\end{align*}
\end{proof}

\begin{theorem}*
以下三个命题是等价的：（对于符号$\sim$，参考\ref{sub:Lp_space}）
\begin{enumerate}
    \item $\forall n,(f,\phi_n)=0\implies f\sim 0$，即$\{\phi_n\}_{n=1}^{\infty}$是完备的标准正交基
    \item $\forall f\in L^2(a,b)$，有$f\sim\sum_{n=1}^{\infty}(f,\phi_n)\phi_n$
    \item $\forall f\in L^2(a,b)$，有\textbf{帕塞瓦尔恒等式}：
          \[\|f\|_2^2=\sum_{n=1}^{\infty}|(f,\phi_n)|^2\]
\end{enumerate}
\end{theorem}
\begin{proof}
我们将证明$1\implies 2\implies 3\implies 1$.\\
$1\implies 2$：\begin{align*}
     & \text{令}g\sim \left(f-\sum_{n=1}^{\infty}(f,\phi_n)\phi_n.\right)                                                              \\
     & \forall m\in\mathbb{N},\left(g,\phi_m\right)=\left(f,\phi_m\right)-\sum_{n=1}^{\infty}\left(f,\phi_n\right)\left(\phi_n,\phi_m\right)=\left(f,\phi_m\right)-\left(f,\phi_m\right)=0 \\
\end{align*}
根据1知g=0，即2.这里内积与求和的换序是由命题2.3保证的。\\
$2\implies 3$：由勾股定理，
\[\|f\|_2^2=\lim_{N\to\infty}\left\|\sum_{n=1}^{N}(f,\phi_n)\phi_n\right\|_2^2=\lim_{N\to\infty}\sum_{n=1}^{N}|(f,\phi_n)|^2=\sum_{n=1}^{\infty}|(f,\phi_n)|^2\]
$3\implies 1$：$(f,\phi_n)=0\implies\|f\|_2=0\implies f\sim 0$.
\end{proof}

\section{傅里叶变换}\label{sec:Fourier}

在构建傅里叶级数时，使用频率和角频率只涉及书写问题，因为傅里叶级数不会涉及尺度变换、逆变换和卷积，但在傅里叶变换的理论中，这将导致许多公式在形式上有一些差别。这时，将同时给出两种傅里叶变换的公式，左侧为频率版本，用蓝色标注，右侧为角频率版本，用红色标注。对于频率的符号，物理上一般使用f或$\nu $，而一些傅里叶分析的书上则使用s或$\xi$，但鉴于f常常用来表示信号或函数，s用于表示复频率，我们将使用$\xi$作为频率的符号。

\subsection{傅里叶变换的引出}\label{sub:introduction_of_fourier}
定义傅里叶变换的一种动机是从傅里叶级数出发。要从傅里叶级数研究的周期现象转向傅里叶变换研究的非周期现象，自然能够想到在傅里叶级数相关的理论中，令T趋于无穷；另一方面，复指数函数比三角函数更适合作为描述振荡（周期）行为的基本函数。

我们做一个简单的尝试，令$f\in L^2(\mathbb{R})$（关于$L^2$空间的讨论，见\ref{sub:Lp_space}）,$T\to \infty$，则\[c_n=\frac{1}{T}\int_{T}f(t)e^{-ik\omega t}\,dt=\frac{1}{T}\int_{T}f(t)e^{-2\pi ik\xi t}\,dt\to 0\]这样做变换将丢失f的所有信息，不是我们希望看到的，但很明显，只要给以上公式乘上T，并认为$k\omega$或$k\xi$是自变量，问题就迎刃而解，得到一个很有意思的积分变换，它正是\textbf{傅里叶变换} (Fourier Tansform,FT)。傅里叶本人同样意识到了傅里叶级数向傅里叶变换的过渡，他用同样的方法从形式上得到了傅里叶变换的公式，但我们使用的指数函数其实是后来柯西、泊松等数学家开始使用的，它使得公式具有更加简洁的形式。
\begin{definition}[傅里叶变换]
设$f\in L^1(\mathbb{R})$，其傅里叶变换定义为
\lr{
    \mathcal{F} f(\xi)=\int_{-\infty}^{\infty}f(t)e^{-2\pi i\xi t}\,dt
}{
    \mathcal{F} f(\omega)=\int_{-\infty}^{\infty}f(t)e^{-i\omega t}\,dt
}
有时也用$\hat{f}$或F表示f的傅里叶变换，记作
\[f\overset{\mathcal{F} }{\longleftrightarrow}F\]
并称之为\textbf{傅里叶变换对}。
\end{definition}

傅里叶变换没有最好的符号，在不引起歧义时采用最简洁和便于理解的即可。注意在傅里叶变换的理论中，要求$f\in L^1(\mathbb{R})$而不是$L^2(\mathbb{R})$，$\mathbb{R}$是无穷区间，$L^1(\mathbb{R})$与$L^2(\mathbb{R})$之间不存在包含关系。

我们通过以下两个命题来说明$L^1(\mathbb{R})$的必要性。

\begin{proposition}
    $f\in L^1(\mathbb{R})$时，它的傅里叶变换是有界的、一致连续的。
\end{proposition}
\begin{proof}
    有界性：由定义，有
\begin{lralign}
    |\mathcal{F} f(\xi)|&=\left|\int_{-\infty}^{\infty}f(t)e^{-2\pi i\xi t}\,dt\right|\\
    &\leq\int_{-\infty}^{\infty}|f(t)||e^{-2\pi i\xi t}|\,dt\\
    &=\int_{-\infty}^{\infty}|f(t)|\,dt=\|f\|_1<\infty
    \switch
    |\mathcal{F} f(\omega)|&=\left|\int_{-\infty}^{\infty}f(t)e^{-i\omega t}\,dt\right|\\
    &\leq\int_{-\infty}^{\infty}|f(t)||e^{-i\omega t}|\,dt\\
    &=\int_{-\infty}^{\infty}|f(t)|\,dt=\|f\|_1<\infty
\end{lralign}
一致连续性：设$\xi,\eta,\omega,\nu\in\mathbb{R}$，则
\begin{lralign}
    &|\mathcal{F} f(\xi)-\mathcal{F} f(\eta)|\\
    =&\left|\int_{-\infty}^{\infty}f(t)(e^{-2\pi i\xi t}-e^{-2\pi i\eta t})\,dt\right|\\
    \leq&\int_{-\infty}^{\infty}|f(t)||e^{-2\pi i\xi t}-e^{-2\pi i\eta t}|\,dt
    \switch
    &|\mathcal{F} f(\omega)-\mathcal{F} f(\nu)|\\
    =&\left|\int_{-\infty}^{\infty}f(t)(e^{-i\omega t}-e^{-i\nu t})\,dt\right|\\
    \leq&\int_{-\infty}^{\infty}|f(t)||e^{-i\omega t}-e^{-i\nu t}|\,dt
\end{lralign}
由于$e^{-2\pi i\xi t}$与$e^{-i\omega t}$在t上均为一致连续函数，$\forall\epsilon>0,\exists\delta>0$，使得
\begin{lralign}
    &|\xi-\eta|<\delta\\
    \implies &|e^{-2\pi i\xi t}-e^{-2\pi i\eta t}|<\frac{\epsilon}{\|f\|_1},\forall t\in\mathbb{R}\\
    \implies &|\mathcal{F} f(\xi)-\mathcal{F} f(\eta)|<\epsilon
\switch
    &|\omega-\nu|<\delta\\
    \implies &|e^{-i\omega t}-e^{-i\nu t}|<\frac{\epsilon}{\|f\|_1},\forall t\in\mathbb{R}\\
    \implies &|\mathcal{F} f(\omega)-\mathcal{F} f(\nu)|<\epsilon
\end{lralign}
\end{proof}
\begin{claim}[黎曼-勒贝格引理]
    若$f\in L^1(\mathbb{R})$，则其傅里叶变换满足
    \lr{
        \lim_{|\xi|\to\infty}\mathcal{F} f(\xi)=0
    }{
        \lim_{|\omega|\to\infty}\mathcal{F} f(\omega)=0
    }
\end{claim}
它的证明比较复杂，将在\ref{sub:riemman_lebesgue_lemma}中给出。

下面解释“乘T，认为$k\omega$或$k\xi$为自变量”的本质。我们来看上一节中\ref{sub:tri_exp_series}的例2.2.1，为了体现双边频谱与采样函数的相似性，我们取了一个较为特殊的周期矩形脉冲信号，它的基波角频率应为图中两相邻竖直线间的间隔，即\textbf{谱线间隔}，可见其频率极小、周期极大，与我们研究非周期现象所用到的极限情况$T\to\infty$是一致的，换言之，令$T\to\infty$自动地使“傅里叶系数”在频谱中的间隔变小，\textbf{周期信号趋向非周期信号的过程自动地使离散频谱趋向连续频谱}。这样，乘T就不难理解了，它的作用是“除以$\frac{1}{T}$”，$\frac{1}{T}$是所在频率成分处小矩形的宽（类似于黎曼积分），换言之，以频率$\xi$为横坐标，\textbf{谱系数}$c_n$是$\frac{n}{T}=n\xi$处的小矩形面积，$Tc_n$是f中对应频率成分的含量，可以理解为单位频段内的谱系数，即频谱密度；以角频率$\omega$为横坐标，$c_n$是$\frac{2\pi n}{T}=n\omega$处的小矩形面积，$Tc_n$是f中对应角频率成分的含量。因此，$F(\xi)$或$F(\omega)$也称为频谱密度函数。

实际上，从这个角度出发，可以立即得到\textbf{傅里叶逆变换} (Inverse Fourier Tansform,IFT)的公式，因为我们已经将f展开为傅里叶级数，这对应着由f的傅里叶变换$\mathcal{F} f$还原出f。我们知道
\lr{
f(t)&=\sum_{n=-\infty}^{\infty}c_n e^{2\pi i\xi t}\\
&=\frac{1}{T}\sum_{n=-\infty}^{\infty}\left(\int_{T}f(t)e^{-2\pi i\xi t}\,dt\right)e^{2\pi i\xi t}
}{
f(t)&=\sum_{n=-\infty}^{\infty}c_n e^{i\omega t}\\
&=\frac{1}{T}\sum_{n=-\infty}^{\infty}\left(\int_{T}f(t)e^{-i\omega t}\,dt\right)e^{i\omega t}
}
根据前文所述的对应关系，做以下替换（注意$T\to\infty$）：
\lr{
    &\frac{1}{T}\rightarrow d\xi,\int_{T}f(t)e^{-2\pi i\xi t}\,dt\rightarrow \mathcal{F} f(\xi)\\
    &f(t)=\mathcal{F} ^{-1}\mathcal{F} (t)=\int_{-\infty}^{\infty}\mathcal{F} f(\xi)e^{2\pi i\xi t}\,d\xi
}{
    &\frac{2\pi}{T}\rightarrow d\omega,\int_{T}f(t)e^{i\omega t}\,dt\rightarrow \mathcal{F} f(\omega)\\
    &f(t)=\mathcal{F} ^{-1}\mathcal{F} (t)=\frac{1}{2\pi}\int_{-\infty}^{\infty}\mathcal{F} f(\omega)e^{i\omega t}\,d\omega
}
这里$\mathcal{F} ^{-1}$表示取傅里叶逆变换，和$\mathcal{F} $一样，是一种从函数空间到函数空间的映射，$\mathcal{F} $是从时域函数到频域（角频域）函数的映射，$\mathcal{F} ^{-1}$是从频域（角频域）到时域函数的映射。因此，严格来说我们总应该写上自变量，但在不引起歧义的情况下允许略去，例如我们同时承认$F(\xi)=\mathcal{F} [f(t)](\xi)$和$F(\xi)=\mathcal{F} [f(t)]$的写法。

至此我们得到了傅里叶逆变换\footnote{在一些文献中，傅里叶变换为$\frac{1}{\sqrt{2\pi}}\int_{-\infty}^{\infty}f(t)e^{-i\omega t}\,dt$，这样逆变换为$\frac{1}{\sqrt{2\pi}}\int_{-\infty}^{\infty}f(\omega)e^{i\omega t}\,d\omega$，公式具有对称性，但不具有直接的物理意义，并且没有本质区别，故本书不加以讨论。}的定义：
\begin{definition}[傅里叶逆变换]
    设$f\in L^1(\mathbb{R})$，其傅里叶逆变换为\lr{
        \mathcal{F} ^{-1}f(t)=\int_{-\infty}^{\infty}f(\xi)e^{2\pi i\xi t}\,d\xi
    }{
        \mathcal{F} ^{-1}f(t)=\frac{1}{2\pi}\int_{-\infty}^{\infty}f(\omega)e^{i\omega t}\,d\omega
    }
\end{definition}
并且从形式上得到了\textbf{傅里叶反演公式} (the Fourier Inversion Thoerem)：
\begin{claim}[傅里叶反演公式]
    \[f=\mathcal{F} \mathcal{F} ^{-1}f=\mathcal{F} ^{-1}\mathcal{F} f\]
\end{claim}
\begin{remark}
    一般的傅里叶反演公式将在\ref{sub:fourier_inversion}中给出，而不会导致循环论证。类似傅里叶级数，我们实际上也应该要求$f\in PC$，傅里叶逆变换收敛到左右极限的平均值，但更多时候我们不关心不连续点的值。
\end{remark}

\subsection{傅里叶变换的运算性质}\label{sub:fourier_operation_properties}
\begin{theorem}[傅里叶变换的运算性质]
    以下默认$f\in L^1(\mathbb{R})$。
    \begin{itemize}   
    \item \textbf{对偶性}：记$f$的反转信号 (the reversed siganl)为$f^-$，即$f^-(t)=f(-t)$，则
          \lr{(\mathcal{F}f)^-=\mathcal{F} (f^-)=\mathcal{F} ^{-1}f
          }{
            (\mathcal{F}f)^-=\mathcal{F} (f^-)=2\pi\mathcal{F} ^{-1}f
          }
        若$\mathcal{F} f\in L^1(\mathbb{R})$，则\lr{
            \mathcal{F} \mathcal{F} f=f^-
        }{
            \mathcal{F} \mathcal{F} f=2\pi f^-
        }
        进一步，如果$f$是实函数，则有\lr{
            \mathcal{F} f^-=\overline{\mathcal{F} f}
        }{
            \mathcal{F} f^-=\overline{\mathcal{F} f}
        }
          \begin{remark}
            时域反转，频域也反转，因此我们可以不区分$(\mathcal{F}f)^-=\mathcal{F} (f^-)$，将它们全部写作$\mathcal{F} f^-$。\\
          不涉及收敛性的问题时，的确可以做多次傅里叶变换，只是此时不再具有明显的物理意义，因而也不纠结所选用的符号。
          \end{remark}
    \item \textbf{对称性}：$\mathcal{F} f$与f奇偶性相同；f是实函数时，如果f还是偶函数，则$\mathcal{F} f$也是实函数，
          如果f还是奇函数，则$\mathcal{F} $是纯虚函数
    \item \textbf{线性性}：$\forall f,g\in L^1(\mathbb{R}),\mathcal{F} (af+bg)=a\mathcal{F} f+b\mathcal{F} g$，即$\mathcal{F} $是线性算子
    \item \textbf{平移定理}：\lr{
          &\mathcal{F} [f(t-b)](\xi)=e^{-2\pi i \xi b}\mathcal{F} f(\xi)\\
          &\mathcal{F} \left[f(t)e^{2\pi i \xi t}\right](\xi)=\mathcal{F} f(\xi-b)
          }{
          &\mathcal{F} [f(t-b)](\omega)=e^{-i\omega t}\mathcal{F} f(\omega)\\
          &\mathcal{F} \left[f(t)e^{ibt}\right](\omega)=\mathcal{F} f(\omega-b)
          }
          \begin{remark}
          可见信号时移$|\mathcal{F} f|$，而仅改变$\mathcal{F} f$的相位。
          \end{remark}
    \item \textbf{伸缩定理}：\lr{
              &\mathcal{F} [f(at)](\xi)=\frac{1}{|a|}\mathcal{F} f\left(\frac{\xi}{a}\right)\\
              &\mathcal{F} f(a\xi)=\frac{1}{|a|}\mathcal{F} \left[f\left(\frac{t}{a}\right)\right]
          }{
              &\mathcal{F} [f(at)](\omega)=\frac{1}{|a|}\mathcal{F} f\left(\frac{\omega}{a}\right)\\
              &\mathcal{F} f(a\xi)=\frac{1}{|a|}\mathcal{F} \left[f\left(\frac{t}{a}\right)\right]
          }
          \begin{remark}
            信号反转可看作a=-1的特例。可以认为两种频率下的傅里叶变换是通过伸缩得到的，即
          \[2\pi\xi=\omega,\textcolor{blue}{\mathcal{F}}(2\pi\xi)=\textcolor{red}{\mathcal{F}}(\omega)\]
          $a>1$，时域收缩，频域舒张、变矮；$0<a<1$，时域舒张，频域收缩、变高；$a<0$，时域和频域都额外做一次反转。
          \end{remark}
    \item \textbf{微分性质}：若$f$可导，且$f'\in L^1(\mathbb{R})$，则有\lr{
              \mathcal{F} (f')(\xi)=2\pi i\xi\mathcal{F} f(\xi)
          }{
              \mathcal{F} (f')(\omega)=i\omega\mathcal{F} f(\omega)
          }
          若$\mathcal{F} f$可导，且$tf(t)\in L^1(\mathbb{R})$，则有\lr{
                \mathcal{F}(2\pi itf)(\xi)=-(\mathcal{F} f)'(\xi)
          }{
            \mathcal{F} [itf(t)](\omega)=-(\mathcal{F} f)'(\omega)
          }
          由线性性，上式即
          \lr{
            \mathcal{F}(tf)(\xi)=\frac{i}{2\pi}(\mathcal{F} f)'(\xi)
          }{
            \mathcal{F}(tf)(\omega)=i(\mathcal{F} f)'(\omega)
          }
          容易将此性质推广至任意阶导数。
\end{itemize}
\end{theorem}
\begin{proof}
1.对偶性
\begin{lralign}
    (\mathcal{F} f)^-(\xi)&=\int_{-\infty}^{\infty}f(t)e^{2\pi i \xi t}\,dt\\
    \mathcal{F} (f^-)(\xi)&=\int_{-\infty}^{\infty}f(-t)e^{-2\pi i \xi t}\,dt\\
    &=\int_{-\infty}^{\infty}f(t)e^{2\pi i \xi t}\,dt\\
    \mathcal{F} ^{-1}f(x)&=\int_{-\infty}^{\infty}f(t)e^{2\pi ixt}\,dt
\switch
    (\mathcal{F} f)^-(\omega)&=\int_{-\infty}^{\infty}f(t)e^{i \omega t}\,dt\\
    \mathcal{F} (f^-)(\omega)&=\int_{-\infty}^{\infty}f(-t)e^{-i \omega t}\,dt\\
    &=\int_{-\infty}^{\infty}f(t)e^{i \omega t}\,dt\\
    \mathcal{F} ^{-1}f(x)&=\frac{1}{2\pi}\int_{-\infty}^{\infty}f(t)e^{i\omega t}\,dt
\end{lralign}
因此\lr{(\mathcal{F}f)^-=\mathcal{F} (f^-)=\mathcal{F} ^{-1}f}{(\mathcal{F}f)^-=\mathcal{F} (f^-)=2\pi\mathcal{F} ^{-1}f}
同时取傅里叶变换，即得
\lr{
    \mathcal{F} \mathcal{F} f=f^-
}{
    \mathcal{F} \mathcal{F} f=2\pi f^-
}
如果$f$是实函数，则$f=\overline{f}$，因此
\lr{
    &\mathcal{F} f^-(\xi)=\int_{-\infty}^{\infty}f(t)e^{2\pi i \xi t}\,dt\\
    &\ =\overline{\int_{-\infty}^{\infty}f(t)e^{-2\pi i \xi t}\,dt}=\overline{\mathcal{F} f(\xi)}
}{
    &\mathcal{F} f^-(\omega)=\int_{-\infty}^{\infty}f(t)e^{i \omega t}\,dt\\
    &\ =\overline{\int_{-\infty}^{\infty}f(t)e^{-i \omega t}\,dt}=\overline{\mathcal{F} f(\omega)}
}
\noindent 2.对称性：根据对偶性立即得到。\\
3.线性性：得自积分的线性性。\\
4.平移定理\\
\ding{172}时移性质
\begin{lralign}
\mathcal{F} [f(t-b)](\xi)&=\int_{-\infty}^{\infty}f(t-b)e^{-2\pi i \xi t}\,dt\\
&=\int_{-\infty}^{\infty}f(t)e^{-2\pi i \xi (t+b)}\,dt\\
&=e^{-2\pi i \xi b}\int_{-\infty}^{\infty}f(t)e^{-2\pi i \xi t}\,dt\\
&=e^{-2\pi i \xi b}\mathcal{F} f(\xi)
\switch
\mathcal{F} [f(t-b)](\omega)&=\int_{-\infty}^{\infty}f(t-b)e^{-i \omega t}\,dt\\
&=\int_{-\infty}^{\infty}f(t)e^{-i \omega (t+b)}\,dt\\
&=e^{-i \omega b}\int_{-\infty}^{\infty}f(t)e^{-i \omega t}\,dt\\
&=e^{-i \omega b}\mathcal{F} f(\omega)
\end{lralign}
\ding{173}频移性质
\begin{lralign}
    \mathcal{F} f(\xi-b)&=\int_{-\infty}^{\infty}f(t)e^{-2\pi i(\xi-b)t}\,dt\\
&=\int_{-\infty}^{\infty}\left(f(t)e^{2\pi ibt}\right)e^{-2\pi i\xi t}\,dt\\
&=\mathcal{F} \left[f(t)e^{2\pi ibt}\right](\xi)
\switch
\mathcal{F} f(\omega-b)&=\int_{-\infty}^{\infty}f(t)e^{-i(\omega-b)t}\,dt\\
&=\int_{-\infty}^{\infty}\left(f(t)e^{ibt}\right)e^{-i\omega t}\,dt\\
&=\mathcal{F} \left[f(t)e^{ibt}\right](\omega)
\end{lralign}
\noindent 5.伸缩定理\lr{
    \mathcal{F} [f(at)](\xi)&=\int_{-\infty}^{\infty}f(at)e^{2\pi i \xi t}\,dt\\
    &=\frac{1}{|a|}\int_{-\infty}^{\infty}f(t)e^{\frac{2\pi i \xi t}{a}}\,dt&(at\to t)\\
    &=\frac{1}{|a|}\mathcal{F} f\left(\frac{\xi}{a}\right)
}{
    \mathcal{F} [f(at)](\omega)&=\int_{-\infty}^{\infty}f(at)e^{i \omega t}\,dt\\
    &=\frac{1}{|a|}\int_{-\infty}^{\infty}f(t)e^{\frac{i \omega t}{a}}\,dt&(at\to t)\\
    &=\frac{1}{|a|}\mathcal{F} f\left(\frac{\omega}{a}\right)
}
注意变量代换时，如果$a<0$，积分上下限也会改变，这正是绝对值的来源，对此有疑惑的读者
可以自行分情况验算。频域的伸缩定理仅仅是时域伸缩定理的直接推论。\\
6.微分性质\\
\ding{172}时域微分
\begin{lralign}
    \mathcal{F} (f')(\xi)&=\int_{-\infty}^{\infty}f'(t)e^{-2\pi i\xi t}\,dt\\
&=\int_{-\infty}^{\infty}e^{-2\pi i\xi t}\,df(t)\\
&=\evalat{e^{-2\pi i\xi t}f(t)}{-\infty}{\infty}+2\pi i\xi\int_{-\infty}^{\infty}f(t)e^{-2\pi i\xi t}\,dt\\
&=2\pi i\xi\mathcal{F} f(\xi)
\switch
    \mathcal{F} (f')(\omega)&=\int_{-\infty}^{\infty}f'(t)e^{-i\omega t}\,dt\\
&=\int_{-\infty}^{\infty}e^{-i\omega t}\,df(t)\\
&=\evalat{e^{-i\omega t}f(t)}{-\infty}{\infty}+i\omega\int_{-\infty}^{\infty}f(t)e^{-i\omega t}\,dt\\
&=i\omega\mathcal{F} f(\omega)
\end{lralign}
\ding{173}频域微分
\begin{lralign}
    (\mathcal{F} f)'(\xi)&=\frac{d}{d\xi}\int_{-\infty}^{\infty}f(t)e^{-2\pi i\xi t}\,dt\\
&=\int_{-\infty}^{\infty}f(t)\frac{\partial e^{-2\pi i\xi t}}{\partial \xi}\,dt\\
&=-\int_{-\infty}^{\infty}2\pi itf(t)e^{-2\pi i\xi t}\,dt\\
&=-\mathcal{F} (2\pi itf)(\xi)
\switch
    (\mathcal{F} f)'(\omega)&=\frac{d}{d\omega}\int_{-\infty}^{\infty}f(t)e^{-i\omega t}\,dt\\
&=\int_{-\infty}^{\infty}f(t)\frac{\partial e^{-i\omega t}}{\partial \omega}\,dt\\
&=-\int_{-\infty}^{\infty}itf(t)e^{-i\omega t}\,dt\\
&=-\mathcal{F} (itf)(\omega)
\end{lralign}
也可以由第一个微分性质取傅里叶逆变换，再令$f'=\mathcal{F} g$证明。
\end{proof}
$\evalat{e^{-2\pi i\xi t}f(t)}{-\infty}{\infty},\evalat{e^{-i\omega t}f(t)}{-\infty}{\infty}=0$是因为$f\in L^1(\mathbb{R})$要求反常积分$\int_{\mathbb{R}}|f(t)|\,dt<\infty$，其必要条件为$f(t)\to 0,t\to\infty$，而复指数函数部分模值恒为1。%对于后一等式中将求导与积分交换使用了\textbf{莱布尼兹积分法则}，也即含参变量积分的求导，通常需要条件（以角频率形式为例）\begin{circlist}
%    \item $\int_{-\infty}^{\infty}f(t)e^{-i\omega t}\,dt$对每个$\omega$可积
%    \item $\partial f(t)e^{-i\omega t}/\partial \omega=-itf(t)e^{-i\omega t}$存在
%    \item 存在可积函数$g(t)$使得$\left|-itf(t)e^{-i\omega t}\right|\leq g(t)$
%\end{circlist}
%最后一条成立是因为定理假设$f(t),tf(t)\in L^1(\mathbb(R)),g(t)=tf(t)$，否则无法做傅里叶变换。

下面，我们给出\textbf{帕塞瓦尔恒等式}(Parseval's identity)/\textbf{普朗歇尔定理}(Plancherel theorem)。\ref{sub:paseval}中已经给出过它的复指数级数形式，如果将傅里叶变换视作傅里叶级数的推广，那么“能量守恒”也自然地推广到傅里叶变换。它于1910年普朗歇尔的博士论文中被严格证明。
\begin{theorem}[帕塞瓦尔恒等式/普朗歇尔定理]
    设$f\in L^1(\mathbb{R})\cap L^2(\mathbb{R})$，则
    \lr{
    \int_{-\infty}^{\infty}|f(t)|^2\,dt=\int_{-\infty}^{\infty}|\mathcal{F} f(\xi)|^2\,d\xi
}{
    \int_{-\infty}^{\infty}|f(t)|^2\,dt=\frac{1}{2\pi}\int_{-\infty}^{\infty}|\mathcal{F} f(\omega)|^2\,d\omega
}
\end{theorem}
\begin{proof}
设$f,g\in L^1(\mathbb{R})\cap L^2(\mathbb{R})$，则\begin{lralign}
&\quad\int_{-\infty}^{\infty}\mathcal{F} f(\xi)\overline{\mathcal{F} g(\xi)}\,d\xi\\
&=\int_{-\infty}^{\infty}\mathcal{F} f(\xi)\mathcal{F}^{-1} \overline{g}(\xi)\,d\xi\\
&=\int_{-\infty}^{\infty}\left(\int_{-\infty}^{\infty}f(x)e^{-2\pi i\xi x}\,dx\right)\mathcal{F}^{-1} \overline{g}(\xi)\,d\xi\\
&=\int_{-\infty}^{\infty}f(x)\,dx\int_{-\infty}^{\infty}\mathcal{F}^{-1} \overline{g}(\xi)e^{-2\pi i\xi x}\,d\xi\\
&=\int_{-\infty}^{\infty}f(x)\mathcal{F} \mathcal{F} ^{-1}\overline{g}(x)\,dx\\
&=\int_{-\infty}^{\infty}f(x)\overline{g(x)}\,dx
\switch
&\quad\int_{-\infty}^{\infty}\mathcal{F} f(\omega)\overline{\mathcal{F} g(\omega)}\,d\omega\\
&=2\pi\int_{-\infty}^{\infty}\mathcal{F} f(\omega)\mathcal{F}^{-1} \overline{g}(\omega)\,d\omega\\
&=2\pi\int_{-\infty}^{\infty}\left(\int_{-\infty}^{\infty}f(x)e^{-i\omega x}\,dx\right)\mathcal{F}^{-1} \overline{g}(\omega)\,d\omega\\
&=2\pi\int_{-\infty}^{\infty}f(x)\,dx\int_{-\infty}^{\infty}\mathcal{F}^{-1} \overline{g}(\omega)e^{-i\omega x}\,d\omega\\
&=2\pi\int_{-\infty}^{\infty}f(x)\mathcal{F} \mathcal{F} ^{-1}\overline{g}(x)\,dx\\
&=2\pi\int_{-\infty}^{\infty}f(x)\overline{g(x)}\,dx
\end{lralign}
取$g=f$即证。注意我们并不要求$g$是实信号，$\overline{\mathcal{F} g}\neq\mathcal{F} ^{-1}g$.
\end{proof}

这说明，傅里叶变换是$L^1(\mathbb{R})\cap L^2(\mathbb{R})$上的等距变换，保持$L^2$范数不变。

\subsection{常用信号的傅里叶变换}\label{sub:fourier_of_signal}

\begin{example}[矩形函数]
在\ref{sub:tri_exp_series}中讨论了矩形函数$f(t)=E\chi_{[-T/2,T/2]}$的傅里叶变换，现在可以验证它的频谱与采样函数相似：
\begin{lralign}
\mathcal{F} f(\xi)&=\int_{-\infty}^{\infty}f(t)e^{-2\pi i\xi t}\,dt\\
&=E\int_{-\infty}^{\infty}\chi_{[-T/2,T/2]}(t)e^{-2\pi i\xi t}\,dt\\
&=E\int_{-\frac{T}{2}}^{\frac{T}{2}}e^{-2\pi i\xi t}\,dt\\
&=-\frac{E}{2\pi i\xi}\evalat{e^{-2\pi i\xi t}}{-\frac{T}{2}}{\frac{T}{2}}\\
&=\frac{e^{\pi i\xi T}-e^{-\pi i\xi T}}{2i}\frac{E}{\pi\xi}\\
&=\frac{E}{\pi\xi}\sin(\pi T\xi)=ET\text{sinc}(T\xi)
\switch
\mathcal{F} f(\omega)&=\int_{-\infty}^{\infty}f(t)e^{-i\omega t}\,dt\\
&=E\int_{-\infty}^{\infty}\chi_{[-T/2,T/2]}(t)e^{-i\omega t}\,dt\\
&=E\int_{-\frac{T}{2}}^{\frac{T}{2}}e^{-i\omega t}\,dt\\
&=-\frac{E}{i\omega}\evalat{e^{-i\omega t}}{-\frac{T}{2}}{\frac{T}{2}}\\
&=\frac{e^{\frac{i\omega T}{2}}-e^{-\frac{i\omega T}{2}}}{2i}\frac{2E}{\pi\omega}\\
&=\frac{2E}{\omega}\sin(\frac{T\omega}{2})=ET\text{Sa}\left(\frac{T\omega}{2}\right)
\end{lralign}
因此\lr{
    \mathcal{F} \chi_{[-T/2,T/2]}(\xi)&=T\text{sinc}(T\xi)\\
    \mathcal{F} \left[\text{sinc}(Tt)\right](\xi)&=\frac{1}{T}\chi_{[-T/2,T/2]}\left(\frac{\xi}{T}\right)
}{
    \mathcal{F} \chi_{[-T/2,T/2]}(\omega)&=T\text{Sa}\left(\frac{T\omega}{2}\right)\\
    \mathcal{F}\left[\text{Sa}(Tt)\right](\omega)&=\frac{\pi}{T}\chi_{[-T,T]}(\omega)
}
\end{example}
基于以上结果，可以证明\ref{sub:int_sin}中给出的狄利克雷积分公式：
\begin{corollary}[狄利克雷积分]
    \[\int_{-\infty}^{\infty}\frac{\sin t}{t}\,dt=\pi\]
\end{corollary}
\begin{proof}
    令$T=1$，则\begin{lralign}
        \mathcal{F} \left[\text{sinc}(t)\right](\xi)&=\chi_{[-1/2,1/2]}\left(\xi\right)
\switch
        \mathcal{F} \left[\text{Sa}(t)\right](\omega)&=\pi\chi_{[-1,1]}(\omega)
    \end{lralign}
    取$\xi=0$或$\omega=0$，根据傅里叶变换的定义，得到采样函数直流分量的大小：
    \begin{lralign}
        \int_{-\infty}^{\infty}\text{sinc}(t)\,dt&=1
\switch
        \int_{-\infty}^{\infty}\text{Sa}(t)\,dt&=\pi
    \end{lralign}
    以上两个结果都与狄利克雷积分等价。
\end{proof}
\begin{example}[狄拉克函数]
在\ref{sub:signal}中介绍了狄拉克$\delta$函数，实际上它应该作为一个分布来理解，见\ref{sub:general_distributions}，不过我们可以从形式上求出它的傅里叶变换。
\lr{
\mathcal{F} \delta(\xi)&=\int_{-\infty}^{\infty}\delta(t)e^{-2\pi i\xi t}\,dt\\
&=\int_{-\infty}^{\infty}\delta(t)\,dt=1
}{
\mathcal{F} \delta(\omega)&=\int_{-\infty}^{\infty}\delta(t)e^{-i\omega t}\,dt\\
&=\int_{-\infty}^{\infty}\delta(t)\,dt=1
}
\end{example}
根据傅里叶变换的对偶性，我们当然希望恒为1的函数的傅里叶变换是$\delta$或$2\pi\delta$（取决于是用频率做变换还是用角频率做变换），然而，1在无限区间上必定是不可积的，在常规意义下它不能够做傅里叶变换。这个问题将在\ref{sub:operation_of_distribution}中讨论，那时就可以对相当大范围内的函数做傅里叶变换，还将在\ref{sub:fourier_of_dirac_comb}中看到周期函数的傅里叶变换与傅里叶级数的深刻关系。现在我们暂且承认公式：
\begin{claim}
    用$\mathds{1}$表示恒为1的函数。
\lr{
    &\mathcal{F} \delta(\xi)=1\\
    &\mathcal{F} \mathds{1}=\delta(\xi)
}{
    &\mathcal{F} \delta(\omega)=1\\
    &\mathcal{F} \mathds{1}=2\pi\delta(\omega)
}
\end{claim}
非零的常函数有无穷大的直流分量，而没有其他的频率分量，这符合我们的直观认识；另一方面，常函数$\mathds{1}$的傅里叶变换是强度为1或$2\pi$的狄拉克函数，这为我们提供了另一种理解狄拉克函数的强度的方法。

\begin{corollary}
    根据傅里叶变换的平移定理，立即得到：
\lr{
&\mathcal{F} [\delta_a](\xi)=e^{-2\pi i\xi a}\\
&\mathcal{F} \left[e^{2\pi ia t}\right]=\delta_a
}{
&\mathcal{F} [\delta_a](\omega)=e^{-i\omega a}\\
&\mathcal{F} \left[e^{ia t}\right]=2\pi\delta_a
}
根据傅里叶变换的微分性质得到：\lr{
    \mathcal{F} [t^n](\xi)&=\left(\frac{i}{2\pi}\right)^n \delta^{(n)}(\xi)\\
}{
    \mathcal{F} [t^n](\omega)&=2\pi i^n\delta^{(n)}(\omega)\\
}\end{corollary}

我们还希望从$u'(t)=\delta(t),\text{sgn}'(t)=2\delta(t)$得到单位阶跃函数$u(t)$和符号函数\text{sgn}$(t)$的傅里叶变换，但在考虑$\delta$的不定积分时，必须处理积分常数“C”，它将导致频域中出现$C\delta$或$2\pi C\delta$项。

注意到$\text{sgn}(t)$是奇函数，其傅里叶变换应为纯虚的奇函数，我们可以由此确定它和单位阶跃函数的傅里叶变换中C的值，从而得到正确的结果:
\begin{corollary}
    \quad
    \lr{
    \mathcal{F} \text{sgn}(\xi)&=\frac{1}{\pi i\xi}
}{
    \mathcal{F} \text{sgn}(\omega)&=\frac{2}{i\omega}
}
\begin{lralign}
    \mathcal{F} u(\xi)&=\mathcal{F} \left[\frac{1}{2}(\text{sgn}(t)+1)\right]\\
    &=\frac{1}{2}\left(\delta+\frac{1}{\pi i\xi}\right)\\
\switch
    \mathcal{F} u(\omega)&=\mathcal{F} \left[\frac{1}{2}(\text{sgn}(t)+1)\right]\\
    &=\pi\delta+\frac{1}{i\omega}\\
\end{lralign}
\end{corollary}

由傅里叶反演公式，有：\begin{lralign}
    \mathcal{F} \mathcal{F} \text{sgn}&=2\pi \text{sgn}^-=-2\pi \text{sgn}\\
    &=\mathcal{F} \left[\frac{1}{\pi i\xi}\right]
\switch
    \mathcal{F} \mathcal{F} \text{sgn}&=2\pi \text{sgn}^-=-2\pi \text{sgn}\\
    &=\mathcal{F} \left[\frac{2}{i\omega}\right]
\end{lralign}
由此可得
\begin{corollary}
    \quad
\lr{
    \mathcal{F} \left[\frac{1}{t}\right](\xi)&=-\pi i sgn(\xi)\\
}{
    \mathcal{F} \left[\frac{1}{t}\right](\omega)&=-\pi i sgn(\omega)\\
}
\end{corollary}

最后，我们来求高斯函数和指数函数的傅里叶变换，它们在信号处理应用广泛，且有许多优美的性质。

\begin{example}[高斯函数]
我们来求$G(t)=e^{-\pi t^2}$的傅里叶变换，其他高斯函数的傅里叶变换可以用同样的方法求得，或者使用伸缩定理得到。
\begin{lralign}
\mathcal{F} G(\xi)&=\int_{-\infty}^{\infty}e^{-\pi t^2}e^{-2\pi i\xi t}\,dt\\
\frac{d}{d\xi}\mathcal{F} G(\xi)&=\int_{-\infty}^{\infty}e^{-\pi t^2}(-2\pi it)e^{-2\pi i\xi t}\,dt\\
&=i\int_{-\infty}^{\infty}e^{-2\pi i\xi t}\,de^{-\pi t^2}\\
&=-i\int_{-\infty}^{\infty}e^{-\pi t^2}(-2\pi i\xi)e^{-2\pi i\xi t}\,dt\\
&=-2\pi \xi\mathcal{F} G
\switch
\mathcal{F} G(\omega)&=\int_{-\infty}^{\infty}e^{-\pi t^2}e^{-i\omega t}\,dt\\
\frac{d}{d\omega}\mathcal{F} G(\omega)&=\int_{-\infty}^{\infty}e^{-\pi t^2}(-it)e^{-i\omega t}\,dt\\
&=\frac{i}{2\pi}\int_{-\infty}^{\infty}e^{-i\omega t}\,de^{-\pi t^2}\\
&=-\frac{i}{2\pi}\int_{-\infty}^{\infty}e^{-\pi t^2}(-i\omega)e^{-i\omega t}\,dt\\
&=-\frac{\omega}{2\pi}\mathcal{F} G
\end{lralign}
这是一个可分离变量的微分方程，
\lr{
\mathcal{F} G(\xi)&=\mathcal{F} G(0)e^{-\pi\xi^2}\\
\mathcal{F} G(0)&=\int_{-\infty}^{\infty}e^{-\pi t^2}\,dt=1\\
\mathcal{F} G(\xi)&=e^{-\pi\xi^2}
}{
\mathcal{F} G(\omega)&=\mathcal{F} G(0)e^{-\frac{\omega^2}{4\pi}}\\
\mathcal{F} G(0)&=\int_{-\infty}^{\infty}e^{-\pi t^2}\,dt=1\\
\mathcal{F} G(\omega)&=e^{-\frac{\omega^2}{4\pi}}
}
\end{example}
%\begin{figure}[htbp]
%    \centering
%    \includegraphics[width=0.4\textwidth]{Gauss}    
%    \caption{高斯函数图像}
%\end{figure}

\begin{example}[单边指数函数和双边指数函数]
在\ref{sub:signal}中我们曾介绍单边指数函数$f(t)=e^{-at}u(t)$和双边指数函数$g(t)=f(t)+f(-t)$.
\begin{lralign}
\mathcal{F} f(\xi)&=\int_{-\infty}^{\infty}f(t)e^{-2\pi i\xi t}\,dt\\
&=\int_{0}^{\infty}e^{-at}e^{-2\pi i\xi t}\,dt\\
&=-\frac{1}{a+2\pi i\xi}\left.e^{-(a+2\pi i\xi)t}\right|_{0}^{\infty}\\
&=\frac{1}{a+2\pi i\xi}
\switch
\mathcal{F} f(\omega)&=\int_{-\infty}^{\infty}f(t)e^{-i\omega t}\,dt\\
&=\int_{0}^{\infty}e^{-at}e^{-i\omega t}\,dt\\
&=-\frac{1}{a+i\omega}\left.e^{-(a+i\omega)t}\right|_{0}^{\infty}\\
&=\frac{1}{a+i\omega}
\end{lralign}
运用对偶性，立即得到
\lr{
\mathcal{F} g(\xi)&=\mathcal{F} f(\xi)+\overline{\mathcal{F} f(\xi)}\\
&=2\text{Re}\ {\mathcal{F} f(\xi)}\\
&=\frac{2a}{a^2 + 4\pi^2 \xi^2}
}{
\mathcal{F} g(\omega)&=\mathcal{F} f(\omega)+\overline{\mathcal{F} f(\omega)}\\
&=2\text{Re}\ {\mathcal{F} f(\omega)}\\
&=\frac{2a}{a^2 +\omega^2}
}
\end{example} 

\section{卷积}\label{sec:Convolution}

\subsection{卷积的引入}\label{sub:convolution}
信号处理讨论的一个基本问题是\textbf{滤波}，即希望把一个信号输入滤波系统后，输出的信号的一些频率成分被剔除或大幅减少，以低通滤波器为例，从数学上讲，就是把信号的频域形式乘以一个矩形函数或一个在给定的频率值之外快速下降到接近于0的函数，这就引出了一个问题：在频域乘一个函数，在时域上的表现是什么？我们知道，一般而言没有$\mathcal{F} (fg)=\mathcal{F} f\mathcal{F} g$。一个自然的想法是，看能否定义一种运算，使得在频域乘一个函数，相当于在时域与这个函数的时域形式做该种运算。实际上，这种运算是存在的，它正是\textbf{卷积}(convolution)

下面就来找出这个运算。设$f\overset{\mathcal{F} }{\longleftrightarrow}F,g\overset{\mathcal{F} }{\longleftrightarrow}G$,
\begin{lralign}
    F(\xi)G(\xi)=&\int_{-\infty}^{\infty}f(x)e^{-2\pi i\xi x}\,dx\int_{-\infty}^{\infty}g(y)e^{-2\pi i\xi y}\,dy\\
    =&\iint\limits_{\mathbb{R}^2}f(x)g(y)e^{-2\pi i\xi(x+y)}\,dx\,dy
\switch
    F(\omega)G(\omega)=&\int_{-\infty}^{\infty}f(x)e^{-i\omega x}\,dx\int_{-\infty}^{\infty}g(y)e^{-i\omega y}\,dy\\
    =&\iint\limits_{\mathbb{R}^2}f(x)g(y)e^{-i\omega(x+y)}\,dx\,dy
\end{lralign}
令$z=x+y$，则积分区域仍为$\mathbb{R}^2$，
\[dxdz=\left|\frac{\partial(x,z)}{\partial(x,y)}\right|dxdy=\left|\begin{vmatrix}
        1 & 0 \\
        1 & 1
    \end{vmatrix}\right| dxdy=dxdy\]
\lr{
F(\xi)G(\xi)=&\iint\limits_{\mathbb{R}^2}f(x)g(z-x)e^{-2\pi i\xi z}\,dx\,dz\\
&=\int_{-\infty}^{\infty}e^{-2\pi i\xi z}\,dz\int_{-\infty}^{\infty}f(x)g(z-x)dx\\
&=\mathcal{F} \left[\int_{-\infty}^{\infty}f(x)g(z-x)dx\right](\xi)
}{
F(\omega)G(\omega)=&\iint\limits_{\mathbb{R}^2}f(x)g(z-x)e^{-i\omega z}\,dx\,dz\\
&=\int_{-\infty}^{\infty}e^{-i\omega z}\,dz\int_{-\infty}^{\infty}f(x)g(z-x)dx\\
&=\mathcal{F} \left[\int_{-\infty}^{\infty}f(x)g(z-x)dx\right](\omega)
}

因此我们定义\begin{definition}[卷积]
函数f,g的\textbf{卷积}为
\begin{equation*}
    (f*g)(x)=\int_{-\infty}^{\infty}f(y)g(x-y)\,dy
\end{equation*}
\end{definition}

\subsection{卷积的性质}\label{sub:properties_of_convolution}
根据前文中的结果，有$\mathcal{F} (f*g)=\mathcal{F} f\mathcal{F} g$，这是时域卷积的性质，由傅里叶反演公式，不难想到频域卷积也有类似的性质。对以上公式两边同时取傅里叶逆变换：
\begin{lralign}
f*g&=\mathcal{F} ^{-1}\left(\mathcal{F} f\mathcal{F} g\right)
\switch
f*g&=\mathcal{F} ^{-1}\left(\mathcal{F} f\mathcal{F} g\right)
\end{lralign}
令$f=\mathcal{F} \mathfrak{f},g=\mathcal{F} \mathfrak{g}$，则
\begin{lralign}
    \mathcal{F} \mathfrak{f}*\mathcal{F} \mathfrak{g}&=\mathcal{F} ^{-1}\left[\mathcal{F}\mathcal{F} \mathfrak{f}\cdot\mathcal{F} \mathcal{F} \mathfrak{g}\right]\\
    &=\mathcal{F} ^{-1}\left(\mathfrak{f}^- \mathfrak{g}^- \right)\\
    &=\mathcal{F} (\mathfrak{fg})
\switch
    \mathcal{F} \mathfrak{f}*\mathcal{F} \mathfrak{g}&=\mathcal{F} ^{-1}\left[\mathcal{F}\mathcal{F} \mathfrak{f}\cdot\mathcal{F} \mathcal{F} \mathfrak{g}\right]\\
    &=\mathcal{F} ^{-1}\left(4\pi^2 \mathfrak{f}^- \mathfrak{g}^- \right)\\
&= 2\pi\mathcal{F} (\mathfrak{fg})
\end{lralign}
综上得到\textbf{卷积定理}(the convolution thoerem)：
\begin{theorem}[卷积定理]
    \quad
\lr{
    \mathcal{F} (f*g)(\xi)=\mathcal{F} f(\xi)\mathcal{F} g(\xi)\\
    \mathcal{F} (fg)(\xi)=(\mathcal{F} f*\mathcal{F} g)(\xi)
}{
    \mathcal{F} (f*g)(\omega)=\mathcal{F} f(\omega)\mathcal{F} g(\omega)\\
    \mathcal{F} (fg)(\omega)=\frac{1}{2\pi}(\mathcal{F} f*\mathcal{F} g)(\omega)
}
\end{theorem}

在不引起歧义时，我们也承认$f(t)*g(t)$和$f(t)*e^{t+1}$这样的写法。需要注意，$f(2t)*g(t)$对应着两种理解：$\int_{-\infty}^{\infty}f(2t-x)g(x)\,dx$和$\int_{-\infty}^{\infty}f(2(t-x))g(x)\,dx$，第二种才是对的，因为我们认为$f(2t)$作为一个新的函数$F(t)=f(2t)$与$g(t)$行卷积。

作为一种新的函数空间上的运算，我们自然要讨论它是否满足线性性、结合律、交换律。事实上，它们都是成立的：
\begin{proposition}[卷积的线性性、结合律、交换律]
    \begin{align*}
    f*(ag_1+bg_2) & =af*g_1+bf*g_2 \\
    (f*g)*h       & =f*(g*h)       \\
    f*g           & =g*f
\end{align*}
\end{proposition}
线性性得自积分的线性性，交换律通过变量替换即可证明，下面仅证明结合律。
\begin{proof}
\begin{align*}
    (f*g)*h(x) & =\int_{-\infty}^{\infty}(f*g)(x-y)h(y)\,dy=\int_{-\infty}^{\infty}h(y)\,dy\int_{-\infty}^{\infty}f(z)g(x-y-z)\,dz \\
               & =\int_{-\infty}^{\infty}\int_{-\infty}^{\infty}f(z)g(x-y-z)h(y)\,dy\,dz=\int_{-\infty}^{\infty}f(z)(g*h)(x-z)\,dz
\end{align*}
\end{proof}

也可以通过取傅里叶变换的方式证明它们，但这样会缩减证明有效的范围，因为卷积存在只要求积分$(f*g)(x)=\int_{-\infty}^{\infty}f(y)g(x-y)\,dy$存在（它有许多种充分条件，不再一一讨论），而取傅里叶变换则要求$f,g,f*g$的傅里叶变换存在。

卷积是否具有“幺元”呢？我们希望找到一个函数，使得它与任一函数$f$卷积，总得到$f$本身。事实上，只有$\delta$可以起到这个作用（尽管它应该作为一个分布来理解，见\ref{sub:general_distributions}和\ref{sub:approach}）。
\begin{proposition}[卷积幺元]
    设$f\in L^1(\mathbb{R})$，则$\delta$是“卷积幺元”，即
    \lr{
    f(t)=(f*\delta)(t)=\int_{-\infty}^{\infty}f(x)\delta(t-x)\,dx
}{
    f(t)=(f*\delta)(t)=\int_{-\infty}^{\infty}f(x)\delta(t-x)\,dx
}
\end{proposition}
\begin{proof}
设$f\in L^1(\mathbb{R})$，则\lr{
\mathcal{F} (f*\delta)(\xi)=\mathcal{F} f(\xi)\mathcal{F} \delta(\xi)=\mathcal{F} f(\xi)
}{
    \mathcal{F} (f*\delta)(\omega)=\mathcal{F} f(\omega)\mathcal{F} \delta(\omega)=\mathcal{F} f(\omega)
}
由傅里叶反演公式得证。
\end{proof}

\subsection{卷积的直观}\label{sub:intuition_of_convolution}
初次接触卷积时，往往会对它的定义感到疑惑，因为在数学分析的课程中我们很少见到这种“翻转、平移、相乘、积分”的结构。需要指出，卷积并不只有“时域相乘，频域卷积；时域卷积，频域相乘”的物理意义，例如概率论中两独立的连续型随机变量X,Y之和作为一种新的随机变量Z，其概率密度函数$f_Z(z)$正是两个独立的随机变量的概率密度函数的卷积$f_X*f_Y(z)$.类似于用“求曲线下方的面积”或“已知速度求位移”引入积分，尽管我们用一种较为自然的方式引入了卷积，但不应该认为它只有单一的意义。不过，还是可以建立一些卷积的性质来辅助我们理解卷积。

\noindent 1.\textbf{卷积是一种起“平均化”作用的运算}
\begin{definition}[加权均值]
    给定区间$[a,b]$和权函数$w(x)$，$f(x)$的加权均值为\[\frac{\int_{a}^{b}f(x)w(x)\,dx}{\int_{a}^{b}w(x)\,dx}\]
\end{definition}
给定$x$时，$w(y)=g(x-y)$就是$f*g$中f的加权均值的倍数。进一步，卷积的光滑性高于用来卷积的两个函数，并且在f可导时有$(f*g)'=f'*g$，因为
\[(f*g)'(x)=\frac{d}{dx}\int_{-\infty}^{\infty}f(x-y)g(y)\,dy=\int_{-\infty}^{\infty}f'(x-y)g(y)\,dy=f'*g\]

特别地，如果$g(x)=\frac{1}{2a}\chi_{[-a,a]}$，则$f*g(x)$是$f(x)$在区间$[x-a,x+a]$上的平均值：
\[(f*g)(x)=\int_{-\infty}^{\infty}f(y)g(x-y)\,dy=\frac{1}{2a}\int_{x-a}^{x+a}f(y)\,dy\]

\noindent 2.\textbf{卷积函数的支集}

我们首先引入\textbf{支集}(support)的概念，读者只需理解其直观，真正理解它需要一些拓扑学的基础。
\begin{definition}[支集]
    设$f:\mathbb{R}\to \mathbb{R}$，f的\textbf{支集}
$\text{supp}\ f=\overline{\left\{x\in\mathbb{R}\left|f(x)\neq 0\right.\right\}}$
\end{definition}

这里上划线不是取共轭，而是对集合取闭包，闭包包括集合本身的和它的极限点，$\mathbb{R}$中集合的闭包是闭集，例如，$(a,b)$的闭包是$[a,b]$.

集合$\{x\in\mathbb{R}:f(x)\neq 0\}$的提出是自然的，取闭包则不那么容易理解。实际上，在度量空间中，一个集合是紧集（任给一个开区间组成的覆盖，总能从中取出有限覆盖）就等价于它是有界闭集，描述有界区间的一种方式是说它是闭包紧的。因此，我们可以说在无穷远处为0的函数有\textbf{紧支集}(compact support)。
\begin{definition}[紧支函数空间]
对于p次连续可导的函数$f\in C^p(\mathbb{R})$，我们记其中具有紧支集的函数构成的集合为$C_0^p(\mathbb{R})$。
\end{definition}

卷积能够将两个函数的支集“相加”，即：\begin{align*}
\text{supp}\ f\in [a,b],\text{supp}\ g\in [c,d]\implies&\text{supp}\ (f*g)\in [a+c,b+d]
\end{align*}
带入定义容易验证这一点：
\begin{align*}
     & (f*g)(x) =\int_{-\infty}^{\infty}f(y)g(x-y)\,dy                               \\
     & \text{积分值非0}\implies y\in [a,b],x-y\in [c,d]\iff x\in [a+c,b+d]
\end{align*}

\noindent 3.\textbf{函数变换下的卷积}
\begin{proposition}[信号反转下的卷积]
    \[(f^-)*(g^-)=(f*g)^-\]
\end{proposition}
\begin{proof}
    \begin{align*}
    (f^-)*(g^-)(x) & =\int_{-\infty}^{\infty}f^-(y)g^-(x-y)\,dy          \\
                   & =\int_{-\infty}^{\infty}f(-y)g(-(x-y))\,dy          \\
                   & =\int_{-\infty}^{\infty}f(z)g(-(x+z))(-dz) & (z=-y) \\
                   & =\int_{-\infty}^{\infty}f(z)g(-x-z)\,dz             \\
                   & =(f*g)^-(x)
\end{align*}
\end{proof}

如果只有一个信号反转，则结果不再是卷积，而是f与g的互相关（在f,g都是实信号时），下面很快将讨论它。

在建立卷积在信号时延或伸缩下的性质前，我们先来明确所使用的符号。我们将用$\tau$表示时延$\tau_b f(t)=f(t-b)$，用$\sigma$表示伸缩$\sigma_a f(t)=f(at)$，并避免使用$\tau,\sigma$作为变量的符号。这样的做法在研究分布的性质时是必要的，因为严格来讲不能给出分布的“自变量”，但例如$\delta$函数这样的分布又具有明显的尺度变换的性质，见\ref{sub:operation_of_distribution}.

\begin{proposition}[信号时延、伸缩时的卷积]
    \begin{align*}
    (\tau_b f)*g=\tau_b (f*g)=f*(\tau_b g) \\
    (\sigma_a f)*(\sigma_a g)=\frac{1}{|a|}\sigma_a(f*g)
\end{align*}
\end{proposition}
\begin{proof}
    \begin{align*}
    (\tau_b f)*g(x) & =\int_{-\infty}^{\infty}\tau_b f(y)g(x-y)\,dy           \\
                    & =\int_{-\infty}^{\infty}f(y-b)g(x-y)\,dy                \\
                    & =\int_{-\infty}^{\infty}f(z)g(x-(z+b))\,dz    & (z=y-b) \\
                    & =\int_{-\infty}^{\infty}f(z)g((x-b)-z)\,dz              \\
                    & =(f*g)(x-b)=\tau_b (f*g)(x)
\end{align*}
类似地，可以证明$f*(\tau_b g)=\tau_b (f*g)$.
\begin{align*}
    (\sigma_a f)*(\sigma_a g)(x) & =\int_{-\infty}^{\infty}\sigma_a f(y)\sigma_a g(x-y)\,dy                          \\
                                 & =\int_{-\infty}^{\infty}f(ay)g(a(x-y))\,dy                                        \\
                                 & =\frac{1}{|a|}\int_{-\infty}^{\infty}f(z)g(a x - z)\,dz  & \left(z=ay,dy=\frac{dz}{a}\right) \\
                                 & =\frac{1}{|a|}(f*g)(a x)=\frac{1}{|a|}\sigma_a(f*g)(x)
\end{align*}
和傅里叶变换的伸缩定理类似，这里也需要讨论a的正负，但不再赘述。
\end{proof}

\noindent 4.\textbf{“面积”关系}

我们已经提到，概率论中两个独立随机变量之和的概率密度函数是它们各自概率密度函数的卷积，这当
然要求两个概率密度函数在$\mathbb{R}$上的积分值为1时，它们的卷积在$\mathbb{R}$上的积
分值也为1。更一般地：
\begin{proposition}[卷积的“面积”关系]
\[\int_{-\infty}^{\infty}(f*g)(x)\,dx=\int_{-\infty}^{\infty}f(y)\,dy\int_{-\infty}^{\infty}g(x)\,dx\]
\end{proposition}
\begin{proof}
\begin{align*}
    \int_{-\infty}^{\infty}(f*g)(x)\,dx & =\int_{-\infty}^{\infty}\,dx\int_{-\infty}^{\infty}f(y)g(x-y)\,dy                                   \\
                                        & =\int_{-\infty}^{\infty}f(y)\,dy\int_{-\infty}^{\infty}g(x-y)\,dx                                   \\
                                        & =\int_{-\infty}^{\infty}f(y)\,dy\int_{-\infty}^{\infty}g(u)\,du                           & (u=x-y) \\
                                        & =\left(\int_{-\infty}^{\infty}f(x)\,dx\right)\left(\int_{-\infty}^{\infty}g(x)\,dx\right)
\end{align*}
\end{proof}

\subsection{相关}\label{sub:correlation}
在统计学中，我们引入相关系数来描述两个随机变量之间的相关程度，类似地，在信号
处理中，我们引入\textbf{相关系数}(correlation coefficient)来描述两个信号之间的相关
程度。
\begin{definition}[相关系数]
设$f,g\in L^2(\mathbb{R})$，它们的相关系数定义为
\begin{equation*}
    \rho(f,g)=\frac{\langle f,g\rangle}{\|f\|\cdot\|g\|}
\end{equation*}
\end{definition}
其中$\langle f,g\rangle=\int_{-\infty}^{\infty}f(x)\overline{g(x)}dx$是$f$和
$g$的内积，$\|f\|=\sqrt{\langle f,f\rangle}$是$f$的范数。根据柯西-施瓦茨不等式，
相关系数的绝对值不超过1，且当且仅当$f$与$g$几乎处处成比例时取等，因此我们说，
$\rho(f,g)=\pm 1$时两信号\textbf{线性相关}；$\rho(f,g)=0$时两信号\textbf{线性无关}，
这相当于两函数正交。

有时信号之间存在时延差，这时我们可以定义\textbf{互相关}(cross-correlation)来描述它
们之间的相关程度。
\begin{definition}[互相关]
设$f,g\in L^2(\mathbb{R})$，它们的互相关定义为
\begin{equation}
    (f\star g)(x)=\int_{-\infty}^{\infty}f(y)\overline{g(x+y)}\,dy
\end{equation}
同样可以定义f的自相关$(f\star f)(x)$
\end{definition}
互相关具有以下性质：
\begin{proposition}[互相关的性质]
\begin{enumerate}
    \quad
    \item $(f\star g) =f^-* \overline{g}=\overline{(g\star f)^-}$，如果$f,g$都是实信号，则$f\star g = (g\star f)^- =f^- *g=(f*g^-)^-$.
    \item $\mathcal{F} (f\star g) =\mathcal{F} f\overline{\mathcal{F} g}$，特别地，
          $\mathcal{F} (f\star f) =|\mathcal{F} f|^2$，这个结果称为\textbf{维纳-辛钦定理}(Wiener-Khinchin theorem)
    \item $f\star (\tau_b g)=\tau_{b} (f\star g)=(\tau_{-b}f)\star g$
    \item $(f\star g)\leq\|f\|_2\|g\|_2$，特别地，$(f\star f)(x)\leq (f\star f)(0)=\|f\|_2^2$
\end{enumerate}
\end{proposition}
\begin{proof}
\begin{align*}
    1.(f\star g)(x)               & =\int_{-\infty}^{\infty}f(y)\overline{g(x+y)}\,dy                                                                   \\
                                  & =\int_{-\infty}^{\infty}f(-y)\overline{g(x-y)}\,dy                                                                  \\
                                  & =\int_{-\infty}^{\infty}f^-(y)\overline{g(x-y)}\,dy                                                                  \\
                                  & = (f^- * \overline{g})(x)                                                                                           \\
    (f\star g)(x)                 & =\int_{-\infty}^{\infty}f(y)\overline{g(x+y)}\,dy                                                                   \\
                                  & =\overline{\int_{-\infty}^{\infty}g(x+y)\overline{f(y)}\,dy}                                                        \\
                                  & =\overline{(g\star f)(-x)}=\overline{(g\star f)^-(x)}                                                               \\
    2.\mathcal{F} (f\star g)(\xi) & =\int_{-\infty}^{\infty}(f\star g)(x)e^{-2\pi i\xi x}\,dx                                                           \\
                                  & =\int_{-\infty}^{\infty}e^{-2\pi i\xi x}\,dx\int_{-\infty}^{\infty}f(y)\overline{g(x+y)}\,dy                        \\
                                  & =\iint\limits_{\mathbb{R}^2}f(y)\overline{g(x+y)}e^{-2\pi i\xi x}\,dy\,dx                                           \\
                                  & =\int_{-\infty}^{\infty}f(y)\,dy\int_{-\infty}^{\infty}\overline{g(x+y)}e^{-2\pi i\xi x}\,dx                        \\
                                  & =\int_{-\infty}^{\infty}f(y)e^{2\pi i\xi y}\,dy\int_{-\infty}^{\infty}\overline{g(u)}e^{-2\pi i\xi u}\,du & (u=x+y) \\
                                  & =\mathcal{F} f(\xi)\overline{\mathcal{F} g(\xi)}
\end{align*}这里不涉及频率、角频率的问题，读者可以自行验证。
\begin{align*}
    3.\left(f\star (\tau_b g)\right)(x)  & =\int_{-\infty}^{\infty}f(y)\overline{(\tau_b g)(x+y)}\,dy                                                  \\
                              & =\int_{-\infty}^{\infty}f(y)\overline{g(x+y-b)}\,dy                                                         \\
                              & =(f\star g)(x-b)=\tau_{b} (f\star g)(x)                                                                     \\
    ( (\tau_{-b}f)\star g)(x) & =\int_{-\infty}^{\infty}(\tau_{-b}f)(y)\overline{g(x+y)}\,dy                                                \\
                              & =\int_{-\infty}^{\infty}f(y+b)\overline{g(x+y)}\,dy                                                         \\
                              & =\int_{-\infty}^{\infty}f(z)\overline{g(x+z-b)}\,dz                                               & (z=y+b) \\
                              & =(f\star g)(x-b)=\tau_{b} (f\star g)(x)                                                                     \\
    4. (f\star g)(x)          & =\int_{-\infty}^{\infty}f(y)\overline{g(x+y)}\,dy                                                           \\
                              & \leq \sqrt{\int_{-\infty}^{\infty}|f(y)|^2\,dy\int_{-\infty}^{\infty}\left|\overline{g(x+y)}\right|^2\,dy  }           \\
                              & =\sqrt{\|f\|_2^2\|g\|_2^2}=\|f\|_2\cdot\|g\|_2                                              
\end{align*}
\end{proof}

对于功率信号，我们需要对以上互相关的定义略作修改，以避免趋于无穷的情况发生。
\begin{definition}[功率信号的互相关]
    对于功率信号$f,g$，定义互相关函数为
\begin{equation}
    (f\star g)(x)=\lim_{T\to\infty}\frac{1}{2T}\int_{-T}^{T}f(y)\overline{g(x+y)}\,dy
\end{equation}
\end{definition}
其性质不再单独讨论。

一些文献（如\cite{signal_systems}）也将互相关函数定义为$$R_{fg}(x)=\int_{-\infty}^{\infty}f(y)\overline{g(x-y)}\,dy=\int_{-\infty}^{\infty}f(x+y)g(y)\,dy$$
功率信号同理。这与上面讨论的互相关没有本质区别。

最后我们给出一个互相关的应用\cite{brad_osgood_ee261}。
\begin{example}[雷达测距]
    设雷达发射了一个信号$f(t)$，经过时间T信号接触到
物体并发生反射，再经过时间T信号回到雷达，雷达接收到的信号$f_r(t)=\alpha (\tau_{2T}f(t))+n(t)$,
其中$\alpha\in(0,1)$，表示信号在传播过程中衰减；$n(t)$为噪声信号。我们
希望确定时间T，以计算雷达到物体间的距离。对于噪声信号$n(t)$，它满足
\[(f\star n)(t)=C\]
C为常数，因此可以考虑求发射信号与接收信号的互相关函数：\begin{align*}
    (f\star f_r)(t)&=\alpha(f\star \tau_{2T}f)(t)+(f\star n)(t)\\
    &=\alpha\tau_{2T}(f\star f)(t)+\alpha C
\end{align*}
根据前面得到的性质4，$(f\star f)(t)$在0处取最大值，因此$(f\star f_r)(t)$在$2T$
处取最大值，于是我们只需要观察这个互相关函数的最大值点，就可以得到T。
\end{example}

\section{分布及其傅里叶变换}\label{sec:Distributions}

经典的数学分析理论难以处理单位阶跃函数的导数，也无法对一些比较比基本的函数如正弦、余弦函数做傅里叶变换，甚至因此傅里叶反演公式不总是成立（注意我们之前仅在形式上使用傅里叶反演公式），要扩充这个理论，标准的做法是引入\textbf{广义函数}(gerneralized function)，又称\textbf{分布}(distribution)。分布这个名称一开始是由物理学家引入的，例如在描述点电荷的分布时，经典函数是失效的，于是在20世纪20年代末到30年代初，狄拉克及一众物理学家开始用分布进行运算，到30年代中，索伯列夫首先明确提出了广义函数的思想，后于40年代末由施瓦兹发展，他因这一工作获得1950年的菲尔兹奖。因此，下面将提到的广义函数空间$\mathcal{D} $也称为\textbf{索伯列夫-施瓦兹广义函数空间}\cite{zorich}。

\subsection{一般的分布理论}\label{sub:general_distributions}

我们已经看到，分布（例如狄拉克$\delta$）难以用经典的“函数”来描述，这时我们可以
考察它们与一系列\textbf{检验函数}(test function)$\varphi$的作用，具体来说：
\begin{definition}[分布]
记$\mathbb{R}$
上的复值光滑紧支函数集为$\mathcal{C} $，如果将检验函数集取为$\mathcal{C}$,我们
将其对偶空间$\mathcal{D} $中的元素称为分布，并规定函数$f\in \mathcal{C} $所产生的分布$T_f$
为作用在$\mathcal{C}$上的以下\textbf{泛函}：
\begin{equation*}
    \left\langle T_f,\varphi\right\rangle:=\int_{-\infty}^{\infty}f(x)\varphi(x)\,dx,\varphi\in\mathcal{C}
\end{equation*}
将这样的分布称为\textbf{正则分布}，而将无法用紧支函数描述的分布称为\textbf{奇异分布}。
\end{definition}
\begin{remark}
   实际上这里不需要要求$f\in\mathcal{C} $，只需要f在$\mathbb{R}$上局部可积（在任意闭区间上可积）即可，但为了简化讨论，我们仅考虑光滑紧支函数。 
\end{remark}
\begin{example}
    尽管我们从形式上给出了$\delta$函数的定义，但它实际上应该采用定义
\[\langle \delta,\varphi\rangle:=\delta(\varphi):=\varphi(0)\]
由于“狄拉克函数”严格来说并不能算作一种函数，$\delta$是一个奇异分布。容易验证这与我们一
开始给出的$\delta$作为“函数”的性质是相符的：
\[\langle \delta,\varphi\rangle=\int_{-\infty}^{\infty}\delta(x)\varphi(x)\,dx=\int_{-\infty}^{\infty}\delta(x)\varphi(0)\,dx=\varphi(0)\]
\end{example}

下面来定义分布与函数的乘法和分布的导数。这一部分中，我们的原则是：\textbf{奇异分布与正
    则分布具有相同的性质}，换言之，只要能够对正则分布定义的算子，就能够对奇异分布
做相同的定义。在讨论分布的傅里叶变换时，还将定义更多的算子，例如分布卷积、尺度变换等。

设$f,g,\varphi\in\mathcal{C} $,有
\begin{align*}
    \left\langle (f\cdot g),\varphi\right\rangle=\int_{-\infty}^{\infty}(f\cdot g)(x)\varphi(x)\,dx=\int_{-\infty}^{\infty}f(x)(g\cdot\varphi)(x)\,dx=\langle f,(g\cdot\varphi)\rangle
\end{align*}
因此对于任意的分布$T\in\mathcal{D} $，定义它与$g\in\mathcal{C} $的乘积$gT$
由以下等式给出：
\begin{definition}[分布与函数的乘法]
    \begin{equation*}
    \left\langle gT,\varphi\right\rangle=\langle T,g\varphi\rangle
\end{equation*}
\end{definition}
$g\varphi$就是普通的函数乘法。现在就可以说，分布集$\mathcal{D} $构成函数环
$\mathcal{C} $上的模(module)，并且可以验证$\delta$的采样性质：
\begin{align*}
     & \left\langle g\delta,\varphi\right\rangle=\langle \delta,g\varphi\rangle=g(0)\varphi(0)=g(0)\langle\delta,\varphi\rangle \Rightarrow  g\delta=g(0)\delta
\end{align*}

用同样的思路定义分布的微分：设$f,g,\varphi\in\mathcal{C} $,有
\begin{align*}
    \left\langle f',\varphi\right\rangle=\int_{-\infty}^{\infty}f'(x)\varphi(x)\,dx=-\int_{-\infty}^{\infty}f(x)\varphi'(x)\,dx=\left\langle f,\varphi'\right\rangle
\end{align*}
因此我们定义：
\begin{definition}[分布的微分]
    \begin{equation*}
    \left\langle T',\varphi\right\rangle=-\left\langle T,\varphi'\right\rangle
\end{equation*}
\end{definition}
注意$\varphi\in\mathcal{C} $是无限阶可导的，我们可以由此定义分布的任意阶导数。
\begin{example}[$\delta$的导数]
\begin{align*}
     & \left\langle u',\varphi\right\rangle=-\left\langle u,\varphi'\right\rangle=-\int_{0}^{\infty}\varphi'(x)\,dx=\varphi(0)=\left\langle\delta,\varphi\right\rangle \\
     & \left\langle \delta',\varphi\right\rangle=-\left\langle \delta,\varphi'\right\rangle=-\varphi'(0)
\end{align*}
\end{example}
$\delta$的高阶导数可以依此类推，它们已经难以用类似$\delta(x)$的“函数”描述，但
可以看到$\delta^{(n)}$作为一个泛函（分布）作用是取测试函数的$(-1)^n$倍的n阶导。

\begin{example}
结合以上两定义，可以推导出$\delta^{(n)}$与函数相乘的公式，例如，
\begin{align*}
    \left\langle g\delta',\varphi\right\rangle & =\left\langle \delta',g\varphi\right\rangle\\
    & =-\left\langle\delta,(g\varphi)'\right\rangle              \\
    & =-\left\langle\delta,g'\varphi+g\varphi'\right\rangle      \\
    & =-(g(0)\varphi'(0)+g'(0)\varphi(0))             \\
    & =\left\langle g(0)\delta'-g'(0)\delta,\varphi\right\rangle
\end{align*}
因此
\[g\delta'=g(0)\delta'-g'(0)\delta\]
\end{example}

现在指出分布的微分运算的某些性质\cite{zorich}。
\begin{theorem}[分布的微分运算的性质]
    \begin{enumerate}
        \quad
    \item 任何分布$T\in\mathcal{D} $都是无穷次可微的
    \item 微分算子$D:\mathcal{D} \to\mathcal{D} $是线性的
    \item 微分算子D满足莱布尼兹法则(Leibniz rule):
          \[\left(gT\right)'=g'T+gT'\]从而数学分析中的莱布尼兹公式在分布理论中仍成立：
          \[\left(gT\right)^{(m)}=\sum_{k=0}^{m}C_m^k T^{(k)}g^{(m-k)}\]
    \item 微分算子D是连续的（表述见证明）
\end{enumerate}
\end{theorem}
\begin{proof}
\begin{enumerate}
    \item 得自$\mathcal{C} $中函数的无限可微性：$\left\langle T^{(m)},\varphi\right\rangle=(-1)^m\left\langle T,\varphi^{(m)}\right\rangle$.
    \item 显然。
    \item 只需验证莱布尼兹法则。
          \begin{align*}
              \left\langle (gT)',\varphi\right\rangle & =-\left\langle gT,\varphi'\right\rangle=-\left\langle T,g\varphi'\right\rangle=-\left\langle T,(g\varphi)'-g'\varphi\right\rangle                                            \\
                                           & =\left\langle T',g\varphi\right\rangle+\left\langle T,g'\varphi\right\rangle=\left\langle gT',\varphi\right\rangle+\left\langle g'T,\varphi\right\rangle=\left\langle gT'+g'T,\varphi\right\rangle
          \end{align*}
    \item 设当$m\to\infty$时，$T_m\to T$，即$\forall\varphi\in\mathcal{C} ,\left\langle T_m,\varphi\right\rangle\to\left\langle T,\varphi\right\rangle$，
          则\[\left\langle T_m',\varphi\right\rangle=-\left\langle T_m,\varphi'\right\rangle\to-\left\langle T,\varphi'\right\rangle=\left\langle T',\varphi\right\rangle\]
\end{enumerate}
可以看到，分布理论中极限的概念是通过测试函数来定义的，如果分布序列$\{T_m\}_{m=1}^{\infty}$
作用在任何测试函数上都是趋于某个分布T作用于这个测试函数的值，就说序列$\{T_m\}$
\textbf{弱收敛}(converge weakly)于T，并记为$T_m\to T$\cite{folland}。
\end{proof}

\subsection{施瓦兹空间的引入}\label{sub:schwartz}
接下来讨论分布理论在傅里叶分析中的应用。我们的目标是，在这个新的理论体系下：
\begin{itemize}
    \item 允许$\delta$信号，单位阶跃信号，多项式，正弦、余弦函数等信号（作为分布）做傅里叶变换
    \item 分布的傅里叶变换和其反变换同时有定义；傅里叶反演公式成立
    \item 对于分布，帕塞瓦尔恒等式成立（之前我们只能在$L^1(\mathbb{R})\cap L^2(\mathbb{R})$中使用它）
\end{itemize}
我们将看到，分布$T$的傅里叶变换$\mathcal{F} T$定义为
\begin{equation}
    \left\langle\mathcal{F}T,\varphi\right\rangle=\left\langle T,\mathcal{F}\varphi\right\rangle
\end{equation}
然而，测试函数$\varphi\in\mathcal{C} $的傅里叶变换$\mathcal{F}\varphi$并不属于
$\mathcal{C} $
（关于这一点的说明，以及施瓦兹函数类的引出，见\ref{sub:fourier_close}），这说明测试函数集$\mathcal{C} $在傅里叶分析中的表现不够好，我们需要引入新的测试函数空间，以保证
$\mathcal{F}\varphi$仍然是测试函数。这个测试函数空间正是\textbf{施瓦兹空间}(Schwartz space)$\mathcal{S} $\cite{brad_osgood_ee261}，它是$\mathbb{R}$上所有无限可微函数的集合，这些函数及其各阶导数都以比任何负幂更快的速度趋于0，即
\begin{definition}[施瓦兹空间与施瓦兹函数]
    \[\mathcal{S} =\left\{\varphi\in C^{\infty}(\mathbb{R} )\left|\lim_{|x|\to\infty}|x|^m\varphi^{(n)}(x)=0,\forall m,n\in\mathbb{N} \right.\right\}\]
施瓦兹空间中的函数称为\textbf{施瓦兹函数}(Schwartz function)，它们是非常光滑且
衰减很快的函数，因此又称为\textbf{速降函数}(rapidly decreasing function)
\end{definition}
\begin{example}
高斯函数$e^{-x^2}$及其各阶导数都属于施瓦兹空间。
\end{example}
\begin{definition}[施瓦兹分布]
    施瓦兹空间的对偶空间$\mathcal{T} :=\mathcal{S}^*$中的元素称为\textbf{施瓦兹分布}(Schwartz distribution)
或\textbf{缓增分布}(tempered distribution)。称之为“缓增分布”，是因为一些能够用函数描述的施瓦兹分布在自变量趋于无穷时增长速度较缓，以至于它们与施瓦兹函数的乘积可积。
\end{definition}
我们仍定义
\begin{align}
    T(\varphi)                 & =\left\langle T,\varphi\right\rangle                                        \\
    \left\langle T_f,\varphi\right\rangle & =\int_{-\infty}^{\infty}f(x)\varphi(x)\,dx,\varphi\in\mathcal{S}
\end{align}
易见$\mathcal{C} \subset \mathcal{S} ,\mathcal{T} \subset\mathcal{D}. $

有了施瓦兹函数类$\mathcal{S} $和缓增分布$\mathcal{T} $，我们就可以定义分布的傅里
叶变换，还可以定义有关分布的一系列算子。前文中曾定义分布与函数的乘法和分布的导数，
现在认为正则分布是由施瓦兹函数导出的，则显然能够推广到缓增分布，即\begin{align}
    \left\langle gT,\varphi\right\rangle=\left\langle T,g\varphi\right\rangle,\left\langle T',\varphi\right\rangle=\left\langle T,\varphi'\right\rangle,g\in\mathcal{S} ,T\in\mathcal{T}
\end{align}

\subsection{分布的运算性质}\label{sub:operation_of_distribution}
用同样的方式，我们依次讨论作用于缓增分布的各种算子。

\noindent 1.\textbf{傅里叶变换}

设$f,\varphi\in\mathcal{S} ,T_f\in\mathcal{T} $，则
\begin{align*}
    \left\langle\mathcal{F}T_f,\varphi\right\rangle & =\int_{-\infty}^{\infty}\mathcal{F}f(x)\varphi(x)\,dx                                       \\
                                         & =\int_{-\infty}^{\infty}\varphi(x)\,dx\int_{-\infty}^{\infty}f(y)e^{-2\pi ixy}\,dy          \\
                                         & =\int_{-\infty}^{\infty}f(y)\,dy\int_{-\infty}^{\infty}\varphi(x)e^{-2\pi ixy}\,dx          \\
                                         & =\int_{-\infty}^{\infty}f(y)\mathcal{F}\varphi(y)\,dy=\left\langle T_f,\mathcal{F}\varphi\right\rangle
\end{align*}
因此我们定义\begin{definition}[分布的傅里叶变换]
    \begin{align*}
        \left\langle \mathcal{F} T,\varphi\right\rangle & =\left\langle T,\mathcal{F} \varphi\right\rangle,T\in\mathcal{T} ,\varphi\in\mathcal{S}
    \end{align*}
\end{definition}

傅里叶逆变换同理:
\begin{definition}[分布的傅里叶反变换]
    \begin{align*}
        \left\langle \mathcal{F} ^{-1}T,\varphi\right\rangle & =\left\langle T,\mathcal{F} ^{-1}\varphi\right\rangle,T\in\mathcal{T} ,\varphi\in\mathcal{S}
    \end{align*}
\end{definition}

只要承认函数的傅里叶反演公式，分布的傅里叶反演公式就自然成立：\begin{theorem}[分布的傅里叶反演公式]
    \[\mathcal{F} \mathcal{F} ^{-1}T=\mathcal{F} ^{-1}\mathcal{F} T=T,\forall T\in\mathcal{T}\]
\end{theorem}
\begin{proof}
    \begin{align*}
    \left\langle \mathcal{F} ^{-1}\mathcal{F} T,\varphi\right\rangle & =\left\langle \mathcal{F} T,\mathcal{F} ^{-1}\varphi\right\rangle \\
                                                          & =\left\langle T,\mathcal{F} \mathcal{F} ^{-1}\varphi\right\rangle \\
                                                          & =\left\langle T,\varphi\right\rangle                              \\
    \left\langle \mathcal{F} \mathcal{F} ^{-1}T,\varphi\right\rangle & =\left\langle T,\mathcal{F} ^{-1}\mathcal{F} \varphi\right\rangle \\
                                                          & =\left\langle T,\varphi\right\rangle
\end{align*}
\end{proof}

傅里叶变换的线性性依然成立：
\begin{theorem}[分布的傅里叶变换的线性]
    \[\mathcal{F} (aT+bS)=a\mathcal{F} T+b\mathcal{F} S,a,b\in\mathbb{C},S,T\in\mathcal{T}\]
\end{theorem}
\begin{proof}
    尽管没有明确指出，我们也会很自然的想到定义
\begin{equation}
    \left\langle aT+bS,\varphi\right\rangle=a\left\langle T,\varphi\right\rangle+b\left\langle S,\varphi\right\rangle
\end{equation}
于是\begin{align*}
    \left\langle \mathcal{F} (aT+bS),\varphi\right\rangle & =a\left\langle T,\mathcal{F} \varphi\right\rangle+b\left\langle S,\mathcal{F} \varphi\right\rangle                     \\
                                               & =a\left\langle \mathcal{F} T,\varphi\right\rangle+b\left\langle \mathcal{F} S,\varphi\right\rangle                     \\
                                               & =\left\langle a\mathcal{F} T+b\mathcal{F} S,\varphi\right\rangle
\end{align*}
因此
\[\mathcal{F} (aT+bS)=a\mathcal{F} T+b\mathcal{F} S,a,b\in\mathbb{C},S,T\in\mathcal{T}\]
\end{proof}
\begin{example}[$\delta$的傅里叶变换]
    现在可以严谨地求出$\delta$的傅里叶变换：
\begin{align*}
    \left\langle\mathcal{F}\delta,\varphi\right\rangle=\left\langle \delta,\mathcal{F}\varphi\right\rangle=\mathcal{F}\varphi(0)=\int_{-\infty}^{\infty}\varphi(x)\,dx=\left\langle \mathds{1},\varphi\right\rangle
\end{align*}
因此
\[\mathcal{F}\delta=\mathds{1}\]
\end{example}
\begin{example}[$\delta$的平移的傅里叶变换]
    $\delta$的平移$\delta_a$作为一种分布，定义为
\begin{equation}
    \delta_a(\varphi)=\left\langle \delta_a,\varphi\right\rangle=\varphi(a)
\end{equation}
它的傅里叶变换为
\lr{
\left\langle\mathcal{F}\delta_a,\varphi\right\rangle&=\left\langle \delta_a,\mathcal{F}\varphi\right\rangle\\
&=\mathcal{F}\varphi(a)\\
&=\int_{-\infty}^{\infty}\varphi(x)e^{-2\pi iax}\,dx\\
&=\left\langle e^{-2\pi iax},\varphi\right\rangle
}{
\left\langle\mathcal{F}\delta_a,\varphi\right\rangle&=\left\langle \delta_a,\mathcal{F}\varphi\right\rangle\\
&=\mathcal{F}\varphi(a)\\
&=\int_{-\infty}^{\infty}\varphi(x)e^{-i a x}\,dx\\
&=\left\langle e^{-i a x},\varphi\right\rangle
}
因此
\lr{
    \mathcal{F}\delta_a =e^{-2\pi iax}
}{
    \mathcal{F}\delta_a =e^{-i a x}
}
根据阿贝尔-狄利克雷判别法（A-D判别法，见数学分析教材如\cite{xinjiang}），$\langle e^{-i a x},\varphi\rangle$
作为一个反常积分是有意义的。可以看出这与函数的傅里叶变换的平移定理很相似，我们将在后面
给出分布的平移、伸缩，并由此得到一些分布的傅里叶变换的性质。
\end{example}

\begin{example}[分布$\mathds{1}$的傅里叶变换]
尽管$\mathds{1}\notin L^1(\mathbb{R})$，但可以
认为它是缓增分布，因为对于任意的$\varphi\in\mathcal{S} $，都有
\[\left\langle \mathds{1},\varphi\right\rangle=\int_{-\infty}^{\infty}\varphi(x)\,dx<\infty\]
因此可以求它的傅里叶变换：
\lr{
    \left\langle \mathcal{F} \mathds{1},\varphi\right\rangle&=\left\langle \mathds{1},\mathcal{F} \varphi\right\rangle\\
    &=\int_{-\infty}^{\infty}\mathcal{F} \varphi(\xi)\,d\xi\\
    &=\mathcal{F} \mathcal{F} \varphi(0)\\
    &=\varphi(0)=\left\langle \delta,\varphi\right\rangle
}{
    \left\langle \mathcal{F} \mathds{1},\varphi\right\rangle&=\left\langle \mathds{1},\mathcal{F} \varphi\right\rangle\\
    &=\int_{-\infty}^{\infty}\mathcal{F} \varphi(\xi)\,d\xi\\
    &=\mathcal{F} \mathcal{F} \varphi(0)\\
    &=2\pi\varphi(0)=2\pi\left\langle \delta,\varphi\right\rangle
}
因此\lr{
    \mathcal{F} \mathds{1}&=\delta
}{
    \mathcal{F} \mathds{1}&=2\pi\delta
}
\end{example}

\noindent 2.\textbf{分布的反转}

设$f,\varphi\in\mathcal{S} ,T_f\in\mathcal{T} $，自然可以定义$T_f^-=T_{f^-}$,
\begin{align*}
    \left\langle T_f^-,\varphi\right\rangle & =\int_{-\infty}^{\infty}f(-x)\varphi(x)\,dx \\
                                 & =\int_{-\infty}^{\infty}f(y)\varphi(-y)\,dy \\
                                 & =\left\langle T_f,\varphi^-\right\rangle
\end{align*}
因此我们定义\begin{definition}[分布的反转]
    \begin{equation*}
    \left\langle T^-,\varphi\right\rangle=\left\langle T,\varphi^-\right\rangle,T\in\mathcal{T} ,\varphi\in\mathcal{S}
\end{equation*}
\end{definition}

有了反转就可以定义分布的奇偶性：
\begin{definition}[分布的奇偶性]
    如果$T^-=T$，则称T为\textbf{偶分布}；如果$T^-=-T$，则称T为\textbf{奇分布}。
\end{definition}

从施瓦兹函数的傅里叶变换的对偶性，就能得到缓增分布的傅里叶变换的对偶性：
\begin{theorem}[分布傅里叶变换的对偶性]
    \quad
    \lr{
    \mathcal{F}(T^-)= (\mathcal{F}T)^-=\mathcal{F} ^{-1}T
    }{
    \mathcal{F}(T^-)= (\mathcal{F}T)^-=2\pi\mathcal{F} ^{-1}T
    }
\end{theorem}
和常规的函数一样，现在也可以不区分反转与傅里叶变换的先后，而统一地记作$\mathcal{F} T^-$.
\begin{proof}
    \begin{align*}
    \left\langle\mathcal{F}(T^-),\varphi\right\rangle=\left\langle T^-,\mathcal{F}\varphi\right\rangle=\left\langle T,\mathcal{F} \varphi^-\right\rangle=\left\langle\mathcal{F}T,\varphi^-\right\rangle=\left\langle(\mathcal{F}T)^-,\varphi\right\rangle \\
    \Rightarrow\mathcal{F}(T^-)= (\mathcal{F}T)^-
\end{align*}
考察反转与傅里叶逆变换的关系：
\lr{
    \left\langle\mathcal{F}T^-,\varphi\right\rangle&=\left\langle T,\mathcal{F}\varphi^-\right\rangle\\
    &=\left\langle T,\mathcal{F} ^{-1}\varphi\right\rangle\\
    &=\left\langle\mathcal{F}^{-1}T,\varphi\right\rangle
}{
    &\left\langle\mathcal{F}T^-,\varphi\right\rangle=\left\langle T,\mathcal{F}\varphi^-\right\rangle\\
    &=\left\langle T,2\pi\mathcal{F} ^{-1}\varphi\right\rangle\\
    &=\left\langle2\pi\mathcal{F}^{-1}T,\varphi\right\rangle
}
因此\lr{
    \mathcal{F}T^-= \mathcal{F}^{-1}T
}{
    \mathcal{F}T^-= 2\pi\mathcal{F}^{-1}T
}
\end{proof}
这与前文中函数的傅里叶变换对偶性完全一样。有了对偶性，就可以得到：
\begin{theorem}[帕塞瓦尔恒等式/普朗歇尔定理]
    \quad
    \lr{
    \int_{-\infty}^{\infty}|f(t)|^2\,dt=\int_{-\infty}^{\infty}|\mathcal{F} f(\xi)|^2\,d\xi
}{
    \int_{-\infty}^{\infty}|f(t)|^2\,dt=\frac{1}{2\pi}\int_{-\infty}^{\infty}|\mathcal{F} f(\omega)|^2\,d\omega
}
\end{theorem}
\begin{proof}
设$f,g\in\mathcal{S} $,\lr{
    \left\langle \mathcal{F} f,\overline{\mathcal{F} g}\right\rangle&=\left\langle \mathcal{F} f,\mathcal{F}^{-1}\overline{g}\right\rangle\\
    &=\left\langle f,\mathcal{F} \mathcal{F} ^{-1}\overline{g}\right\rangle\\
    &=\left\langle f,\overline{g}\right\rangle
}{
    \left\langle \mathcal{F} f,\overline{\mathcal{F} g}\right\rangle&=\left\langle f,2\pi\mathcal{F}^{-1}\overline{g}\right\rangle\\
    &=\left\langle f,2\pi\mathcal{F} \mathcal{F} ^{-1}\overline{g}\right\rangle\\
    &=2\pi\left\langle f,\overline{g}\right\rangle
}
取$g=f$即证。
\end{proof}
看上去，这里只是将\ref{sub:fourier_operation_properties}中的证明换了一种符号，并没有用到刚才建立的分布的傅里叶变换的对偶性，然而，现在我们可以得到正则分布的帕塞瓦尔恒等式。我们不仅扩大了证明适用的范围，还得到了比积分换序的方法简单得多的证明。

\begin{example}[$\delta$是偶分布]
    \begin{align*}
    \left\langle \delta^-,\varphi\right\rangle & =\left\langle \delta,\varphi^-\right\rangle=\varphi^-(0)=\varphi(0)=\left\langle \delta,\varphi\right\rangle \\
    \Rightarrow \delta^-            & =\delta
\end{align*}
\end{example}

\begin{example}[分布$\mathds{1}$的傅里叶逆变换]
应用对偶性求$\mathds{1}$的傅里叶逆变换：
\lr{
    \mathcal{F} \mathds{1}=\mathcal{F} ^{-1}\mathds{1}^-=\delta^-=\delta
}{
    \mathcal{F} \mathds{1}=2\pi\mathcal{F} ^{-1}\mathds{1}^- =2\pi\delta^- =2\pi\delta
}
\end{example}
\begin{example}[复指数函数$e^{iat}$的傅里叶变换]
作为函数当然不能求$e^{iat}$的傅里叶变换，我们甚至无法确定它在0处的傅里叶变换：$\int_{-\infty}^{\infty}e^{iat}\,dt$不存在。
但它可以视为一个缓增分布，前文中已经提到$\langle e^{iat},\varphi\rangle$是收敛
的。下面应用对偶性求它的傅里叶变换：
\lr{
\mathcal{F} [e^{2\pi iat}]=\mathcal{F}^{-1}[e^{2\pi iat}]^-=\delta_{a}^-=\delta_{-a}
}{
\mathcal{F} [e^{iat}]=2\pi\mathcal{F}^{-1}[e^{iat}]^- =2\pi\delta_{a}^- =2\pi\delta_{-a}
}
（请读者自行验证$\delta_{a}^-= \delta_{-a}$）
\end{example}

\begin{example}[正弦、余弦函数的傅里叶变换]
根据欧拉公式$e^{ix}=\cos(x)+i\sin(x)$，
有\[\cos(x)=\frac{e^{ix}+e^{-ix}}{2},\sin(x)=\frac{e^{ix}-e^{-ix}}{2i}\]因此
\lr{
    \mathcal{F} [\cos(2\pi ax)]&=\frac{1}{2}(\mathcal{F} [e^{2\pi iax}]+\mathcal{F} [e^{-2\pi iax}])\\
    &=\frac{1}{2}(\delta_{-a}+\delta_{a}) \\
    \mathcal{F} [\sin(2\pi ax)]&=\frac{1}{2i}(\mathcal{F} [e^{2\pi iax}]-\mathcal{F} [e^{-2\pi iax}])\\
    &=\frac{1}{2i}(\delta_{-a}-\delta_{a})
}{
    \mathcal{F} [\cos(ax)]&=\frac{1}{2}(\mathcal{F} [e^{iax}]+\mathcal{F} [e^{-iax}])\\
    &=\pi(\delta_{-a}+\delta_{a}) \\
    \mathcal{F} [\sin(ax)]&=\frac{1}{2i}(\mathcal{F} [e^{iax}]-\mathcal{F} [e^{-iax}])\\
    &=-i\pi(\delta_{-a}-\delta_{a})
}
\end{example}

\noindent 3.\textbf{分布的共轭}

设$f,\varphi\in\mathcal{S} ,T_f\in\mathcal{T} $，则
\begin{align*}
    \left\langle \overline{T_f},\varphi\right\rangle=\int_{-\infty}^{\infty}\overline{f(x)}\varphi(x)\,dx=\overline{\int_{-\infty}^{\infty}f(x)\overline{\varphi(x)}\,dx}=\overline{\left\langle T_f,\overline{\varphi}\right\rangle} \\
\end{align*}
因此我们定义\begin{definition}[分布的共轭]
    \begin{equation*}
    \left\langle \overline{T},\varphi\right\rangle=\overline{\left\langle T,\overline{\varphi}\right\rangle},T\in\mathcal{T} ,\varphi\in\mathcal{S}
\end{equation*}
\end{definition}

有了共轭就可以仿照复数定义分布的实部、虚部以及实分布、纯虚分布：
\begin{definition}[分布的实部、虚部]
    设$T\in\mathcal{T} $，则
    \[\text{Re}\ T=\frac{T+\overline{T}}{2}\]
    称为T的\textbf{实部}，
    \[\text{Im}\ T=\frac{T-\overline{T}}{2}\]
    称为T的\textbf{虚部}。
\end{definition}
\begin{definition}[实分布与纯虚分布]
如果$\overline{T}=T$，则称T为\textbf{实分布}；如果
$\overline{T}=-T$，则称T为\textbf{纯虚分布}。
\end{definition}
现在就来考察实分布的最后一条对偶性。在函数的傅里叶变换理论中，我们知道：
    \[f=\overline{f}\implies \mathcal{F}f^- =\overline{\mathcal{F} f}\]

对于分布，
\begin{align*}
    \left\langle\mathcal{F}T^-,\varphi\right\rangle =\left\langle T,\mathcal{F}\varphi^-\right\rangle
\end{align*}
但是，我们并不能保证$\varphi$是实值函数\footnote{尽管在原始定义中没有提到这一点，但和前
    面引入施瓦兹函数类一样，要保证施瓦兹函数的傅里叶变换仍然是施瓦兹函数，而实值函数的
    傅里叶变换往往是复值函数。}，因此并不能推出实分布的最后一条对偶性。不过，我们还是可
以得到分布的傅里叶变换的对称性：
\begin{theorem}[分布的傅里叶变换的对称性]
    \begin{align*}
    &T^-=T\implies\mathcal{F} T^-=\mathcal{F} T \\
    &T^-=-T\implies\mathcal{F} T^-=-\mathcal{F} T
\end{align*}
\end{theorem}
换言之，分布的傅里叶变换的奇偶性与分布本身相同。

\noindent 4.\textbf{分布的平移和伸缩}

设$f,\varphi\in\mathcal{S} ,T_f\in\mathcal{T} $，自然可以定义$\tau_b T_f=T_{\tau_b f}$，
\begin{align*}
    \left\langle \tau_b T_f,\varphi\right\rangle & =\int_{-\infty}^{\infty}f(x-b)\varphi(x)\,dx \\
                                      & =\int_{-\infty}^{\infty}f(y)\varphi(y+b)\,dy \\
                                      & =\left\langle T_f,\tau_{-b}\varphi\right\rangle
\end{align*}
因此我们定义\begin{definition}[分布的平移]
    \begin{equation*}
    \left\langle \tau_b T,\varphi\right\rangle=\left\langle T,\tau_{-b}\varphi\right\rangle,T\in\mathcal{T} ,\varphi\in\mathcal{S}
\end{equation*}
\end{definition}

设$f,\varphi\in\mathcal{S} ,T_f\in\mathcal{T} $，自然可以定义$\sigma_a T_f=T_{\sigma_a f}$，
\begin{align*}
    \left\langle \sigma_a T_f,\varphi\right\rangle & =\int_{-\infty}^{\infty}f(ax)\varphi(x)\,dx                                  \\
                                        & =\frac{1}{|a|}\int_{-\infty}^{\infty}f(y)\varphi\left(\frac{y}{a}\right)\,dy \\
                                        & =\frac{1}{|a|}\left\langle T_f,\sigma_{1/a}\varphi\right\rangle
\end{align*}
因此我们定义\begin{definition}[分布的伸缩]
    \begin{equation*}
    \left\langle\sigma_a T,\varphi\right\rangle=\left\langle T,\frac{1}{|a|}\sigma_{1/a}\varphi\right\rangle,T\in\mathcal{T} ,\varphi\in\mathcal{S}
\end{equation*}
\end{definition}

分布的伸缩与函数的伸缩有一点不同，即多了一个$\dfrac{1}{|a|}$的因子，这意味着，作为形式上的函数定义的分布$T(x)$，其伸缩$\sigma_a T(x)$并不一定等于$T(ax)$。例如：
\begin{example}
    \[\sigma_a\delta=\frac{1}{a}\delta\]
    这是因为（以下默认$a>0$，$a<0$的情况可直接从$\delta$是偶分布得出）：
\begin{align*}
    \left\langle \sigma_a\delta,\varphi\right\rangle&=\left\langle \delta,\frac{1}{a}\sigma_{1/a}\varphi\right\rangle=\frac{1}{a}\varphi(0)=\left\langle \frac{1}{a}\delta,\varphi\right\rangle
\end{align*}
根据\ref{sub:signal}中的定义，$\delta(ax)=\delta(x)/|a|$，这样就有$\sigma_a\delta=\delta(ax)$。
\end{example}
\begin{example}
    函数$mathds{1}\notin L^1(\mathbb{R})$，作为一个分布，它的伸缩为：
\begin{align*}
    \sigma_a\mathds{1}&=\frac{1}{|a|}\mathds{1}
\end{align*}
但是，直观上，常函数1不论如何伸缩，仍然是常函数1，因此不能认为$\sigma_a\mathds{1}=\mathds{1}(ax)$。
\end{example}

有了分布的平移和伸缩的定义，就可以建立分布的傅里叶变换的平移和尺度变换定理：
\begin{theorem}[分布的傅里叶变换的平移和尺度变换]
\begin{align*}
    &\mathcal{F}(\tau_b T)=\mathcal{F}(e^{2\pi ibx})T\\
    &\mathcal{F}(\sigma_a T)=\frac{1}{|a|}\mathcal{F}(\sigma_a T)
\end{align*}
\end{theorem}
\begin{proof}
    对于前者，
        \begin{align*}
    \left\langle\mathcal{F}(\tau_b T),\varphi\right\rangle =\left\langle \tau_b T,\mathcal{F}\varphi\right\rangle=\left\langle T,\tau_{-b}\mathcal{F}\varphi\right\rangle=\left\langle T,e^{2\pi ibx}\mathcal{F}\varphi\right\rangle=\left\langle \mathcal{F}(e^{2\pi ibx}T),\varphi\right\rangle
\end{align*}
即\[\mathcal{F}(\tau_b T)=\mathcal{F}(e^{2\pi ibx}T)\]
对于后者，
\begin{align*}
    \left\langle\mathcal{F}(\sigma_a T),\varphi\right\rangle =\left\langle \sigma_a T,\mathcal{F}\varphi\right\rangle=\left\langle T,\frac{1}{|a|}\sigma_{\frac{1}{a}}\mathcal{F}\varphi\right\rangle=\left\langle T,\frac{1}{|a|}\mathcal{F}\sigma_a \varphi\right\rangle=\left\langle \frac{1}{|a|}\mathcal{F}(\sigma_a T),\varphi\right\rangle
\end{align*}
即\[\mathcal{F}(\sigma_a T)=\frac{1}{|a|}\mathcal{F}(\sigma_a T)\]
\end{proof}

\noindent 5.\textbf{分布的傅里叶变换的微分性质}

我们已经得到$\langle T',\varphi\rangle=-\langle T,\varphi'\rangle$，现在结合
分布与函数的乘法，仿照函数的情形得到分布的傅里叶变换的微分性质：
\lr{
    \left\langle\mathcal{F} (T'),\varphi\right\rangle&=-\left\langle T,(\mathcal{F} \varphi)'\right\rangle\\
    &=\left\langle T,\mathcal{F} (2\pi i t\varphi)\right\rangle\\
    &=\left\langle 2\pi i\xi\mathcal{F}T,\varphi\right\rangle
}{
    \left\langle\mathcal{F} (T'),\varphi\right\rangle&=-\left\langle T,(\mathcal{F} \varphi)'\right\rangle\\
    &=\left\langle T,\mathcal{F} (i t\varphi)\right\rangle\\
    &=\left\langle i\omega\mathcal{F}T,\varphi\right\rangle
}
因此\lr{
    \mathcal{F} (T')=2\pi i\xi\mathcal{F}T
}{
    \mathcal{F} (T')=i\omega\mathcal{F}T
}
这与函数的傅里叶变换的微分性质一致，注意将$t$换成$\xi$或$\omega$，只是符号上的改
变，用以区分所讨论的场景。同样地，
\begin{lralign}
    \left\langle (\mathcal{F} T)',\varphi\right\rangle&=\left\langle T,-\mathcal{F} (\varphi')\right\rangle\\
    &=\left\langle T,-2\pi i\xi\mathcal{F} \varphi\right\rangle\\
    &=\left\langle -\mathcal{F} (2\pi i tT),\varphi\right\rangle
\switch
    \left\langle(\mathcal{F} T)',\varphi\right\rangle&=\left\langle T,-\mathcal{F} (\varphi)'\right\rangle\\
    &=\left\langle T,-i\omega\mathcal{F} \varphi\right\rangle\\
    &=\left\langle -\mathcal{F} (itT),\varphi\right\rangle
\end{lralign}
因此
\begin{lralign}
    (\mathcal{F} T)'=-\mathcal{F} (2\pi i tT)
\switch
    (\mathcal{F} T)'=-\mathcal{F} (itT)
\end{lralign}
也即
\begin{lralign}
    \mathcal{F} (tT)=\frac{i}{2\pi}(\mathcal{F} T)'
\switch
    \mathcal{F} (tT)=i(\mathcal{F} T)'
\end{lralign}

综上得到：
\begin{theorem}[分布的傅里叶变换的微分性质]
    \begin{lralign}
    &\mathcal{F} (T')=2\pi i\xi\mathcal{F}T \\
    &(\mathcal{F} T)'=-\mathcal{F} (2\pi i tT) \\
    &\mathcal{F} (tT)=\frac{i}{2\pi}(\mathcal{F} T)'
\switch
    &\mathcal{F} (T')=i\omega\mathcal{F}T \\
    &(\mathcal{F} T)'=-\mathcal{F} (itT) \\
    &\mathcal{F} (tT)=i(\mathcal{F} T)'
    \end{lralign}
    
\end{theorem}

\noindent 6.\textbf{分布的卷积}

设$f,g,\varphi\in\mathcal{S} ,T_f\in\mathcal{T} $，自然可以定义$(T_f)*g=T_{(f*g)}$，
\begin{align*}
    \left\langle T_f*g,\varphi\right\rangle & =\int_{-\infty}^{\infty}(f*g)(x)\varphi(x)\,dx                                           \\
                                 & =\int_{-\infty}^{\infty}\left(\int_{-\infty}^{\infty}f(y)g(x-y)\,dy\right)\varphi(x)\,dx \\
                                 & =\int_{-\infty}^{\infty}f(y)\,dy\int_{-\infty}^{\infty}g(x-y)\varphi(x)\,dx              \\
                                 & =\int_{-\infty}^{\infty}f(y)\,dy\int_{-\infty}^{\infty}g^- (y-x)\varphi(x)\,dx           \\
                                 & =\int_{-\infty}^{\infty}f(y)[(g^-) *\varphi](y)\,dy                                      \\
                                 & =\left\langle T_f,(g^-)*\varphi\right\rangle
\end{align*}
因此我们定义\begin{definition}[分布与函数的卷积]
    \[\left\langle T*g,\varphi\right\rangle=\left\langle T,(g^-)*\varphi\right\rangle\]
\end{definition}

从定义分布与函数的卷积的过程可以看出，应当要求卷积的交换律仍然成立；“结合律”在目前
只限于讨论$(f*g)*T$是否等于$f*(g*T)$，我们来验证这一性质：
\begin{align*}
    \left\langle (f*g)*T,\varphi\right\rangle & =\left\langle T,(f*g)^- *\varphi\right\rangle\\
    & =\left\langle T,(f^-)*(g^-)*\varphi\right\rangle\\
    & =\left\langle g*T,(f^-)*\varphi\right\rangle\\
    & =\left\langle f*(g*T),\varphi\right\rangle
\end{align*}
即\[(f*g)*T=f*(g*T),f,g\in\mathcal{S} ,T\in\mathcal{T}\]
而线性性则和前面傅里叶变换的线性性没有多少区别：\\
\ding{172}对函数的线性性
\begin{align*}
    \left\langle (af+bg)*T,\varphi\right\rangle & =\left\langle T,[(af+bg)^-]*\varphi\right\rangle                                               \\
                                     & =a\left\langle T,(f^-)*\varphi\right\rangle+b\left\langle T,(g^-)*\varphi\right\rangle                    \\
                                     & =a\left\langle f*T,\varphi\right\rangle+b\left\langle g*T,\varphi\right\rangle                            \\
                                     & =\left\langle af*T+bg*T,\varphi\right\rangle
\end{align*}
即\[(af+bg)*T=af*T+bg*T,a,b\in\mathbb{C},f,g\in\mathcal{S} ,T\in\mathcal{T} \]
{\parskip=0pt \ding{173} 对分布的线性性}
\begin{align*}
    \left\langle f*(aS+bT),\varphi\right\rangle & =\left\langle aS+bT,(f^-)*\varphi\right\rangle                                                 \\
                                     & =a\left\langle S,(f^-)*\varphi\right\rangle+b\left\langle T,(f^-)*\varphi\right\rangle                    \\
                                     & =a\left\langle f*S,\varphi\right\rangle+b\left\langle f*T,\varphi\right\rangle                            \\
                                     & =\left\langle af*S+bf*T,\varphi\right\rangle
\end{align*}
即\[f*(aS+bT)=af*S+bf*T,a,b\in\mathbb{C},f\in\mathcal{S} ,S,T\in\mathcal{T}\]

下面研究卷积定理是否仍成立：\\\ding{172}时域卷积
\lr{
    \left\langle \mathcal{F} (g*T),\varphi\right\rangle&=\left\langle T,(g^-)*\mathcal{F} \varphi\right\rangle\\
    &=\left\langle T,(\mathcal{F} \mathcal{F} g)*\mathcal{F} \varphi\right\rangle\\
    &=\left\langle T,\mathcal{F} [(\mathcal{F} g) \varphi]\right\rangle\\
    &=\left\langle \mathcal{F} T,(\mathcal{F} g)\varphi\right\rangle\\
    &=\left\langle \mathcal{F} g\mathcal{F} T,\varphi\right\rangle
}{
    \left\langle \mathcal{F} (g*T),\varphi\right\rangle&=\left\langle T,(g^-)*\mathcal{F} \varphi\right\rangle\\
    &=\left\langle T,\frac{1}{2\pi}(\mathcal{F} \mathcal{F} g)*\mathcal{F} \varphi\right\rangle\\
    &=\left\langle T,\mathcal{F} [(\mathcal{F} g) \varphi]\right\rangle\\
    &=\left\langle \mathcal{F} T,(\mathcal{F} g)\varphi\right\rangle\\
    &=\left\langle \mathcal{F} g\mathcal{F} T,\varphi\right\rangle
}
因此\lr{
    \mathcal{F} (g*T)=\mathcal{F} g\mathcal{F} T
}{
    \mathcal{F} (g*T)=\mathcal{F} g\mathcal{F} T
}
\ding{173}频域卷积
\lr{
    \left\langle \mathcal{F} (gT),\varphi\right\rangle&=\left\langle T,g\mathcal{F} \varphi\right\rangle\\
    &=\left\langle T,\mathcal{F} \mathcal{F} (g^-) \mathcal{F} \varphi\right\rangle\\
    &=\left\langle T,\mathcal{F} [\mathcal{F} g^- *\varphi]\right\rangle\\
    &=\left\langle\mathcal{F} T*\mathcal{F} g,\varphi\right\rangle
}{
    \left\langle\mathcal{F} (gT),\varphi\right\rangle&=\left\langle T,g\mathcal{F} \varphi\right\rangle\\
    &=\left\langle T,\frac{1}{2\pi}\mathcal{F} \mathcal{F} (g^-) \mathcal{F} \varphi\right\rangle\\
    &=\left\langle T,\frac{1}{2\pi}\mathcal{F} [\mathcal{F} g^- *\varphi]\right\rangle\\
    &=\frac{1}{2\pi}\left\langle\mathcal{F} T*\mathcal{F} g,\varphi\right\rangle
}
因此\lr{
    \mathcal{F} (gT)=\mathcal{F} g*\mathcal{F} T
}{
    \mathcal{F} (gT)=\frac{1}{2\pi}\mathcal{F} g*\mathcal{F} T
}
综上我们得到：\begin{theorem}[分布与函数的卷积定理]
    \quad
    \lr{
    &\mathcal{F} (g*T)=\mathcal{F} g\mathcal{F} T \\
    &\mathcal{F} (gT)=\mathcal{F} g*\mathcal{F} T
}{
    &\mathcal{F} (g*T)=\mathcal{F} g\mathcal{F} T \\
    &\mathcal{F} (gT)=\frac{1}{2\pi}\mathcal{F} g*\mathcal{F} T
}
\end{theorem}
这与函数之间卷积的情况是完全一样的。

实际上，我们同样可以定义分布与分布的卷积，只是这时事情会麻烦的多。首先还是研究正则
分布的卷积，如果想将前文中定义分布与函数卷积时的g也换成分布，则需要另一种方式来处理
这个积分。设$f,g,\varphi\in\mathcal{S} ,S_f,T_g\in\mathcal{T} $，根据前面已经
得到的结果，
\begin{align*}
    \left\langle S_f *T_g,\varphi\right\rangle & =\int_{-\infty}^{\infty}\int_{-\infty}^{\infty}f(y)g(x-y)\varphi(x)\,dx\,dy           \\
                                    & =\int_{-\infty}^{\infty}\int_{-\infty}^{\infty}f(y)g(u)\varphi(u+y)\,du\,dy & (x-y=u) \\
                                    & =\int_{-\infty}^{\infty}f(y)\,dy\int_{-\infty}^{\infty}g(u)\varphi(u+y)\,du           \\
                                    & =\left\langle f(y),\langle g(u),\varphi(u+y)\rangle\right\rangle
\end{align*}
如果允许给分布标上自变量（对于能用函数表示的分布，即便不属于$\mathcal{S} $，这样做
也的确是有意义的），那么我们可以定义\cite{brad_osgood_ee261}：
\begin{definition}[分布与分布的卷积]
    \begin{equation*}
    \left\langle S*T,\varphi\right\rangle=\left\langle S(y),\left\langle T(x),\varphi(x+y)\right\rangle\right\rangle,S,T\in\mathcal{T} ,\varphi\in\mathcal{S} ,\left\langle T(x),\varphi(x+y)\right\rangle\in\mathcal{S}
\end{equation*}
\end{definition}

注意我们必须要求$\left\langle T(x),\varphi(x+y)\right\rangle\in\mathcal{S}$，如果不满足这
个条件，我们就只好说$S*T$无定义。对于分布之间的卷积，交换律和结合律就不总是成立了，
交换律在$\left\langle S,\varphi\right\rangle\in\mathcal{S} ,\left\langle T,\varphi\right\rangle\notin\mathcal{S}$
时被破坏，对于结合律，从形式上可以两次套用分布与分布卷积的定义，得到
\begin{equation*}
    \left\langle R*(S*T),\varphi\right\rangle=\left\langle T(x),\left\langle S(y),\left\langle R(z),\varphi(x+y+z)\right\rangle\right\rangle\right\rangle=\left\langle (R*S)*T,\varphi\right\rangle
\end{equation*}
然而当证明过程中任何一步遇到卷积无定义的情况，这个证明就会失效。
\begin{example}[结合律的失效]
\begin{align*}
    \left\langle\mathds{1}*\delta',\varphi\right\rangle& =\left\langle \mathds{1}(y),\left\langle \delta'(x),\varphi(x+y)\right\rangle\right\rangle\\
    &=\left\langle \mathds{1},-\varphi'\right\rangle\\
    &=-\int_{-\infty}^{\infty}\varphi'(y)\,dy\\
    &=-\evalat{\varphi(y)}{-\infty}{\infty}=0\\
    \left\langle \delta'*u,\varphi\right\rangle&=\left\langle \delta'(y),\left\langle u(x),\varphi(x+y)\right\rangle\right\rangle\\
    &=\left\langle \delta'(y),\int_{y}^{\infty}\varphi(x)\,dx\right\rangle\\
    &=\varphi(0)=\left\langle \delta,\varphi\right\rangle\\
    \left\langle\mathds{1}*(\delta'*u),\varphi\right\rangle&=\left\langle \mathds{1}(y),\left\langle \delta(x),\varphi(x+y)\right\rangle\right\rangle\\
    &=\left\langle \mathds{1},\varphi\right\rangle\\
    &=\int_{-\infty}^{\infty}\varphi(y)\,dy\\
    & =\left\langle \mathds{1},\varphi\right\rangle 
\end{align*}
以上我们得到了：\begin{align*}
    &(\mathds{1}*\delta')*u=0\\
    &\delta'*u=\delta\\
    &\mathds{1}*(\delta'*u)=\mathds{1}*\delta=\mathds{1}
\end{align*}
可见\begin{equation*}
    (\mathds{1}*\delta')*u                       \neq\mathds{1}*(\delta'*u)
\end{equation*}
\end{example}

\begin{example}[与$\delta$卷积]
    分布$T*\delta$必然有定义，并且$T*\delta=T$.
\begin{align*}
    \left\langle T*\delta,\varphi\right\rangle & =\left\langle T(y),\left\langle \delta(x),\varphi(x+y)\right\rangle\right\rangle \\
                                    & =\left\langle T,\varphi\right\rangle
\end{align*}
\end{example}

\begin{example}[$\delta_a$的平移作用]
    分布$\delta_a*\varphi$必然有定义，并且$\delta_a*\varphi=\tau_a \varphi$.
    \begin{align*}
    \left\langle \delta_a*\delta_b,\varphi\right\rangle & =\left\langle \delta_a(y),\left\langle\delta_b(x),\varphi(x+y)\right\rangle\right\rangle \\
                                             & =\left\langle \delta_a(y),\varphi(b+y)\right\rangle                    \\
                                             & =\varphi(a+b)                                               \\
                                             & =\left\langle\delta_{(a+b)},\varphi\right\rangle
\end{align*}
因此\[\delta_a*\delta_b=\delta_{(a+b)}\]
这与函数的情况是一致的：\begin{align*}
    \left\langle f*\delta_a,\varphi\right\rangle & =\left\langle \delta_a,(f^-)*\varphi\right\rangle                  \\
                                      & =(f^-)*\varphi(a)                                       \\
                                      & =\int_{-\infty}^{\infty}f(-x)\varphi(a-x)\,dx & (a-x=y) \\
                                      & =\int_{-\infty}^{\infty}f(y-a)\varphi(y)\,dy            \\
                                      & =\left\langle \tau_a f,\varphi\right\rangle
\end{align*}
因此\[f*\delta_a=\tau_a f\]
\end{example}
在\ref{sub:fourier_of_signal}中，我们已经从形式上得到了$sgn,u,1/t$，的傅里叶变换，现在有了分布的工具，就可以借助分布的傅里叶变换的对偶性说明之前的结论是严谨的。

最后，我们指出，分布的傅里叶变换具有连续性，即：
\begin{theorem}[分布的傅里叶变换的连续性]
    设$\{T_n\}\subset\mathcal{T} $，$T\in\mathcal{T} $，如果$T_n\to T$，则$\mathcal{F} T_n\to\mathcal{F} T$.
\end{theorem}
\begin{proof}
    设$\varphi\in\mathcal{S} $，则
    \begin{align*}
    \left\langle\mathcal{F} T_n-\mathcal{F} T,\varphi\right\rangle & =\left\langle T_n-T,\mathcal{F} \varphi\right\rangle \\
    \lim_{n\to\infty}\left\langle\mathcal{F} T_n-\mathcal{F} T,\varphi\right\rangle & =\lim_{n\to\infty}\left\langle T_n-T,\mathcal{F} \varphi\right\rangle=0
\end{align*}
\end{proof}

然而，要证明施瓦兹函数的傅里叶变换的连续性，要困难得多，我们将在\ref{sub:fourier_continuous}中给出其证明。

\chapter{连续系统的时频分析}

\section{系统概述}\label{sec:System}

\subsection{系统的基本概念}\label{sub:concepts_of_system}
对于单输入单输出系统，将输入信号称为激励 (excitation)，输出信号称为响应 (response)，并将时域信号分别用$e(t),r(t)$表示，如果系统用字母H表示，可以记$r(t)=H[e(t)]$，或更简洁地，$r(t)=He(t)$.H是函数空间上的映射。下面先引入几个基本的定义\cite{brad_osgood_ee261}\cite{signal_systems}。
\begin{definition}[线性系统]
    如果算子H是线性的，即
\[\forall a,b\in\mathbb{C},\forall e_1(t),e_2(t),H[ae_1(t)+be_2(t)]=aH[e_1(t)]+bH[e_2(t)]\]
就说系统是\textbf{线性系统}(linear system)，且满足叠加法则 (principle of superposition)。
\end{definition}
\begin{definition}[零输入响应与零状态响应]
    由于系统原有的能量，初始状态可能不为零，这时即便激励$e(t)=0$，响应$r(t)$也可能不为零。根据系统的线性性，可以将r(t)分解为两部分：\textbf{零输入响应}(zero input response,$r_{zi}(t)$)和\textbf{零状态响应}(zero state response,$r_{zs}(t)$)，零输入响应是指$e(t)=0$，由初始状态产生的响应，零状态响应则是将初始状态置零时的响应。\textbf{全响应}$r(t)=r_{zi}(t)+r_{zs}(t)$。
\end{definition}
对于零输入响应不为0的线性系统，直接将两个响应相加将得到两倍的零输入响应，这不是我们希望看到的，因此我们其实应该定义零状态响应有线性性的系统为线性系统。
\begin{definition}[单位脉冲响应与单位阶跃响应]
    当$e(t)=\delta(t)$时，$r_{zs}(t)$为\textbf{单位脉冲响应}，在不涉及零输入
响应时就说r(t)为单位脉冲响应。当$e(t)=u(t)$时，响应r(t)称为\textbf{单位阶跃响应}。习惯上，将单位脉冲响应记为h(t)，单位阶跃响应记为g(t)。需要指出，对于线性系统，脉冲响应应该定义为双变量函数$h(x,y)=H[\delta(x-y)]$，见后文的讨论。
\end{definition}

除了线性性，系统还有一些其他的特性，下面一一进行说明。
\begin{definition}[时不变性和移不变性]
    如果一个系统的输出不依赖于输入信号施加于系统的时间，输入信号发生时移，输出信号也发生相同的时移，即$\forall b\in\mathbb{R},H[e(t-b)]=r(t-b)$,则称该系统是\textbf{时不变系统}
用第二章中定义的时移算子的符号，时不变性可以记为$H\tau_b=\tau_b H$，换言之，时移和经过系统可交换，这与我们的直观相符。

如果激励和响应的自变量是空间，我们同样可以定义系统的\textbf{移不变性}(shift invariance)，这时$H\tau_b=\tau_b H$中b是空间中的向量。后面的讨论中，不特意区分时域和空间域。
\end{definition}
\begin{definition}[线性时不变系统]
    如果一个系统既是线性的又是时不变的，就说它是\textbf{线性时不变系统}(linear time-invariant system,LTI)。
\end{definition}
线性时不变系统满足$r(t)=(h*e)(t)$，h为单位脉冲响应，将在本小节的后文介绍。在考虑系统的初始状态时，只要零状态响应具有线性和时不变性，就说系统是线性时不变系统。

\begin{definition}[因果性]
一个系统在有激励时，才会出现响应，或者说
$r(t_0)$仅依赖于e(t)在$t<t_0$时的值（这里不等号不取等是标准的定义方式，我们马上会看到它的作用），即
\begin{equation}
    \forall t_0,\left(e_1(t)=e_2(t)\ for\ t<t_0\right)\implies \left(r_1(t)=r_2(t)\ for\ t<t_0\right)\label{eq:4.1}
\end{equation}
这个条件称为\textbf{因果性条件}(casuality condition)。
\end{definition}
对于线性系统，容易看出其因果性条件等价于
\begin{equation}
    \forall t_0,\left(e(t)=0\ for\ t<t_0\right)\implies \left(r(t)=0\ for\ t<t_0\right)\label{eq:4.2}
\end{equation}
如果系统还有时不变性，则因果性条件等价于
\begin{equation}
    \left(e(t)=0\ for\ t<0\right)\implies \left(r(t)=0\ for\ t<0\right)\label{eq:4.3}
\end{equation}
或者更简便的
\begin{equation}
    h(t)=0\ for\ t<0\label{eq:4.4}
\end{equation}
其中h为单位脉冲响应。只要取$t_0=0$，就从条件\ref{eq:4.2}推出条件\ref{eq:4.3}；用时不变性，条件\ref{eq:4.3}可以推出条件\ref{eq:4.2}。对于单位脉冲响应，从$\delta=0\ for\ t<0$可以推出$h(t)=0\ for\ t<0$；如果$h(t)=0,e(t)=0\ for\ t<0$,则根据\ref{sub:intuition_of_convolution}中介绍的卷积的“支集相加”性质，有$r(t)=(h*e)(t)=0\ for\ t<0$.

\begin{definition}[稳定性]
如果一个系统在激励信号有界时，响应也是有界的，则称之为\textbf{稳定系统}(bounded-input bounded-output,BIBO)。
\end{definition}
工程上，一个实用系统在所有可能条件下都保持稳定时至关重要的。我们将在\ref{sub:stability_of_system}中给出线性时不变系统具有稳定性的充分必要条件。

\begin{definition}[记忆性]
如果一个系统在$t_0$时刻的响应不仅与该时刻的输入有关，还与其他时刻的输入有关，则称之为\textbf{记忆系统/动态系统}，与之相对的是\textbf{即时系统}，在$t_0$时刻的响应仅与$t_0$时刻的激励有关，这使得我们可以直接用函数$r(t)=f(e(t))$对系统进行建模。
\end{definition}

\begin{definition}[可逆性]
    如果H（作为映射）如果是单射，则也是双射（因为我们不关注其值域），于是H是可逆的。换句话说，一种响应仅可能对应唯一的激励。
\end{definition}

\subsection{常见线性系统}\label{{sub:ordinary_system}}

\begin{example}[时域乘积]
\begin{equation*}
    r(t)=f(t)e(t)
\end{equation*}
例如描述开关开闭的系统，$f(t)=\chi_{[-T/2,T/2]}(t)$或$u(t)$，描述采样的系统，$f(t)=\shah(t)$.
\end{example}

\begin{example}[矩阵乘法]
对于n维的离散激励信号$\mathbf{v}$，\begin{equation}
    \mathbf{w}=A\mathbf{v},A\in M_{n\times n}(\mathbb{C})
\end{equation}
例如，线性动力系统中，初值问题$\mathbf{\dot{x}}(t)=A\mathbf{x}(t)$的解为$H[\mathbf{v}]=e^{At}\mathbf{v}$。
\end{example}
线性代数中，如果一个线性算子L的在某一组基下的矩阵表示是A，则将L的转置定义为用$A^T$表示的线性算子，其中T表示矩阵的转置，如果矩阵A是对称的，则算子L称为对称算子；L的共轭转置定义为用$A^H$表示的线性算子，其中H表示矩阵的共轭转置，如果A是埃尔米特的(Hermitian)，即$A^H=A$，则称算子L是埃尔米特的，并说L是\textbf{自伴算子}
(self-adjoint operator).对于矩阵乘法系统，可以根据A的性质定义
\textbf{对称系统、自伴系统}。

\begin{example}[积分]
\begin{equation*}
    r(t)=\int_{a}^{b}k(x,y)e(y)\,dy
\end{equation*}
其中，$k(x,y)$称为核函数(kernel)，$\int_{a}^{b}k(x,y)e(y)\,dy$称为对核积分(integrating against a kernel).
\end{example}
对核积分非常类似于连续版本的矩阵乘积，我们同样可以定义：\begin{itemize}
    \item 上述系统的转置系统描述为$e(t)\mapsto\int_{a}^{b}k(y,x)e(y)\,dy$
    \item 如果$k(x,y)=k(y,x)$，称k是对称的并将系统称为\textbf{对称系统}
    \item 如果$k(x,y)=\overline{k(y,x)}$，称k是埃尔米特的并将系统称为\textbf{自伴系统}。
\end{itemize}

\begin{example}[卷积]
    取定连续信号$g,r(t)=g*e(t)$;取定周期离散信号$\mathbf{h},r[n]=\mathbf{h*e}[n]$.
\end{example}
在标准正交基底下，卷积系统的矩阵是一个循环矩阵(circulant matrix)或托普利兹矩阵(Toepliz matrix)：\[\begin{pmatrix}
    h[0] & h[N-1] & \cdots & h[1]\\
    h[1] & h[0] & \cdots &  h[2]\\
    \vdots & \vdots & \ddots & \vdots\\
    h[N-1] & h[N-2] & \cdots & h[0]
\end{pmatrix}\]

\begin{example}[信号平移]
    取定时延b，$r(t)=e(t-b)$;取定整数m，$r[n]=e[n-m]$.
\end{example}

\begin{example}[傅里叶变换]
$r(t)=\mathcal{F} e(t)$.

在一些光学仪器中可以实现空间上的傅里叶变换，这时变量t是多维的空间变量，例如矩孔夫琅禾费衍射装置。作为径向对称函数的傅里叶变换的特例，零阶汉克尔变换可以用圆孔夫琅禾费衍射装置实现。对于这两个变换，见\ref{sub:hankel}和\ref{sub:hilbert}.
\end{example}

\subsection{系统的级联}\label{sub:cascade}
我们知道，函数与$\delta$的卷积还是它本身，这就好比信号在进入任何一个系统前，先经过了一个与$\delta$卷积的系统。这样的系统连接方式称为系统的\textbf{级联}(cascade)，下面就来研究这个话题。
\begin{theorem}[线性系统的级联]
    设有两线性系统K,L,将两系统级联之后，所得的新系统仍是线性系统：\begin{align*}
    LK[ae_1+be_2]=L[aK[e_1]+bK[e_2]]=aLK[e_1]+bLK[e_2]
\end{align*}
\end{theorem}
对于周期离散信号，两个系统都是矩阵乘法，则级联系统也可以用矩阵乘法来描述，并且其矩阵是两子系统的矩阵之乘积，这正是定义矩阵乘法的原因之一；对于连续信号，如果两个系统都是对核积分系统，我们也有类似的结论：
\begin{theorem}[对核积分系统的级联]
    设有两对核积分系统K，L：
    \[K[e(t)](x)=\int_{a}^{b}k(x,y)e(y)\,dy,L[e(t)](x)=\int_{a}^{b}l(x,y)e(y)\,dy\]
则级联系统$H=LK$也是对核积分系统，并且核函数为\begin{equation*}
    h(x,z)=L_y(k(y,z))(x)=\int_{a}^{b}l(x,y)k(y,z)\,dy
\end{equation*}
\end{theorem}
这里$L_y$表示$k(x,y)$作为y的函数输入系统L，输出为x,y的双变量函数。
\begin{proof}\begin{align*}
    H[e(z)](x)&=LK[e(z)](x)\\
    &=\int_{a}^{b}l(x,y)\left(\int_{a}^{b}k(y,z)e(z)\,dz\right)\,dy\\
    &=\int_{a}^{b}e(z)\,dz\int_{a}^{b}l(x,y)k(y,z)\,dy\\
    &=\int_{a}^{b}h(x,z)e(z)\,dz
\end{align*}
可以看到，只要我们使用的函数满足富比尼定理(Fubini's thoerem)\cite{xinjiang}的条件，就可以交换积分次序，并得到前文中断言的证明。
\end{proof}

如果系统H是对核的无穷限积分，就有\textbf{叠加定理}(superposition thoerem)\cite{brad_osgood_ee261}，由于它是泛函分析中对应定理的特殊形式，有时也将它称为\textbf{施瓦兹核定理}(Schwartz kernel thoerem):
\begin{theorem}[叠加定理/施瓦兹核定理]
    \begin{equation*}
    r(x)=\int_{-\infty}^{\infty}h(x,y)e(y)\,dy
\end{equation*}
其中$h(x,y)$是线性系统H的脉冲响应。
\end{theorem}
\begin{proof}\begin{align*}
    H[e(y)]&=H[e*\delta(y)]\\
    &=H\left[\int_{-\infty}^{\infty}\delta(x-y)e(y)\,dy\right]\\
    &=\int_{-\infty}^{\infty}H[\delta(x-y)]e(y)\,dy\\
    &=\int_{-\infty}^{\infty}h(x,y)e(y)\,dy
\end{align*}
\end{proof}
反过来，如果一个系统是激励信号与脉冲响应的含参积分，那么这个系统也是线性的，这得自积分的线性性。至此我们有了充分的动机去定义：
\begin{definition}[线性系统的脉冲响应]
    线性系统H的\textbf{脉冲响应}定义为$h(x,y)=H_x[\delta(x-y)]$，其中$H_x$表示$\delta(x-y)$作为x的函数输入系统，输出为x,y的双变量函数。
\end{definition}
\begin{proposition}[线性系统的等价定义]
    “一个系统是线性系统”等价于“响应是激励对脉冲响应积分”。
\end{proposition}

对于时不变系统，这个定理具有更加优美的形式。将系统视为线性系统，其脉冲响应为
\[h(x,y)=H_x[\delta(x-y)]=H[\tau_y\delta(x)]=\tau_y H[\delta(x)]\]
按照单变量的脉冲响应的定义，这就是$\tau_y h(x)=h(x-y)$，它只依赖于x、y的差值，带入叠加定理：\begin{align*}
    r(x)&=\int_{-\infty}^{\infty}h(x-y)e(y)\,dy\\
    &=(h*e)(t)
\end{align*}
也就是说，信号经过线性时不变系统相当于与这个系统的单位脉冲响应做卷积。下面来验证，如果一个系统是激励信号与脉冲响应的卷积，那么这个系统也是线性时不变系统。线性性是显然的，我们来验证$H\tau_b=\tau_b H$:\begin{align*}
    H[\tau_b e(y)](x)=(h*\tau_b e)(x)=\tau_b(h*e)(x)=\tau_b H[e(y)]
\end{align*}
总之，我们有：
\begin{proposition}[线性时不变系统的等价定义]
    “一个系统是线性时不变系统”等价于“响应是激励与脉冲响应的卷积”。
\end{proposition}

\begin{example}[单位阶跃响应]
求线性时不变系统的单位阶跃响应$g(t)$：\begin{align*}
    g(t)&=H[u(t)]=(u*h)(t)\\
    &=\int_{-\infty}^{\infty}u(t-y)h(y)\,dy\\
    &=\int_{-\infty}^{t}h(y)\,dy
\end{align*}
可以看到，单位阶跃响应就是单位脉冲响应的积分，利用这个性质，可以快速地求出单位阶跃响应，在使用卷积来描述线性时不变系统时，这个性质很容易得到，但在一些其他的线性时不变系统中很难想到具有这样的性质，例如下一节将讨论的系统。
\end{example}

\section{常系数线性微分方程}\label{sec:ODE}

除了上一节中提到的几种系统，还有一种典型的具有因果性的线性时不变系统是用常系数线性微分方程表示的，在学习数学分析时我们曾遇到过这种微分方程，下面先回忆在数学分析中对于这种方程的处理方法\cite{xinjiang}\cite{ode}

\subsection{解法回顾}\label{sub:solution_of_ODE}
\begin{definition}[常系数线性微分方程]
    一个形如
\[a_n y^{(n)}+a_{n-1}y^{(n-1)}+\cdots +a_1 y'+a_0 y=f\]
称为\textbf{n阶常系数线性微分方程}，等式左侧的y和f都是t的函数，特别地，如果
$f(t)=0$，称之为\textbf{n阶常系数线性齐次微分方程}。
\end{definition}
不难看出，如果找到了n阶常系数线性齐次微分方程的两个解$y_1,y_2$，则$ay_1+by_2$也是方程的解；另外，如果带
入$y=e^{\lambda t}$并消去这一项，则微分方程化为其\textbf{特征方程}：
\begin{definition}[特征方程]
    \[a_n\lambda^n+a_{n-1}\lambda^{n-1}+\cdots+a_1\lambda+a_0=0\]
\end{definition}

根据代数基本定理，$\lambda$在复数域$\mathbb{C}$中有n个解（称之为\textbf{特征根}）
，即微分方程一定有n个形如$e^{\lambda t}$的解。因此，对于常系数线性微分方程，我
们的标准处理方法是：
\begin{enumerate}
    \item 先令$f(t)=0$，得到其对应的\textbf{齐次方程}，解其方程的特征方程得到n个\textbf{齐次解}(homogeneous solution)，记为$y_h(t)$；
    \item 找到一个\textbf{特解}(particular solution)使得它恰好满足原方程，记为$y_p(t)$；
    \item 将齐次解的线性组合与特解相加，得到\textbf{完全解}：$y(t)=y_h(t)+y_p(t)$。
\end{enumerate}
对于特解，需要一定的配凑技巧，特别地，如果f为一个t的多项式与某个齐次解的乘积，则
需要带入固定形式的特解求解其中的参数（以下默认P、Q为多项式）：\begin{itemize}
    \item 如果$f(t)=c$，c为常数，则特解$y_p(t)$也为常数；
    \item 如果$f(t)=e^{\beta t}$，$\beta$不是特征根，则特解$y_p(t)=ce^{\beta t}$，c为常数；
    \item 如果$f(t)$为关于t的n次多项式，则特解$y_p(t)$也为t的n次多项式；
    \item 如果$f(t)=P(t)e^{\lambda t}$，$\lambda$为k重特征根，则特解$y_p(t)=t^k Q(t)e^{\lambda t}$，其中Q是与P次数相同的多项式，即$deg Q=degP$；
    \item 如果$f(t)=(P_1(t)\cos(\omega t)+P_2(t)\sin(\omega t))e^{\lambda t}$，$\lambda\pm i\omega$是k重特征根，则特解$y_p(t)=t^k(Q_1(t)\cos(\omega t)+Q_2(t)\sin(\omega t))e^{\lambda t}$，其中$degQ_1=degQ_2=max\{degP_1,degP_2\}$
\end{itemize}
如果确定了一组初始条件$y(t_0),y'(t_0),\cdots,y^{(n-1)}(t_0)$，则微分方程有唯一的解，因为完全解中的特解部分是确定的，而齐次解部分的n个解对应着n个系数，只要给定n个初始条件，就相当于给出了n个方程，可以解出所有的系数。
\begin{example}
    求解微分方程\[y''-3y'+2y=2e^{-x}\cos x+e^{2x}(4x+5)\]
解：特征方程为$\lambda^2-3\lambda+2=0$，有两个特征根$\lambda_1=1,\lambda_2=2$，
齐次解为$y_h(t)=C_1e^{\lambda_1 t}+C_2e^{\lambda_2 t}$。根据解的线性性，可以将方程拆分为：\begin{align*}
    y''-3y'+2y=2e^{-x}\cos x\\
    y''-3y'+2y=e^{2x}(4x+5)
\end{align*}
对于前一个方程，$-1+i$不是特征根，设方程特解为$y_1(t)=e^{-x}(A\cos x+B\sin x)$，带入原方程可得$A=\frac{1}{5},B=-\frac{1}{5}$，即$y_1(t)=\frac{1}{5}e^{-x}(\cos x-\sin x)$。\\
对后一个方程，2是一重特征根，设方程特解为$y_2(t)=e^{2x}x(ax+b)$，带入原方程可得$a=2,b=1$，即$y_2(t)=e^{2x}x(2x+1)$。\\
将齐次解与特解相加，得到完全解：\begin{align*}y(t)&=C_1e^{\lambda_1 t}+C_2e^{\lambda_2 t}+\frac{1}{5}e^{-x}(\cos x-\sin x)+e^{2x}x(2x+1)\\
    &=C_1 e^{x}+\frac{1}{5}e^{-x}(\cos x-\sin x)+e^{2x}(2x^2+x+C_2)
\end{align*}
\end{example}

\subsection{信号与系统中的一些术语}\label{sub:term_in_ODE}
\begin{definition}[自由响应与强迫相应]
    一个用常系数线性微分方程描述的系统，就是指激励为$e(t)=f(t)$，响应为微分方程的完
全解$y(t)$的系统，齐次解$y_h(t)$相当于在激励为0时系统的响应。其中，齐次解又称为\textbf{自由响应}(natural response)，它不依赖于激励的形式，而特解又称为\textbf{强迫响应}(forced response)。
\end{definition}
注意区分它们与\ref{sub:concepts_of_system}中介绍的零状态响应、零输入响应，后者对于更一般的线性系统都有定义，对于用微分方程描述的系统，齐次解和特解、零输入响应和零状态响应也是不同的分类方式。

\begin{example}[两种响应划分方式的区别]
    由微分方程及初始条件
\[y'+2y=10,y(0)=1\]
描述的系统，采用数学的解法，可以求出其特征方程$\lambda+2=0$的解$\lambda=-2$，从而有齐次解$y_h(t)=Ce^{-2t}$，C为常数，特解$y_p(t)=5$，完全解$y(t)=y_h(t)+y_p(t)=5+Ce^{-2t}$，带入$y(0)=1$得$5+C=1,C=-4$，因此最终的解为\[y(t)=5-4e^{-2t}\]
采用系统响应分解，求零输入响应时，应求齐次方程满足初始条件得解，即令$y_h(0)=C=1$，得到$C=1,y_{z.i.}(t)=e^{-2t}$；而求零状态响应时，则应该求原方程在初始条件为0向量情况下的解，即在前面得到的完全解中令$y(0)=5+C=0$,得到$C=-5$，$y_{zs}(t)=5-5e^{-2t}$，将零输入响应、零状态响应相加，又得到了原来的解$y(t)=5-4e^{-2t}$。

可见，$y_h(t)\neq y_{zi}(t),y_p(t)\neq y_{zs}(t)$。
\end{example}
尽管从数学上我们先得到了齐次解和特解才进一步求出零输入响应、零状态响应，但解的这两种划分都是有意义的，后者揭示了：响应中有一部分齐次解用来使响应满足初始条件，而另一部分齐次解会与特解叠加得到无关初始条件、仅依赖于方程形式的解。

由于我们对输入激励建模时，常常认为激励是瞬间施加到系统上的，并且经常认为激励施加的时间就是0时刻，我们需要区分0的左、右邻域内的系统状态，为此定义\cite{signal_systems}：
\begin{definition}[起始状态和初始状态]
    将激励接入之前的瞬间系统的状态称为\textbf{$0_-$状态}或\textbf{起始状态}，记为
\[y^{(k)}(0-)=[y(0-),y'(0-),\cdots,y^{(n-1)}(0-)]\]
将激励接入之后的瞬间系统的状态称为\textbf{$0_+$状态}或\textbf{初始状态}，记为
\[y^{(k)}(0+)=[y(0+),y'(0+),\cdots,y^{(n-1)}(0+)]\]
\end{definition}
\begin{definition}[初始条件]
    在微分方程的理论中\cite{ode}，将$y^{(k)}(0+)$称为初始条件。由于我们对激励和响应的建模是允许跳变的，一般不会给出初始条件。
\end{definition}
注意此时我们是允许一些条件发生突变的。
\begin{example}[换路定则]
    RLC振荡电路中，对于电感，$u_L=Ldi_L/dt$，施加于电感两侧的电压不会无穷大，其电流$i_L(t)$总是连续的，即$i_L(0_-)=i_L(0_+)=i_L(0)$，而其电压则可以不连续；对于电容，$i_C=Cdu_C/dt$，通过电容的电流不会无穷大，其电压$u_C(t)$总是连续的，即$u_C(0_-)=u_C(0_+)=u_C(0)$，而其电流可以不连续。电感电流、电容电压不突变的这个结果，称为换路定则。
\end{example}

激励$f(t)$不连续，意味着$y(t)$（或它的某阶导数）不连续，这时需要将y视为一个分布来求导，见\ref{sub:general_distributions}。例如$f(t)=g(t)u(t)$时，完全解中可能含有$u(t)$及其导数$\delta(t)$。

物理中的受迫振动，以及电路分析中的二阶电路，都是用二阶常系数线性微分方程描述的系统的例子，从直观上看，如果使激励（施加于系统的力，或者电源提供的电压、电流）经过一段时间后变为0，则响应一定也会随时间的增大而趋于0。因此，又可以将响应分为\textbf{稳态响应}(steady state response)$y_{ss}(t)$和\textbf{暂态响应}(transient state)$y_t(t)$：
\begin{definition}[稳态响应和暂态响应]
完全解中，$t\to\infty$时保留下来的分量称为稳态响应，例如一个常数；$t\to\infty$时趋于0的分量为稳态响应，例如$e^{-\lambda t}$。
\end{definition}

\begin{proposition}
    由常系数线性齐次微分方程描述的系统，如果初始状态为0向量，则该系统是因果线性时不变系统。
\end{proposition}
\begin{proof}
    设一个系统描述为
\[a_n r^{(n)}+a_{n-1}r^{(n-1)}+\cdot +a_1 r'+a_0 r=e\]
并且对于给定的激励$e(t)$找到了完全解$r(t)$，那么\begin{align*}
    \tau_b e&=\tau_b(a_n r^{(n)}+a_{n-1}r^{(n-1)}+\cdot +a_1 r'+a_0 r)\\
    &=a_n \tau_b r^{(n)}+a_{n-1}\tau_b r^{(n-1)}+\cdot +a_1 \tau_b r'+a_0 \tau_b r\\
    &=a_n (\tau_b r)^{(n)}+a_{n-1}(\tau_b r)^{(n-1)}+\cdot +a_1 (\tau_b r)'+a_0 (\tau_b r)
\end{align*}
即激励产生延时b时，零状态响应也产生延时b。

线性性是显然的，对此感到疑惑的读者可以自行将激励带入微分方程验证。

对于因果性，见后文中对这种系统的单位脉冲响应的讨论。
\end{proof}
至于零输入响应，它不会由于激励的改变而改变，不仅会破坏系统的时不变性，还会破坏系统的线性性，因为在初始状态非0时，直接将两个完全解相加，则所得信号的初始条件变为给定初始条件的两倍，但由于零输入相应是易于研究的，并且只要指出了零输入响应，就可以认为系统的初始状态为n维零向量来进行研究，最后将所得的零状态响应与零输入响应叠加，因此我们约定：
\begin{definition}
    由常系数线性微分方程描述的系统总是因果线性时不变系统，不论初始状态是否为0。
\end{definition}

\subsection{基本解}\label{sub:fundamental_solution}
以线性时不变系统的视角来看微分方程，自然会想到求这个系统的单位脉冲响应，也就是说，令方程右侧的激励信号为$\delta$，看所得响应$h(t)$，这样，根据上一小节中的结果，不论方程右侧的激励$e(t)$变为何种形式，只要它与$h(t)$的卷积是有定义的，就可以直接求出响应（或者说零状态响应）$r(t)=(h*e)(t)$，只要再叠加上零输入响应，就可以得到任意给定初始状态下方程的解，这是一个一劳永逸的工作，在实际问题中，我们经常给出系统的微分方程描述和初始条件，而激励则是任意的，现在就可以避开微分方程，直接计算卷积来求得系统的响应。历史上，数学家格林在1828年关于电势和磁势的论文中首次提出了这种方法并用它来处理带有边界条件的偏微分方程（如泊松方程）。因此我们说：
\begin{definition}
使用单位脉冲响应处理微分方程的方法称为\textbf{基本解法}或\textbf{格林函数法}，脉冲响应$h(t)$被称为\textbf{基本解}(fundamental solution)或\textbf{格林函数}(Green's function)。
\end{definition}

那么，如何求这个单位脉冲响应呢？对于微分方程
\[a_n r^{(n)}+a_{n-1}r^{(n-1)}+\cdot +a_1 r'+a_0 r=\delta\]
要使等式右边出现$\delta$，$r(t)$中一定含有$\delta$及其导数、积分，根据\ref{sub:general_distributions}中的结果，$u'=\delta$，而$u(t)$的各阶积分都可以用$P(t)u(t)$来表示，其中$P(t)$是t的多项式，因此可以假定$r(t)=f_1(t)u(t)+f_2(t)\delta(t)+f_3(t)\delta'(t)+\cdots$。我们知道，$\delta$具有采样性质：$\delta(t)f(t)=\delta(t)f(0)$，类似地，还推导过$\delta'$与函数的乘积：$g\delta'=g(0)\delta'-g'(0)\delta$，不难想象，$\delta$的各阶导数与函数的乘积都是类似的（可以通过归纳法验证这一点），于是刚才的$r(t)$简
化为
\[r(t)=f(t)u(t)+a_1\delta+a_2\delta'+\cdots\]
我们知道，分布与函数乘积的求导也满足莱布尼兹法则，运用这一点，将上式带入激励取为$\delta$的微分方程，可以通过待定系数法求出各个系数，并得到关于$f(t)$的常规的微分方程。很明显，我们不总是需要$\delta$及其高阶导数项，为此需要研究取到$u(t)$的几阶导数就足以完成基于待定系数法的求解，我们通过一个简单的例子来说明这个问题。

\begin{example}
    求微分方程
\[r''(t)+3r'(t)+2r(t)=e(t)\]
的单位脉冲响应。令$r''(t)+3r'(t)+2r(t)=\delta$，如果$r(t)$中含有$\delta'$，则
其各阶导数会因此含有$\delta$的更高阶导数，这不是我们所需要的，因此，令
$r(t)=f(t)u(t)+a\delta$，求出其一阶、二阶导数：\begin{align*}
    r'(t)&=f'(t)u(t)+f(t)\delta+a\delta'\\
    &=f'(t)u(t)+f(0)\delta+a\delta'\\
    r''(t)&=f''(t)u(t)+f'(t)\delta+f(0)\delta'+a\delta''\\
    &=f''(t)u(t)+f'(0)\delta+f(0)\delta'+a\delta''
\end{align*}
再带入原方程：\begin{align*}
    &r''(t)+3r'(t)+2r(t)\\
    =&\left[f''(t)u(t)+f'(0)\delta+f(0)\delta'+a\delta''\right]\\
    &+3\left[f'(t)u(t)+f(0)\delta+a\delta'\right]\\
    &+2\left[f(t)u(t)+a\delta\right]\\
    =&\left[f''(t)+3f'(t)+2f(t)\right]u(t)+\left[f'(0)+3f(0)+2a\right]\delta+\left[f(0)+3a\right]\delta'+a\delta''
\end{align*}
对比系数，得到：\begin{align*}\begin{cases}
    &f''(t)+3f'(t)+2f(t)=0\\
    &f'(0)+3f'(0)+2a=1\\
    &f(0)+3a=0\\
    &a=0
\end{cases}
\end{align*}
因此问题转化为求解微分方程
\[f''(t)+3f'(t)+2f(t)=0,f(0)=0,f'(0)=1\]
这个方程正是一开始的微分方程的齐次方程,可以立即得到它的解：
\begin{align*}
    &f(t)=e^{-t}-e^{-2t}\\
    &h(t)=\left(e^{-t}-e^{-2t}\right)u(t)
\end{align*}
总之，只要将齐次解乘以$u(t)$，求出对应阶导数并带回原方程对比系数，即可得到单位脉
冲响应；由于单位阶跃响应形如$h(t)=y_h(t)u(t)$，满足$h(t)=0,t<0$，微分方程描述的
系统还具有因果性。
\end{example}
\begin{definition}[因果信号]
    以上例子中出现了满足$h(t)=y_h(t)u(t)$的信号，将这种信号称为\textbf{因果信号}(cau\text{Sa}l signal)；而如果信号满足$h(t)=y_h(t)u(-t)$，则称之为\textbf{反因果信号}(anti-cau\text{Sa}l signal)。
\end{definition}

更一般地，由微分方程\[\sum_{n=0}^{N}a_n r^{(n)}(t)=\sum_{m=0}^{M}b_m e^{(m)}(t)\]
描述的系统，其单位脉冲响应满足：
\[\sum_{n=0}^{N}a_n r^{(n)}(t)=\sum_{m=0}^{M}b_m \delta^{(m)}\]
当$r(t)$的最高次导的阶数大于$\delta$的最高阶导阶数，即$N> M$时，解为$y_h(t)u(t)$；当$r(t)$的最高次导的阶数不小于$\delta$的最高阶导阶数，即$N\leq M$时，解为$y_h(t)u(t)+\sum_{k=0}^{M-N}c_k \delta^{(k)}$。换言之，需要利用方程左侧的最高阶导，让方程右侧所需的$\delta$的最高阶导数项出现。

从数学上我们没有必要考虑这种形式的方程，只要把方程右侧看作一个新的非齐次项，它与其他微分方程没有区别，但作为一个线性时不变系统，求解其脉冲响应就显得十分重要了。另一种单位脉冲响应的求解方法是，将系统视作普通的常系数线性微分方程，将基本解与$\sum_{m=0}^{M}b_m e^{(m)}(t)$的卷积作为系统的单位脉冲响应，但这样涉及$\delta$各阶导数的卷积，计算较为复杂，通过待定系数法求解往往更快。

我们在\ref{sub:cascade}末尾得到：单位脉冲响应是单位阶跃响应的导数，因此可以通过单位脉冲响应求出单位阶跃响应。不过一般不会使用待定系数法求解单位阶跃响应，因为这涉及非齐次项得处理，读者可以在以下例子中，改写对比系数所得得方程组来体会这一点。
\begin{example}
    设系统由微分方程\[r''(t)+3r'(t)+2r(t)=e''(t)+e(t)\]描述，求其单位脉冲响应。\\
    解：齐次方程的特征方程为$\lambda^2+3\lambda+2=0$，$\lambda_1=-1,\lambda_2=-2$，齐次解为$r_h(t)=C_1 e^{-t}+C_2 e^{-2t}$。\\
    将$\delta$带入右式得到$\delta''+\delta$，为了使左式也出现$\delta''$，设单位脉冲响应为$h(t)=r_h(t)u(t)+C\delta$，则$h'(t)=r_h'(t)u(t)+r_h(0)\delta+C\delta',h''(t)=r_h''(t)u(t)+r_h'(0)\delta+r_h(0)\delta'+C\delta''$
    带入原方程得到：\begin{align*}
        LHS=&\left(r_h''(t)u(t)+r_h'(0)\delta+r_h(0)\delta'+C\delta''\right)\\
        &+3\left(r_h'(t)u(t)+r_h(0)\delta+C\delta'\right)\\
        &+2\left(r_h(t)u(t)+C\delta\right)\\
        =&\left(r''_h(t)+3r'_h(t)+2r_h(t)\right)u(t)+\left(r'_h(0)+3r_h(0)+2C\right)\delta+\left(r_h(0)+3C\right)\delta'+C\delta''
    \end{align*}
    对比系数，得到：\begin{align*}
        \begin{cases}
            r'_h(0)+3r_h(0)+2C=1\\
            r_h(0)+3C=0\\
            C=1
        \end{cases}
    \end{align*}
    所以$C=1,r_h(0)=-3,r'_h(0)=8$，注意$u(t)$的系数自然为0，这是由齐次解的性质保证的。满足上述条件的$C_1=2,C_2=-5$，因此单位脉冲响应为$h(t)=\left(2e^{-t}-5e^{-2t}\right)u(t)+\delta$。
\end{example}

\section{系统的频率响应特性}\label{sec:Freq_Response}

由于这两节中，绝大部分文献和教材都采用角频率进行讨论，并且涉及大量的三角函数运算时，角频率也更加方便，本章的这两个小节将直接使用角频率形式的傅里叶变换。

\subsection{频率响应特性的引出}\label{sub:freq_response}
在上一节中我们得到了$r(t)=(h*e)(t)$，看到卷积的结构，自然会想到对其做傅里叶变换，即\[R(\omega)=H(\omega)E(\omega)\]
\begin{definition}[频率响应]
    将$H(\omega)$称为$r(t)$的\textbf{频率响应}，简称\textbf{频响}。
\end{definition}
一个物理可实现的系统，容易理解它必须满足因果性，即$h(t)=0,t<0$。实际上，这样的系统还必须满足\textbf{佩利-维纳准则}(Paley-Wiener criterion)\cite{signal_systems}：
\begin{definition}[佩利-维纳准则]
    \begin{align*}
    &\int_{-\infty}^{\infty}\left|H(\omega)\right|^2\,d\omega<\infty\\
    &\int_{-\infty}^{\infty}\frac{\left|\ln|H(\omega)|\right|}{1+\omega^2}\,d\omega<\infty
\end{align*}
\end{definition}

在分析电路时曾见过它的另一种定义方式\cite{electronic_circuits}：
\begin{definition}[频率响应]
    $H(\omega)=Y(\omega)/X(\omega)$，其中$Y(\omega)$是输出端口信号的频域形式，$X(\omega)$是输入端口信号的频域形式
\end{definition}
它与我们用傅里叶变换的理论给出的定义没有区别，但是展示了另一种求频率响应的视角。在学习电路分析时，我们知道线性的电感、电容在相量法下可以与线性电阻等同处理，统一地用\textbf{阻抗}来描述其电压电流关系。感值为L的电感，阻抗为$i\omega L$，容值为C的电容，阻抗为$1/(i\omega C)$，而阻值为R的电阻，阻抗就是R，这种分析方法实际上正是基于傅里叶变换的。
\begin{example}
    描述电容的方程为：
\[i(t)=C\frac{d}{dt}v(t)\]
对其做傅里叶变换，得到
\[I(\omega)=i\omega C V(\omega)\]
因此电容的阻抗为
\[Z_C(\omega)=\frac{V(\omega)}{I(\omega)}=\frac{1}{i\omega C}\]
描述电感的方程为：
\[v(t)=L\frac{d}{dt}i(t)\]
对其做傅里叶变换，得到
\[V(\omega)=i\omega L I(\omega)\]
因此电感的阻抗为
\[Z_L(\omega)=\frac{V(\omega)}{I(\omega)}=i\omega L\]
\end{example}
\begin{example}
    考虑RC电路：
\begin{center}\begin{circuitikz}[american] % 美式电路风格
    % 输入端口
    \draw (0,2) to [short, o-] (1,2) % 输入接线端到电阻
          to [R, l=$R$] (4,2);       % 电阻R
    
    % 电容C与接地
    \draw (4,2) to [C, l_=$C$] (4,0) % 电容C（下标注）
          to [short] (4,-0.5);   % 接地符号延伸
    \draw (4,0) node[ground]{};      % 接地符号
    
    % 输出端口（从电阻与电容连接点引出）
    \draw (4,2) to [short, -o] (6,2);
    
    % 标注输入输出电压
    \draw (0,2) node[left]{$V_{\text{in}}(\omega)$};  % 输入电压
    \draw (6,2) node[right]{$V_{\text{out}}(\omega)$}; % 输出电压
\end{circuitikz}\end{center}
我们直接使用相量法得到其输入输出方程的频域形式，与电阻分压同理：
\[V_{out}(\omega)=\frac{1/(i\omega C)}{R+1/(i\omega C)}V_{in}(\omega)\]
因此频率响应为
\[
    H(\omega)=\frac{V_{out}(\omega)}{V_{in}(\omega)}=\frac{1}{1+i\omega RC}
\]
\end{example}
可见相量法可以省去列写微分方程和求傅里叶变换的过程，直接得到频率响应，这也是前文中强调定义式$H(\omega)=Y(\omega)/X(\omega)$的原因。

将频率响应$H(\omega)$看作一个复数，即$H(\omega)=|H(\omega)|e^{i\varphi(\omega)}$，则$|H(\omega)|$表示系统对频率为$\omega$的信号成分的放大倍数，$\varphi(\omega)$表示该频率成分经过系统后相位的变化。我们定义:
\begin{definition}[幅频特性和相频特性]
    $|H(\omega)|-\omega$称为系统的\textbf{幅频特性}，$\varphi(\omega)-\omega$称为系统的\textbf{相频特性}，这里$\varphi(\omega)$通常取主值，即$(-\pi,\pi]$内的值。
\end{definition}

\subsection{滤波器}\label{sub:filter}
我们曾在\ref{sub:convolution}中提到，滤波就是把信号中的某些成分剔除或大幅减少，相当于在频域乘以一个函数，在时域上的表现则是与这个函数的傅里叶逆变换进行卷积。从频率响应的视角来看，滤波器就是一个系统，理想滤波器的幅频特性在某些频率处接近于0，而在另一些频率处接近于1。

\begin{definition}[滤波器的分类]
    低通滤波器是指幅频特性$|H(\omega)|$近似等于$$\chi_{[-\omega_c,\omega_c]}$$的滤波器，$\omega_c$为截止频率；高通滤波器则相反，幅频特性近似$$1-\chi_{[-\omega_c,\omega_c]}$$
    带通滤波器的幅频特性近似等于$$\chi_{[\omega_L,\omega_H]}+\chi_{[-\omega_H,-\omega_L]}$$带阻滤波器则相反，幅频特性近似为$$1-\left(\chi_{[\omega_L,\omega_H]}+\chi_{[-\omega_H,-\omega_L]}\right)$$
\end{definition}
\begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{Filter}
    \caption{理想滤波器的频率响应特性}
\end{figure}

偶函数在傅里叶变换下仍是偶函数，因此以上滤波器的单位脉冲响应也是偶函数，不具有因果性，因此是无法实现的。以它们作为理想滤波器，是因为实信号的幅度谱是偶函数，我们希望实信号经过系统还是实信号。实际设计滤波器时，只能逼近理想滤波器，例如巴特沃斯滤波器、切比雪夫滤波器等。

一般而言，理想滤波器的单位脉冲响应是实函数，从而频率响应满足$H(\omega)=\overline{H(-\omega)}$，即幅频特性是偶函数，相频特性是奇函数。
\begin{example}
将激励信号$V_{in}(t)=\cos(\omega_0 t)$施加于例10中的RC电路，求输出信号$V_{out}(t)$\\
解：激励信号的傅里叶变换为
    \[V_{in}(\omega)=\pi(\delta_{\omega_0}+\delta_{-\omega_0})\]
因此输出信号的傅里叶变换为
\begin{align*}
    V_{out}(\omega)&=H(\omega)V_{in}(\omega)\\
    &=\frac{\pi}{1+i\omega RC}(\delta_{\omega_0}+\delta_{-\omega_0})\\
    &=\frac{\pi}{1+i\omega_0 RC}\delta_{\omega_0}+\frac{\pi}{1+i(-\omega_0) RC}\delta_{-\omega_0}
\end{align*}
反变换得到输出信号为
\begin{align*}
    r(t)&=\frac{1}{2\pi}\int_{-\infty}^{\infty}V_{out}(\omega)e^{i\omega t}\,d\omega\\
    &=\frac{1}{2\pi}\int_{-\infty}^{\infty}\left(\frac{\pi}{1+i\omega_0 RC}\delta_{\omega_0}+\frac{\pi}{1-i\omega_0 RC}\delta_{-\omega_0}\right)e^{i\omega t}\,d\omega\\
    &=\frac{1}{2}\left(\frac{1}{1+i\omega_0 RC}e^{i\omega_0 t}+\frac{1}{1-i\omega_0 RC}e^{-i\omega_0 t}\right)\\
    &=\text{Re}\left[\frac{1}{1+i\omega_0 RC}e^{i\omega_0 t}\right]\\
    &=\frac{1}{\sqrt{1+(\omega_0 RC)^2}}\cos(\omega_0 t-\arctan(\omega_0 RC))
\end{align*}

考虑$\omega_0$处$H(\omega)$的幅度和相位：
\begin{align*}
    &|H(\omega_0)|=\frac{1}{\sqrt{1+(\omega_0 RC)^2}}\\
    &\varphi(\omega_0)=-\arctan(\omega_0 RC)\\
    &r(t)=\left|H(\omega_0)\right|\cos\left(\omega_0 t+\varphi(\omega_0)\right)
\end{align*}
可以看到，$|H(\omega_0)|$为输出信号幅值的放大倍数，$\varphi(\omega_0)$为相位延迟，输出信号$V_{out}(t)$只用到了频域中的两个点$\pm\omega_0$，且由于系统函数偶对称，输出信号只显含$H(\omega_0)$的幅值的相位。这是因为$\cos(\omega_0 t)$在频域中只含有两个对称的频率成分。
\end{example}

将以上过程进一步抽象:
\begin{align*}
    \mathcal{F}\left[H[e^{i\omega_0 t}]\right]&=\mathcal{F} \left[h(t)*e^{i\omega_0 t}\right]\\
    &=H(\omega)\mathcal{F} \left[e^{i\omega_0 t}\right]\\
    &=2\pi H(\omega)\delta_{\omega_0}\\
    &=2\pi H(\omega_0)\delta_{\omega_0}
\end{align*}
因此\[r(t)=H\left[e^{i\omega_0 t}\right]=H(\omega_0)e^{i\omega_0 t}\]
\begin{definition}[特征函数]
    给定$\omega$，将函数$e^{i\omega t}$称为系统H的\textbf{特征函数}(eigenfunction)，\textbf{特征值}(eigenvalue)为$H(\omega)$。
\end{definition}

\subsection{失真与无失真传输}\label{sub:distortion}
在信号传输的过程中，有时希望信号经过一个系统，只有幅值发生变化，而波形不改变，例如小信号放大电路。我们定义：
\begin{definition}[失真]
波形改变的现象称为\textbf{失真}(distortion)。根据输出信号是否产生新的频率分量，将失真分为\textbf{线性失真}(linear distortion)和\textbf{非线性失真}(nonlinear distortion)；线性失真中，根据引起失真的方式，又分为\textbf{幅度失真}(amplitude distortion)和\textbf{相位失真}(phase distortion)。幅度失真是指系统的幅频特性不是常数，即不同频率成分的放大倍数不同；相位失真是指系统的相频特性不是线性的，即不同频率成分的相位延迟不同。
\end{definition}
\begin{definition}[无失真传输系统]
如果一个系统对任意激励信号都不会产生失真，则称之为\textbf{无失真传输系统}(ideal transfer system)
\end{definition}

对于一个理想的\textbf{无失真传输系统}，它只能对输入信号进行幅值的统一改变或相位的统一延迟，即\[r(t)=Ke(t-t_0)\]其中K为常数，$t_0$为常数延迟。由傅里叶变换的时移性质可知，无失真传输系统的系统函数为
\[H(\omega) = Ke^{-i\omega t_0}\]
可以看到，$|H(\omega)|=K,t_0=-\varphi(\omega)/\omega$，其幅频特性是常数，图像为一水平线；相频特性是线性函数，图像为过原点的直线，斜率$-t_0$对应系统造成的延时。

由于物理限制，我们不可能实现一个无失真传输系统，但只要所讨论的信号的频谱基本都集中在特定的频段当中，就可以近似认为在这个频段上满足$|H(\omega)|=K,\varphi(\omega)=-\omega t_0$的系统是无失真传输系统。

对于一般的线性时不变系统，可以将时延$t_0=-\varphi(\omega)/\omega$由常数推广为$\omega$的函数$\tau_p(\omega)$。此外，$\varphi(\omega)/\omega$是$\varphi(\omega)-\omega$图像的割线斜率，而$d\varphi(\omega)/d\omega$是该图像在$\omega$处的切线斜率，仿照电路分析中对于动态电阻和静态电阻的处理，我们定义相时延和群时延\cite{signal_systems}：
\begin{definition}[相时延和群时延]
\[\tau_p(\omega)=-\frac{\varphi(\omega)}{\omega}\]
描述了系统对不同频率成分造成时延的情况，称之为\textbf{相时延}(phase delay)；将
\[\tau_g(\omega)=-\frac{d\varphi(\omega)}{d\omega}\]
称为\textbf{群时延}(group delay)或\textbf{包络延时}(envelope delay)。
\end{definition}

对于无失真传输系统，$\tau_p(\omega)=\tau_g(\omega)=t_0$。根据电路分析的经验，看到$\tau_p(\omega)=-\varphi(\omega)/\omega$而定义$\tau_g(\omega)=-d\varphi(\omega)/d\omega$是自然的，在处理非线性电阻的伏安特性曲线时也曾类似地定义动态电阻和静态电阻，但其物理意义并不十分明显，我们通过两个例子来理解它们的意义。

\begin{example}[相时延]
设输入信号为单频复指数信号$e^{i\omega_0 t}$，求频率响应为$H(\omega)$
的线性时不变系统的输出信号$r(t)$。\\
解：我们已经在前面得到：\[r(t)=H\left[e^{i\omega_0 t}\right]=H(\omega_0)e^{i\omega_0 t}\]
可以看到，输出信号仍然是单频复指数信号，其幅值被放大了$|H(\omega_0)|$倍，相位
延迟了$\varphi(\omega_0)$，折合到时间上，就得到相时延为$\tau_p(\omega_0)=-\varphi(\omega_0)/\omega_0$。
\end{example}

可以想象，能够分解成不同频率成分的信号，其各频率成分一般会产生不同的相时延，从而使得输出信号的波形发生变化，这就是相频特性不是线性函数导致的相位失真。

\begin{example}[群时延]
设输入信号为调幅信号（关于调幅信号，见\ref{sec:modulation}）：
\[e(t)=\cos(\omega_m t)\cos(\omega_c t)\]
其中$\omega_c$为载波角频率，$\omega_m$为被调制信号的角频率，且$\omega_c\gg \omega_m$.系统H的单位脉冲响应$h(t)$为实信号，频率响应为$H(\omega)$。求$e(t)$进入系统所得的输出信号$r(t)$。\\
解：
可以看到该信号是一个被低频信号$\pm\cos(\omega_m t)$包络的高频载波信号$\cos(\omega_c t)$:
\begin{figure}[H]
    \centering
    \includegraphics[width=0.6\textwidth]{AM.jpeg}
    \caption{调幅信号示意图}
\end{figure}
将输入信号用积化和差公式展开：
\begin{align*}
    e(t)&=\frac{1}{2}[\cos((\omega_c+\omega_m)t)+\cos((\omega_c-\omega_m)t)]
\end{align*}
输入信号的傅里叶变换为
\begin{align*}
    E(\omega)&=\frac{\pi}{2}\left[\delta_{\omega_c+\omega_m}+\delta_{-(\omega_c+\omega_m)}+\delta_{\omega_c-\omega_m}+\delta_{-(\omega_c-\omega_m)}\right]
\end{align*}
因此输出信号的傅里叶变换为
\begin{align*}
    R(\omega)=&H(\omega)E(\omega)\\
    =&\frac{\pi}{2} \left[H(\omega_c+\omega_m)\delta_{\omega_c+\omega_m}+H(-(\omega_c+\omega_m))\delta_{-(\omega_c+\omega_m)}\right.\\
    &+\left. H(\omega_c-\omega_m)\delta_{\omega_c-\omega_m}+H(-(\omega_c-\omega_m))\delta_{-(\omega_c-\omega_m)}\right]\\
    =&\frac{\pi}{2} \left[H(\omega_c+\omega_m)\delta_{\omega_c+\omega_m}+\overline{H(\omega_c+\omega_m)}\delta_{-(\omega_c+\omega_m)}\right.\\
    &+\left.H(\omega_c-\omega_m)\delta_{\omega_c-\omega_m}+\overline{H(\omega_c-\omega_m)}\delta_{-(\omega_c-\omega_m)}\right]
\end{align*}
反变换得到输出信号为
\begin{align*}
    r(t)=&\frac{1}{4}\left[H(\omega_c+\omega_m)e^{i(\omega_c+\omega_m)t}+\overline{H(\omega_c+\omega_m)}e^{-i(\omega_c+\omega_m)t}\right.\\
    &+\left. H(\omega_c-\omega_m)e^{i(\omega_c-\omega_m)t}+\overline{H(\omega_c-\omega_m)}e^{-i(\omega_c-\omega_m)t}\right]\\
    =&\frac{1}{2}\text{Re}\ \left[H(\omega_c+\omega_m)e^{i(\omega_c+\omega_m)t}+H(\omega_c-\omega_m)e^{i(\omega_c-\omega_m)t}\right]\\
    =&\frac{1}{2}|H(\omega_c+\omega_m)|\cos((\omega_c+\omega_m)t+\varphi(\omega_c+\omega_m))\\
    &+\frac{1}{2}\left|H(\omega_c-\omega_m)\right|\cos\left((\omega_c-\omega_m)t+\varphi(\omega_c-\omega_m)\right)
\end{align*}
由于$\omega_c\gg \omega_m$，可以对$|H(\omega)|$和$\varphi(\omega)$在$\omega_c$处做泰勒展开：
\begin{align*}
    |H(\omega_c+\omega)|&\approx |H(\omega_c)|+\left.\frac{d|H(\omega)|}{d\omega}\right|_{\omega=\omega_c}\omega\\
    \varphi(\omega_c+ \omega)&\approx \varphi(\omega_c)+\left.\frac{d\varphi(\omega)}{d\omega}\right|_{\omega=\omega_c}\omega
\end{align*}
将其带入$r(t)$中，得到
\begin{align*}
    r(t)=&\frac{1}{2}\left[|H(\omega_c)|+\left.\frac{d|H(\omega)|}{d\omega}\right|_{\omega=\omega_c}\omega_m\right]\cos\left((\omega_c+\omega_m)t+\varphi(\omega_c)+\left.\frac{d\varphi(\omega)}{d\omega}\right|_{\omega=\omega_c}\omega_m\right)\\
    &+\frac{1}{2}\left[|H(\omega_c)|-\left.\frac{d|H(\omega)|}{d\omega}\right|_{\omega=\omega_c}\omega_m\right]\cos\left((\omega_c-\omega_m)t+\varphi(\omega_c)-\left.\frac{d\varphi(\omega)}{d\omega}\right|_{\omega=\omega_c}\omega_m\right)\\
    \approx&|H(\omega_c)|\left[\cos\left((\omega_c+\omega_m)t+\varphi(\omega_c)+\left.\frac{d\varphi(\omega)}{d\omega}\right|_{\omega=\omega_c}\omega_m\right)\right.\\
    &\qquad\qquad\left.+\cos\left((\omega_c-\omega_m)t+\varphi(\omega_c)-\left.\frac{d\varphi(\omega)}{d\omega}\right|_{\omega=\omega_c}\omega_m\right)\right]\\
    =&|H(\omega_c)|\cos(\omega_c t+\varphi(\omega_c))\cos\left(\omega_m\left[t+\left.\frac{d\varphi(\omega)}{d\omega}\right|_{\omega=\omega_c}\right]\right)
\end{align*}
对比输入信号
\[e(t)=\cos(\omega_m t)\cos(\omega_c t)\]
可以看到，输出信号的幅度大约变为$|H(\omega_c)|$倍，载波信号的相位延迟了$\varphi(\omega_c)$，调制信号的相位延迟了$\omega_m\left.\dfrac{d\varphi(\omega)}{d\omega}\right|_{\omega=\omega_c}$，折合到时间上，就是群时延$\tau_g(\omega_c)=-\left.\dfrac{d\varphi(\omega)}{d\omega}\right|_{\omega=\omega_c}$。因此，群时延描述了系统对调制信号的包络造成的延时。从信号的图像上来看，高频的载波信号的延时是不会造成很明显的变化的，而低频的调制信号的时延则会明显地反映在图像上，就像一个“信号群”在传播过程中整体产生了一段时延，群时延的名称就由此而来。
\end{example}

\subsection{*色散}\label{sub:dispersion}
\begin{definition}[色散介质]
    物理上，研究波在介质中的传播时，将波速与频率无关的介质称为\textbf{无色散介质}(non-dispersive medium)，将波速与频率有关的介质称为\textbf{色散介质}(dispersive medium)。在无色散介质中，波的相时延和群时延相等，即无失真传输；在色散介质中，波的相时延和群时延不相等，这种波速差往往会导致波形展宽，发生相位失真。
\end{definition}
典型的色散现象如一束白光通过三棱镜时，不同频率的光波由于波速不同而发生空间分离，形成彩虹色带。在无线电通信中，电离层对不同频率的电磁波有不同的折射率，导致信号传播速度不同，从而引起信号失真。
\begin{figure}[H]
    \centering
    \includegraphics[width=0.6\textwidth]{sesan}
    \caption{波通过色散介质时波形展宽示意图}
\end{figure}

为了讨论方便，我们假设波动是一维的，$x$处的质点在时刻$t$的位置为$y(x,t)$，波速为$u$，$y(x,t)$\\
满足的动力学方程称为\textbf{波动方程}，具有如下统一形式：
\[\frac{\partial^2 y}{\partial x^2}=\frac{1}{u^2}\frac{\partial^2 y}{\partial t^2}\]
波动方程的解具有形式$y(x,t)=f(x-ut)+g(x+ut)$，其中$f$和$g$分别表示向x轴正方向和负方向传播的波。

特别地，对于简谐波，有
\[y(x,t)=A\cos\omega\left(t-\frac{x}{u}\right)=A\cos\left(\frac{2\pi t}{T}-\frac{2\pi x}{\lambda}\right)\]
引入\textbf{波数}$k=\frac{2\pi}{\lambda}$，则简谐波可以表示为
\[y(x,t)=A\cos(\omega t - k x)\]

这里波数并不是指波的数目，而是一个将空间距离折算为相位延迟的比例系数，也可以将它理解为波的空间角频率：对简谐波$y(x,t)=A\cos(\omega t-kx)$的空间变量做傅里叶变换，将得到空间角频率仅有$\pm k$的成分，对三维空间中的平面波也有类似的结论，见\ref{sec:Multi_Fourier}。我们将宗量$\omega t-kx$称为波的\textbf{相位}(phase)，考察相位的传播速度，即令$\omega t-kx=const$（例如，振幅最大值处恒有$\omega t-kx=0$），得到
\[\frac{dx}{dt}=\frac{\omega}{k}=u\]
这个速度称为\textbf{相速度}(phase velocity)，它描述了波的相位传播的速度，可以看到相速度正是波速$u$。

借助傅里叶级数或傅里叶变换的理论，可以认为任意的波形都是若干不同频率的简谐波的叠加。

下面，我们将长度为$L$的均匀介质看作一个系统，设波$y(x,t)$沿$x$轴正向传播，将$x=0$处的波形作为输入信号$e(t)=y(0,t)$，$x=L$处的波形作为输出信号$r(t)=y(L,t)$。对于无色散介质，当输入为角频率为$\omega$的正弦波$\cos(\omega t)$时，有
\[r(t)=y(L,t)=e\left(t - \frac{L}{u}\right)=\cos\left(\omega \left(t-\frac{L}{u}\right)\right)\]
因此可以对给定的$\omega$求出频率响应为
\[H(\omega)=e^{-i\omega \frac{L}{u}}=e^{-ikL},k=\frac{\omega}{u}\]
可以看出，$k$实际上是关于$\omega$的函数$k(\omega)=\omega/u$，但在研究单频正弦波时看不出这一点。
\begin{definition}[色散关系]
    介质中波数$k$与角频率$\omega$之间的函数关系$k(\omega)$称为\textbf{色散关系}(dispersion relation)。
\end{definition}

一般地，设初始波形为$f(x)$，波速为$u$，可以确定$x=0$处的激励信号$e(t)=f(-ut)$。它的不同频率成分通过均匀色散介质构成的系统时，只产生相位失真，因此频率响应可以表示为
\[H(\omega)=e^{-ik(\omega)L}\]
这样就得到一般情况下的波速的定义，从而得到相速度的定义，还可以仿照动态电阻和群时延，定义\textbf{群速度}(group velocity)：
\begin{definition}[相速度和群速度]
    \quad\\
    相速度为\[v_p(\omega)=\frac{\omega}{k(\omega)}\]
    群速度为\[v_g(\omega)=\frac{d\omega}{dk}=\frac{1}{k'(\omega)}\]
    $v_p>v_g$时称为\textbf{正常色散}(normal dispersion)，$v_p<v_g$时称为\textbf{反常色散}(anomalous dispersion)。
\end{definition}
另一方面，介质作为一个系统，其相时延和群时延分别为
\begin{align*}
    \tau_p(\omega)&=-\frac{\varphi(\omega)}{\omega}=\frac{k(\omega)L}{\omega}=\frac{L}{v_p(\omega)}\\
    \tau_g(\omega)&=-\frac{d\varphi(\omega)}{d\omega}=\frac{dk(\omega)}{d\omega}L=\frac{L}{v_g(\omega)}
\end{align*}
即\[\tau_p(\omega)v_p(\omega)=\tau_g(\omega)v_g(\omega)=L\]

\begin{definition}
    波包即脉冲波形，\textbf{波包中心}是指脉冲波形中振幅最大的位置。经验上，用波包中心移动的速度来表征波包的移动速度，并称之为\textbf{波包速度}，这也是能量和信息在介质中传播的速度。
\end{definition}
\begin{proposition}
    对窄带光脉冲，其波包速度等于群速度。
\end{proposition}
\begin{proof}
设窄带光脉冲的中心频率为$\omega_0$，即其振幅谱$\hat{A}(\omega)$集中在$\omega_0$附近，做傅里叶反变换，得到的时域信号为$x=0$处经过的波形$A(t)$。对各频率成分引入相位因子$e^{-ik(\omega)x}$来表征波的传输，得到$x$处的波形为
\[\psi(x,t)=\frac{1}{2\pi}\int_{-\infty}^{\infty}\hat{A}(\omega)e^{i(\omega t-k(\omega)x)}\,d\omega\]
对$k(\omega)$在$\omega_0$处做泰勒展开：
\[k(\omega)\approx k(\omega_0)+k'(\omega_0)(\omega-\omega_0)\]
将其代入$\psi(x,t)$中，得到
\begin{align*}
    \psi(x,t)&=\frac{1}{2\pi}\int_{-\infty}^{\infty}\hat{A}(\omega)e^{i(\omega t-k(\omega_0)x-k'(\omega_0)(\omega-\omega_0)x)}\,d\omega\\
    &=\frac{1}{2\pi}e^{i(\omega_0 t-k(\omega_0)x)}\int_{-\infty}^{\infty}\hat{A}(\omega)e^{i(\omega - \omega_0)(t - k'(\omega_0)x)}\,d\omega\\
    &=\frac{1}{2\pi}e^{i(\omega_0 t-k(\omega_0)x)}\int_{-\infty}^{\infty}\hat{A}(\omega+\omega_0)e^{i\omega(t - k'(\omega_0)x)}\,d\omega&(\omega\to\omega-\omega_0)\\
    &=e^{i(\omega_0 t-k(\omega_0)x)}\mathcal{F}^{-1}[\hat{A}(\omega+\omega_0)]\left(t - k'(\omega_0)x\right)\\
    &=e^{i(\omega_0 t-k(\omega_0)x)}A\left(t - k'(\omega_0)x\right)e^{-i\omega_0 (t- k'(\omega_0)x)}\\
    &=A\left(t - k'(\omega_0)x\right)e^{i(\omega_0 k'(\omega_0)-k(\omega_0))x}
\end{align*}
可以看到，波形的包络$A\left(t - k'(\omega_0)x\right)$以速度$v_g(\omega_0)=\frac{1}{k'(\omega_0)}$传播，因此波包速度等于群速度。
\end{proof}

\section{调制、解调与复用传输}\label{sec:modulation}

现代的通信方式有两种\cite{electronic_circuits}，\textbf{有线通信}(wired communication)和\textbf{无线通信}(wireless communication)。无线通信指用电磁波作为载体的\textbf{射频通信}(radio frequency communication)，有线通信则是通过导线传输电信号，例如电话线、光纤等。尽管无线通信的信息传输效率比有线通信低一些，但无线通信配置灵活、建设速度快、通信可靠、维护方便且易于跨越复杂地形，应用广泛。

电磁波是通过天线发射和接受的。在电路分析的课程中，我们学过：当实际电路的几何尺寸远小于使用时最高工作频率所对应的波长时，可以忽略电磁场相互作用，由此抽象出的理想化原件模型被称为\textbf{集总参数元件}(lumped element)；当实际电路的几何尺寸与使用时最高工作频率所对应的波长相当时，必须考虑电磁场相互作用，由此抽象出的理想化原件模型被称为\textbf{分布参数元件}(distributed element)。无线通信中的天线就是一个典型的分布参数元件，它将受金属束缚的电磁场（电压、电流）转化为辐射的电磁场，这个转化过程要求天线的尺寸必须与波长相当。以四分之一波长导体线为例，要发射$1kHz$的电磁波，则需要$75km$长的天线，这是难以实现的，因此无线通信通常使用$MHz$甚至$GHz$频率的电磁波作为载体。

将低频基带信号装载到高频信号上的过程，称为\textbf{调制}(modulation)，此时高频信号被称为\textbf{载波}(carrier)，例如用正弦信号作为载波，可以将基带信号装载到载波的幅度、频率、相位上，对应的调制方式称为\textbf{调幅}(AM, amplitude modulation)、\textbf{调频}(FM, frequency modulation)和\textbf{调相}(PM, phase modulation)。相应地，在信号接收端，从高频的已调信号还原出低频的基带信号的过程，称为\textbf{解调}(demodulation)。
\begin{definition}[调频、调幅、调相]
    设基带信号为$m(t)$，载波信号为\[c(t)=A_c \cos(\omega_c t+\varphi_c)\]
    其中$A_c,\omega_c,\varphi_c$分别为载波的幅值、角频率和初相位，则：
    \begin{itemize}
        \item 调幅信号为\[v_{AM}(t)=[1+k_{AM} m(t)]A_c \cos(\omega_c t+\varphi_c)\]其中$k_{AM}$为调幅灵敏度；
        \item 调频信号为\[v_{FM}(t)=A_c \cos\left(\omega_c t+k_{FM}\int_{0}^{t}m(\tau)\,d\tau+\varphi_c\right)\]其中$k_{FM}$为调频灵敏度；
        \item 调相信号为\[v_{PM}(t)=A_c \cos\left(\omega_c t+k_{PM} m(t)+\varphi_c\right)\]其中$k_{PM}$为调相灵敏度。
    \end{itemize}
\end{definition}
也可以在载波的幅度和相位上同时调制，例如\textbf{正交振幅调制}(QAM, quadrature amplitude modulation)。

下面来解释为什么这三种调制方式的数学表示形式如上。\\
1.\textbf{幅度调制}：已调信号的幅度为\[1+k_{AM}m(t)\]
我们曾用这种调制方式作为\ref{sub:distortion}中的例子来解释群时延的概念，事实上，当时所使用的是\textbf{双边带调幅}(DSB)，一般而言不能略去1倍的载波信号这一项，即
\[v_{AM}(t)\neq k_{AM} m(t)A_c \cos(\omega_c t+\varphi_c)=v_{DSB}(t)\]
这是因为调幅信号通常通过包络检测器直接恢复，虽然有部分功率用于传输载波，但这简化了解调过程。此外，一般被调信号$m(t)$会预先经过衰减器以确保$|k_{AM}m(t)|\leq 1$，这样，$1+km(t)\geq 0$，包络不出现反转，即不会出现过度调制问题，包络检测器才能正常解调。\\
2.\textbf{频率调制}：$v_{FM}(t)$的傅里叶变换较为复杂，但其直观易于理解，这种调制方式下的\textbf{瞬时角频率}为：\begin{align*}
    \frac{d}{dt}\left(\omega_c t+k_{FM}\int_{0}^{t}m(\tau)\,d\tau+\varphi_c\right)=\omega_c+k_{FM}m(t)
\end{align*}
3.\textbf{相位调制}：\textbf{瞬时相位}为\[\omega_c t+k_{PM} m(t)+\varphi_c\]

我们以双边带调制为例给出一个简单的调制解调过程：
\begin{example}
设基带信号为$m(t)=\cos(\omega_m t)$，载波信号为$c(t)=\cos(\omega_c t)$，其中$\omega_c\gg \omega_m$。设计一个简单的解调器以还原出$m(t)$。\\
解：双边带调幅信号为\[v_{DSB}(t)=m(t)c(t)=\cos(\omega_m t)\cos(\omega_c t)\]
我们已经在上一节对它做过频域分析，得到其频谱为
\[V_{DSB}(\omega)=\frac{\pi}{2}\left[\delta_{\omega_c+\omega_m}+\delta_{-(\omega_c+\omega_m)}+\delta_{\omega_c-\omega_m}+\delta_{-(\omega_c-\omega_m)}\right]\]
假设传输过程没有发生失真，接收端得到的信号仍为$v_{DSB}(t)$。为了还原出$m(t)$，我们可以将$v_{DSB}(t)$与载波$c(t)$相乘，得到
\begin{align*}
    y(t)&=v_{DSB}(t)c(t)\\
    &=\cos(\omega_m t)\cos^2(\omega_c t)\\
    &=\frac{1}{2}\cos(\omega_m t)(1+\cos(2\omega_c t))\\
    &=\frac{1}{2}\cos(\omega_m t)+\frac{1}{2}\cos(\omega_m t)\cos(2\omega_c t)
\end{align*}
其傅里叶变换为
\begin{align*}
    Y(\omega)&=\frac{\pi}{2}[\delta_{\omega_m}+\delta_{-\omega_m}]\\
    &+\frac{\pi}{4}[\delta_{2\omega_c+\omega_m}+\delta_{-(2\omega_c+\omega_m)}+\delta_{2\omega_c-\omega_m}+\delta_{-(2\omega_c-\omega_m)}]
\end{align*}
只要再通过一个截止频率在$(\omega_m,\ 2\omega_c-\omega_m)$之间的低通滤波器，就可以滤除高频成分，得到$\dfrac{1}{2}\cos(\omega_m t)$，从而还原出基带信号$m(t)$。
\end{example}
时域上，这个过程相当于\begin{align*}
    y(t)&=v_{DSB}(t)c(t)\\
    &=m(t)c^2(t)\\
    &=m(t)\frac{1+\cos(2\omega_c t)}{2}\\
    &=\frac{m(t)}{2}+\frac{m(t)}{2}\cos(2\omega_c t)
\end{align*}
而$\frac{m(t)}{2}\cos(2\omega_c t)$被低通滤波器滤除。

事实上，对于带限信号（尤其是窄带信号），我们都可以采用这种调制解调的方法进行传输，这是由于三角函数具有\textbf{频谱搬移}(spectrum shifting)的性质：\begin{align*}
    \mathcal{F} \left[\cos(\omega_c t)\right]&=\pi\left[\delta_{\omega_c}+\delta_{-\omega_c}\right]\\
    \mathcal{F}\left[x(t)\cos(\omega_c t)\right]&=\frac{1}{2\pi}X(\omega)*\mathcal{F}\left[\cos(\omega_c t)\right]\\
    &=\frac{1}{2}\left[X(\omega-\omega_c)+X(\omega+\omega_c)\right]
\end{align*}
经过两次与载波相乘，一半的信号回到原来的位置，另一半被搬移到$2\omega_c$处，可见只要信号的带宽小于$\omega_c$，就可以通过选择合适的低通滤波器还原出基带信号。

利用这种频谱搬移特性，还可以实现信号的\textbf{频分复用}(FDM, frequency division multiplexing)：将多个基带信号分别调制到不同的载波频率上进行传输，在接收端先使用不同的带通滤波器分别解调，再与载波信号相乘，最后通过低通滤波器，即可还原出各个基带信号。

可以看到，复用传输能够有效提高信道的利用率。下面列举一些常用的复用传输方式：\begin{itemize}
    \item \textbf{时分复用}(TDM, time division multiplexing)：将多个基带信号在时间上交替传输，在接收端根据时间顺序还原出各个基带信号。这种方式适用于数字信号传输；
    \item \textbf{码分复用}(CDM, code division multiplexing)：为每个基带信号分配一个独特的编码序列，所有信号同时传输，在接收端通过相关解码技术还原出各个基带信号。这种方式常用于无线通信系统，如CDMA技术；
    \item \textbf{波分复用}(WDM, wavelength division multiplexing)：主要用于光纤通信中，通过不同波长的光信号同时传输多个基带信号，在接收端通过光学滤波器分离出各个波长的信号进行解调，实质上还是频分复用，只是频率较高；
    \item \textbf{空分复用}(SDM, space division multiplexing)：利用空间上的不同路径同时传输多个基带信号，在接收端通过空间滤波技术还原出各个基带信号，常用于多输入多输出（MIMO）系统中；
    \item \textbf{偏振复用}(PDM, polarization division multiplexing)：利用光信号的不同偏振状态同时传输多个基带信号，在接收端通过偏振分离技术还原出各个基带信号，常用于光纤通信中以提高传输容量。
\end{itemize}

\chapter{关于傅里叶变换的进一步讨论}

\section{采样与插值，狄拉克梳状分布}\label{sec:Sampling_Interpolation}

本节和下一节中涉及采样频率等问题，简洁起见，我们将使用频率做傅里叶变换。

\subsection{插值问题}\label{sub:interpolation}
\textbf{插值}的雏形来自于古代天文学，最简单的插值就是通过观察星体在几个时刻的位置推测中间时刻的位置。在数学上，插值需要我们给出一个连续信号来逼近甚至还原原信号，工程上则需要我们插入若干新的样值点使得离散信号看起来更接近原信号。我们首先引入一些术语：
\begin{definition}
设有确定信号$f(t)$，通过采样（与周期矩形脉冲序列相乘）的方式找出它在若干点处的\textbf{样值}$f(t_0),f(t_1),f(t_2),\cdots$，\textbf{采样与插值}问题即讨论在怎样的情况下可以借助这组值还原出$f(t)$。一般地，相邻采样点的间隔一定，记为$T_s$，称为\textbf{采样间隔}，将$f_s=1/T_s$称为\textbf{采样频率},将$\omega_s=2\pi f_s=2\pi/T_s$称为\textbf{采样角频率}。
\end{definition}

类似于用像素表示图片，利用采样所得的离散信号$f_d[n]=f(nT_s)$表示信息，相当于用离散信号表示连续信号，能够大大降低传输和存储的成本。一个数字处理系统或数字传输系统的第一个环节就是对信号进行采样，随后进行量化编码、数字传输或处理，到信号接收方或需要使用信号时再进行信号恢复。

历史上，最早对插值问题进行系统研究的是牛顿和拉格朗日。牛顿提出的牛顿插值公式是组合数学讨论的话题，他通过引入离散信号的差商的概念，提出了一种使用三角形差商表构造过若干指定数据点的多项式的方法；相比之下拉格朗日的拉格朗日插值法要简单得多，其想法的关键在于构造在特定数据点处非0，而在另外所有数据点处均为0的多项式：
\begin{definition}[拉格朗日插值法]
    对于一组互异的数据点
 \[(x_0,y_0),(x_1,y_1),\dots,(x_n,y_n)\]
 其拉格朗日插值多项式为
\[L(x) = \sum_{i=0}^{n} y_i \ell_i(x)\]
其中 $\ell_i(x)$ 是拉格朗日基函数，满足$\ell_i(x_i)=1,\ell_i(x_j)=0(j\neq i)$：
\[\ell_i(x) = \prod_{\substack{j=0 \\ j \neq i}}^{n} \frac{x - x_j}{x_i - x_j}\]
该多项式满足 $L(x_i) = y_i,i=0,1,\dots,n$。
\end{definition}
这个方法后来被埃尔米特改进，不仅能保证函数值相等，还能保证若干阶导数的值相等，称为\textbf{埃尔米特插值法}。

另外，还有一种插值的思路将采样时产生的误差也考虑了进来，以这种视角进行最优线性拟合，就是\textbf{最小二乘法}，在测量误差可能比较大时，这一类拟合方法的表现会更好。

以上插值方式对原信号的逼近效果比较有限，一些数学家们开始转向研究如何重建整个信号。1948年，克劳德·香农发表了他的巨著《通信的数学原理》，明确提出了\textbf{香农采样定理}，并给出下一节中将介绍的还原带限信号的公式。要还原大带宽信号需要很高的采样频率，会对硬件设备提出很高的要求。我们可以通过另外的插值流程还原信号，例如对于一些信号可以利用其稀疏性和相关性，用远低于$f_N$的采样频率还原信号。

就信息通信而言，我们最关注的是如何\textbf{用更低的成本传递更多的信息}。可以想象，传递离散信号要比传递连续信号更为高效，而离散信号时我们用来近似描述连续信号的，其本质就是对连续信号的采样。因此，本书所要研究的内容集中在以下两个方面：\begin{itemize}
    \item 采用什么采样方式，需要多高的采样率；
    \item 对于采样所得的信号（尤其是离散信号），如何进行分析和处理。
\end{itemize}

将采样所得的信号抽象成一个离散信号对于采样技术的要求是比较高的。首先，我们必须保证采样频率足够高，否则这些点无法表征原信号的特性，例如正弦信号在不当的采样下可能得到恒为0的离散信号；其次，我们要保证采样所使用的脉冲波形的周期和幅值稳定；最后，我们应该使脉冲波形尽量短，这样才能将一个脉冲波形对应到一个样值点上，而不产生太大误差。

在以上所有条件都满足的情况下，我们就可以将采样信号抽象成一个$\shah$分布，下一小节就来介绍这个分布。

\subsection{狄拉克梳状分布}\label{sub:dirac_comb}
由于我们并不关注采样信号幅值的大小，又希望采样所得信号与离散信号尽可能相似，我们可以将采样信号取成若干等间距排列、强度相同的狄拉克$\delta$分布的和，即：
\begin{definition}[狄拉克梳状分布]
    对任意$T>0$，定义分布
    \begin{equation*}
        \shah_T=\sum_{k=-\infty}^{\infty}\delta_{kT}
    \end{equation*}
    即\[\langle \shah_T,\varphi\rangle=\left\langle \sum_{k=-\infty}^{\infty}\delta_{kT},\varphi\right\rangle=\sum_{k=-\infty}^{\infty}\varphi(kT)\]
    符号“$\shah$”读作“shah”，在T=1时可以将角标略去，直接写作$\shah$\cite{brad_osgood_ee261}。由于其图像是等间距排列的一个个$\delta$，又称之为\textbf{狄拉克梳状分布}(dirac comb)。
\end{definition}

容易看出，这个分布具有三条基本性质。其一是采样性质，它直接得自$\delta_a$的采样性质：$$\shah_T f(t)=\sum_{k=-\infty}^{\infty}f(kT)\delta_{kT}$$
可以看到，这个式子就是我们对采样信号的理想化描述，采样所得信号在每个采样点处的强度就是原信号在该点处的值，而在其他位置处幅值为0。
\begin{figure}[H]
    \centering
    \includegraphics[width=0.4\textwidth]{shah.jpeg}
    \caption{狄拉克梳状分布示意图}
\end{figure}
其二是$\shah$在伸缩变换下的性质：\begin{proposition}[$\shah$的伸缩]
    \[\sigma_a\shah=\frac{1}{a}\shah_{1/a},\shah_T=\frac{1}{T}\sigma_{1/T}\shah \quad (a\to\frac{1}{T})\]
\end{proposition}
\begin{proof}
\begin{align*}
    \left\langle \sigma_a\shah,\varphi\right\rangle&=\left\langle \shah,\frac{1}{a}\sigma_{1/a}\varphi\right\rangle=\frac{1}{a}\sum_{k=-\infty}^{\infty}\varphi\left(x-\frac{k}{a}\right)=\frac{1}{a}\left\langle \shah_{1/a},\varphi\right\rangle
\end{align*}
\end{proof}

其三是周期化：$$\shah_T*f(t)=f_T(t)=\sum_{k=-\infty}^{\infty}f(t-kT)$$
在\ref{sub:operation_of_distribution}中，我们曾建立了$\delta_a$的平移性质：$\delta_a*f=\tau_a f$，只要函数项级数$\sum_{k=-\infty}^{\infty}f(t-kT)$收敛，自然就可以把它写成卷积的形式。

对于一个施瓦兹函数，以上的式子中均不会出现收敛性的问题。回顾施瓦兹函数类的定义：
\[\mathcal{S} =\left\{\varphi\in C^{\infty}(\mathbb{R} )\left|\lim_{|x|\to\infty}|x|^m\varphi^{(n)}(x)=0,\forall m,n\in\mathbb{N} \right.\right\}\]
对任意的t，考察级数$\sum_{k=-\infty}^{\infty}f(t-kT)$的收敛性时，只需要将n取为0，m取为不小于2的整数，则在$|k|$充分大时，级数比$C/n^2$更小，从而绝对收敛。注意这种估计方式并不依赖于自变量t的选取，因此这个函数项级数一致收敛，其和函数会保留$f(t)$的许多分析性质，例如我们可以逐项求导（从而和函数也无限阶可导）、逐项积分，还可以交换求和符号与其他极限过程的顺序（见数学分析教材，如\cite{zorich}\cite{xinjiang}）。

\subsection{泊松求和公式}\label{sub:possion_summation}
本小节旨在说明\textbf{泊松求和公式}(the Poisson summation formula)，它揭示了傅里叶级数与傅里叶变换的深刻关系。
\begin{theorem}[泊松求和公式]
\begin{align*}
    \sum_{k=-\infty}^{\infty}\varphi(k)=\sum_{k=-\infty}^{\infty}\mathcal{F} \varphi(k)
\end{align*}
\end{theorem}
\begin{proof}
考虑函数$f\in\mathcal{S} $，记其周期化函数为$\Phi=\shah*\varphi$，并将$\Phi$的傅里叶系数记为$\hat{\Phi}(k)$，由$\Phi$的无限阶可导性可知其傅里叶级数绝对一致收敛于它本身（这里只需要逐点收敛性，至于更强的收敛性，见\ref{sub:uniform_converge}），即
\[\Phi(t)=\sum_{k=-\infty}^{\infty}\hat{\Phi}(k)e^{2\pi ikt}\]
其中
\begin{align*}
    \hat{\Phi}(k)&=\int_{0}^{1}\Phi(t)e^{-2\pi ikt}\,dt\\
    &=\int_{0}^{1}\left(\sum_{n=-\infty}^{\infty}\varphi(t-n)\right)e^{-2\pi ikt}\,dt\\
    &=\sum_{n=-\infty}^{\infty}\left(\int_{0}^{1}\varphi(t-n)e^{-2\pi ikt}\,dt\right)\\
    &=\sum_{n=-\infty}^{\infty}\left(\int_{n}^{n+1}\varphi(t)e^{-2\pi ik(t+n)}\,dt\right)   &(t\to t+n)\\
    &=\sum_{n=-\infty}^{\infty}\int_{n}^{n+1}\varphi(t) e^{-2\pi ikt}\,dt\\
    &=\int_{-\infty}^{\infty}\varphi(t)e^{-2\pi ikt}\,dt
\end{align*}
即\begin{align*}
    \hat{\Phi}(k)=\mathcal{F} \varphi(k)
\end{align*}
证明中，第二行到第三行的积分与求和的换序用到了周期化函数作为函数项级数的一致收敛性。这个等式意味着对时限函数的关系$\mathcal{F} f(k)=Tc_k$对施瓦兹函数都成立（以上是周期化为$T=1$的情况，读者可以自行推广至周期为其他值的情况），进一步，在恒等式
\begin{align*}
    \Phi(t)&=\sum_{k=-\infty}^{\infty}\hat{\Phi}(k)e^{2\pi ikt}=\sum_{k=-\infty}^{\infty}\mathcal{F} \varphi(k)e^{2\pi ikt}
\end{align*}
中取$t=0$，则得到
\begin{align*}
\Phi(0)=\sum_{k=-\infty}^{\infty}\mathcal{F} \varphi(k)
\end{align*}
又由\[\Phi=\shah*\varphi,\Phi(0)=\sum_{k=-\infty}^{\infty}\varphi(k)\]
得证。
\end{proof}

我们当然也可以对$\shah_T*\varphi$做类似的推导，但其结论远不如以上两式简洁，这实际上是整数集$\mathbb{Z}$的自对偶性的体现。

\subsection{狄拉克梳状分布的傅里叶变换}\label{sub:fourier_of_dirac_comb}
借助泊松求和公式，可以得到$\shah$分布的傅里叶变换：
\begin{align*}
    \left\langle \mathcal{F} \shah,\varphi \right\rangle=\left\langle \shah,\mathcal{F} \varphi\right\rangle=\sum_{k=-\infty}^{\infty}\mathcal{F} \varphi(k)=\sum_{k=-\infty}^{\infty}\varphi(k)=\left\langle \shah,\varphi\right\rangle
\end{align*}
即
\begin{proposition}[$\shah$的傅里叶变换]
\begin{align*}
    \mathcal{F} \shah=\shah
\end{align*}
\end{proposition}
可以看到，$\shah$分布的傅里叶变换具有自对偶性，即$\shah\overset{\mathcal{F} }{\longleftrightarrow}\shah$

利用以上结果，我们来讨论周期化在频域上的行为。对$f*\shah_T$做傅里叶变换，有
\begin{align*}
    \mathcal{F} (f*\shah_T)(\xi)=&\mathcal{F} f(\xi)\cdot\mathcal{F} \shah_T(\xi)\\
    =&\mathcal{F} f(\xi)\cdot\frac{1}{T}\shah_{1/T}(\xi)\\
    =&\frac{1}{T}\sum_{k=-\infty}^{\infty}\mathcal{F} f(k/T)\delta_{k/T}(\xi)
\end{align*}
可以看到，将f以周期T进行周期化时，其频谱会剩下频率为$k/T$处，也即角频率为$2\pi k/T$处的值，并且在这些频率处以$\delta$分布的形式“趋于无穷”。

根据分布的傅里叶变换的连续性（见\ref{sub:operation_of_distribution}最后的内容），我们还可以直接对$\shah$分布的傅里叶变换做另一种推导：
\begin{align*}
     \mathcal{F} \shah&= \mathcal{F} \left(\lim_{N\to\infty}\sum_{k=-N}^{N}\delta_k\right)\\
    &=\lim_{N\to\infty}\sum_{k=-N}^{N}\mathcal{F} \delta_k\\
    &=\lim_{N\to\infty}\sum_{k=-N}^{N}e^{-2\pi ikx}\\
    &=\sum_{k=-\infty}^{\infty}e^{-2\pi ikx}
\end{align*}

结合$\shah$的傅里叶变换公式可以得到$\shah$分布作为形式上的函数的另一种定义。实际上，这就是$\shah$作为一个周期分布的傅里叶级数展开（分布的周期性是通过$\tau_1 \shah=\shah$体现的）：
\begin{definition}[$\shah$的傅里叶级数形式]
    \[\shah(x)=\sum_{k=-\infty}^{\infty}e^{-2\pi ikx}\]
\end{definition}
右边正是\ref{sub:dirichlet_kernel}中提到的狄利克雷核在$N\to\infty$时的式子。需要注意，这个式子仅在分布的意义下成立，例如将这个分布作用在某一区间的特征函数$\chi_{[a,b]}\in\mathcal{S}$上，则可验证函数项级数$$\sum_{k=-\infty}^{\infty}e^{-2\pi ikx}$$在整数点处趋于正无穷，在任意不包含整数点的区间上积分值为0。然而，作为函数项级数，我们只能得到整数点处的广义极限存在，这是一个几乎处处不收敛的函数项级数，例如在$x=1/2$处，级数项为$(-1)^k$，其和函数在多数点没有定义，只能作为奇异分布来定义。

根据角频率形式下的$\shah$分布的傅里叶变换，可以想到$\shah$的伸缩的傅里叶变换仍具有
$\shah$的形式，下面就来找出具体的公式：
\begin{proposition}[$\shah_T$的傅里叶变换]
\begin{align*}
    \mathcal{F} \shah_T=\frac{1}{T}\shah_{1/T}
\end{align*}
\end{proposition}
\begin{proof}
\begin{align*}
    \mathcal{F} \shah_T=\mathcal{F} \left[\frac{1}{T}\sigma_{1/T}\shah\right]=\sigma_T\shah=\frac{1}{T}\shah_{1/T}
\end{align*}
\end{proof}

可以看到，傅里叶变换前后$\delta$的位置具有倒数关系。事实上，在多维傅里叶变换的理论中，我们还将看到更为深刻的关系。直观上，我们曾提出对函数和分布的一维傅里叶变换的伸缩定理：
\[f(at)\overset{\mathcal{F} }{\longleftrightarrow}\frac{1}{|a|}F\left(\frac{\xi}{a}\right),\sigma_a T\overset{\mathcal{F} }{\longleftrightarrow}\frac{1}{|a|}\sigma_{1/a}\mathcal{F} T\]
它同样揭示了时域伸而频域缩，时域缩而频域伸的关系，而$\shah_T$为我们提供了一种新的视角。对多维的$\shah$分布的讨论，见\ref{sec:Multi_Fourier}。二维$\shah$分布在$\mathbb{R}^3$中的图像就像一个“钉床”，因此又可以将$\shah$分布称为\textbf{钉床函数}(bed of nails)。

\section{理想采样}\label{sec:Ideal_Sample}

\subsection{带限函数}\label{sub:band_limit}

\begin{definition}[时限函数与带限函数]
    时域上紧支（即支集$\text{supp}\ f$有界）的函数称为\textbf{时限函数}；相应的，在频域上紧支的函数称为\textbf{带限函数}。
\end{definition}

对于带限函数，有以下恒等式：
\[\mathcal{F} f=\chi_{[-T/2,T/2]}\mathcal{F} f\]
取傅里叶逆变换可得
\begin{theorem}[采样函数的“卷积幺元”作用]
    设带限函数$f(t)$满足$$\text{supp}\ \mathcal{F} f\subset [-T/2,T/2]$$
    则\begin{align*}
    f(t)=T\text{sinc}(Tt)*f(t)
\end{align*}
可见对于带限函数，采样信号能够起到类似$\delta$的卷积幺元的作用。
\end{theorem}
\begin{proof}
    由恒等式$\mathcal{F} f=\chi_{[-T/2,T/2]}\mathcal{F} f$，对两边同时取傅里叶逆变换，得到
    \begin{align*}
        f(t)&=\mathcal{F} ^{-1}(\chi_{[-T/2,T/2]}\mathcal{F} f)(t)\\
               &=\left(\mathcal{F} ^{-1}\chi_{[-T/2,T/2]}\right)*\left(\mathcal{F} ^{-1}\mathcal{F} f\right)(t)\\
               &=\left(\mathcal{F} ^{-1}\chi_{[-T/2,T/2]}\right)*f(t)\\
               &=T\text{sinc}(Tt)*f(t)
    \end{align*}
\end{proof}

\subsection{香农采样定理}\label{sub:shannon}
本小节旨在说明以下定理：
\begin{theorem}[香农采样定理]
    如果已知信号的频谱支于$[-\nu_m,\nu_m]$，则采样频率必须大于$2\nu_m$，即奈奎斯特频率$f_N$，才能还原出原信号\cite{brad_osgood_ee261}。
\end{theorem}
有时也将奈奎斯特频率称为信号的\textbf{带宽}(bandwidth)，但在另一些文献中\cite{signal_systems}，实信号的带宽不考虑负频率，值为奈奎斯特频率的一半。
另一方面，先周期化再乘以特征函数，所得的恒等式称为\textbf{采样定理}(the Sampling theorem)：
\begin{theorem}[采样定理]
    \[\mathcal{F} f(x)=\chi_{[-T/2,T/2]}(\mathcal{F} f*\shah_T)(x)\]
    其中$T=1/2\nu_m$，对应频率$f_N=1/T$被称为\textbf{奈奎斯特频率}(Nyquist frequency)。
\end{theorem}
对其做傅里叶反变换，有\begin{align*}
    f(t)&=\mathcal{F} ^{-1} [\chi_{[-T/2,T/2]}(\mathcal{F} f*\shah_T)](t)\\
    &=T\text{sinc}(Tt)*\mathcal{F} ^{-1} \left(\mathcal{F} f*\shah_T\right)\\
    &=\text{sinc}(Tt)*\left(\sum_{k=-\infty}^{\infty}f\left(\frac{k}{T}\right)\delta_{k/T}(t)\right)\\
    &=\sum_{k=-\infty}^{\infty}f\left(\frac{k}{T}\right)\text{sinc}\left(T\left(t-\frac{k}{T}\right)\right)\\
    &=\sum_{k=-\infty}^{\infty}f\left(\frac{k}{T}\right)\text{sinc}(Tt-k)
\end{align*}
因此有\begin{theorem}
\begin{align*}
    f(t)=\sum_{k=-\infty}^{\infty}f\left(\frac{k}{T}\right)\text{sinc}(Tt-k)
\end{align*}
\end{theorem}
这正是\textbf{理想采样}下，由采样函数恢复出原函数的方法也即\textbf{香农采样定理}(Shannon Sampling theorem)中采样率取奈奎斯特频率时的极限情况。它与上一节中讨论的拉格朗日插值有一定的相似之处。$\text{sinc}$函数在非零整数点处的值为0，在0处的值为1，于是可以直接利用每个数据点处的值限定所还原出信号在这一点的值，换言之，在以下这种公式所代表的插值方式下，数据点处的值是不会产生偏移的，$\text{Sa}$函数同理。不同的是，拉格朗日插值法在数据点以外的位置往往会有误差，而以上插值方法在没有产生混叠现象时是精确的。

\subsection{混叠现象}\label{sub:alias}
我们已经说明了采样率不低于奈奎斯特频率时的信号还原方法，下面来说明为什么奈奎斯特频率时极限情况。直观上，采样频率越高，所需要的成本就越高，提供的信息就越多，而如果采样频率低于$f_N$，将发生\textbf{混叠}(alias)现象，还原所得的信号将产生失真。下图展示了正弦波的混叠：
\begin{figure}[H]
    \centering
    \includegraphics[width=0.4\textwidth]{cos.jpeg}
    \caption{正弦波的混叠现象}
\end{figure}

从频域上不难理解它。我们来看抽样时到底发生了什么。对$f(t)$进行采样，相当于将$f(t)$与$\shah_T$\\
相乘，在频域上则相当于$\mathcal{F} f(\xi)$与$\mathcal{F} \shah_T(\xi)$的卷积，即
\begin{align*}
    \mathcal{F} (f\cdot\shah_T)(\xi)=\mathcal{F} f(\xi)*\mathcal{F} \shah_T(\xi)=\mathcal{F} f(\xi)*\frac{1}{T}\shah_{1/T}(\xi)=\frac{1}{T}\sum_{k=-\infty}^{\infty}\mathcal{F} f\left(\xi-\frac{k}{T}\right)
\end{align*}
可以看到，采样在频域上相当于将频谱进行周期化，采样频率为$f_s$，采样间隔$T_s=1/f_s$，它也是我们所使用的采样信号$\shah_T$的周期；频谱周期宽度为$f_s$，与$\shah_{1/T}$做卷积，相当于以$f_s=1/T_s$为周期进行周期化。如果采样频率不低于奈奎斯特频率$f_N$，则频谱在周期化的过程中未发生交叠，可以用特征函数$\chi_{[-\nu_m,\nu_m]}$还原；而如果采样频率$f_s$低于奈奎斯特频率$f_N$，则周期化后的频谱会发生重叠，如图所示：
\begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{alias.jpeg}
    \caption{混叠的频域分析}
\end{figure}

在建立采样定理时我们曾要求
$$\text{supp}\ \mathcal{F} f\subset[-\nu_m,\nu_m]$$
如果频谱在周期化时重叠，那么用先前得到的公式
\begin{align*}
    f(t)=\sum_{k=-\infty}^{\infty}f\left(\frac{k}{T}\right)\text{sinc}(Tt-k)
\end{align*}
还原函数当然是有误差的，乘以$\chi_{[-\nu_m,\nu_m]}$，会丢掉一部分原有频谱，并叠加一部分平移后的频谱。

\subsection{*有限采样公式}\label{sub:finite_sampling}
本小节旨在建立带限周期信号的有限采样公式，以处理实际问题中只能进行有限次采样的情况。

我们首先引入一个引理：
\begin{lemma}
    设$f_s,T>0$，正整数$N$为严格小于$\dfrac{T f_s}{2}$的最大整数，则$\forall t\in\mathbb{R}$，有
    \begin{align*}
        \text{sinc}\left(f_s t\right)*\shah_T=\frac{1}{T f_s}\frac{\sin\left((2N+1)\pi t/T\right)}{\sin\left(\pi t/T\right)}=\frac{2N+1}{T f_s}\frac{\text{sinc}\left((2N+1)t/T\right)}{\text{sinc}\left(t/T\right)}
    \end{align*}
    特别地，$T f_s=2N+1$时，有
    \begin{align*}
        \text{sinc}\left(f_s t\right)*\shah_T=\frac{\text{sinc}\left(f_s t\right)}{\text{sinc}\left(t/T\right)}
    \end{align*}
\end{lemma}
\begin{remark}
    取$f_s=T=1,N=0$，可得$\text{sinc}(t)*\shah=1$。这里给出前$N$项和的图像：
    \begin{figure}[H]
        \centering
        \includegraphics[width=0.8\textwidth]{sinc_shah.jpeg}
        \caption{$\text{sinc}(t)*\shah$的前N项和}
    \end{figure}
    它与方波很接近，并且出现了吉布斯现象。将部分和$S_N(t)=\sum_{k=-N}^{N}\text{sinc}(t-k)$视为采样率为1的情况下，对时宽为$2N$的方波进行还原的结果，则随着$N$的增大，采样点增多，结果越来越接近$\mathds{1}$。方波不是带限信号，吉布斯现象可以视为混叠的结果，但由于频带能量集中于低频，所以在大部分区域上，这种还原结果仍然较好地逼近了方波。
\end{remark}
\begin{proof}
    取傅里叶变换：
\begin{align*}
    \mathcal{F} \left[\text{sinc}\left(f_s t\right)*\shah_T\right](\xi)&=\mathcal{F} \left[\text{sinc}\left(f_s t\right)\right](\xi)\cdot\mathcal{F} \shah_T(\xi)\\
    &=\frac{1}{f_s}\chi_{[-f_s/2,f_s/2]}(\xi)\cdot\frac{1}{T}\shah_{1/T}(\xi)\\
    &=\frac{1}{T f_s}\sum_{k=-\infty}^{\infty}\chi_{[-f_s/2,f_s/2]}\left(\xi-\frac{k}{T}\right)\delta_{k/T}\\
    &=\frac{1}{T f_s}\sum_{k=-N}^{N}\delta_{k/T}(\xi)
\end{align*}
对上式取傅里叶逆变换，有
\begin{align*}
    \text{sinc}\left(f_s t\right)*\shah_T&=\mathcal{F} ^{-1}\left(\frac{1}{T f_s}\sum_{k=-N}^{N}\delta_{k/T}(\xi)\right)(t)\\
    &=\frac{1}{T f_s}\sum_{k=-N}^{N}e^{2\pi ikt/T}\\
    &=\frac{1}{T f_s}\frac{\sin\left((2N+1)\pi t/T\right)}{\sin\left(\pi t/T\right)}\\
    &=\frac{2N+1}{T f_s}\frac{\text{sinc}\left((2N+1)t/T\right)}{\text{sinc}\left(t/T\right)}
\end{align*}
第二行到第三行其实就是狄利克雷核的相关公式，见\ref{sub:dirichlet_kernel}，可以通过等比数列求和公式得到：\begin{align*}
    \sum_{k=-N}^{N}e^{2\pi ikt/T}&=e^{-2\pi iNt/T}\frac{1-e^{2\pi i(2N+1)t/T}}{1-e^{2\pi it/T}}\\
    &=\frac{e^{-\pi i(2N+1)t/T}-e^{\pi i(2N+1)t/T}}{e^{-\pi it/T}-e^{\pi it/T}}\\
    &=\frac{\sin\left((2N+1)\pi t/T\right)}{\sin\left(\pi t/T\right)}
\end{align*}
\end{proof}
\begin{proposition}[有限采样公式]
    设$f(t)$周期为$T$，且带限于$[-\nu_m,\nu_m]$，取$f_s$满足
    $$f_s=1/T_s=\frac{2N+1}{T}\geq 2\nu_m$$
    $2N+1$为采样点数（可由上面对$f_s$提出的要求算得$N\geq T\nu_m-\dfrac{1}{2}$），则$f(t)$可以用一个周期内的有限个采样点$t_k=kT_s,k\in\{0,1,\cdots,2N\}$还原：
    \begin{align*}
        f(t)=\sum_{k=0}^{2N}f(t_k)\frac{\text{sinc}\left(f_s(t-t_k)\right)}{\text{sinc}\left(\frac{1}{T}(t-t_k)\right)}
    \end{align*}
\end{proposition}
\begin{figure}[H]
    \centering
    \includegraphics[width=0.6\textwidth]{finite_Sample.jpeg}
    \caption{有限采样公式示意图}
\end{figure}
\begin{proof}
由于$f$带限，可以设$f(t)$的傅里叶级数为
\begin{align*}
    f(t)=\sum_{n=-N}^{N}c_n e^{2\pi int/T}
\end{align*}
这样，其频域是支于$[-N/T,N/T]\subset[-\nu_m,\nu_m]$的：
\begin{align*}
    \mathcal{F}f(\xi)=\sum_{n=-N}^{N}c_n \delta\left(\xi-\frac{n}{T}\right)
\end{align*}
用$\shah_{T_s}$进行采样，在频域上相当于以$f_s$为周期进行周期化，由香农采样定理，有
\begin{align*}
    f(t)=\sum_{k=-\infty}^{\infty}f(t_k)\text{sinc}\left(f_s(t-t_k)\right)
\end{align*}
其中采样点$t_k=kT_s$。由于$f(t)$周期为$T$，我们可以对上式进行分组求和：
\begin{align*}
    f(t)&=\sum_{m=-\infty}^{\infty}\sum_{k=0}^{2N}f\left(t_{k+m(2N+1)}\right)\text{sinc}\left(f_s(t-t_{k+m(2N+1)})\right)\\
    &=f(t_0)\sum_{m=-\infty}^{\infty}\text{sinc}\left(f_s(t-mT)\right)+f(t_1)\sum_{m=-\infty}^{\infty}\text{sinc}\left(f_s(t-mT-T_s)\right)+\cdots\\
    &\quad +f(t_{2N})\sum_{m=-\infty}^{\infty}\text{sinc}\left(f_s(t-mT-2N T_s)\right)\\
    &=f(t_0)\text{sinc}\left(f_s t\right)*\shah_T+f(t_1)\text{sinc}\left(f_s (t-T_s)\right)*\shah_T+\cdots\\
    &\quad +f(t_{2N})\text{sinc}\left(f_s (t-2N T_s)\right)*\shah_T\\
    &=\sum_{m=0}^{2N}f(t_m)\left[\text{sinc}\left(f_s (t-m T_s)\right)*\shah_T\right]
\end{align*}
\end{proof}

%这一节就来讨论真实系统中的插值方法，包括自然采样、零阶采样保持、一阶采样保持以及降低采样率的一些办法。最后，还将给出有限采样公式，它从数学上给出了用有限的采样点还原带限周期信号的方法。

%自然采样PS6.2(4也有点意思)
%降低采样率的想法
%final2006.2，或许跟一阶采样保持相通？
%零阶采样保持，一阶采样保持

\section{多维傅里叶变换}\label{sec:Multi_Fourier}

这一节中，我们将傅里叶变换推广到高维。由于时间总是一维的，高维傅里叶变换往往指空间域，因此我们将用$\mathbf{x}=(x_1,x_2,\cdots,x_n)$表示n维的空间变量，$\boldsymbol{\xi}=(\xi_1,\xi_2,\cdots,\xi_n)$表示n维的空间频率，$\boldsymbol{\omega}=(\omega_1,\omega_2,\cdots,\omega_n)$表示n维的空间角频率。多维傅里叶变换在图像处理、计算机视觉等领域有着重要的应用。

\subsection{多维傅里叶变换的定义}\label{sub:multi_fourier}

\begin{definition}[n维傅里叶变换]
设$f\in L^1(\mathbb{R}^n)$，则其n维傅里叶变换定义为：
\begin{lralign}
    \mathcal{F} f(\boldsymbol{\xi})&=\int_{\mathbb{R}^n}f(\mathbf{x})e^{-2\pi i\mathbf{x}\cdot\boldsymbol{\xi}}\,d\mathbf{x}
\switch
    \mathcal{F} f(\boldsymbol{\omega})&=\int_{\mathbb{R}^n}f(\mathbf{x})e^{-i\mathbf{x}\cdot\boldsymbol{\omega}}\,d\mathbf{x}
\end{lralign}
我们仍记$f\overset{\mathcal{F} }{\longleftrightarrow}F$并称$f$与$F$构成\textbf{傅里叶变换对}。
\end{definition}

类似一维傅里叶变换，我们来验证$f\in L^1(\mathbb{R}^n)$时，其多维傅里叶变换是有界的、一致连续的。
\begin{proposition}
    设$f\in L^1(\mathbb{R}^n)$，则其n维傅里叶变换$\mathcal{F} f$是有界的、一致连续的。
\end{proposition}
\begin{proof}
    有界性：由定义，有
\begin{lralign}
    |\mathcal{F} f(\boldsymbol{\xi})|&=\left|\int_{\mathbb{R}^n}f(\mathbf{x})e^{-2\pi i\mathbf{x}\cdot\boldsymbol{\xi}}\,d\mathbf{x}\right|\\
    &\leq \int_{\mathbb{R}^n}|f(\mathbf{x})||e^{-2\pi i\mathbf{x}\cdot\boldsymbol{\xi}}|\,d\mathbf{x}\\
    &= \int_{\mathbb{R}^n}|f(\mathbf{x})|\,d\mathbf{x}\\
    &=\|f\|_1<\infty
\switch
    |\mathcal{F} f(\boldsymbol{\omega})|&=\left|\int_{\mathbb{R}^n}f(\mathbf{x})e^{-i\mathbf{x}\cdot\boldsymbol{\omega}}\,d\mathbf{x}\right|\\
    &\leq \int_{\mathbb{R}^n}|f(\mathbf{x})||e^{-i\mathbf{x}\cdot\boldsymbol{\omega}}|\,d\mathbf{x}\\
    &= \int_{\mathbb{R}^n}|f(\mathbf{x})|\,d\mathbf{x}\\
    &=\|f\|_1<\infty
\end{lralign}
一致连续性：设$\boldsymbol{\xi},\boldsymbol{\eta}\in\mathbb{R}^n$，则
\begin{lralign}
    &|\mathcal{F} f(\boldsymbol{\xi})-\mathcal{F} f(\boldsymbol{\eta})|\\
    =&\left|\int_{\mathbb{R}^n}f(\mathbf{x})\left(e^{-2\pi i\mathbf{x}\cdot\boldsymbol{\xi}}-e^{-2\pi i\mathbf{x}\cdot\boldsymbol{\eta}}\right)\,d\mathbf{x}\right|\\
    \leq& \int_{\mathbb{R}^n}|f(\mathbf{x})|\left|e^{-2\pi i\mathbf{x}\cdot\boldsymbol{\xi}}-e^{-2\pi i\mathbf{x}\cdot\boldsymbol{\eta}}\right|\,d\mathbf{x}
\switch
    &|\mathcal{F} f(\boldsymbol{\omega})-\mathcal{F} f(\boldsymbol{\nu})|\\
    =&\left|\int_{\mathbb{R}^n}f(\mathbf{x})\left(e^{-i\mathbf{x}\cdot\boldsymbol{\omega}}-e^{-i\mathbf{x}\cdot\boldsymbol{\nu}}\right)\,d\mathbf{x}\right|\\
    \leq& \int_{\mathbb{R}^n}|f(\mathbf{x})|\left|e^{-i\mathbf{x}\cdot\boldsymbol{\omega}}-e^{-i\mathbf{x}\cdot\boldsymbol{\nu}}\right|\,d\mathbf{x}
\end{lralign}
由于$e^{-2\pi i\mathbf{x}\cdot\boldsymbol{\xi}}$与$e^{-i\mathbf{x}\cdot\boldsymbol{\omega}}$均为一致连续函数，$\forall\epsilon>0,\exists\delta>0$，使得\begin{lralign}
    &|\boldsymbol{\xi}-\boldsymbol{\eta}|<\delta\\
    \implies &|e^{-2\pi i\mathbf{x}\cdot\boldsymbol{\xi}}-e^{-2\pi i\mathbf{x}\cdot\boldsymbol{\eta}}|<\frac{\epsilon}{\|f\|_1},\forall \mathbf{x}\in\mathbb{R}^n\\
    \implies &|\mathcal{F} f(\boldsymbol{\xi})-\mathcal{F} f(\boldsymbol{\eta})|<\epsilon
\switch
    &|\boldsymbol{\omega}-\boldsymbol{\nu}|<\delta\\
    \implies &|e^{-i\mathbf{x}\cdot\boldsymbol{\omega}}-e^{-i\mathbf{x}\cdot\boldsymbol{\nu}}|<\frac{\epsilon}{\|f\|_1},\forall \mathbf{x}\in\mathbb{R}^n\\
    \implies &|\mathcal{F} f(\boldsymbol{\omega})-\mathcal{F} f(\boldsymbol{\nu})|<\epsilon
\end{lralign}
\end{proof}

此外，黎曼-勒贝格引理仍然成立：
\begin{claim}[n维黎曼-勒贝格引理]
    设$f\in L^1(\mathbb{R}^n)$，则其n维傅里叶变换$\mathcal{F} f$满足
    \begin{lralign}
    \lim_{|\boldsymbol{\xi}|\to\infty}\mathcal{F} f(\boldsymbol{\xi})&=0
\switch
    \lim_{|\boldsymbol{\omega}|\to\infty}\mathcal{F} f(\boldsymbol{\omega})&=0
\end{lralign}
\end{claim}

不难想到，傅里叶逆变换为：
\begin{definition}[n维傅里叶逆变换]
    设$F\in L^1(\mathbb{R}^n)$，则其n维傅里叶逆变换为：
    \begin{lralign}
    \mathcal{F} ^{-1} F(\mathbf{x})&=\int_{\mathbb{R}^n}F(\boldsymbol{\xi})e^{2\pi i\mathbf{x}\cdot\boldsymbol{\xi}}\,d\boldsymbol{\xi}
\switch
    \mathcal{F} ^{-1} F(\mathbf{x})&=\frac{1}{(2\pi)^n}\int_{\mathbb{R}^n}F(\boldsymbol{\omega})e^{i\mathbf{x}\cdot\boldsymbol{\omega}}\,d\boldsymbol{\omega}
\end{lralign}
\end{definition}

傅里叶反演公式仍然成立，因此n维傅里叶变换也是一一的，从而前文中傅里叶变换对的记号$f\overset{\mathcal{F} }{\longleftrightarrow}F$是合理的。
\begin{claim}[n维傅里叶反演公式]
    设$f\in L^1(\mathbb{R}^n)$且$\mathcal{F} f\in L^1(\mathbb{R}^n)$，则
    \begin{lralign}
    f(\mathbf{x})&=\int_{\mathbb{R}^n}\mathcal{F} f(\boldsymbol{\xi})e^{2\pi i\mathbf{x}\cdot\boldsymbol{\xi}}\,d\boldsymbol{\xi}
\switch
    f(\mathbf{x})&=\frac{1}{(2\pi)^n}\int_{\mathbb{R}^n}\mathcal{F} f(\boldsymbol{\omega})e^{i\mathbf{x}\cdot\boldsymbol{\omega}}\,d\boldsymbol{\omega}
\end{lralign}
\end{claim}
\begin{remark}
    多维情况下很难讲清楚什么是“左右极限平均值”，一种处理方式是通过球平均在半径趋于0时的极限来替代$\dfrac{f(t+)+f(t-)}{2}$，但这样比较复杂，因此我们不妨说$\mathcal{F} f$的傅里叶逆变换几乎处处收敛到$f$，或者要求$f\in C(\mathbb{R}^n)$。
\end{remark}

为了说明空间角频率形式的傅里叶逆变换的系数$\dfrac{1}{(2\pi)^n}$的由来，我们可以令$\boldsymbol{\omega}=2\pi\boldsymbol{\xi}$，则$d\boldsymbol{\omega}=(2\pi)^n d\boldsymbol{\xi}$，以上两种傅里叶逆变换的公式是等价的。

下面给出几个例子来建立多维傅里叶变换的直观。
\begin{definition}[可分函数]
    $f(\mathbf{x}):\mathbb{R}^n\to\mathbb{C}$是一个可分函数，即如果存在$n$个一维函数$f_i(x_i):\mathbb{R}\to\mathbb{C},i=1,2,\cdots,n$，使得
    \begin{align*}
        f(\mathbf{x})=f_1(x_1)f_2(x_2)\cdots f_n(x_n)
    \end{align*}
\end{definition}
$f(\mathbf{x})$的傅里叶变换为：

{\color{blue}
\begin{align*}
\mathcal{F} f(\boldsymbol{\xi})&=\int_{\mathbb{R}^n}f(\mathbf{x})e^{-2\pi i \mathbf{x}\cdot\boldsymbol{\xi}}\,d\mathbf{x}\\
&=\int_{-\infty}^{\infty}\cdots \int_{-\infty}^{\infty}f_1(x_1)f_2(x_2)\cdots f_n(x_n)e^{-2\pi i (x_1\xi_1+x_2\xi_2+\cdots +x_n\xi_n)}\,dx_1 dx_2\cdots dx_n\\
&=\left(\int_{-\infty}^{\infty}f_1(x_1)e^{-2\pi i x_1\xi_1}\,dx_1\right)\left(\int_{-\infty}^{\infty}f_2(x_2)e^{-2\pi i x_2\xi_2}\,dx_2\right)\cdots \left(\int_{-\infty}^{\infty}f_n(x_n)e^{-2\pi i x_n\xi_n}\,dx_n\right)\\
&=\mathcal{F} f_1(\xi_1)\mathcal{F} f_2(\xi_2)\cdots \mathcal{F} f_n(\xi_n)
\end{align*}}
{\color{red}
\begin{align*}
\mathcal{F} f(\boldsymbol{\omega})&=\int_{\mathbb{R}^n}f(\mathbf{x})e^{-i \mathbf{x}\cdot\boldsymbol{\omega}}\,d\mathbf{x}\\
&=\int_{-\infty}^{\infty}\cdots \int_{-\infty}^{\infty}f_1(x_1)f_2(x_2)\cdots f_n(x_n)e^{-i (x_1\omega_1+x_2\omega_2+\cdots +x_n\omega_n)}\,dx_1 dx_2\cdots dx_n\\  
&=\left(\int_{-\infty}^{\infty}f_1(x_1)e^{-i x_1\omega_1}\,dx_1\right)\left(\int_{-\infty}^{\infty}f_2(x_2)e^{-i x_2\omega_2}\,dx_2\right)\cdots \left(\int_{-\infty}^{\infty}f_n(x_n)e^{-i x_n\omega_n}\,dx_n\right)\\
&=\mathcal{F} f_1(\omega_1)\mathcal{F} f_2(\omega_2)\cdots \mathcal{F} f_n(\omega_n)
\end{align*}}
也就是说，空间域上可分的函数，其傅里叶变换也是可分的，且每个分量的傅里叶变换正是对应一维函数的傅里叶变换。

\begin{example}[高斯函数]
    高斯函数是可分的：
    \begin{align*}
        f(\mathbf{x})=e^{-\pi(x_1^2+x_2^2+\cdots +x_n^2)}=e^{-\pi x_1^2}e^{-\pi x_2^2}\cdots e^{-\pi x_n^2}
    \end{align*}
    我们仍考虑这个特殊的高斯函数，并指出其他高斯函数可以通过下一小节中介绍的运算性质得到。一维高斯函数的傅里叶变换为：
    \begin{lralign}
    \mathcal{F} \left(e^{-\pi x^2}\right)(\xi)&=e^{-\pi \xi^2}
\switch
    \mathcal{F} \left(e^{-\pi x^2}\right)(\omega)&=e^{-\frac{\omega^2}{4\pi}}
    \end{lralign}
    因此，n维高斯函数的傅里叶变换为：
    \begin{lralign}
    \mathcal{F} f(\boldsymbol{\xi})=e^{-\pi(\xi_1^2+\xi_2^2+\cdots +\xi_n^2)}=e^{-\pi |\boldsymbol{\xi}|^2}\quad
\switch
    \mathcal{F} f(\boldsymbol{\omega})=e^{-(\omega_1^2+\omega_2^2+\cdots +\omega_n^2)/4\pi}=e^{-|\boldsymbol{\omega}|^2/4\pi}\quad
    \end{lralign}
    \end{example}
    \begin{figure}[H]
        \centering
        \includegraphics[width=0.5\textwidth]{n_gauss.jpeg}
        \caption{二维高斯函数的图像}
    \end{figure}

\begin{example}[矩形函数]
    n维空间中的矩形函数是n维“长方体”的特征函数。由于这种长方体是区间(Interval)的笛卡尔积，是n维空间中区间的推广，我们仍称之为区间并用$I$表示：
    \begin{align*}
        I=[a_1,b_1]\times[a_2,b_2]\times\cdots \times[a_n,b_n]
    \end{align*}
    n维矩形函数记为$\chi_I$。简洁起见，这里计算一个特殊的矩形函数$\chi_I$，其中$I=[-T/2,T/2]$：
    \begin{lralign}
    \mathcal{F} \left(\chi_{[-T/2,T/2]}\right)(\xi)&=T\text{sinc}(T\xi)
\switch
    \mathcal{F} \left(\chi_{[-T/2,T/2]}\right)(\omega)&=T\text{Sa}\left(\frac{T\omega}{2}\right)
    \end{lralign}
    因此，$I=[-T/2,T/2]^n$时，n维矩形函数的傅里叶变换为：
    \begin{lralign}
    \mathcal{F} \chi_I(\boldsymbol{\xi})&=T^n \prod_{j=1}^n \text{sinc}(T\xi_j)
\switch
    \mathcal{F} \chi_I(\boldsymbol{\omega})&=T^n \prod_{j=1}^n \text{Sa}\left(\frac{T\omega_j}{2}\right)
    \end{lralign}
\end{example}

\begin{wrapfigure}{r}{0.5\textwidth}
    \centering
    \vspace{-20pt}
    \includegraphics[width=0.48\textwidth]{zero_phase.jpeg}
    \caption{二维空间中$e^{2\pi i \mathbf{x}\cdot\boldsymbol{\xi}}$的等相面示意图}
    \vspace{4em}
\end{wrapfigure}
下面考察$e^{2\pi i \mathbf{x}\cdot\boldsymbol{\xi}}$和$e^{i \mathbf{x}\cdot\boldsymbol{\omega}}$的性质。以$e^{2\pi i \mathbf{x}\cdot\boldsymbol{\xi}}$为例，对于给定的$\mathbf{\xi}$，令$$\boldsymbol{x\cdot\xi}=k(k\in\mathbb{Z})$$
则$$e^{2\pi i \mathbf{x}\cdot\boldsymbol{\xi}}=1$$
这时称$e^{2\pi i \mathbf{x}\cdot\boldsymbol{\xi}}$是\textbf{零相}(zero phase)的。
这些点构成了过原点且法向量为$\boldsymbol{\xi_0}$的超平面族，相邻零相面之间的距离为$1/|\boldsymbol{\xi}|$。类似地，可以定义\textbf{等相面}(constant phase surface)为
$$\left\{\mathbf{x}\in\mathbb{R}^n \mid \mathbf{x}\cdot\boldsymbol{\xi}=k+\theta,k\in\mathbb{Z},\theta\in[0,1)\right\}$$
的超平面族，法向量为$\boldsymbol{\xi_0}$，相邻等相面距离为$1/|\boldsymbol{\xi}|$。

\subsection{多维傅里叶变换的运算性质}\label{sub:operation_of_multi_fourier}

多维傅里叶变换的运算性质相较一维比较丰富，本小节中将分条列举这些性质。由于

\begin{proposition}[对偶性]
    设$f(\mathbf{x}):\mathbb{R}^n\to\mathbb{C}$，则有：
    \begin{lralign}
    &\mathcal{F} f^- =\mathcal{F} (f^-)=\mathcal{F} ^{-1} f\\
    &\mathcal{F} \left(\mathcal{F} f\right)=f
\switch
    &\mathcal{F} f^-=(2\pi)^n \mathcal{F} ^{-1} f\\
    &\mathcal{F} \left(\mathcal{F} f\right)=(2\pi)^n f^-
    \end{lralign}
    进一步，如果$f$是实函数，则有：
    \begin{lralign}
    \mathcal{F} f^-&=\overline{\mathcal{F} f}
\switch
    \mathcal{F} f^-&=(2\pi)^n \overline{\mathcal{F} f}
    \end{lralign}
\end{proposition}
\begin{proof}
    类似一维的情况（见\ref{sub:fourier_operation_properties}），带入定义可立即得到：
    \begin{lralign}
        \mathcal{F} f^-=\mathcal{F} (f^-)=\mathcal{F} ^{-1} f
    \switch
        \mathcal{F} f^-=(2\pi)^n \mathcal{F} ^{-1} f
    \end{lralign}
    同时取傅里叶变换，即得：
    \begin{lralign}
        \mathcal{F} \left(\mathcal{F} f\right)=f^-
\switch
        \mathcal{F} \left(\mathcal{F} f\right)=(2\pi)^n f^-
    \end{lralign}
    如果$f$是实函数，则$f=\overline{f}$，因此：
    \begin{lralign}
    \mathcal{F} f^-(\mathbf{\xi})&=\int_{\mathbb{R}^n}f(\mathbf{x})e^{2\pi i \mathbf{x}\cdot\boldsymbol{\xi}}\,d\mathbf{x}\\
    &=\overline{\int_{\mathbb{R}^n}}f(\mathbf{x})e^{-2\pi i \mathbf{x}\cdot\boldsymbol{\xi}}\,d\mathbf{x}\\
    &=\overline{\mathcal{F} f(\boldsymbol{\xi})}
\switch
    \mathcal{F} f^-(\mathbf{\omega})&=\int_{\mathbb{R}^n}f(-\mathbf{x})e^{-i \mathbf{x}\cdot\mathbf{\omega}}\,d\mathbf{x}\\
    &=\overline{\int_{\mathbb{R}^n}}f(\mathbf{x})e^{i \mathbf{x}\cdot\mathbf{\omega}}\,d\mathbf{x}\\
    &=(2\pi)^n \overline{\mathcal{F} f(\mathbf{\omega})}
    \end{lralign}
\end{proof}

\begin{corollary}[对称性]
    可仿照一维函数定义函数的奇偶性：如果$f(\mathbf{x})=f(-\mathbf{x})$，则称$f$为偶函数；如果$f(\mathbf{x})=-f(-\mathbf{x})$，则称$f$为奇函数。$\mathcal{F} f$与$f$具有相同的奇偶性；$f$是实函数时，如果$f$为偶函数，则$\mathcal{F} f$为实函数；如果$f$为奇函数，则$\mathcal{F} f$为纯虚函数。
\end{corollary}

\begin{proposition}[线性性]
    设$f(\mathbf{x}),g(\mathbf{x}):\mathbb{R}^n\to\mathbb{C}$，则有：
    \begin{lralign}
    \mathcal{F} [af(\mathbf{x})+bg(\mathbf{x})](\boldsymbol{\xi})&=a\mathcal{F} f(\boldsymbol{\xi})+b\mathcal{F} g(\boldsymbol{\xi})    
\switch
    \mathcal{F} [af(\mathbf{x})+bg(\mathbf{x})](\boldsymbol{\omega})&=a\mathcal{F} f(\boldsymbol{\omega})+b\mathcal{F} g(\boldsymbol{\omega})
    \end{lralign}
\end{proposition}
这个性质是显然的，它直接得自积分的线性性。

\begin{proposition}[平移定理]
    设$f(\mathbf{x}):\mathbb{R}^n\to\mathbb{C}$，时域上：
    \begin{lralign}
    \mathcal{F} \left[f(\mathbf{x}-\mathbf{a})\right](\boldsymbol{\xi})&=e^{-2\pi i \mathbf{a}\cdot\boldsymbol{\xi}}\mathcal{F} f(\boldsymbol{\xi})
\switch
    \mathcal{F} \left[f(\mathbf{x}-\mathbf{a})\right](\boldsymbol{\omega})&=e^{-i \mathbf{a}\cdot\boldsymbol{\omega}}\mathcal{F} f(\boldsymbol{\omega})
    \end{lralign}
    频域上：
    \begin{lralign}
    \mathcal{F} \left[e^{2\pi i \mathbf{a}\cdot\boldsymbol{\xi}}f(\mathbf{x})\right](\boldsymbol{\xi})&=f(\boldsymbol{\xi}-\mathbf{a})
\switch
    \mathcal{F} \left[e^{i \mathbf{a}\cdot\boldsymbol{\omega}}f(\mathbf{x})\right](\boldsymbol{\omega})&=f(\boldsymbol{\omega}-\mathbf{a})
    \end{lralign}
\end{proposition}
\begin{proof}
    \ding{172}时移性质，
    \begin{lralign}
    &\mathcal{F} \left[f(\mathbf{x}-\mathbf{a})\right](\boldsymbol{\xi})\\
    &=\int_{\mathbb{R}^n}f(\mathbf{x}-\mathbf{a})e^{-2\pi i \mathbf{x}\cdot\boldsymbol{\xi}}\,d\mathbf{x}\\
    =&\int_{\mathbb{R}^n}f(\mathbf{y})e^{-2\pi i (\mathbf{y}+\mathbf{a})\cdot\boldsymbol{\xi}}\,d\mathbf{y}(\mathbf{y}=\mathbf{x}-\mathbf{a})\\
    =&e^{-2\pi i \mathbf{a}\cdot\boldsymbol{\xi}}\int_{\mathbb{R}^n}f(\mathbf{y})e^{-2\pi i \mathbf{y}\cdot\boldsymbol{\xi}}\,d\mathbf{y}\\
    =&e^{-2\pi i \mathbf{a}\cdot\boldsymbol{\xi}}\mathcal{F} f(\boldsymbol{\xi})
\switch
    &\mathcal{F} \left[f(\mathbf{x}-\mathbf{a})\right](\boldsymbol{\omega})\\
    =&\int_{\mathbb{R}^n}f(\mathbf{x}-\mathbf{a})e^{-i \mathbf{x}\cdot\boldsymbol{\omega}}\,d\mathbf{x}\\
    =&\int_{\mathbb{R}^n}f(\mathbf{y})e^{-i (\mathbf{y}+\mathbf{a})\cdot\boldsymbol{\omega}}\,d\mathbf{y}(\mathbf{y}=\mathbf{x}-\mathbf{a})\\
    =&e^{-i \mathbf{a}\cdot\boldsymbol{\omega}}\int_{\mathbb{R}^n}f(\mathbf{y})e^{-i \mathbf{y}\cdot\boldsymbol{\omega}}\,d\mathbf{y}\\
    =&e^{-i \mathbf{a}\cdot\boldsymbol{\omega}}\mathcal{F} f(\boldsymbol{\omega})
    \end{lralign}
    \ding{173}频移性质，
    \begin{lralign}
    &\mathcal{F} \left[e^{2\pi i \mathbf{a}\cdot\boldsymbol{\xi}}f(\mathbf{x})\right](\boldsymbol{\xi})\\
    =&\int_{\mathbb{R}^n}e^{2\pi i \mathbf{a}\cdot\boldsymbol{\xi}}f(\mathbf{x})e^{-2\pi i \mathbf{x}\cdot\boldsymbol{\xi}}\,d\mathbf{x}\\
    =&\int_{\mathbb{R}^n}f(\mathbf{x})e^{-2\pi i (\mathbf{x}-\mathbf{a})\cdot\boldsymbol{\xi}}\,d\mathbf{x}\\
    =&f(\boldsymbol{\xi}-\mathbf{a})
\switch
    &\mathcal{F} \left[e^{i \mathbf{a}\cdot\boldsymbol{\omega}}f(\mathbf{x})\right](\boldsymbol{\omega})\\
    =&\int_{\mathbb{R}^n}e^{i \mathbf{a}\cdot\boldsymbol{\omega}}f(\mathbf{x})e^{-i \mathbf{x}\cdot\boldsymbol{\omega}}\,d\mathbf{x}\\
    =&\int_{\mathbb{R}^n}f(\mathbf{x})e^{-i (\mathbf{x}-\mathbf{a})\cdot\boldsymbol{\omega}}\,d\mathbf{x}\\
    =&f(\boldsymbol{\omega}-\mathbf{a})
    \end{lralign}
\end{proof}

\begin{proposition}[伸缩定理]
    设$f(\mathbf{x}):\mathbb{R}^n\to\mathbb{C}$，$A$为$n$阶可逆矩阵，则有：
    \begin{lralign}
    \mathcal{F} \left[f(A\mathbf{x})\right](\boldsymbol{\xi})&=\frac{1}{|\det A|}\mathcal{F} f\left(A^{-T}\boldsymbol{\xi}\right)
    \switch
    \mathcal{F} \left[f(A\mathbf{x})\right](\boldsymbol{\omega})&=\frac{1}{|\det A|}\mathcal{F} f\left(A^{-T}\boldsymbol{\omega}\right)
    \end{lralign}
    特别地，当$A$是对角阵时，设$A=\text{diag}(a_1,a_2,\cdots,a_n)$，则有：
    \begin{lralign}
    &\mathcal{F} \left[f(a_1 x_1,a_2 x_2,\cdots,a_n x_n)\right](\boldsymbol{\xi})\\
    =&\frac{1}{|a_1 a_2\cdots a_n|}\mathcal{F} f\left(\frac{\xi_1}{a_1},\frac{\xi_2}{a_2},\cdots,\frac{\xi_n}{a_n}\right)
\switch
    &\mathcal{F} \left[f(a_1 x_1,a_2 x_2,\cdots,a_n x_n)\right](\boldsymbol{\omega})\\
    =&\frac{1}{|a_1 a_2\cdots a_n|}\mathcal{F} f\left(\frac{\omega_1}{a_1},\frac{\omega_2}{a_2},\cdots,\frac{\omega_n}{a_n}\right)
    \end{lralign}
    对于旋转矩阵$R$（即满足$R^T R=I$的矩阵），有：
    \begin{lralign}
    \mathcal{F} \left[f(R\mathbf{x})\right](\boldsymbol{\xi})&=\mathcal{F} f\left(R\boldsymbol{\xi}\right)
\switch
    \mathcal{F} \left[f(R\mathbf{x})\right](\mathbf{\omega})&=\mathcal{F} f\left(R\mathbf{\omega}\right)
    \end{lralign}
    这表明时域旋转，频域也会做相应旋转。
\end{proposition}
\begin{proof}
    \begin{lralign}
    &\mathcal{F} \left[f(A\mathbf{x})\right](\boldsymbol{\xi})\\
    =&\int_{\mathbb{R}^n}f(A\mathbf{x})e^{-2\pi i \mathbf{x}\cdot\boldsymbol{\xi}}\,d\mathbf{x}\\
    =&\int_{\mathbb{R}^n}f(\mathbf{y})e^{-2\pi i A^{-1}\mathbf{y}\cdot\boldsymbol{\xi}}\,\frac{d\mathbf{y}}{|\det A|}(\mathbf{y}=A\mathbf{x})\\
    =&\frac{1}{|\det A|}\int_{\mathbb{R}^n}f(\mathbf{y})e^{-2\pi i \mathbf{y}\cdot A^{-T}\boldsymbol{\xi}}\,d\mathbf{y}\\
    =&\frac{1}{|\det A|}\mathcal{F} f\left(A^{-T}\boldsymbol{\xi}\right)
\switch
    &\mathcal{F} \left[f(A\mathbf{x})\right](\boldsymbol{\omega})\\
    =&\int_{\mathbb{R}^n}f(A\mathbf{x})e^{-i \mathbf{x}\cdot\boldsymbol{\omega}}\,d\mathbf{x}\\
    =&\int_{\mathbb{R}^n}f(\mathbf{y})e^{-i A^{-1}\mathbf{y}\cdot\boldsymbol{\omega}}\,\frac{d\mathbf{y}}{|\det A|}(\mathbf{y}=A\mathbf{x})\\
    =&\frac{1}{|\det A|}\int_{\mathbb{R}^n}f(\mathbf{y})e^{-i \mathbf{y}\cdot A^{-T}\boldsymbol{\omega}}\,d\mathbf{y}\\
    =&\frac{1}{|\det A|}\mathcal{F} f\left(A^{-T}\boldsymbol{\omega}\right)
    \end{lralign}
    请读者自行验证$A$为对角矩阵和旋转矩阵情况下的公式。
\end{proof}

\begin{proposition}[微分性质]
    设$f(\mathbf{x}):\mathbb{R}^n\to\mathbb{C}$一阶连续可导，则有：
    \begin{lralign}
    \mathcal{F} \left(\frac{\partial f}{\partial x_j}\right)(\boldsymbol{\xi})&=2\pi i \xi_j \mathcal{F} f(\boldsymbol{\xi})
\switch
    \mathcal{F} \left(\frac{\partial f}{\partial x_j}\right)(\boldsymbol{\omega})&=i \omega_j \mathcal{F} f(\boldsymbol{\omega})
    \end{lralign}
    易见在高阶混合偏导数存在时，有：
    \begin{lralign}
    \mathcal{F} \left(\frac{\partial^{\alpha} f}{\partial x_1^{\alpha_1}\partial x_2^{\alpha_2}\cdots \partial x_n^{\alpha_n}}\right)(\boldsymbol{\xi})\\
    =(2\pi i)^{\alpha} \xi_1^{\alpha_1}\xi_2^{\alpha_2}\cdots \xi_n^{\alpha_n} \mathcal{F} f(\boldsymbol{\xi})
\switch
    \mathcal{F} \left(\frac{\partial^{\alpha} f}{\partial x_1^{\alpha_1}\partial x_2^{\alpha_2}\cdots \partial x_n^{\alpha_n}}\right)(\boldsymbol{\omega})\\
    =i^{\alpha} \omega_1^{\alpha_1}\omega_2^{\alpha_2}\cdots \omega_n^{\alpha_n} \mathcal{F} f(\boldsymbol{\omega})
    \end{lralign}
    其中$\alpha=\alpha_1+\alpha_2+\cdots +\alpha_n$。
\end{proposition}
\begin{proof}
    以$j=1$为例，其他分量类似。简洁起见，以下不区分重积分时$d\mathbf{x}$的含义。
    {\color{blue}\begin{align*}
    \mathcal{F} \left(\frac{\partial f}{\partial x_1}\right)(\boldsymbol{\xi})=&\int_{\mathbb{R}^n}\frac{\partial f}{\partial x_1}(\mathbf{x})e^{-2\pi i \mathbf{x}\cdot\boldsymbol{\xi}}\,d\mathbf{x}\\
    =&\int_{\mathbb{R}^{n-1}}e^{-2\pi i (x_2\xi_2+\cdots +x_n\xi_n)}\,d\mathbf{x}\int_{-\infty}^{\infty}\frac{\partial f}{\partial x_1}(\mathbf{x})e^{-2\pi i x_1 \xi_1}\,dx_1\\
    =&\int_{\mathbb{R}^{n-1}}e^{-2\pi i (x_2\xi_2+\cdots +x_n\xi_n)}\left[f(\mathbf{x})e^{-2\pi i x_1 \xi_1}\Big|_{x_1=-\infty}^{x_1=\infty}+2\pi i \xi_1 \int_{-\infty}^{\infty}f(\mathbf{x})e^{-2\pi i x_1 \xi_1}\,dx_1\right]\,d\mathbf{x}\\
    =&2\pi i \xi_1 \int_{\mathbb{R}^n}f(\mathbf{x})e^{-2\pi i \mathbf{x}\cdot\boldsymbol{\xi}}\,d\mathbf{x}\\
    =&2\pi i \xi_1 \mathcal{F} f(\boldsymbol{\xi})
    \end{align*}}
    {\color{red}
    \begin{align*}
    \mathcal{F} \left(\frac{\partial f}{\partial x_1}\right)(\boldsymbol{\omega})=&\int_{\mathbb{R}^n}\frac{\partial f}{\partial x_1}(\mathbf{x})e^{-i \mathbf{x}\cdot\boldsymbol{\omega}}\,d\mathbf{x}\\
    =&\int_{\mathbb{R}^{n-1}}e^{-i (x_2\omega_2+\cdots +x_n\omega_n)}\,d\mathbf{x}\int_{-\infty}^{\infty}\frac{\partial f}{\partial x_1}(\mathbf{x})e^{-i x_1 \omega_1}\,dx_1\\
    =&\int_{\mathbb{R}^{n-1}}e^{-i (x_2\omega_2+\cdots +x_n\omega_n)}\left[f(\mathbf{x})e^{-i x_1 \omega_1}\Big|_{x_1=-\infty}^{x_1=\infty}+i \omega_1 \int_{-\infty}^{\infty}f(\mathbf{x})e^{-i x_1 \omega_1}\,dx_1\right]\,d\mathbf{x}\\
    =&i \omega_1 \int_{\mathbb{R}^n}f(\mathbf{x})e^{-i \mathbf{x}\cdot\boldsymbol{\omega}}\,d\mathbf{x}\\
    =&i \omega_1 \mathcal{F} f(\boldsymbol{\omega})
    \end{align*}}
\end{proof}

\begin{definition}[场论中的算子]
    $\nabla$为哈密顿算子（或称nabla算子），$\Delta=\nabla\cdot \nabla$为拉普拉斯算子，
    \begin{align*}
        \nabla=\left(\frac{\partial }{\partial x_1},\frac{\partial }{\partial x_2},\cdots,\frac{\partial }{\partial x_n}\right),
        \Delta=\frac{\partial^2 }{\partial x_1^2}+\frac{\partial^2 }{\partial x_2^2}+\cdots+\frac{\partial^2 }{\partial x_n^2}
    \end{align*}
    场论中，梯度、散度、旋度等运算都可以用$\nabla$表示：
    \begin{itemize}
        \item 梯度：$\nabla f=\text{grad}f$
        \item 散度：$\nabla\cdot \mathbf{F}=\text{div}\mathbf{F}$，其中$\mathbf{F}=(F_1,F_2,\cdots,F_n)$
        \item 旋度（仅在$\mathbb{R}^3$中定义）：$\nabla\times \mathbf{F}=\text{curl}\mathbf{F}$（一些文献中也将旋度算子记为$\text{rot}$）
    \end{itemize}
\end{definition}

\begin{corollary}[场论中的微分性质]
    由微分性质，我们依次对比向量值函数的各个分量。对于梯度$\nabla f=\text{grad}f$，有：
    \begin{lralign}
    \mathcal{F} \left(\nabla f\right)(\boldsymbol{\xi})&=2\pi i \boldsymbol{\xi} \mathcal{F} f(\boldsymbol{\xi})
\switch
    \mathcal{F} \left(\nabla f\right)(\boldsymbol{\omega})&=i \boldsymbol{\omega} \mathcal{F} f(\boldsymbol{\omega})
    \end{lralign}
    对于散度$\nabla\cdot \mathbf{F}=\text{div}\mathbf{F}$，其中$\mathbf{F}=(F_1,F_2,\cdots,F_n)$，有：
    \begin{lralign}
    \mathcal{F} \left(\nabla\cdot \mathbf{F}\right)(\boldsymbol{\xi})&=2\pi i \boldsymbol{\xi}\cdot \mathcal{F} \mathbf{F}(\boldsymbol{\xi})
\switch
    \mathcal{F} \left(\nabla\cdot \mathbf{F}\right)(\boldsymbol{\omega})&=i \boldsymbol{\omega}\cdot \mathcal{F} \mathbf{F}(\boldsymbol{\omega})
    \end{lralign}
    在$\mathbb{R}^3$中，对于旋度$\nabla\times \mathbf{F}=\text{curl}\mathbf{F}$，有：
    \begin{lralign}
    \mathcal{F} \left(\nabla\times \mathbf{F}\right)(\boldsymbol{\xi})&=2\pi i \boldsymbol{\xi}\times \mathcal{F} \mathbf{F}(\boldsymbol{\xi})
\switch
    \mathcal{F} \left(\nabla\times \mathbf{F}\right)(\boldsymbol{\omega})&=i \boldsymbol{\omega}\times \mathcal{F} \mathbf{F}(\boldsymbol{\omega})
    \end{lralign}
    对于拉普拉斯算子$\Delta f$，有：
    \begin{lralign}
    \mathcal{F} \left(\Delta f\right)(\boldsymbol{\xi})&=-(2\pi)^2 |\boldsymbol{\xi}|^2 \mathcal{F} f(\boldsymbol{\xi})
\switch
    \mathcal{F} \left(\Delta f\right)(\boldsymbol{\omega})&=-|\boldsymbol{\omega}|^2 \mathcal{F} f(\boldsymbol{\omega})
    \end{lralign}
\end{corollary}

我们还可以定义n维空间$\mathbb{R}^n$上的\textbf{卷积}。与一维的情况类似，由于卷积的存在性可以由多种充分条件保证，我们直接从形式上给出卷积的定义，而不讨论$f,g$具体的范围。
\begin{definition}[卷积]
    设$f(\mathbf{x}),g(\mathbf{x}):\mathbb{R}^n\to\mathbb{C}$，它们的卷积定义为：
    \begin{align*}
        (f*g)(\mathbf{x})=\int_{\mathbb{R}^n}f(\mathbf{y})g(\mathbf{x}-\mathbf{y})\,d\mathbf{y}
    \end{align*}
\end{definition}

\begin{theorem}[卷积定理]
    设$f(\mathbf{x}),g(\mathbf{x}):\mathbb{R}^n\to\mathbb{C}$，则有：
    \begin{lralign}
    &\mathcal{F} (f*g)(\boldsymbol{\xi})=\mathcal{F} f(\boldsymbol{\xi})\cdot \mathcal{F} g(\boldsymbol{\xi})\\
    &\mathcal{F} f(\boldsymbol{\xi})\mathcal{F} g(\boldsymbol{\xi})=\mathcal{F} (f*g)(\boldsymbol{\xi})
\switch
    &\mathcal{F} (f*g)(\boldsymbol{\omega})=\mathcal{F} f(\boldsymbol{\omega})\cdot \mathcal{F} g(\boldsymbol{\omega})\\
    &\mathcal{F} f(\boldsymbol{\omega})\mathcal{F} g(\boldsymbol{\omega})=\frac{1}{(2\pi)^n}\mathcal{F} (f*g)(\boldsymbol{\omega})
    \end{lralign}
\end{theorem}
\begin{proof}
    \ding{172}时域卷积：
\begin{lralign}
    &\mathcal{F} (f*g)(\boldsymbol{\xi})\\
    =&\int_{\mathbb{R}^n}(f*g)(\mathbf{x})e^{-2\pi i \mathbf{x}\cdot\boldsymbol{\xi}}\,d\mathbf{x}\\
    =&\int_{\mathbb{R}^n}e^{-2\pi i \mathbf{x}\cdot\boldsymbol{\xi}}\,d\mathbf{x}\int_{\mathbb{R}^n}f(\mathbf{y})g(\mathbf{x}-\mathbf{y})\,d\mathbf{y}\\
    =&\int_{\mathbb{R}^n}f(\mathbf{y})\,d\mathbf{y}\int_{\mathbb{R}^n}g(\mathbf{x}-\mathbf{y})e^{-2\pi i \mathbf{x}\cdot\boldsymbol{\xi}}\,d\mathbf{x}\\
    =&\int_{\mathbb{R}^n}f(\mathbf{y})\,d\mathbf{y}\int_{\mathbb{R}^n}g(\mathbf{z})e^{-2\pi i (\mathbf{z}+\mathbf{y})\cdot\boldsymbol{\xi}}\,d\mathbf{z}\quad (\mathbf{z}=\mathbf{x}-\mathbf{y})\\
    =&\int_{\mathbb{R}^n}f(\mathbf{y})e^{-2\pi i \mathbf{y}\cdot\boldsymbol{\xi}}\,d\mathbf{y}\int_{\mathbb{R}^n}g(\mathbf{z})e^{-2\pi i \mathbf{z}\cdot\boldsymbol{\xi}}\,d\mathbf{z}\\
    =&\mathcal{F} f(\boldsymbol{\xi})\cdot \mathcal{F} g(\boldsymbol{\xi})
    \switch
    &\mathcal{F} (f*g)(\boldsymbol{\omega})\\
    =&\int_{\mathbb{R}^n}(f*g)(\mathbf{x})e^{-i \mathbf{x}\cdot\boldsymbol{\omega}}\,d\mathbf{x}\\
    =&\int_{\mathbb{R}^n}f(\mathbf{y})\,d\mathbf{y}\int_{\mathbb{R}^n}g(\mathbf{x}-\mathbf{y})e^{-i \mathbf{x}\cdot\boldsymbol{\omega}}\,d\mathbf{x}\\
    =&\int_{\mathbb{R}^n}f(\mathbf{y})\,d\mathbf{y}\int_{\mathbb{R}^n}g(\mathbf{x}-\mathbf{y})e^{-i \mathbf{x}\cdot\boldsymbol{\omega}}\,d\mathbf{x}\\
    =&\int_{\mathbb{R}^n}f(\mathbf{y})\,d\mathbf{y}\int_{\mathbb{R}^n}g(\mathbf{z})e^{-i (\mathbf{z}+\mathbf{y})\cdot\boldsymbol{\omega}}\,d\mathbf{z}\quad (\mathbf{z}=\mathbf{x}-\mathbf{y})\\
    =&\int_{\mathbb{R}^n}f(\mathbf{y})e^{-i \mathbf{y}\cdot\boldsymbol{\omega}}\,d\mathbf{y}\int_{\mathbb{R}^n}g(\mathbf{z})e^{-i \mathbf{z}\cdot\boldsymbol{\omega}}\,d\mathbf{z}\\
    =&\mathcal{F} f(\boldsymbol{\omega})\cdot \mathcal{F} g(\boldsymbol{\omega})
    \end{lralign}
\ding{173}频域卷积：\\
仿照\ref{sub:properties_of_convolution}中的证明。根据时域卷积定理$\mathcal{F} (f*g)=\mathcal{F} f\mathcal{F} g$，
令$f=\mathcal{F} \mathfrak{f},g=\mathcal{F} \mathfrak{g}$，则
\begin{lralign}
    \mathcal{F} \mathfrak{f}*\mathcal{F} \mathfrak{g}&=\mathcal{F} ^{-1}\left[\mathcal{F}\mathcal{F} \mathfrak{f}\cdot\mathcal{F} \mathcal{F} \mathfrak{g}\right]\\
    &=\mathcal{F} ^{-1}\left(\mathfrak{f}^- \mathfrak{g}^- \right)\\
    &=\mathcal{F} (\mathfrak{fg})
\switch
    \mathcal{F} \mathfrak{f}*\mathcal{F} \mathfrak{g}&=\mathcal{F} ^{-1}\left[\mathcal{F}\mathcal{F} \mathfrak{f}\cdot\mathcal{F} \mathcal{F} \mathfrak{g}\right]\\
    &=\mathcal{F} ^{-1}\left((2\pi)^{2n} \mathfrak{f}^- \mathfrak{g}^- \right)\\
    &= (2\pi)^n\mathcal{F} (\mathfrak{fg})
\end{lralign}
\end{proof}

\begin{theorem}[普朗歇尔定理]
    设$f(\mathbf{x}),\in L^1(\mathbb{R}^n)\cap L^2(\mathbb{R}^n)$，则有：
    \begin{lralign}
    \int_{\mathbb{R}^n}|f(\mathbf{x})|^2\,d\mathbf{x}&=\int_{\mathbb{R}^n}|\mathcal{F} f(\boldsymbol{\xi})|^2\,d\boldsymbol{\xi}
\switch
    \int_{\mathbb{R}^n}|f(\mathbf{x})|^2\,d\mathbf{x}&=\frac{1}{(2\pi)^n}\int_{\mathbb{R}^n}|\mathcal{F} f(\boldsymbol{\omega})|^2\,d\boldsymbol{\omega}
    \end{lralign}
\end{theorem}
\begin{proof}
    \begin{lralign}
    &\int_{\mathbb{R}^n}|f(\mathbf{x})|^2\,d\mathbf{x}\\
    =&\int_{\mathbb{R}^n}f(\mathbf{x})\overline{f(\mathbf{x})}\,d\mathbf{x}\\
    =&\int_{\mathbb{R}^n}f(\mathbf{x})\cdot \mathcal{F} ^{-1}(\mathcal{F} \overline{f})(\mathbf{x})\,d\mathbf{x}\\
    =&\int_{\mathbb{R}^n}f(\mathbf{x})\,d\mathbf{x}\int_{\mathbb{R}^n}\mathcal{F} \overline{f}(\boldsymbol{\xi})e^{2\pi i \mathbf{x}\cdot\boldsymbol{\xi}}\,d\boldsymbol{\xi}\\
    =&\int_{\mathbb{R}^n}\mathcal{F} \overline{f}(\boldsymbol{\xi})\,d\boldsymbol{\xi}\int_{\mathbb{R}^n}f(\mathbf{x})e^{2\pi i \mathbf{x}\cdot\boldsymbol{\xi}}\,d\mathbf{x}\\
    =&\int_{\mathbb{R}^n}\mathcal{F} \overline{f}(\boldsymbol{\xi})\cdot \overline{\mathcal{F} f(\boldsymbol{\xi})}\,d\boldsymbol{\xi}\\
    =&\int_{\mathbb{R}^n}|\mathcal{F} f(\boldsymbol{\xi})|^2\,d\boldsymbol{\xi}
\switch
    &\int_{\mathbb{R}^n}|f(\mathbf{x})|^2\,d\mathbf{x}\\
    =&\int_{\mathbb{R}^n}f(\mathbf{x})\overline{f(\mathbf{x})}\,d\mathbf{x}\\
    =&\int_{\mathbb{R}^n}f(\mathbf{x})\cdot \mathcal{F} ^{-1}(\mathcal{F} \overline{f})(\mathbf{x})\,d\mathbf{x}\\
    =&\int_{\mathbb{R}^n}f(\mathbf{x})\,d\mathbf{x}\int_{\mathbb{R}^n}\mathcal{F} \overline{f}(\boldsymbol{\omega})\frac{e^{i \mathbf{x}\cdot\boldsymbol{\omega}}}{(2\pi)^n}\,d\boldsymbol{\omega}\\
    =&\int_{\mathbb{R}^n}\mathcal{F} \overline{f}(\boldsymbol{\omega})\,d\boldsymbol{\omega}\int_{\mathbb{R}^n}f(\mathbf{x})\frac{e^{i \mathbf{x}\cdot\boldsymbol{\omega}}}{(2\pi)^n}\,d\mathbf{x}\\
    =&\frac{1}{(2\pi)^n}\int_{\mathbb{R}^n}\mathcal{F} \overline{f}(\boldsymbol{\omega})\cdot \overline{\mathcal{F} f(\boldsymbol{\omega})}\,d\boldsymbol{\omega}\\
    =&\frac{1}{(2\pi)^n}\int_{\mathbb{R}^n}|\mathcal{F} f(\boldsymbol{\omega})|^2\,d\boldsymbol{\omega}
    \end{lralign}
\end{proof}

\subsection{多维施瓦兹函数与多维分布}\label{sub:muti_schwartz}

首先，我们将\textbf{施瓦兹函数}的定义推广到多维空间$\mathbb{R}^n$中。
\begin{definition}[多维施瓦兹函数]
    设$\varphi(\mathbf{x}):\mathbb{R}^n\to\mathbb{C}$，如果\begin{itemize}
        \item $\varphi(\mathbf{x})\in C^{\infty}(\mathbb{R}^n)$；
        \item 对任意多重指标$\mathcal{J}=(j_1,j_2,\ldots,j_n)$，都有
        \[\lim_{|\mathbf{x}|\to\infty}|\mathbf{x}^{\mathcal{J}} \partial_{\mathcal{J}} \varphi(\mathbf{x})|=0\]
    \end{itemize}
    其中$$\partial_{\mathcal{J}}=\frac{\partial^{j_1+j_2+\cdots +j_n}}{\partial x_1^{j_1}\partial x_2^{j_2}\cdots \partial x_n^{j_n}}$$
    则称$\varphi(\mathbf{x})$为\textbf{多维施瓦兹函数}，所有多维施瓦兹函数构成的空间记为$\mathcal{S}(\mathbb{R}^n)$，在不引起歧义的前提下，也可直接记作$\mathcal{S}$。
\end{definition}

$\mathcal{S} $是线性空间，因此可以定义其对偶空间，即\textbf{多维缓增分布空间}，$\mathcal{T} $中的元素称为\textbf{多维缓增分布}：
\begin{definition}[多维缓增分布]
    泛函$T:\mathcal{S} \to \mathbb{C}$为线性映射，将施瓦兹函数$\varphi\in \mathcal{S} $映射为复数$T(\varphi)\in \mathbb{C}$。对于正则分布$T_f$，有
    $$T_f(\varphi)=\langle T_f,\varphi\rangle=\int_{\mathbb{R}^n}f(\mathbf{x})\varphi(\mathbf{x})\,d\mathbf{x}$$
    将缓增分布组成的线性空间记作$\mathcal{T} (\mathbb{R}^n)$，在不引起歧义的前提下，也可直接记作$\mathcal{T} $。
\end{definition}

容易验证$\mathcal{S} $上的卷积总是有定义的；用类似于\ref{sub:fourier_close}中的方法，可以证明$\mathcal{S} $在傅里叶变换下是封闭的，我们仍然定义$\langle \mathcal{F} T,\varphi\rangle=\langle T,\mathcal{F} \varphi\rangle$从而$\mathcal{T} $在傅里叶变换下也是封闭的。典型的施瓦兹函数例如高斯函数$f(\mathbf{x})=e^{-\pi |\mathbf{x}|^2}$。

我们不再一一讨论作用于分布的各算子，因为它们与一维的情况没有多少差异。对于分布而言，平移与伸缩需要用算子来表示，只是这时平移算子$\tau_{\mathbf{b}}$（其中$\mathbf{b}$为向量）定义为：
\begin{align*}
    (\tau_{\mathbf{b}} f)(\mathbf{x})=f(\mathbf{x}-\mathbf{b})
\end{align*}
伸缩算子$\sigma_A$（其中$A$为矩阵）定义为：
\begin{align*}
    (\sigma_A f)(\mathbf{x})=f(A\mathbf{x})
\end{align*}

下面以这两个算子为例，给出它们作用于缓增分布$T\in\mathcal{T} $的定义，从而看出它们与一维情况下的相似性。
\begin{example}[平移算子]
    设$f,\varphi\in\mathcal{S} ,T_f\in\mathcal{T} $，自然可以定义$\tau_{\mathbf{b}} T_f=T_{\tau_{\mathbf{b}} f}$，
    \begin{align*}
        \langle \tau_{\mathbf{b}} T_f,\varphi\rangle=&\int_{\mathbb{R}^n}f(\mathbf{x}-\mathbf{b})\varphi(\mathbf{x})\,d\mathbf{x}\\
        =&\int_{\mathbb{R}^n}f(\mathbf{y})\varphi(\mathbf{y}+\mathbf{b})\,d\mathbf{y}\quad (\mathbf{y}=\mathbf{x}-\mathbf{b})\\
        =&\langle T_f,\tau_{-\mathbf{b}}\varphi\rangle
    \end{align*}
    因此我们定义：
    \[\langle \tau_{\mathbf{b}} T,\varphi\rangle=\langle T,\tau_{-\mathbf{b}}\varphi\rangle,T\in\mathcal{T} ,\varphi\in\mathcal{S} \]
\end{example}

\begin{example}[伸缩算子]
    设$f,\varphi\in\mathcal{S} ,T_f\in\mathcal{T} $，自然可以定义$\sigma_A T_f=T_{\sigma_A f}$，
    \begin{align*}
        \langle \sigma_A T_f,\varphi\rangle=&\int_{\mathbb{R}^n}f(A\mathbf{x})\varphi(\mathbf{x})\,d\mathbf{x}\\
        =&\int_{\mathbb{R}^n}f(\mathbf{y})\varphi(A^{-1}\mathbf{y})\,\frac{d\mathbf{y}}{|\det A|}\quad (\mathbf{y}=A\mathbf{x})\\
        =&\frac{1}{|\det A|}\langle T_f,\sigma_{A^{-1}}\varphi\rangle
    \end{align*}
    因此我们定义：
    \[\langle \sigma_A T,\varphi\rangle=\frac{1}{|\det A|}\langle T,\sigma_{A^{-1}}\varphi\rangle,T\in\mathcal{T} ,\varphi\in\mathcal{S} \]
\end{example}
在一维情况下，我们有：

\[\langle \tau_a T,\varphi\rangle=\langle T,\tau_{-a}\varphi\rangle,\langle\sigma_{a} T,\varphi\rangle=\frac{1}{|a|}\langle T,\sigma_{1/a}\varphi\rangle,T\in\mathcal{T} ,\varphi\in\mathcal{S} \]
可以看到，如果将标量$b$推广为向量$\mathbf{b}$，而将线性变换（的矩阵表示）由一维矩阵$a$推广为$n$维矩阵$A$，则一维情况下的平移和伸缩算子的定义就是多维空间中的特例。

借助上一小节中对函数的傅里叶变换的讨论，读者可以自行构建出分布的傅里叶变换的各种性质。

下面，我们来讨论一些典型的分布。首先是多维狄拉克分布：
\begin{definition}[多维狄拉克分布]
    设$\mathbf{x}_0\in\mathbb{R}^n$，则多维狄拉克分布$\delta_{\mathbf{x}_0}\in\mathcal{T} $定义为：
    \[\langle \delta_{\mathbf{x}_0},\varphi\rangle=\varphi(\mathbf{x}_0),\forall \varphi\in\mathcal{S} \]
    特别地，$\delta_{\mathbf{0}}$记为$\delta$，称为\textbf{多维狄拉克分布}。

    形式上，可以将多维狄拉克分布表示为：
    \[\delta_{\mathbf{x}_0}(\mathbf{x})=\begin{cases}
    \infty,&\mathbf{x}=\mathbf{x}_0\\
    0,&\mathbf{x}\neq \mathbf{x}_0
    \end{cases},\int_{\mathbb{R}^n}\delta(\mathbf{x})\,d\mathbf{x}=1\]
    即$\delta_{\mathbf{x}_0}(\mathbf{x})=\tau_{\mathbf{x}_0}\delta(\mathbf{x})$。
\end{definition}
\begin{proposition}[多维狄拉克分布的性质]
    多维狄拉克分布具有以下性质：
    \begin{itemize}
        \item 多维狄拉克分布仍为卷积幺元，即$f*\delta=\delta*f=f$；
        \item 多维狄拉克分布是可分的，即
        \[\delta(\mathbf{x})=\delta(x_1,x_2,\ldots,x_n)=\delta(x_1)\delta(x_2)\cdots \delta(x_n)\]
        \item 多维狄拉克分布的伸缩性质：
        \[\sigma_A \delta=\frac{1}{|\det A|}\delta\]
        特别地，\[\delta(a_1 x_1,a_2 x_2,\ldots,a_n x_n)=\frac{1}{|a_1 a_2 \cdots a_n|}\delta(x_1,x_2,\ldots,x_n)\]
        并且$\delta$是偶分布，即$\delta^-=\delta$；
        \item 多维狄拉克分布的傅里叶变换：
        \begin{lralign}
        \mathcal{F} \delta(\boldsymbol{\xi})&=\mathds{1}
\switch
        \mathcal{F} \delta(\boldsymbol{\omega})&=\mathds{1}
        \end{lralign}
    \end{itemize}
\end{proposition}
\begin{proof}
    分布与函数的卷积定义为：
    \[\langle f*T,\varphi\rangle=\langle T,(f^-)*\varphi\rangle,f,\varphi\in\mathcal{S} ,T\in\mathcal{T} \]
    并且这种卷积总满足交换律，即$f*T=T*f$。因此有：
    \begin{align*}
        \langle f*\delta,\varphi\rangle=\langle \delta,(f^-)*\varphi\rangle=((f^-)*\varphi)(\mathbf{0})=\int_{\mathbb{R}^n}f(\mathbf{y})\varphi(\mathbf{y})\,d\mathbf{y}=\langle f,\varphi\rangle
    \end{align*}
    这就证明了$f*\delta=\delta*f=f$。

    类似地，有：
    \begin{align*}
        \langle \delta(x_1)\delta(x_2)\cdots \delta(x_n),\varphi(\mathbf{x})\rangle&=\int_{\mathbb{R}^n}\delta(x_1)\delta(x_2)\cdots \delta(x_n)\varphi(\mathbf{x})\,d\mathbf{x}\\
        &=\int_{\mathbb{R}^{n-1}}\delta(x_2)\cdots \delta(x_n)\,dx_2\cdots dx_n\int_{-\infty}^{\infty}\delta(x_1)\varphi(\mathbf{x})\,dx_1\\
        &=\int_{\mathbb{R}^{n-1}}\delta(x_2)\cdots \delta(x_n)\varphi(0,x_2,\ldots,x_n)\,dx_2\cdots dx_n\\
        &\vdots\\
        &=\varphi(0,0,\ldots,0)\\
        &=\langle \delta(\mathbf{x}),\varphi(\mathbf{x})\rangle
    \end{align*}
    即$\delta(\mathbf{x})=\delta(x_1)\delta(x_2)\cdots \delta(x_n)$。

    对于伸缩性质，直接套用作用于分布的伸缩算子的定义：
    \begin{align*}
        \langle \sigma_A \delta,\varphi\rangle=&\frac{1}{|\det A|}\langle \delta,\sigma_{A^{-1}}\varphi\rangle\\
        =&\frac{1}{|\det A|}(\sigma_{A^{-1}}\varphi)(\mathbf{0})\\
        =&\frac{1}{|\det A|}\varphi(A^{-1}\mathbf{0})\\
        =&\frac{1}{|\det A|}\varphi(\mathbf{0})\\
        =&\left\langle \frac{1}{|\det A|}\delta,\varphi\right\rangle
    \end{align*}

    最后，求多维狄拉克分布的傅里叶变换：
    \begin{lralign}
    \langle \mathcal{F} \delta,\varphi\rangle&=\langle \delta,\mathcal{F} \varphi\rangle\\
    &=(\mathcal{F} \varphi)(\mathbf{0})\\
    &=\int_{\mathbb{R}^n}\varphi(\mathbf{x})\,d\mathbf{x}\\
    &=\langle \mathds{1},\varphi\rangle
\switch
    \langle \mathcal{F} \delta,\varphi\rangle&=\langle \delta,\mathcal{F} \varphi\rangle\\
    &=(\mathcal{F} \varphi)(\mathbf{0})\\
    &=\frac{1}{(2\pi)^n}\int_{\mathbb{R}^n}\varphi(\mathbf{x})\,d\mathbf{x}\\
    &=\langle \mathds{1},\varphi\rangle
    \end{lralign}
因此多维狄拉克分布的傅里叶变换是常函数1。
\end{proof}

\begin{corollary}
    利用傅里叶变换的对偶性，可以得到：
    \begin{lralign}
    \mathcal{F} \mathds{1}(\boldsymbol{\xi})&=\delta(\boldsymbol{\xi})
\switch
    \mathcal{F} \mathds{1}(\boldsymbol{\omega})&=(2\pi)^n \delta(\boldsymbol{\omega})
    \end{lralign}

    再利用傅里叶变换的频移性质，得到：
    \begin{lralign}
        \mathcal{F} [e^{2\pi i \mathbf{x}_0\cdot\mathbf{x}}](\boldsymbol{\xi})&=\delta_{\mathbf{x_0}}
\switch
        \mathcal{F} [e^{i \mathbf{x}_0\cdot\mathbf{x}}](\boldsymbol{\omega})&=(2\pi)^n \delta_{\mathbf{x_0}}
    \end{lralign}
    利用欧拉公式求得三角函数的傅里叶变换：
    \begin{lralign}
        \mathcal{F} [\cos(2\pi \mathbf{x}_0\cdot\mathbf{x})](\boldsymbol{\xi})&=\frac{1}{2}[\delta_{\mathbf{x_0}}+\delta_{-\mathbf{x_0}}]
\switch
        \mathcal{F} [\cos(\mathbf{x}_0\cdot\mathbf{x})](\boldsymbol{\omega})&=\frac{(2\pi)^n}{2}[\delta_{\mathbf{x_0}}+\delta_{-\mathbf{x_0}}]
    \end{lralign}
    以及
    \begin{lralign}
        \mathcal{F} [\sin(2\pi \mathbf{x}_0\cdot\mathbf{x})](\boldsymbol{\xi})&=\frac{1}{2i}[\delta_{\mathbf{x_0}}-\delta_{-\mathbf{x_0}}]
\switch
        \mathcal{F} [\sin(\mathbf{x}_0\cdot\mathbf{x})](\boldsymbol{\omega})&=\frac{(2\pi)^n}{2i}[\delta_{\mathbf{x_0}}-\delta_{-\mathbf{x_0}}]
    \end{lralign}
\end{corollary}

\subsection{格与二维狄拉克梳状分布}\label{sub:lattice}

为了直观性，我们再这一小节中将仅考虑$\mathbb{R}^2$中的情况。我们首先给出\textbf{格}的定义，讨论它的一些性质，再介绍它在信号与系统中的应用。
\begin{definition}[格]
    任取$\mathbb{R}^2$，的一组基$\{\mathbf{u}_1,\mathbf{u}_2\}$，称形如
    \[\mathbf{p}=p_1\mathbf{u}_1+p_2\mathbf{u}_2,p_1,p_2\in\mathbb{Z}\]
    的点为\textbf{格点}(lattice point)，所有格点组成的集合称为由基$\{\mathbf{u}_1,\mathbf{u}_2\}$生成的\textbf{格}(lattice)，记为$\mathcal{L}$，$\mathcal{L} $构成$\mathbb{Z}$模。

    以$\mathbf{u}_1,\mathbf{u}_2$为邻边的平行四边形称为该格的\textbf{基本单元}或\textbf{基本平行四边形}(fundamental parallelogram)，基本单元的面积为$|\det(\mathbf{u}_1,\mathbf{u}_2)|$，定义为该格的\textbf{面积}（体积），记为$\mathrm{Area}(\mathcal{L} )$。

    记$A=(\mathbf{u}_1,\mathbf{u}_2)$为由基向量组成的可逆矩阵，则
    \[\mathbf{u}_1=A \mathbf{e}_1,\mathbf{u}_2=A \mathbf{e}_2\]
    其中$\mathbf{e}_1,\mathbf{e}_2$为标准正交基。作为列向量，格点可以表示为
    \[\mathbf{p}=A\mathbf{n},\mathbf{n}\in\mathbb{Z}^2\]
    因此，我们也将格$\mathcal{L} $记为$\mathcal{L} =A(\mathbb{Z}^2)$，$\mathrm{Area}(\mathcal{L} )=|\det A|$。
\end{definition}

\begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{n_comb}
    \caption{二维的格和狄拉克梳状分布示意图}
\end{figure}

\begin{definition}[狄拉克梳状分布]
    设$\mathcal{L}=A(\mathbb{Z}^2)$为$\mathbb{R}^2$中的格，则由该格生成的\textbf{二维狄拉克梳状分布}(Dirac comb distribution)定义为
    \[\shah_{\mathcal{L} }=\sum_{\mathbf{p}\in\mathcal{L} }\delta_{\mathbf{p}}\]
    特别地，当$\mathcal{L} =\mathbb{Z}^2$时，我们直接记为$\shah$。$\shah_{\mathcal{L} }=\dfrac{1}{|\det A|}\sigma_{A^{-1}}\shah$。

    狄拉克梳状分布看起来像一个钉床，因此又称为\textbf{钉床分布}(bed of nails)。
\end{definition}
\begin{remark}
    $\shah_{\mathcal{L} }=\dfrac{1}{|\det A|}\sigma_{A^{-1}}\shah$的证明如下：
    \begin{align*}
        \frac{1}{|\det A|}\langle \sigma_{A^{-1}}\shah,\varphi\rangle=\frac{1}{|\det A^{-1}|}\langle \shah,\sigma_A \varphi\rangle
        =\sum_{\mathbf{n}\in\mathbb{Z}^2}(\sigma_A \varphi)(\mathbf{n})
        =\sum_{\mathbf{n}\in\mathbb{Z}^2}\varphi(A\mathbf{n})
        =\sum_{\mathbf{p}\in\mathcal{L} }\varphi(\mathbf{p})
        =\langle \shah_{\mathcal{L} },\varphi\rangle
    \end{align*}
\end{remark}

我们将再一次使用狄拉克梳状分布来分析采样信号，只不过这时信号是二维的（例如图像信号），而采样是在格点上进行的。在本小节中，我们仍然使用频率形式的傅里叶变换。

首先，我们给出二维情况下的\textbf{傅里叶级数}以及\textbf{泊松求和公式}：
\begin{definition}[二维傅里叶级数]
    设$f(x_1,x_2)$为$\mathbb{R}^2$中周期为$(T_1,T_2)$的周期函数，即
    \[f(x_1,x_2)=f(x_1+T_1,x_2)=f(x_1,x_2+T_2),\forall (x_1,x_2)\in\mathbb{R}^2\]
    设$f\in L^2([0,T_1]\times[0,T_2])$，则$f$的\textbf{二维傅里叶级数}为
    \[f(x_1,x_2)=\sum_{k_1,k_2=-\infty}^{\infty}c_{k_1,k_2}e^{2\pi i\left(\frac{1}{T_1}k_1 x_1+\frac{1}{T_2}k_2 x_2\right)}\]
    其中
    \[c_{k_1,k_2}=\frac{1}{T_1 T_2}\int_0^{T_1}\int_0^{T_2}f(x_1,x_2)e^{-2\pi i\left(\frac{1}{T_1}k_1 x_1+\frac{1}{T_2}k_2 x_2\right)}\,dx_1 dx_2\]
    特别地，设$T_1=T_2=1$，则有
    \[f(x_1,x_2)=\sum_{k_1,k_2=-\infty}^{\infty}c_{k_1,k_2}e^{2\pi i(k_1 x_1+k_2 x_2)}=\sum_{\mathbf{k}\in\mathbb{Z}^2}c_{\mathbf{k}}e^{2\pi i\mathbf{k\cdot x}}\]
    其中
    \[c_{k_1,k_2}=\int_{[0,1]^2}f(x_1,x_2)e^{-2\pi i(k_1 x_1+k_2 x_2)}\,dx_1 dx_2=\int_{[0,1]^2}f(\mathbf{x})e^{-2\pi i \mathbf{k}\cdot \mathbf{x}}\,d\mathbf{x}\]
\end{definition}
\begin{theorem}[二维泊松求和公式]
    \[\sum_{\mathbf{k}\in\mathbb{Z}^2}\mathcal{F} \varphi(\mathbf{k})=\sum_{\mathbf{k}\in\mathbb{Z}^2}\varphi(\mathbf{k}),\varphi\in\mathcal{S} \]
\end{theorem}
\begin{proof}
    仿照一维情况下的证明（见\ref{sub:possion_summation}），令$\Phi(\mathbf{x})=(\shah *\varphi)(\mathbf{x})=\sum_{\mathbf{k}\in\mathbb{Z}^2}\varphi(\mathbf{x}-\mathbf{k})$，则$\Phi$为周期为1的二维函数，可以展开为傅里叶级数：
    \[\Phi(\mathbf{x})=\sum_{\mathbf{k}\in\mathbb{Z}^2}\hat{\Phi}(\mathbf{k})e^{2\pi i \mathbf{k}\cdot \mathbf{x}}\]
    其中\begin{align*}
        \hat{\Phi}(\mathbf{k})&=\int_{[0,1]^2}\Phi(\mathbf{x})e^{-2\pi i\mathbf{k}\cdot \mathbf{x}}\,d\mathbf{x}\\
        &=\int_{[0,1]^2}\sum_{\mathbf{m}\in\mathbb{Z}^2}\varphi(\mathbf{x}-\mathbf{m})e^{-2\pi i\mathbf{k}\cdot \mathbf{x}}\,d\mathbf{x}\\
        &=\int_{\mathbb{R}^2}\varphi(\mathbf{y})e^{-2\pi i\mathbf{k}\cdot \mathbf{y}}\,d\mathbf{y}\quad (\mathbf{y}=\mathbf{x}-\mathbf{m})\\
        &=\mathcal{F} \varphi(\mathbf{k})
    \end{align*}
    因此，有
    \[\Phi(\mathbf{x})=\sum_{\mathbf{k}\in\mathbb{Z}^2}\mathcal{F} \varphi(\mathbf{k})e^{2\pi i \mathbf{k}\cdot \mathbf{x}}\]
    令$\mathbf{x}=\mathbf{0}$，即得所需结论。
\end{proof}

通过二维泊松求和公式，可以得到狄拉克梳状分布的傅里叶变换：
\begin{proposition}[二维狄拉克梳状分布的傅里叶变换]
    \[\mathcal{F} \shah=\shah\]
\end{proposition}

考虑使用傅里叶变换的伸缩性质，可以得到：
\begin{proposition}
    设$\mathcal{L} =A(\mathbb{Z}^2)$为$\mathbb{R}^2$中的格，则由该格生成的二维狄拉克梳状分布的傅里叶变换为
    \[\mathcal{F} \shah_{\mathcal{L} }=\frac{1}{|\det A|}\shah_{A^{-T}(\mathbb{Z}^2)}\]
\end{proposition}

可以看到，空间域上，线性变换$A:\mathbb{R}^2\to\mathbb{R}^2$作用于格$\mathbb{Z}^2$，对应频域上，线性变换$A^{-T}:\mathbb{R}^2\to\mathbb{R}^2$作用于格$\mathbb{Z}^2$。这启发我们定义：
\begin{definition}[对偶格]
    设$\mathcal{L} =A(\mathbb{Z}^2)$为$\mathbb{R}^2$中的格，则由线性变换$A^{-T}$作用于$\mathbb{Z}^2$生成的格称为$\mathcal{L} $的\textbf{对偶格}(dual lattice)，记为$\mathcal{L} ^*$，即
    \[\mathcal{L} ^*=A^{-T}(\mathbb{Z}^2)\]
    在这种记号下，二维狄拉克梳状分布的傅里叶变换可以记为
    \[\mathcal{F} \shah_{\mathcal{L} }=\frac{1}{\mathrm{Area}(\mathcal{L} )}\shah_{\mathcal{L} ^*}\]

    对偶格的等价定义为：
    \[\mathcal{L} ^*=\{\mathbf{y}\in\mathbb{R}^2\left|\mathbf{y}\cdot \mathbf{x}\in\mathbb{Z},\forall \mathbf{x}\in\mathcal{L}\right. \}\]
\end{definition}
\begin{definition}[对偶基与对偶线性泛函]
    考虑对偶格的基向量。令
    \[A=\begin{bmatrix}
        \mathbf{u}_1&\mathbf{u}_2
    \end{bmatrix},A^{-T}=\begin{bmatrix}
        \mathbf{u}^*_1&\mathbf{u}^*_2
    \end{bmatrix}\]
    其中$\mathbf{u}^*_1,\mathbf{u}^*_2$为对偶格$\mathcal{L} ^*$的基向量，它们满足：
    \[A^{-1}A=\begin{bmatrix}
        \mathbf{u}^*_1&\mathbf{u}^*_2
    \end{bmatrix}^T\begin{bmatrix}
        \mathbf{u}_1&\mathbf{u}_2
    \end{bmatrix}=I=\begin{bmatrix}
        1&0\\
        0&1
    \end{bmatrix}\]
    即\[\mathbf{u}^*_i\cdot \mathbf{u}_j=\begin{cases}
    1,&i=j\\
    0,&i\neq j
    \end{cases}=\delta^i_{j}\]
    $\delta^i_{j}$为克罗内克δ符号。我们将$\mathbf{u}^*_1,\mathbf{u}^*_2$称为$\mathbf{u}_1,\mathbf{u}_2$的\textbf{对偶基}。\textbf{对偶基生成了对偶格}。此外，与对偶基做内积，定义了内积空间上唯一一组满足正交归一化条件，即$f_i(\mathbf{u_j})=\delta^i_{j}$的线性泛函，这组线性泛函称为\textbf{对偶线性泛函}。
\end{definition}

$\shah_{\mathcal{L} }$的$\delta$分布位于格$\mathcal{L} $的格点上，而其傅里叶变换$\mathcal{F} \shah_{\mathcal{L} }$的$\delta$分布位于对偶格$\mathcal{L} ^*$的格点上。这为我们展示了一种理解空间域与频域关系的方式，并从更高的视角解释了我们在\ref{sub:fourier_of_dirac_comb}最后所发现的现象，即一维狄拉克梳状分布经过傅里叶变换，$\delta$的位置具有“倒数”关系。

最后，我们来讨论二维信号的采样与重建问题。
\begin{definition}[二维带限函数]
    设$f\in L^1(\mathbb{R}^2)$，如果存在矩形区域$$B=\{( \xi_1,\xi_2)\left| |\xi_1|\leq \xi_{m1},|\xi_2|\leq \xi_{m2}\right.\}$$
    使得$\text{supp} \mathcal{F}f \subset B$，就说$f$为二维\textbf{带限函数}(bandlimited function)，带宽为$(\xi_{m1},\xi_{m2})$。
\end{definition}
特别地，我们考虑
$$\text{supp}\mathcal{F} f\subset\left\{( \xi_1,\xi_2)\left| |\xi_1|\leq \dfrac{1}{2},|\xi_2|\leq \dfrac{1}{2}\right.\right\}$$
的情况。由恒等式
\[\mathcal{F} f(\boldsymbol{\xi})=\chi_{[-1/2,1/2]^2}(\boldsymbol{\xi})(\mathcal{F} f(\boldsymbol{\xi})*\shah)\]
取傅里叶逆变换，由\ref{sub:multi_fourier}中的结果可知$\mathcal{F} ^{-1}\chi_{[-1/2,1/2]}(\mathbf{x})=\text{sinc}(\mathbf{x})$，我们得到：\begin{align*}
    f(\mathbf{x})&=\mathcal{F} ^{-1}[\chi_{[-1/2,1/2]^2}(\boldsymbol{\xi})(\mathcal{F} f(\boldsymbol{\xi})*\shah)](\mathbf{x})\\
    &=\mathcal{F} ^{-1}\chi_{[-1/2,1/2]^2}(\mathbf{x})*(f(\mathbf{x})*\shah(\mathbf{x}))\\
    &=\text{sinc}(\mathbf{x})*(f(\mathbf{x})*\shah(\mathbf{x}))\\
    &=\sum_{\mathbf{k}\in\mathbb{Z}^2}f(\mathbf{k})\text{sinc}(x_1-k_1)\text{sinc}(x_2-k_2)
\end{align*}
最后一行用到了卷积的结合律，见\ref{sub:properties_of_convolution}。综上得到以下引理：
\begin{lemma}[方形采样公式]
    设$$f\in L^1(\mathbb{R}^2),\text{supp}\mathcal{F} f\subset\left\{( \xi_1,\xi_2)\left| |\xi_1|\leq \dfrac{1}{2},|\xi_2|\leq \dfrac{1}{2}\right.\right\}$$
    则有
    \[f(\mathbf{x})=\sum_{\mathbf{k}\in\mathbb{Z}^2}f(\mathbf{k})\text{sinc}(x_1-k_1)\text{sinc}(x_2-k_2)\]
\end{lemma}

更一般地，我们考虑$\text{supp}\mathcal{F} f$属于格$\mathcal{L} =A(\mathbb{Z}^2),A=[\mathbf{u}_1,\mathbf{u}_2]$的某个基本平行四边形内。显而易见，带限等价于存在这样一个平行四边形，使得频域信号$\mathcal{F} f$支于它。由于我们通常考虑实信号，不妨设这个基本平行四边形是关于原点对称的。

我们希望利用已经得到的方形采样公式来推导格采样公式。为此，考虑将频域信号$\mathcal{F} f$进行伸缩变换，这对应时域上“对偶”的伸缩变换：
\[\mathcal{F} f(A\boldsymbol{\xi})=\frac{1}{|\det A|}\mathcal{F}[f(A^{-T}\mathbf{x})](\boldsymbol{\xi})\]

令$g(\mathbf{x})=f(A^{-T}\mathbf{x})$，则$\text{supp}\mathcal{F} g\in[-1/2,1/2]^2$，因此可以应用方形采样公式：
\[g(\mathbf{x})=\sum_{\mathbf{k}\in\mathbb{Z}^2}g(\mathbf{k})\text{sinc}(x_1-k_1)\text{sinc}(x_2-k_2)\]
将$g$的定义代入上式，得到：
\[f(A^{-T}\mathbf{x})=\sum_{\mathbf{k}\in\mathbb{Z}^2}f(A^{-T}\mathbf{k})\text{sinc}(x_1-k_1)\text{sinc}(x_2-k_2)\]

以上结果可以改写为\textbf{格采样公式}：
\begin{theorem}[格采样公式]
    设$$f\in L^1(\mathbb{R}^2),\text{supp}\mathcal{F} f\subset\left\{( \xi_1,\xi_2)\left| \mathbf{\xi}=A\boldsymbol{\eta},\boldsymbol{\eta}\in[-1/2,1/2]^2\right.\right\}$$
    则有
    \[f(\mathbf{y})=\sum_{k_1,k_2\in\mathbb{Z}}f(k_1\mathbf{u}^*_1+k_2\mathbf{u}^*_2)\text{sinc}(\mathbf{u}_1\cdot \mathbf{y}-k_1)\text{sinc}(\mathbf{u}_2\cdot \mathbf{y}-k_2)\]
\end{theorem}
\begin{proof}
    令$\mathbf{y}=A^{-T}\mathbf{x}$，则$\mathbf{x}=A^T\mathbf{y}$，于是
    \[x_1=\mathbf{u}_1\cdot \mathbf{y},x_2=\mathbf{u}_2\cdot \mathbf{y}\]
    对$A^{-T}\mathbf{k}$，我们知道$A^{-T}$的行向量分别为$\mathbf{u}^*_1,\mathbf{u}^*_2$，因此$A^{-T}\mathbf{k}=k_1\mathbf{u}^*_1+k_2\mathbf{u}^*_2$。综上得到：
    \begin{align*}
        f(\mathbf{y})&=\sum_{\mathbf{k}\in\mathbb{Z}^2}f(A^{-T}\mathbf{k})\text{sinc}(\mathbf{u}_1\cdot \mathbf{y}-k_1)\text{sinc}(\mathbf{u}_2\cdot \mathbf{y}-k_2)\\
        &=\sum_{k_1,k_2\in\mathbb{Z}}f(k_1\mathbf{u}^*_1+k_2\mathbf{u}^*_2)\text{sinc}(\mathbf{u}_1\cdot \mathbf{y}-k_1)\text{sinc}(\mathbf{u}_2\cdot \mathbf{y}-k_2)
    \end{align*}
\end{proof}

称之为格采样公式，是因为采样点位于对偶格$\mathcal{L} ^*=A^{-T}(\mathbb{Z}^2)$上。下面左图绘制了空间域上的采样点，而右图则绘制了频域上的带限区域。频域上的限制越强，频域上的格的基本平行四边形就越小，基向量越短，这样，空间域上的格就越大，基向量越长，节点也越稀疏，即重建信号所需的采样点就越少。这符合我们的直观认识。
\begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{lattice_sample}
    \caption{格采样示意图}
\end{figure}

\section{与傅里叶变换有关的其他变换}\label{sec:Other_Transforms}

\subsection{梅林变换}\label{sub:mellin}

\textbf{梅林变换}(Mellin transform)是一种积分变换，定义为：
\begin{definition}[梅林变换]
    设$f\in L^1(\mathbb{R}^+)$，则$f$的梅林变换定义为
    \[\mathcal{M} f(s)=\int_0^{\infty}f(x)x^{s-1}\,dx\]
    其中$s\in\mathbb{C}$。    
\end{definition}

初看起来它与傅里叶变换没什么关系，但如果做变量替换$x=e^{-t}$，则$dx=-e^{-t}dt=-x dt$，积分限变为$t\in(-\infty,\infty)$，因此有：
\[\mathcal{M} f(s)=\int_{-\infty}^{\infty}f(e^{-t})e^{-s t}\,dt\]
这实际上是$f(e^{-t})$的双边拉普拉斯变换，见\ref{sub:introduction_of_laplace}，但如果限制$s=i\omega$，则是$f(e^{-t})$的角频率形式的傅里叶变换：
\[\mathcal{M} f(i\omega)=\int_{-\infty}^{\infty}f(e^{-t})e^{-i\omega t}\,dt\]
可以通过傅里叶变换的性质研究梅林变换的性质。显然，梅林变换是线性的。

首先，利用傅里叶反演公式（见\ref{sub:introduction_of_fourier}或\ref{sub:fourier_inversion}），可以得到梅林变换的反变换：
\begin{proposition}[梅林反变换]
    设$f\in L^1(\mathbb{R}^+)$，则有
    \[f(x)=\frac{1}{2\pi i}\int_{-\infty}^{\infty}\mathcal{M} f(i\omega)x^{-i\omega}\,d\omega\]
\end{proposition}
\begin{proof}
    由傅里叶反演公式，有
    \[f(e^{-t})=\mathcal{F} ^{-1}[\mathcal{M} f(i\omega)](t)=\frac{1}{2\pi}\int_{-\infty}^{\infty}\mathcal{M} f(i\omega)e^{i\omega t}\,d\omega\]
    令$t=-\ln x$，则有
    \[f(x)=\frac{1}{2\pi}\int_{-\infty}^{\infty}\mathcal{M} f(i\omega)e^{i\omega (-\ln x)}\,d\omega=\frac{1}{2\pi}\int_{-\infty}^{\infty}\mathcal{M} f(i\omega)x^{-i\omega}\,d\omega\]
\end{proof}

在学习\ref{sub:laplace_inversion}后，也可以用类似的方法，将梅林反变换的求解转化为留数的计算，不过我们不打算深入讨论这个话题。

梅林变换可以看作是傅里叶变换在对数坐标系下的对应。从这个视角来看，梅林变换在时域发生变化时，频域的变化方式会与傅里叶变换有所不同。具体来说，我们给出以下命题：
\begin{proposition}[梅林变换的尺度变换性质]
    设$f\in L^1(\mathbb{R}^+)$，则对于任意$a>0$，都有
    \[\mathcal{M} [f(ax)](s)=a^{-s}\mathcal{M} f(s)\]
\end{proposition}
\begin{proof}
    由梅林变换的定义，有
    \begin{align*}
        \mathcal{M} [f(ax)](s)&=\int_0^{\infty}f(ax)x^{s-1}\,dx\\
        &=\int_0^{\infty}f(u)a^{-1}(u/a)^{s-1}\,du\quad (u=ax,dx=du/a)\\
        &=a^{-s}\int_0^{\infty}f(u)u^{s-1}\,du\\
        &=a^{-s}\mathcal{M} f(s)
    \end{align*}
\end{proof}

这表明时域上的尺度变换对应频域上的指数变换，这与傅里叶变换中时域的尺度变换对应频域的反比例变换不同。此外，梅林变换没有时移性质，不过我们还是可以提出变换域上的平移性质：

\begin{proposition}[梅林变换的乘幂性质]
    设$f\in L^1(\mathbb{R}^+)$，则对于任意$c\in\mathbb{C}$，都有
    \[\mathcal{M} [x^c f(x)](s)=\mathcal{M} f(s+c)\]
\end{proposition}
\begin{proof}
    由梅林变换的定义，有
    \begin{align*}
        \mathcal{M} [x^c f(x)](s)&=\int_0^{\infty}x^c f(x)x^{s-1}\,dx\\
        &=\int_0^{\infty}f(x)x^{s+c-1}\,dx\\
        &=\mathcal{M} f(s+c)
    \end{align*}
\end{proof}

对于傅里叶变换，频域或角频域上的平移对应时域上的调制，即乘以某个复指数信号；而梅林变换中，频域上的平移对应时域上的乘幂。

此外，梅林变换还有卷积性质，不过这里的卷积不是通常意义下的卷积，而是\textbf{梅林卷积}，定义为：
\begin{definition}[梅林卷积]
    设$f,g\in L^1(\mathbb{R}^+)$，则它们的\textbf{梅林卷积}(Mellin convolution)定义为
    \[(f\star g)(x)=\int_0^{\infty}f\left(\frac{x}{t}\right)g(t)\frac{dt}{t}\]
\end{definition}

符号$\star$与\ref{sub:correlation}中的互相关符号相同，但我们很少同时用到它们，必要时将指出它的具体含义。

%我们还将在\ref{sub:z_convolution}看到类似的卷积方式，并且梅林变换的定义与性质与z变换有一定的相似之处，不过，z变换是用来处理离散信号的，而梅林卷积处理的是连续信号。它们的相似性或许可以解释为，它们都可以看作是特定情况下的双边拉普拉斯变换。

\begin{proposition}[梅林卷积的变换性质]
    设$f,g\in L^1(\mathbb{R}^+)$，则有
    \[\mathcal{M} [f\star g](s)=\mathcal{M} f(s)\cdot \mathcal{M} g(s)\]
\end{proposition}
\begin{proof}
    由梅林卷积的定义，有
    \begin{align*}
        \mathcal{M} [f\star g](s)&=\int_0^{\infty}(f\star g)(x)x^{s-1}\,dx\\
        &=\int_0^{\infty}\int_0^{\infty}f\left(\frac{x}{t}\right)g(t)\frac{dt}{t}x^{s-1}\,dx\\
        &=\int_0^{\infty}g(t)\frac{1}{t}\int_0^{\infty}f\left(\frac{x}{t}\right)x^{s-1}\,dx\,dt\\
        &=\int_0^{\infty}g(t)\frac{1}{t}\int_0^{\infty}f(u)(ut)^{s-1}t\,du\,dt\quad (u=x/t,dx=t\,du)\\
        &=\int_0^{\infty}g(t)t^{s-1}\,dt\int_0^{\infty}f(u)u^{s-1}\,du\\
        &=\mathcal{M} f(s)\cdot \mathcal{M} g(s)
    \end{align*}
\end{proof}

\subsection{希尔伯特变换}\label{sub:hilbert}

\textbf{希尔伯特变换}(Hilbert transform)既可以看作积分变换，又可以看作滤波器，因为它是函数与$\dfrac{1}{\pi t}$的卷积（见\ref{sub:cascade}）。希尔伯特变换在信号处理领域有着重要的应用，例如构造解析信号，将在本小节最后介绍。
\begin{definition}[希尔伯特变换]
    函数$f:\mathbb{R}\to\mathbb{C}$的\textbf{希尔伯特变换}定义为
    \[\mathcal{H} f(x)=\frac{1}{\pi}\text{p.v.}\int_{-\infty}^{\infty}\frac{f(y)}{x-y}\,dy=\left(f*\frac{1}{\pi x}\right)(x)\]
    其中p.v.表示柯西主值意义下的积分\cite{hilbert_transform}，即：
    \[\text{p.v.}\int_{-\infty}^{\infty}\frac{f(y)}{x-y}\,dy=\lim_{\epsilon\to 0^+}\left(\int_{-\infty}^{x-\epsilon}\frac{f(y)}{x-y}\,dy+\int_{x+\epsilon}^{\infty}\frac{f(y)}{x-y}\,dy\right)\]
    称$f$与$\mathcal{H} f$为\textbf{希尔伯特变换对}，记为$f\overset{\mathcal{H} }{\longleftrightarrow} \mathcal{H} f$。
\end{definition}
\begin{remark}
    一些文献中\cite{brad_osgood_ee261}，希尔伯特变换为$-\dfrac{1}{\pi t}$与$f(t)$的卷积，我们很快将看到这就是本书中的希尔伯特逆变换，它们没有本质区别；一些文献中\cite{signal_systems}，直接将希尔伯特变换记为$\hat{f}$，这样做有一定的好处，例如书写简便，但它与傅里叶变换的记号冲突，因此本书中不采用这种记号。
\end{remark}
\begin{remark}
    我们没有对$f$所属的函数空间做出限制。实际上，希尔伯特变换可以定义在多种函数空间上，经典的希尔伯特变换建立在$L^1(\mathbb{R})$上，并且要求函数$f$是赫德尔连续的（我们没有介绍这个概念），希尔伯特变换还可以定义在$L^p(\mathbb{R}),1<p<\infty$上，或者更广义的分布空间上。专著\cite{hilbert_transform}详细讨论了$f$的范围。
\end{remark}

在\ref{sub:fourier_of_signal}中，我们求出了函数$\dfrac{1}{x}$的傅里叶变换，并在建立了分布的理论后给出了严格的证明：
\begin{lralign}
    \mathcal{F} \left[\frac{1}{\pi x}\right](\xi)= -i\,\text{sgn}(\xi)
    \switch
    \mathcal{F} \left[\frac{1}{\pi x}\right](\omega)= -i\,\text{sgn}(\omega)
\end{lralign}

借助这个结论，我们可以通过傅里叶变换来研究希尔伯特变换的性质。

首先，由卷积定理（见\ref{sub:properties_of_convolution}），我们可以得到希尔伯特变换的傅里叶变换表达式：
    \[\mathcal{F} [\mathcal{H} f](\omega)=-i\,\text{sgn}(\omega)\mathcal{F} f(\omega)\]
可以看到，希尔伯特变换在频域上对应乘以$-i\,\text{sgn}(\omega)$，这表明希尔伯特变换是一个全通滤波器，它将正频率成分的相位延迟$\dfrac{\pi}{2}$，将负频率成分的相位超前$\dfrac{\pi}{2}$，而不改变任意频率成分的幅度。因为这个原因，在一些文献中\cite{brad_osgood_ee261}，$\mathcal{H} f$称为$f$的\textbf{正交函数}(quadrature function)。

如果连续取两次希尔伯特变换，在频域上就对应乘以$(-i\,\text{sgn}(\omega))^2=-1$，也就是：
\[\mathcal{H} \mathcal{H} f=-f\]
因此，希尔伯特变换的逆变换为：
\begin{definition}[希尔伯特逆变换]
    设$f\in L^1(\mathbb{R})$，则$f$的\textbf{希尔伯特逆变换}定义为
    \[\mathcal{H} ^{-1} f(x)=-\mathcal{H} f(x)=-\frac{1}{\pi}\text{p.v.}\int_{-\infty}^{\infty}\frac{f(y)}{x-y}\,dy=-\left(f*\frac{1}{\pi x}\right)(x)\]
\end{definition}
至此可以看出，希尔伯特变换对是一一的，因此记号$f\overset{\mathcal{H} }{\longleftrightarrow} \mathcal{H} f$是合理的。

\begin{example}[三角函数的希尔伯特变换]
    三角函数的希尔伯特变换可以通过它们的傅里叶变换来求解。考虑$\cos(2\pi f_0 x)=\cos(\omega_0 x)$，我们知道：
    \begin{lralign}
        \mathcal{F} [\cos(2\pi f_0 t)](\xi)&=\frac{1}{2}(\delta_{f_0}+\delta_{-f_0})
        \switch
        \mathcal{F} [\cos(\omega_0 t)](\omega)&=\pi(\delta_{\omega_0}+\delta_{-\omega_0})
    \end{lralign}
    因此余弦函数的希尔伯特变换的傅里叶变换为：
    \begin{lralign}
        &\mathcal{F} [\mathcal{H} \cos(2\pi f_0 t)](\xi)\\
        =&-i\,\text{sgn}(\xi)\cdot \frac{1}{2}(\delta_{f_0}+\delta_{-f_0})\\
        =&-\frac{i}{2}(\delta_{f_0}-\delta_{-f_0})
        \switch
        &\mathcal{F} [\mathcal{H} \cos(\omega_0 t)](\omega)\\
        =&-i\,\text{sgn}(\omega)\cdot \pi(\delta_{\omega_0}+\delta_{-\omega_0})\\
        =&-i\pi(\delta_{\omega_0}-\delta_{-\omega_0})
    \end{lralign}
    这正是$\sin(2\pi f_0 t)=\sin(\omega_0 t)$的傅里叶变换，因此我们得到：
    \[\mathcal{H} \cos(\omega_0 t)=\sin(\omega_0 t)\]
    同理可得：
    \[\mathcal{H} \sin(\omega_0 t)=-\cos(\omega_0 t)\]
\end{example}

\begin{example}[直接计算希尔伯特变换]
    对于多数函数而言，计算希尔伯特变换时，直接使用定义进行计算比较困难。这里给出一个简单的函数，它能够使用定义计算希尔伯特变换。考虑脉冲宽度为$T$的矩形函数$f(x)=\chi[-T/2,T/2](x)$，则有：
    \begin{align*}
        \mathcal{H} f(x)&=\frac{1}{\pi}\text{p.v.}\int_{-T/2}^{T/2}\frac{1}{x-y}\,dy\\
        &=\frac{1}{\pi}\lim_{\epsilon\to 0^+}\left(\int_{-T/2}^{x-\epsilon}\frac{1}{x-y}\,dy+\int_{x+\epsilon}^{T/2}\frac{1}{x-y}\,dy\right)\\
        &=\frac{1}{\pi}\lim_{\epsilon\to 0^+}\left(\ln|x-y|\Big|_{y=-T/2}^{y=x-\epsilon}+\ln|x-y|\Big|_{y=x+\epsilon}^{y=T/2}\right)\\
        &=\frac{1}{\pi}\lim_{\epsilon\to 0^+}\left(\ln \epsilon -\ln|x+T/2|+\ln|T/2 -x|-\ln \epsilon \right)\\
        &=\frac{1}{\pi}\ln\left|\frac{T/2 -x}{x+T/2}\right|
    \end{align*}
\end{example}

\begin{example}[三角函数的希尔伯特变换，直接计算]
    如果使用狄利克雷积分的结果：
    \[\int_{-\infty}^{\infty}\frac{\sin ax}{x}\,dx=\pi,a>0\]
    也可以直接计算三角函数的希尔伯特变换，这次以正弦函数为例：
    \begin{align*}
        \mathcal{H} \sin(\omega_0 t)&=\frac{1}{\pi}\text{p.v.}\int_{-\infty}^{\infty}\frac{\sin(\omega_0 y)}{t-y}\,dy\\
        &=\frac{1}{\pi}\lim_{\epsilon\to 0^+}\left(\int_{-\infty}^{t-\epsilon}\frac{\sin(\omega_0 y)}{t-y}\,dy+\int_{t+\epsilon}^{\infty}\frac{\sin(\omega_0 y)}{t-y}\,dy\right)\\
        &=\frac{1}{\pi}\lim_{\epsilon\to 0^+}\left(\int_{\epsilon}^{\infty}\frac{\sin(\omega_0 (t-u))}{u}\,du+\int_{-\infty}^{-\epsilon}\frac{\sin(\omega_0 (t-u))}{u}\,du\right)& (u=t-y)\\
        &=\frac{1}{\pi}\lim_{\epsilon\to 0^+}\left(\int_{\epsilon}^{\infty}\frac{\sin(\omega_0 t)\cos(\omega_0 u)-\cos(\omega_0 t)\sin(\omega_0 u)}{u}\,du\right.\\
        &\quad \left.+\int_{-\infty}^{-\epsilon}\frac{\sin(\omega_0 t)\cos(\omega_0 u)-\cos(\omega_0 t)\sin(\omega_0 u)}{u}\,du\right)\\
        &=\frac{1}{\pi}\lim_{\epsilon\to 0^+}\left(\sin(\omega_0 t)\int_{\epsilon}^{\infty}\frac{\cos(\omega_0 u)}{u}\,du+\sin(\omega_0 t)\int_{-\infty}^{-\epsilon}\frac{\cos(\omega_0 u)}{u}\,du\right.\\
        &\quad \left.-\cos(\omega_0 t)\int_{\epsilon}^{\infty}\frac{\sin(\omega_0 u)}{u}\,du-\cos(\omega_0 t)\int_{-\infty}^{-\epsilon}\frac{\sin(\omega_0 u)}{u}\,du\right)\\
        &=\frac{1}{\pi}\lim_{\epsilon\to 0^+}\left(-\cos(\omega_0 t)\int_{\epsilon}^{\infty}\frac{\sin(\omega_0 u)}{u}\,du+\cos(\omega_0 t)\int_{\epsilon}^{\infty}\frac{\sin(\omega_0 u)}{u}\,du\right)\\
        &=-\cos(\omega_0 t)
    \end{align*}
    倒数第三行到倒数第二行运用了函数的奇偶性。
\end{example}

下面，我们使用希尔伯特变换来构造解析信号。
\begin{definition}[解析信号]
    函数$f\in L^1(\mathbb{R})$称为\textbf{解析信号}(analytic signal)，如果它仅含正频率成分，即
    \[\text{supp}\mathcal{F} f\subseteq[0,\infty)\]
\end{definition}

根据傅里叶变换的对偶性（见\ref{sub:fourier_operation_properties}），实信号的傅里叶变换满足$\mathcal{F} f^-=\overline{\mathcal{F} f}$，即幅度谱为偶函数而相位谱为奇函数，因此实信号不可能是解析信号。但如果考虑$2u\cdot\mathcal{F} f$，其中$u$为单位阶跃函数，则该信号仅含正频率成分（我们马上将看到为什么是两倍的$u\mathcal{F} f$）。

对$2u\cdot\mathcal{F} f$做傅里叶逆变换，并即相应的时域函数为$\mathcal{Z}_f(t)$，则有：
\begin{lralign}
    \mathcal{Z}_f(t)&=\mathcal{F} ^{-1}[2u(\xi)\cdot\mathcal{F} f(\xi)](t)\\
    &=\mathcal{F} ^{-1}[(1+\text{sgn}(\xi))\mathcal{F} f(\xi)](t)\\
    &=\mathcal{F} \mathcal{F} ^{-1}f(t)+\mathcal{F} ^{-1}[\text{sgn}(\xi)\mathcal{F} f(\xi)](t)\\
    &=f(t)+i\mathcal{H} f(t)
    \switch
    \mathcal{Z}_f(t)&=\mathcal{F} ^{-1}[2u(\omega)\cdot\mathcal{F} f(\omega)](t)\\
    &=\mathcal{F} ^{-1}[(1+\text{sgn}(\omega))\mathcal{F} f(\omega)](t)\\
    &=\mathcal{F} \mathcal{F} ^{-1}f(t)+\mathcal{F} ^{-1}[\text{sgn}(\omega)\mathcal{F} f(\omega)](t)\\
    &=f(t)+i\mathcal{H} f(t)
\end{lralign}

因此，在实信号的虚部中加入它的希尔伯特变换（显然，实信号的希尔伯特变换仍是实信号），就得到了一个解析信号。需要注意的是，以上解析信号的构造过程并未限制$f$是实信号。我们定义：

\begin{definition}
    设$f\in L^1(\mathbb{R})$，称$\mathcal{Z}_f(t)=f(t)+i\mathcal{H} f(t)$为\textbf{与}$f$\textbf{相关的解析信号}。
    从构造过程可以看出，时域上，$f(x)=\text{Re}\{\mathcal{Z}_f(x)\}$；频域上，$\mathcal{Z} _f$是由$f$截去复频率成分，而正频率成分加倍得到的。
\end{definition}

与解析信号相关的解析信号并不是它本身，因为只有0的希尔伯特变换是0。

以上构造过程告诉我们，如果一个线性时不变系统能够的响应是激励信号的希尔伯特变换，就能够用它获得与激励信号相关的解析信号。但是，希尔伯特变换的单位冲激响应为$\dfrac{1}{\pi t}$，它不是因果信号，因此希尔伯特变换系统不是因果系统。

最后，我们来讨论因果的线性时不变系统的性质。设$h(t)$为因果线性时不变系统的单位冲激响应，则$h(t)u(t)=h(t)$。考虑系统的频率响应$H(\omega)=\mathcal{F} h(\omega)$，则有：
\begin{align*}
    H(\omega)&=\mathcal{F} [h(t)u(t)](\omega)\\
    &=\frac{1}{2\pi}H(\omega)*\left(\pi\delta(\omega)+\frac{1}{i\omega}\right)\\
    &=\frac{1}{2}H(\omega)+\frac{1}{2\pi i\omega}*H(\omega)
\end{align*}

考察上式的实部和虚部，记$H(\omega)=R(\omega)+iI(\omega)$，则有：
\begin{align*}
    R(\omega)&=\frac{1}{2}R(\omega)-\frac{1}{2\pi \omega}*I(\omega)\\
    I(\omega)&=\frac{1}{2}I(\omega)+\frac{1}{2\pi \omega}*R(\omega)
\end{align*}
整理可得：
\begin{align*}
    &R(\omega)=-\frac{1}{\pi \omega}*I(\omega)=\mathcal{H} ^{-1}I(\omega)\\
    &I(\omega)=\frac{1}{\pi \omega}*R(\omega)=\mathcal{H} R(\omega)
\end{align*}
也就是以下定理：
\begin{theorem}[希尔伯特变换关系]
    设$h(t)$为因果线性时不变系统的单位冲激响应，$H(\omega)=R(\omega)+iI(\omega)$为系统的频率响应，则$R(\omega)$与$I(\omega)$构成希尔伯特变换对，即：
    \begin{align*}
    &R(\omega)=-\frac{1}{\pi \omega}*I(\omega)=\mathcal{H} ^{-1}I(\omega)\\
    &I(\omega)=\frac{1}{\pi \omega}*R(\omega)=\mathcal{H} R(\omega)
\end{align*}
将这种关系称为\textbf{希尔伯特变换关系}(Hilbert transform relation)。
\end{theorem}

\subsection{拉东变换}\label{sub:radon}

拉东变换在医疗成像领域有着重要的应用，它使得我们可以通过x射线对人体进行扫描，进而重建人体内部的结构图像。本小节将介绍x射线成像的基本原理，读者将看到，一些资料中将这种技术描述为“x光透视”是不准确的。

考虑一束光强为$I_0$的光线穿过浑浊的水，则光线强度会随穿过水的距离增加而减小，如果浑浊程度是均匀的，我们可以用$I=I_0 e^{-\mu x}$来描述光线强度的变化，其中$x$为光线穿过水的距离，$\mu$描述了水的浑浊程度。如果水的浑浊程度不均匀，则在光线所在线段$L$上，$\mu$是空间位置的函数$\mu(x)$，出射光线的强度为：
\[I=I_0 \exp\left(-\int_{L}\mu(x)\,dx\right)\]

类似地，我们考虑一个水平移动的x射线源穿过人体，对人体进行扫描，而另一侧为探测器阵列，用于测量穿过人体后x射线的强度变化。这样，每一次扫描，我们都将获得若干直线上的x射线的总衰减量，可以想象，在适当的数据处理下，我们可以重建人体内部的衰减系数分布$\mu(x,y)$，进而得到人体内部的二维截面的结构图像。这就是\textbf{拉东变换}(Radon transform)做的工作。

拉东变换是一种广义的积分变换。积分变换通常将函数与某个权函数（例如，傅里叶变换时，权函数为$e^{-2\pi i\xi t}$或$e^{-i\omega t}$）相乘再积分，而拉东变换的则将函数与“权分布”相乘（这并不是一个标准的术语）。在给出它的定义之前，我们先来约定本小节中的符号。

\begin{definition}[二位平面上的直线系]
    二维平面上的直线$L:ax+by+c=0$可以由参数组$(\rho,\phi)$唯一确定，其中$\rho\geq 0$为原点到直线的距离，$\phi\in[0,\pi)$为$L$与x轴正方向的夹角。
    我们将$L$记为$L(\rho,\phi)$。
\end{definition}

在这样的符号下，$L(\rho,\phi)$具有单位法向量$\hat{\mathbf{n}}=(\cos\phi,\sin\phi)$，并且$$\forall (x,y)\in L(\rho,\phi),\rho=\mathbf{x}\cdot\hat{\mathbf{n}}=x\cos\phi+y\sin\phi$$
因此$L(\rho,\phi)$的方程为：
\[L(\rho,\phi): x\cos\phi+y\sin\phi-\rho=0\]

本小节中，我们总是将这个方程记为$l(x,y)=0$，其中函数$l(x,y)=x\cos\phi+y\sin\phi-\rho$。

\begin{definition}[线脉冲]
    设$L(\rho,\phi)$为二维平面上的一条直线，则它的\textbf{线脉冲}(line delta function)定义为
    \[\delta_{L(\rho,\phi)}=\delta(l(x,y))=\delta(x\cos\phi+y\sin\phi-\rho)\]
    其中$\delta$为一维狄拉克函数。尽管它只是一个形式上的函数，但借助它来理解拉东变换是方便的。
\end{definition}

以上我们给出了线脉冲在形式上的定义，作为分布而言，线脉冲的作用为：
\[\left\langle \delta_{L(\rho,\phi)},f\right\rangle=\int_{\mathbb{R}^2}\delta(l(x,y))f(x,y)\,dx\,dy=\int_{L(\rho,\phi)}f(x,y)\,ds\]
其中$ds$为弧长微元。也就是说，线脉冲作为泛函作用于二元函数$f(x,y)$，相当于$f$在直线$L(\rho,\phi)$上的线积分。实际上，它是以下定理的推论，不过我们不在这里进行证明。
\begin{claim}
    设有平面曲线$\gamma:F(x,y)=0$，$F$连续可微，且$|\nabla F|\neq 0$，其中
    \[\nabla F=\text{grad}F=\begin{bmatrix}
        \frac{\partial F}{\partial x}\\
        \frac{\partial F}{\partial y}        
    \end{bmatrix}\]
    为$F$的梯度，$|\cdot|$为向量值函数$\nabla F$的模长，则有：
    \begin{align*}
        \left\langle \delta_{\gamma},f\right\rangle=\int_{\mathbb{R}^2}\delta(F(x,y))f(x,y)\,dx\,dy=\int_{\gamma}\frac{f(x,y)}{|\nabla F|}\,ds
    \end{align*}
\end{claim}

类似的，线脉冲可以对高维空间中的\textbf{超平面}(hyperplane)定义。
\begin{definition}
$\mathbb{R}^n$中的超平面为：
\[P=\left\{\mathbf{x}\in\mathbb{R}^n\left|a_1 x_1+a_2 x_2+\cdots+a_n x_n=0,a_j(1\leq j\leq n)\text{为常数}\right.\right\}\]
在三维空间中，它就是我们所熟知的平面，而在n维空间中为n-1维流形，可以用参数对$(\rho,\hat{\mathbf{n}})$表示，其中$\rho$为原点到超平面的距离，$\hat{\mathbf{n}}$为单位法向量。我们又将超平面$P$记为$P(\rho,\hat{\mathbf{n}})$。尽管这样使用了n个参量，但$\hat{\mathbf{n}}$的参量不是独立的。
\end{definition}

现在，终于可以给出拉东变换的定义。
\begin{definition}[拉东变换]
    给定平面上的二元函数$f(x,y)$，它的拉东变换定义为：
    \begin{align*}
    \mathcal{R} f(\rho,\phi)=\left\langle \delta_{L(\rho,\phi)},f\right\rangle=\int_{\mathbb{R}^2}\delta(l(x,y))f(x,y)\,dx\,dy=\int_{L(\rho,\phi)}f(x,y)\,ds
    \end{align*}
\end{definition}
\begin{remark}
    我们也没有对$f$的范围进行讨论。一般而言，我们需要要求$f$分段连续，并且是紧支的或至少在无穷远处快速衰减至0的（例如施瓦兹函数），这样才能保证线积分存在。这个函数空间的精确描述由Cormack定理给出，我们不对它进行讨论，仅仅指出：这个函数空间构成线性空间。
\end{remark}
\begin{remark}
    沿用前面对超平面的记号，对于n元函数$f(\mathbf{x})$及超平面$P(\rho,\hat{\mathbf{n}})$，拉东变换定义为
    \begin{align*}
    \mathcal{R} f(\rho,\hat{\mathbf{n}})=\int_{\mathbb{R}^n}f(\mathbf{x})\delta(\rho-\mathbf{x}\cdot\hat{\mathbf{n}})\,d\mathbf{x}=\int_{P}f(\mathbf{x})\,d\Omega
    \end{align*}
    其中$d\Omega$是$n-1$维流形上的体积元。高维的拉东变换不是本小节的主要目标。
\end{remark}

\begin{example}[圆形特征函数的拉东变换]
    设有一以原点为中心，半径为$r$的圆形区域$$D=\{(x,y)|x^2+y^2\leq r^2\}$$
    考虑它的特征函数$\chi_D(x,y)$，则它的拉东变换为：
    \begin{align*}
        \mathcal{R} \chi_D(\rho,\phi)&=\int_{\mathbb{R}^2}\chi_D(x,y)\delta(x\cos\phi+y\sin\phi-\rho)\,dx\,dy\\
        &=\int_{L(\rho,\phi)}\chi_D(x,y)\,ds
    \end{align*}
    当$|\rho|>r$时，直线$L(\rho,\phi)$与圆形区域$D$没有交点，因此$\mathcal{R} \chi_D(\rho,\phi)=0$。当$|\rho|\leq r$时，直线$L(\rho,\phi)$与圆形区域$D$有两个交点，记为$A,B$，则：
    \begin{align*}
        \mathcal{R} \chi_D(\rho,\phi)&=\int_{L(\rho,\phi)}\chi_D(x,y)\,ds=|AB|=2\sqrt{r^2-\rho^2}
    \end{align*}
    综上所述，圆形区域的特征函数的拉东变换为：
    \[\mathcal{R} \chi_D(\rho,\phi)=\begin{cases}
        2\sqrt{r^2-\rho^2},&|\rho|\leq r\\
        0,&|\rho|>r
    \end{cases}\]
\end{example}
\begin{example}[高斯函数的拉东变换]
    二维高斯函数$e^{-\pi(x^2+y^2)}=e^{-\pi|\mathbf{x}|^2}$的拉东变换为：
    \begin{align*}
        \mathcal{R} [e^{-\pi|\mathbf{x}|^2}](\rho,\phi)&=\int_{\mathbb{R}^2}e^{-\pi(x^2+y^2)}\delta(x\cos\phi+y\sin\phi-\rho)\,dx\,dy\\
        &=\int_{L(\rho,\phi)}e^{-\pi(x^2+y^2)}\,ds
    \end{align*}
    做正交变量替换：
    \[\begin{bmatrix}u\\v\end{bmatrix}=\begin{bmatrix}
        \cos\phi & \sin\phi\\
        -\sin\phi & \cos\phi
    \end{bmatrix}\begin{bmatrix}x\\y\end{bmatrix}\]
    则有$ds=dv$，并且在直线$L(\rho,\phi)$上，$u=\rho$，因此：
    \begin{align*}
        \mathcal{R} [e^{-\pi|\mathbf{x}|^2}](\rho,\phi)&=\int_{-\infty}^{\infty}e^{-\pi(\rho^2+v^2)}\,dv\\
        &=e^{-\pi \rho^2}\int_{-\infty}^{\infty}e^{-\pi v^2}\,dv\\
        &=e^{-\pi \rho^2}
    \end{align*}
    高斯函数的拉东变换仍是高斯函数，令人惊讶。
\end{example}

下面，我们首先给出一些二维拉东变换的基本性质，再使用傅里叶变换来研究拉东变换。

\begin{proposition}[线性性]
    拉东变换是线性的，即任给$f,g:\mathbb{R}^2\to\mathbb{C}$及常数$a,b\in\mathbb{C}$，有
    \[\mathcal{R}[af+bg](\rho,\phi)=a\mathcal{R} f(\rho,\phi)+b\mathcal{R} g(\rho,\phi)\]
\end{proposition}
这个性质是显然的。

\begin{proposition}[平移性质]
    \[\mathcal{R} [\tau_{\mathbf{b}}f](\rho,\hat{\mathbf{n}})=\mathcal{R} f(\rho-\hat{\mathbf{n}}\cdot\mathbf{b},\hat{\mathbf{n}})\]
\end{proposition}
$\rho-\hat{\mathbf{n}}\cdot\mathbf{b}<0$的情况，将在下一性质指出处理方法。
\begin{proof}
    \begin{align*}
        \mathcal{R} [\tau_{\mathbf{b}}f](\rho,\hat{\mathbf{n}})&=\int_{\mathbb{R}^2}f(\mathbf{x}-\mathbf{b})\delta(\rho-\mathbf{x}\cdot\hat{\mathbf{n}})\,d\mathbf{x}\\
        &=\int_{\mathbb{R}^2}f(\mathbf{y})\delta(\rho-(\mathbf{y}+\mathbf{b})\cdot\hat{\mathbf{n}})\,d\mathbf{y}&(\mathbf{y}=\mathbf{x}-\mathbf{b})\\
%        &=\int_{\mathbb{R}^2}f(\mathbf{y})\delta((\rho-\mathbf{b}\cdot\hat{\mathbf{n}})-\mathbf{y}\cdot\hat{\mathbf{n}})\,d\mathbf{y}\\
        &=\mathcal{R} f(\rho-\hat{\mathbf{n}}\cdot\mathbf{b},\hat{\mathbf{n}}) 
    \end{align*}
    这里我们将$\delta$作为形式函数来使用，但读者容易对照这个证明，借助线积分给出严格的证明。
\end{proof}

\begin{proposition}[均匀性]
    $\mathcal{R} f(\rho,\phi)$可以延拓为$(\rho,\phi)\in\mathbb{R}^2$的函数，并且
    \[\mathcal{R} f(-\rho,\phi)=\mathcal{R} f(\rho,\phi+\pi)\]
\end{proposition}
\begin{proof}
    形式上，$\delta$是偶分布，因此
    \begin{align*}
        \mathcal{R} f(-\rho,\phi)&=\int_{\mathbb{R}^2}f(x,y)\delta(-\rho - (x\cos\phi+y\sin\phi))\,dx\,dy\\
        &=\int_{\mathbb{R}^2}f(x,y)\delta(\rho + x\cos(\phi+\pi)+y\sin(\phi+\pi))\,dx\,dy\\
        &=\mathcal{R} f(\rho,\phi+\pi)
    \end{align*}
    在拉东变换的分布定义$\left\langle \delta_{L(\rho,\phi)},f\right\rangle$中，$\rho$下，这个命题的严格证明也是容易给出的，不过至此已经能看出拉东变换中使用$\delta$函数的好处。
\end{proof}

\begin{theorem}[投影切片定理]
    将$\mathcal{R} f(\rho,\phi)$关于$\rho$做一维傅里叶变换（这是含参变量$\phi$的积分变换），我们记之为$\mathcal{F} _{\rho}[\mathcal{R} f](r,\phi)$，则有：
    \[\mathcal{F} _{\rho}[\mathcal{R} f](r,\phi)=\mathcal{F} f(r\hat{\mathbf{n}})=\mathcal{F} f(r\cos\phi,r\sin\phi)\]
\end{theorem}
\begin{proof}
    带入定义并交换积分次序：
    \begin{align*}
        \mathcal{F} _{\rho}[\mathcal{R} f](r,\phi)&=\int_{-\infty}^{\infty}\mathcal{R} f(\rho,\phi)e^{-2\pi i r \rho}\,d\rho\\
        &=\int_{-\infty}^{\infty}\left(\int_{\mathbb{R}^2}f(x,y)\delta(x\cos\phi+y\sin\phi-\rho)\,dx\,dy\right)e^{-2\pi i r \rho}\,d\rho\\
        &=\int_{\mathbb{R}^2}f(x,y)\left(\int_{-\infty}^{\infty}\delta(x\cos\phi+y\sin\phi-\rho)e^{-2\pi i r \rho}\,d\rho\right)\,dx\,dy\\
        &=\int_{\mathbb{R}^2}f(x,y)e^{-2\pi i r (x\cos\phi+y\sin\phi)}\,dx\,dy\\
        &=\mathcal{F} f(r\cos\phi,r\sin\phi)
    \end{align*}
    要将这个证明严格化，需要限定$f\in\mathcal{S} (\mathbb{R}^2)$，其中$\mathcal{S} (\mathbb{R}^2)$为二维施瓦兹函数空间，将$\delta$用类似\ref{sub:approach}的方法进行逼近，这个过程比较复杂，本书不进行讨论。
\end{proof}

根据投影切片定理，如果我们能够对$[0,\pi)$区间内的每个角度，对足够宽范围内的$\rho$进行测量，就可以得到$\mathcal{R} f(\rho,\phi)$，于是
\[f(x,y)=\mathcal{F} ^{-1}[\mathcal{F} f](x,y)=\mathcal{F} ^{-1}[\mathcal{F} _{\rho}[\mathcal{R} f]](x,y)\]
在充分大的采样频率下，我们可以还原出清晰度足够的图像。这就是x射线成像的基本原理。

\subsection{汉克尔变换}\label{sub:hankel}

如果说多维傅里叶变换是一维傅里叶变换在多维直角坐标系下的版本，那么\textbf{汉克尔变换}(Hankel transform)则是从一维傅里叶变换的“圆形版本”，它适用于具有\textbf{辐射对称}(radial symmetry)或称\textbf{循环对称}(circular symmetry)特性的函数。汉克尔变换需要用到\ref{sub:bessel}中介绍的第一类贝塞尔函数。

\begin{definition}[辐射对称性]
    $f:\mathbb{R}^n\to\mathbb{C}$具有\textbf{辐射对称性}(radial symmetry)，如果
    $$\forall\mathbf{x}\in\mathbb{R}^n,f(\mathbf{x})=f(\|\mathbf{x}\|)$$
    即$f$的极坐标表示仅仅依赖于径向变量$r=\|\mathbf{x}\|$，而与角度无关。
\end{definition}

\begin{definition}[汉克尔变换]
    设$f:[0,\infty)\to\mathbb{C}$，$n\in\mathbb{Z}^+$，则$f$的\textbf{n阶汉克尔变换}(n-th order Hankel transform)定义为：
    \[\mathcal{H} _n f(k)=\int_0^{\infty}f(r)J_n(kr)r\,dr\]
    其中$J_n$为第一类贝塞尔函数。
\end{definition}

本小节主要介绍0阶汉克尔变换，因为它与二维傅里叶变换有着密切的联系，简介起见，本小节使用角频率形式的二维傅里叶变换。

\begin{lemma}
    设$f:\mathbb{R}^2\to\mathbb{C}$具有辐射对称性，则其傅里叶变换$\mathcal{F} f$也具有辐射对称性。
\end{lemma}
\begin{proof}
    为了区别空间域和频率域，我们将空间域的极坐标记为$(r,\theta)$，频率域的极坐标记为$(\rho,\phi)$，于是$f(\mathbf{x})=f(r)$。极坐标下，$\mathbf{x}=(r\cos\theta,r\sin\theta)$，$\boldsymbol{\omega}=(\rho\cos\phi,\rho\sin\phi)$，因此
    $$\boldsymbol{\omega}\cdot\mathbf{x}=\rho r(\cos\theta\cos\phi+\sin\theta\sin\phi)=\rho r \cos(\phi-\theta)$$
    带入二维傅里叶变换的定义，有：
    \begin{align*}
        \mathcal{F} f(\boldsymbol{\omega})&=\int_{\mathbb{R}^2}f(\mathbf{x})e^{-i\boldsymbol{\omega}\cdot\mathbf{x}}\,d\mathbf{x}\\
        &=\int_0^{\infty}\int_0^{2\pi}f(r)e^{-i \rho r \cos(\phi-\theta)}r\,d\theta\,dr\\
        &=\int_0^{\infty}f(r)r\,dr\int_0^{2\pi}e^{-i \rho r \cos(\phi-\theta)}\,d\theta\\
        &=\int_0^{\infty}f(r)r\,dr\int_0^{2\pi}e^{-i \rho r \cos\theta}\,d\theta&(\theta\to \theta+\phi)\\
    \end{align*}
    注意到最后一行的表达式与$\phi$无关，因此$\mathcal{F} f(\boldsymbol{\omega})$仅依赖于$\rho$，即具有辐射对称性。
\end{proof}

\begin{theorem}
    设$f:\mathbb{R}^2\to\mathbb{C}$具有辐射对称性，记$f(\mathbf{x})=f(r)$，其中$r=\|\mathbf{x}\|$，则$f$的二维傅里叶变换$\mathcal{F} f(\boldsymbol{\omega})$也具有辐射对称性，记$\mathcal{F} f(\boldsymbol{\omega})=F(\rho)$，其中$\rho=\|\boldsymbol{\omega}\|$，并且有：
    \[F(\rho)=2\pi \int_0^{\infty}f(r)J_0(\rho r)r\,dr=2\pi\mathcal{H}_0 f(\rho)\]
\end{theorem}
\begin{proof}
    根据\ref{sub:bessel}节中的结论，\begin{align*}
        \int_{0}^{2\pi}e^{-i \rho r \cos\theta}\,d\theta&=2\pi J_0(\rho r)
    \end{align*}
    带入前一引理的证明中推导的傅里叶变换的表达式，得到：
    \begin{align*}
        \mathcal{F} f(\boldsymbol{\omega})&=\int_0^{\infty}f(r)r\,dr\int_0^{2\pi}e^{-i \rho r \cos\theta}\,d\theta\\
        &=2\pi \int_0^{\infty}f(r)J_0(\rho r)r\,dr\\
        &=2\pi \mathcal{H} _0 f(\rho)
    \end{align*}
\end{proof}

\begin{example}[圆形特征函数的傅里叶变换]
    与上一小节相同，记$D=\{(x,y)|x^2+y^2\leq r^2\}$，则它的特征函数$\chi_D(x,y)$的二维傅里叶变换为：
    \begin{align*}
        \mathcal{F} \chi_D(\boldsymbol{\omega})&=2\pi\mathcal{H}_0 \chi_D(\rho)\\
        &=2\pi \int_0^{\infty}\chi_D(r)J_0(\rho r)r\,dr\\
        &=2\pi \int_0^{r}J_0(\rho r)r\,dr
    \end{align*}
    其中$\rho=\|\boldsymbol{\omega}\|$。根据\ref{sub:bessel}节中的结论，有：
    \begin{align*}
        F\chi_D(\boldsymbol{\omega})&=2\pi \left[\frac{r J_1(\rho r)}{\rho}\right]\\
        &=\frac{2\pi r}{\rho}J_1(\rho r)
    \end{align*}
\end{example}

遗憾的是，更高维度下的辐射对称函数的傅里叶变换要复杂得多。事实上，我们有：
\begin{claim}
    设$f:\mathbb{R}^n\to\mathbb{C}$具有辐射对称性，记$f(\mathbf{x})=f(r)$，其中$r=\|\mathbf{x}\|$，则$f$的n维傅里叶变换$\mathcal{F} f(\boldsymbol{\omega})$也具有辐射对称性，记$\mathcal{F} f(\boldsymbol{\omega})=F(\rho)$，其中$\rho=\|\boldsymbol{\omega}\|$，引入常数$\nu=\dfrac{n}{2}-1$，则有：
    \[F(\rho)=(2\pi)^{n/2}\rho^{-\nu}\int_0^{\infty}f(r)J_{\nu}(\rho r)r^{\nu+1}\,dr=(2\pi)^{n/2}\rho^{-\nu}\mathcal{H}_\nu f(\rho)\]
\end{claim}

这意味着，在高维空间中，辐射对称函数的傅里叶变换可以用半整数阶汉克尔变换表示，仅仅使用第一类贝塞尔函数是无法处理奇数维空间的情况的。

\section{回到有限区间}\label{sec:Finite_Interval}

%PS3.6卷积的周期化
%PS4.3
%加窗傅里叶变换，小波变换

\chapter{拉普拉斯变换与系统的复频域分析}

\section{复变函数概要}\label{sec:Complex}

本小节将串写拉普拉斯变换所需的复变函数论中的一些基本概念和重要结果\cite{Function_Theory}。实际上，只需要复变函数中一些最基础的概念即可建立起拉普拉斯变换理论的大部分内容。因此，即便是未学过复变函数的读者，也可通过本小节快速把握拉普拉斯变换中所需的复变函数的内容。

\subsection{形式导数与全纯函数}\label{sub:derivative_and_holomorphic}
我们总是用$z$表示复数$x+iy$。考虑复系数双变元多项式集$\mathbb{C}[x,y]$，通过做替换$$x=\frac{z+\overline{z}}{2},y=\frac{z-\overline{z}}{2i}$$
可以将$\mathbb{C}[x,y]$中的多项式$f(x,y)$表示为$g(z,\overline{z})$。在一些情况下，$g(z,\overline{z})$不显含$\overline{z}$，例如$f(x,y)=x+iy$，$g(z,\overline{z})=z$。对于$f(x,y)$，我们可以用导数$\frac{\partial f}{\partial x},\frac{\partial f}{\partial y}$来描述它对$x,y$的依赖关系，同理，为了表述多项式对$z,\overline{z}$的依赖关系，我们定义:\begin{definition}[形式导数]
    设$f=u+iv\in C^1(\mathbb{C})$，$u,v$为复数域上的实值函数，则
    \begin{align*}
        \frac{\partial f}{\partial z}=\frac{1}{2}\left(\frac{\partial}{\partial x}-i\frac{\partial}{\partial y}\right)f=\frac{1}{2}\left(\frac{\partial u}{\partial x}+\frac{\partial v}{\partial y}\right)+\frac{i}{2}\left(\frac{\partial v}{\partial x}-\frac{\partial u}{\partial y}\right)\\
        \frac{\partial f}{\partial \overline{z}}=\frac{1}{2}\left(\frac{\partial}{\partial x}+i\frac{\partial}{\partial y}\right)f=\frac{1}{2}\left(\frac{\partial u}{\partial x}-\frac{\partial v}{\partial y}\right)-\frac{i}{2}\left(\frac{\partial v}{\partial x}+\frac{\partial u}{\partial y}\right)
    \end{align*}
\end{definition}
注意$f$未必是多项式，多项式只是为了给我们提供一个直观的动机和理解方式。

这种定义可以视作复合函数求导的结果，即\[\frac{\partial f}{\partial z}=\frac{\partial f}{\partial x}\frac{\partial x}{\partial z}+\frac{\partial f}{\partial y}\frac{\partial y}{\partial z},\frac{\partial f}{\partial \overline{z}}=\frac{\partial f}{\partial x}\frac{\partial x}{\partial \overline{z}}+\frac{\partial f}{\partial y}\frac{\partial y}{\partial \overline{z}}\]

读者可以自行验证，在这样的定义下有：\begin{claim}
    \begin{align*}
        \frac{\partial z}{\partial z}=\frac{\partial \overline{z}}{\partial \overline{z}}=1,\\
        \frac{\partial z}{\partial \overline{z}}=\frac{\partial \overline{z}}{\partial z}=0
    \end{align*}
\end{claim}

这种形式导数在其他方面也很像普通的导数，甚至可以说$z,\overline{z}$构成了一组新的坐标。例如：
\begin{claim}[莱布尼兹法则]
    \[\frac{\partial}{\partial z}(fg)=f\frac{\partial}{\partial z}g+g\frac{\partial}{\partial z}f\]
    \[\frac{\partial}{\partial \overline{z}}(fg)=f\frac{\partial}{\partial \overline{z}}g+g\frac{\partial}{\partial \overline{z}}f\]
\end{claim}
\begin{claim}[链式法则]
    设$f,g\in C^1$，$f\circ g$有定义并记$w=g(z)$，则
    \begin{align*}
        \frac{\partial}{\partial z}(f\circ g)=\frac{\partial f}{\partial w}\frac{\partial g}{\partial z}+\frac{\partial f}{\partial \overline{w}}\frac{\partial\overline{g}}{\partial z}\\
        \frac{\partial}{\partial \overline{z}}(f\circ g)=\frac{\partial f}{\partial w}\frac{\partial g}{\partial \overline{z}}+\frac{\partial f}{\partial \overline{w}}\frac{\partial\overline{g}}{\partial \overline{z}}
    \end{align*}
\end{claim}
以上结论的证明略去，它们只是多元微分学的小练习。
\begin{remark}*
    对于了解微分形式的语言的读者，可以更好地理解$z,\overline{z}$作为坐标的意义以及形式导数的意义。定义1-形式\cite{shijihuai}
    $$dz=dx+idy,d\overline{z}=dx-idy$$
    则$dz\wedge d\overline{z}=-2i dx\wedge dy$。定义算子
    $$\partial f=\frac{\partial f}{\partial z}dz,\overline{\partial} f=\frac{\partial f}{\partial \overline{z}}d\overline{z}$$
    作用于1-形式时，有
    $$\partial(f(z,\overline(z))dz+g(z,\overline{z})d\overline{z})=\frac{\partial g}{\partial z}dz\wedge d\overline{z},\overline{\partial}(f(z,\overline{z})dz+g(z,\overline{z})d\overline{z})=\frac{\partial f}{\partial \overline{z}}d\overline{z}\wedge dz$$
    可以验证：$$d=\partial+\overline{\partial},\partial^2=\overline{\partial}^2=0,\partial\overline{\partial}+\overline{\partial}\partial=0$$
\end{remark}
\begin{definition}[全纯函数]
    设开集$U\in\mathbb{C}$，如果$f=u+iv\in C^1(U)$满足$\frac{\partial f}{\partial \overline{z}}=0,\forall z\in U$，则称$f$为$U$上的\textbf{全纯函数}(holomorphic function)。这等价于$u,v$在$U$上满足\textbf{柯西-黎曼方程组}(Cauchy-Riemann equations)：
    \begin{align*}
        \begin{cases}
        \frac{\partial u}{\partial x}=\frac{\partial v}{\partial y}\\
        \frac{\partial v}{\partial x}=-\frac{\partial u}{\partial y}
        \end{cases},\text{或}\frac{\partial f}{\partial y}= i\frac{\partial f}{\partial x}
    \end{align*}
\end{definition}
\begin{definition}[整函数]
    如果$f$在整个复平面$\mathbb{C}$上全纯，则称$f$为\textbf{整函数}(entire function)。
\end{definition}

全纯等价于极限\[\lim_{\zeta\to z}\frac{f(\zeta)-f(z)}{\zeta-z}\]
存在，即全纯等价于复可导性，并且由此定义的导数$f'(z)=\frac{\partial f}{\partial z}$；全纯函数还是无限阶可导的，其各阶导数也是全纯函数，并且全纯性等价于解析性，即其泰勒级数在收敛域内一定收敛于这个函数本身：
\begin{definition}[复变函数的泰勒级数展开]
    设$f$为开集$U\in\mathbb{C}$上的全纯函数，$D(a,R)\in U$，则$\forall z\in D(a,R)$，有
    \[f(z)=\sum_{n=0}^{\infty}\frac{f^{(n)}(a)}{n!}(z-a)^n\]
    其中$f^{(n)}(a)$表示$f$在$a$处的第n阶导数。
\end{definition}

以上定义其实隐含了一个很强的结论：只要$D(a,r)\in U$，则$f$在$a$处的泰勒级数在$D(a,r)$上收敛于$f$，即泰勒级数的收敛半径恰为$f$在$a$处到$U$的边界的距离。
\begin{example}
    函数$f(z)=\dfrac{1}{1-z}$在$\mathbb{C}\backslash\{1\}$上全纯。将$f$展开为$z_0$处的泰勒级数，有
    \[f(z)=\frac{1/(1-z_0)}{1-\dfrac{z-z_0}{1-z_0}}=\sum_{n=0}^{\infty}\frac{1}{(1-z_0)^{n+1}}(z-z_0)^n\]
    收敛半径为$|1-z_0|$，即$f$在$z_0$处到点$z=1$的距离。

    我们马上将给出计算复幂级数收敛半径的方法，即柯西-阿达马公式，这时读者可以自行验证这个结果。
\end{example}

对实变函数，即便无限阶可导，泰勒级数也未必收敛于函数本身，即未必解析：
\begin{example}
    设$$f(x)=\begin{cases}
    e^{-1/x}&\text{,if\ }x> 0\\
    0&\text{,if\ }x\leq 0
    \end{cases}$$
    则$f(x)$在$x=0$处各阶导数都是0，泰勒展开式也为0，收敛域为$\mathbb{R}$，但$f(x)\neq 0,x>0$，它不是解析函数。
\end{example}

数学分析中，我们学过幂级数收敛半径的求法，复变函数的泰勒级数也有类似的结论：
\begin{theorem}[柯西-阿达马公式]
    复幂级数\[\sum_{n=0}^{\infty}c_n(z-a)^n\]
    的\textbf{收敛域}(region of convergence,ROC)为$D(a,R)$，其中收敛半径$R$由下式给出：
    \[R=\left(\varlimsup_{n\to\infty}|c_n|^{1/n}\right)^{-1}\]
    这里的极限是广义极限，即允许$R=0$（仅在中心点收敛）或$R=\infty$（级数在整个复平面上收敛）。
\end{theorem}
在复幂级数的收敛域上，级数是绝对收敛且内闭一致收敛的。其本质还是与几何级数做比较，收敛半径与实幂级数的收敛半径求法一致，实幂级数的收敛半径可看作是复幂级数的收敛半径在实轴上的投影。使用柯西-阿达马公式求出的收敛半径与前面提到的“到不全纯区域的距离”总是一致的，读者可以对例5.1.1.自行验算。

\subsection{复线积分}\label{sub:line_integral}
在数学分析中，我们曾学过曲线积分，它对于复平面上的复变函数也有意义：
\begin{definition}[复线积分]
    设开集$U\in\mathbb{C},f\in C^1(U),\gamma:[a,b]\to U$为$\mathbb{C}$中的$C^1$曲线，则
    \begin{align*}
        \int_{\gamma}f(z)\,dz=\int_a^bf(\gamma(t))\gamma'(t)\,dt
    \end{align*}
\end{definition}

与实变函数的曲线积分一致，可以验证此复线积分不依赖于参数$t$的选取，从而是良定义的，并且有：\begin{claim}
    \[f(\gamma(b))-f(\gamma(a))=\int_{a}^{b}(f\circ \gamma)'(t)\,dt=\int_{\gamma}\frac{\partial f}{\partial z}\,dz\]
\end{claim}
\begin{remark}
    前一个等号直接得自微积分基本定理，后一个等号才是需要证明的，读者可以带入形式导数的定义验算。
\end{remark}
实际上还能将曲线推广至分段一阶可导，即$\gamma\in PS[a,b]$，只要分区间使用微积分基本定理，就能得到与上面一致的结论，但为了叙述的简洁性，下面不再提及这一点。

后续内容中，我们用符号$D(z_0,r)$表示复平面上以$z_0=x_0+iy_0$为圆心，$r$为半径的开圆盘，即$D(z_0,r)=\{x+iy\in\mathbb{C}\big| (x-x_0)^2+(y-y_0)^2<r\}$；用符号$\mathcal{A} _a(r,R)=\{z\in\mathbb{C}|r<|z-a|<R\}$表示以$a$为圆心，内半径$r$，外半径$R$的开圆环。
\begin{theorem}[柯西积分公式]
    设开集$U\in\mathbb{C}$，$\gamma$为$C^1$闭曲线，且$$f\in C^1(U),D(z_0,r)\in U,\gamma:[a,b]\to D(z_0,r)$$则
    \[\forall z\in D(z_0,r),f(z)=\frac{1}{2\pi i}\oint_{\gamma}\frac{f(\zeta)}{\zeta-z}\,d\zeta\]
\end{theorem}
\begin{theorem}[柯西积分定理]
    设$f$是单连通开集$U\in\mathbb{C}$上的全纯函数，$\gamma(t)\in U$，则
    \[\oint_{\gamma}f(z)\,dz=0\]
\end{theorem}
\begin{remark}
    \textbf{单连通}(single connected)是一个拓扑学概念，直观上讲，它表示$U$道路连通且“没有洞”，例如单位圆是单连通的，而圆环$\mathcal{A}_0(1,2)$不是单连通的。
\end{remark}
\begin{example}
设$f(z)=1/z$，则$f$在$\mathbb{C}\backslash\{0\}$上全纯，但$\mathbb{C}\backslash\{0\}$不是单连通的，它在单位圆$\gamma(t)=e^{it},t\in[0,2\pi]$上积分为\begin{align*}
    \oint_{\gamma}f(z)\,dz=\int_0^{2\pi}f(\gamma(t))\gamma'(t)\,dt=\int_0^{2\pi}\frac{1}{e^{it}}ie^{it}\,dt=\int_0^{2\pi}i\,dt=2\pi i\neq 0
\end{align*}
\end{example}

\begin{remark}*
    根据Morera定理，单连通开集上的任意复线积分为0，则函数也是全纯函数，因此全纯函数与单连通开集上的复线积分为0是等价的。这种等价性表明可以用$\mathbb{R}^2$上的势场来理解全纯函数，其曲线积分具有路径无关性。根据数学分析中处理路径无关性的经验，我们可以分段调整积分路径，避开不全纯的区域。例如对$f(z)=1/z$在曲线$\gamma(t)=e^{it},t\in[0,2\pi]$上积分，尽管$f$在包含原点的区域上不全纯，但可以将$\gamma$分成两段，分别在不包含原点的半圆上积分并调整积分路径（例如调整到$\gamma_2(t)=2e^{it},t\in[0,2\pi]$）。理解这一点将有利于理解后面的留数定理中对积分曲线的要求。
\end{remark}

\begin{remark}*
    对于了解微分形式的语言的读者，可以从柯西-黎曼方程看出全纯函数$f=u+iv$相当于闭形式$u(x,y)dx+v(x,y)dy$。在单连通开集上，则闭形式也是恰当形式，1-形式$udx+vdy$相当于无旋无源场，且$udx+vdy$是某实函数$\varphi$的外导数，即$d\varphi=\frac{\partial \varphi}{\partial x}dx+\frac{\partial \varphi}{\partial y}dy=udx+vdy$；另外，根据另一柯西-黎曼方程$-v(x,y)dx+u(x,y)dy$也是闭形式、恰当形式，是某实函数$\psi$的外导数，即$d\psi=-v\,dx+u\,dy$。由于$\varphi,\psi$满足柯西-黎曼方程，可以定义全纯函数$g=\varphi+i\psi$，将$g$称为向量场$f$的\textbf{复势函数}(complex potential function)，$\frac{\partial g}{\partial z}=u-iv$与$f$互为共轭复变函数。如果将$d\psi$取为$v\,dx-u\,dy$，$g=\varphi+i\psi$，则$\frac{\partial g}{\partial z}=u+iv=f$，即单连通开集上的全纯函数$f$总是某个全纯函数$g$的导数。
\end{remark}

\subsection{洛朗级数}\label{sub:laurant_series}
对于$f(z)=1/z$这样的函数，它已经是很简洁的分式形式了，但它在$z=0$处并不是全纯函数，因此不能在包含0的开集上展开成泰勒级数。我们将破坏了全纯性的这种点称为\textbf{孤立奇点}(isolated singular point)，孤立表示它不构成奇点集的极限点。为了处理这种情况，我们引入\textbf{洛朗级数}：

\begin{definition}[洛朗级数]
    设$a\in\mathbb{C}$，形如
    \[\sum_{n=-\infty}^{\infty}c_n(z-a)^n\]
    的级数称为以$a$为中心的\textbf{洛朗级数}，其收敛域记为ROC。

    将它的负幂次项部分视为$w=1/(z-a)$下的幂级数，则可用柯西-阿达马公式确定它的收敛域为圆环$\mathcal{A} _a(r,R)$，其中$r,R$分别称为洛朗级数的\textbf{外半径}(outer radius)和\textbf{内半径}(inner radius)，满足：
    \[r=\varlimsup_{n\to\infty}|c_{-n}|^{1/n},R=\left(\varlimsup_{n\to\infty}|c_n|^{1/n}\right)^{-1}\]
    在$\text{ROC}=\mathcal{A} _a(r,R)$上，洛朗级数是绝对收敛且内闭一致收敛的。
\end{definition}
事实上，对任意的全纯函数$f:U\to\mathbb{C}$，及孤立奇点$a\in U$，$f$在$a$处存在且有唯一的洛朗级数展开式。

借助洛朗级数的一致收敛性，可以建立一个对柯西积分公式的直观认识：记$f_n(z)=1/z^n,n\in\mathbb{Z}$，则在逆时针绕0一周的闭曲线$\gamma$上，有
\[\oint_{\gamma}f_n(z)\,dz=\begin{cases}0&n\neq 1\\2\pi i&n=1\end{cases}\]
我们已经在前面说明了路径无关性，下面设$\gamma(t)=e^{it},t\in[0,2\pi]$，则
\begin{align*}
    \oint_{\gamma}f_n(z)\,dz&=\int_0^{2\pi}f_n(\gamma(t))\gamma'(t)\,dt\\
    &=\int_0^{2\pi}\frac{1}{(e^{it})^n} ie^{it}\,dt\\
    &=i\int_0^{2\pi}e^{i(1-n)t}\,dt\\
    &=\begin{cases}
        i\int_0^{2\pi}\,dt=2\pi i&n=1\\
        i\evalat{\left[\frac{e^{i(1-n)t}}{i(1-n)}\right]}{0}{2\pi}=0&n\neq 1
    \end{cases}
\end{align*}

为了验证柯西积分公式
\[f(z)=\frac{1}{2\pi i}\oint_{\gamma}\frac{f(\zeta)}{\zeta-z}\,d\zeta,\gamma:t\mapsto z+re^{it},t\in[0,2\pi]\]将$f$展开为$z$处的洛朗级数$f(\zeta)=\sum_{n=0}^{\infty}c_n (\zeta-z)^n$，由于洛朗级数在闭曲线$\gamma$上一致收敛，可以交换求和与积分的次序，得到
\begin{align*}
    \oint_{\gamma}\frac{f(\zeta)}{\zeta-z}\,dz&=\oint_{\gamma}\sum_{n=0}^{\infty}c_n (\zeta-z)^{n-1}\,d\zeta\\
    &=\sum_{n=0}^{\infty}c_n\oint_{\gamma}(\zeta-z)^{n-1}\,d\zeta\\
    &=2\pi i c_0=2\pi i f(z)
\end{align*}

多数情况下，洛朗级数的负幂次项并不真正构成级数，即负幂次项仅仅由有限项构成，因此内半径必为0，即只要外半径$R>0$，洛朗级数就在展开点的去心邻域内收敛。例如$f(z)=1/z$在0处的展开式就是它本身，收敛域为$\mathcal{A}_0(0,\infty)=\mathbb{C}^*$。根据负幂次项是否存在、是否构成级数，我们可以将孤立奇点分为三类：
\begin{definition}[孤立奇点的分类]
    设$f$在开集$U\in\mathbb{C}$上全纯，$a$为$f$的孤立奇点，$f$在$a$处的洛朗级数展开式为
    \[f(z)=\sum_{n=-\infty}^{\infty}c_n(z-a)^n\]
    \begin{enumerate}
        \item 如果$c_n=0,\forall n<0$，则称$a$为$f$的\textbf{可去奇点}(removable singularity)；
        \item 如果$\exists m\in\mathbb{N}_+$使得$c_{-1}=c_{-2}=\cdots=c_{-m}=0,c_{-(m+1)}\neq 0$，则称$a$为$f$的\textbf{m阶极点}(pole of order m)，$m$阶极点意味着$f(z)$在$a$处趋于无穷的速度与$1/(z-a)^m$同阶。
        其中$m=1$时，称$a$为$f$的\textbf{简单极点}(simple pole)；
        \item 如果$c_n\neq 0$对无穷多个负整数$n$成立，则称$a$为$f$的\textbf{本性奇点}(essential singularity)。
    \end{enumerate}
\end{definition}
\begin{example}
$f(z)=e^{1/z}$在0处有本性奇点，$f(z)=1/\sin(\pi z)$在$z=n,n\in\mathbb{Z}$处有简单极点，$f(z)=\dfrac{\sin z}{z}$在0处有可去奇点。
\end{example}

类似地也可以根据泰勒级数或等价无穷小量定义全纯函数的若干阶的零点，不过这不属于我们讨论的范围。

柯西积分公式中，$\dfrac{f(\zeta)}{\zeta-z}$这一结构相当于为$f(\zeta)$添加了一个简单极点。\textbf{留数定理}(residue theorem)就是描述复线积分的值与被积函数在闭曲线内部的“$1/z$”系数关系的定理：
\begin{theorem}[留数定理]
    设$f$为开集$U\in\mathbb{C}$上的全纯函数，$a_1,a_2,\cdots,a_n$为$f$在$U$内的极点，$\gamma:[a,b]\to U$为包含所有$a_k$的$C^1$闭曲线，则
    \[\oint_{\gamma}f(z)\,dz=2\pi i\sum_{k=1}^{n}\text{Res}(f,a_k)\text{Ind}_{\gamma}(a_k)\]
    其中$\text{Res}(f,a_k)$称为$f$在$a_k$处的\textbf{留数}(residue)，它等于$f$在$a_k$处洛朗级数展开式中$(z-a_k)^{-1}$项的系数；$\text{Ind}_{\gamma}(a_k)$称为$\gamma$绕点$a_k$的\textbf{环绕数}(winding number)，它表示$\gamma$绕$a_k$转了多少圈。
\end{theorem}
注意计算环绕数时，以逆时针为正向，例如$\gamma(t)=e^{it},t\in[0,2\pi]$绕原点的环绕数为1，而$\gamma(t)=e^{-it},t\in[0,2\pi]$绕原点的环绕数为-1。希望了解环绕数严格定义的读者可以参考复变函数或拓扑学的教材。在留数定理的语境下又将积分路径称为\textbf{围道}(contour)。

要找到$f$在极点$a$处的留数的计算公式，可以将$f$视同其在$a$处的洛朗级数展开式：
\[f(z)=\sum_{n=-k}^{\infty}c_n(z-a)^n\]
这里假设$a$为$f$的k阶极点。在处理泰勒级数时，我们在$f(x)=\sum_{n=0}^{\infty}a_n x^n$中两边同时对$x$求导再令$x=0$，得到$f^{(m)}(0)=m!a_m$。类似地，在处理洛朗级数时，我们可以将其乘以$(z-a)^k$从而化归到泰勒级数：
\begin{align*}
    (z-a)^k f(z)=\sum_{n=0}^{\infty}c_{n-k}(z-a)^n
\end{align*}
\begin{align*}
    \frac{d^{k-1}}{dz^{k-1}}((z-a)^k f(z))=\sum_{n=0}^{\infty}c_{n-k}\frac{d^{(k-1)}}{dz^{(k-1)}}(z-a)^n=\sum_{n=k-1}^{\infty}c_{n-k}\frac{n!}{(n-k+1)!}(z-a)^{n-k+1}
\end{align*}
令$z\to a$，就得到留数的计算公式：\begin{proposition}
    设$f$在$a$处有k阶极点，则
    \[\text{Res}(f,a)=\frac{1}{(k-1)!}\lim_{z\to a}\frac{d^{(k-1)}}{dz^{(k-1)}}((z-a)^k f(z))\]
    特别地，对于简单极点，有
    \[\text{Res}(f,a)=\lim_{z\to a}(z-a)f(z)\]
\end{proposition}

我们使用留数定理来计算一个傅里叶变换作为例子。
\begin{example}
    计算$f(t)=\dfrac{1}{a^2+t^2}$的傅里叶变换$\mathcal{F} f(\omega)$。\\
    解：根据定义，$\mathcal{F} f(\omega)=\int_{-\infty}^{\infty}\dfrac{1}{a^2+t^2}e^{-i\omega t}\,dt$。为了使用留数定理计算该积分，我们将其推广为复变量上的积分，注意在$\mathbb{R}$上$z=\text{Re}\,z=t$：
    \[\mathcal{F} f(\omega)=\int_{-\infty}^{\infty}\frac{1}{a^2+z^2}e^{-i\omega z}\,dz\]
    设$f(z)=\dfrac{e^{-i\omega z}}{a^2+z^2}$，围道为：\begin{align*}
        &\gamma_1:t\mapsto t,t\in[-R,R]\\
        &\gamma_2:t\mapsto Re^{-it},t\in[0,\pi]
    \end{align*}
    则$\int_{\gamma_1}f(z)\,dz=\int_{-R}^{R}\frac{1}{a^2+t^2}e^{-i\omega t}\,dt$，当$R\to\infty$时，$\int_{\gamma_1}f(z)\,dz\to \mathcal{F} f(\omega)$。经验上，另一条趋向无穷远处的围道上的积分将变成0，我们来验证这一点：\begin{align*}
        \left|\int_{\gamma_2}f(z)\,dz\right|&=\left|-\int_0^{\pi}\frac{1}{a^2+R^2e^{-2it}}e^{i\omega Re^{it}}iRe^{-it}\,dt\right|\\
        &\leq \sup_{t\in[0,\pi]}\left|\frac{1}{a^2+R^2e^{2it}}e^{i\omega Re^{it}}iRe^{it}\right|\mu(\gamma_2)\\
        &\leq \frac{\pi Re^{-\omega R\sin t}}{R^2+a^2}\to 0&(R\to\infty)
    \end{align*}
    这里的$\mu(\gamma_2)$表示$\gamma_2$的长度。围道内仅有一个简单极点$-ai$，环绕数为-1，根据留数定理，有
    \begin{align*}
        \oint_{\gamma}f(z)\,dz=-2\pi i\text{Res}(f,-ai)=-2\pi i\lim_{z\to -ai}(z+ai)\frac{e^{-i\omega z}}{a^2+z^2}=\frac{\pi}{a}e^{a\omega}
    \end{align*}
\end{example}

\subsection{*唯一延拓定理}\label{sub:unique_exetension}
\begin{theorem}*
    设$U\in\mathbb{C}$为连通开集，$f$为$U$上的全纯函数，如果$f$的\textbf{零集}（zero set）$Z(f)=\{z\in U|f(z)=0\}$有$U$中的极限点，则$f(z)=0,\forall z\in U$。
\end{theorem}
\begin{corollary}*
    设$f,g$为连通开集$U\in\mathbb{C}$上的全纯函数，$S\subset U$，且$S$包含$U$中的极限点，如果$f(z)=g(z),\forall z\in S$，则$f(z)=g(z),\forall z\in U$。
\end{corollary}
这表明连通开集上的全纯函数环是整环。
\begin{corollary}[*唯一延拓定理]
    整函数可以由$\mathbb{R}$上的值唯一确定，即如果整函数$f,g$满足$f(x)=g(x),\forall x\in\mathbb{R}$，则$f(z)=g(z),\forall z\in\mathbb{C}$。
\end{corollary}

借助唯一延拓定理，可以将实变量上的函数延拓为复变量上的全纯函数，例如$\sin x,\cos x,e^x$都可以延拓为复变量上的全纯函数，它们的复幂级数与实幂级数一致，并且运算公式（如和差角公式、欧拉公式等）均可以推广到复变量上，因为在实轴上恒为0的函数在复平面上也恒为0。

\begin{example}[三角函数]
    在实变量的情形下，熟知\begin{align*}
        &\sin^2 x+\cos^2 x=1\\
        &\sin(x+y)=\sin x\cos y+\cos x\sin y\\
        &\cos(x+y)=\cos x\cos y-\sin x\sin y
    \end{align*}
    我们定义：\begin{align*}
        f(z)&=\sin^2 z+\cos^2 z-1\\
        g(z)&=\sin(z+y)-\sin z\cos y-\cos z\sin y\\
        h(z)&=\cos(z+y)-\cos z\cos y+\sin z\sin y
    \end{align*}
    则$f,g,h$均为复变量上的全纯函数，并且在实轴上恒为0，根据唯一延拓定理，$f(z)=g(z)=h(z)=0,\forall z\in\mathbb{C}$，即三角函数的这些公式可以推广到复变量上。
\end{example}
\begin{example}[双曲函数]
    双曲正弦、双曲余弦、双曲正切函数分别定义为
    \begin{align*}
        \sinh z&=\frac{e^z-e^{-z}}{2}\\
        \cosh z&=\frac{e^z+e^{-z}}{2}\\
        \tanh z&=\frac{\sinh z}{\cosh z}=\frac{e^z-e^{-z}}{e^z+e^{-z}}
    \end{align*}
    代入$z=ix$可得
    \begin{align*}
        \sinh (ix)=i\sin x,\cosh (ix)=\cos x
    \end{align*}
    同理有\begin{align*}
        \sin z=-i\sinh (iz),\cos z=\cosh (iz)
    \end{align*}
    因此双曲函数和三角函数互为全纯延拓。由唯一延拓定理，双曲函数的性质可以由三角函数的性质推导而来，例如恒等式
    \begin{align*}
        \cosh^2 z-\sinh^2 z=\cos^2 (iz)+\sin^2 (iz)=1
    \end{align*}
    以及和差公式：
    \begin{align*}
        \sinh(z+w)&=-i\sin(iz+iw)=-i\sin(iz)\cos(iz)-i\cos(iz)\sin(iz)\\
        &=\sinh z\cosh w+\cosh z\sinh w\\
        \cosh(z+w)&=\cos(iz+iw)=\cos(iz)\cos(iz)-\sin(iz)\sin(iz)\\
        &=\cosh z\cosh w+\sinh z\sinh w
    \end{align*}
    以上两式作比，得到双曲正切的和差公式：
    \begin{align*}
        \tanh(z+w)=\frac{\tanh z+\tanh w}{1+\tanh z\cdot\tanh w}
    \end{align*}
\end{example}

\section{拉普拉斯变换}\label{sec:Laplace_Transform}

十八世纪，欧拉在研究微分方程时，首先使用了积分变换的方法，将微分方程转化为代数方程来求解，随后，拉格朗日和拉普拉斯也使用了类似的方法。其中，拉普拉斯所使用的积分变换为$y_s=\int e^{-sx}\phi(x)\,dx$，与现代的拉普拉斯变换最为相似，但当时并未以拉普拉斯变换命名。十九世纪，Petzval在其著作中首次系统地考察了这一方法，但他的学生Spitzer强烈主张将这一变换命名为拉普拉斯变换，这影响到几位很有影响力的数学家：Boole，Poincaré和Doetsch，他们在著作中均将这种方法称为“拉普拉斯变换”，使得这个名称被逐渐巩固。

%二十世纪初，Heaviside在研究电磁学时提出了一种符号运算的方法，将微分方程中的微分算子$\dfrac{d}{dt}$替换为符号$p$（或$D$），从而将微分方程转化为代数方程来求解。这种方法直观、快捷但缺乏严格的数学基础，随着数学家对拉普拉斯变换的研究不断深入，到1950年，拉普拉斯变换已完全取代Heaviside演算。

鉴于拉普拉斯变换的应用场景中使用角频率明显多于使用频率，我们在本书中采用角频率$\omega$作为拉普拉斯变换的变量；另外，本章默认$u(0)=1$。

\subsection{拉普拉斯变换的引出}\label{sub:introduction_of_laplace}
在\ref{sub:introduction_of_fourier}中，我们介绍了傅里叶变换：\begin{align*}
    \mathcal{F} f(\omega)=\int_{-\infty}^{\infty}f(t)e^{-i\omega t}\,dt
\end{align*}

在不涉及收敛性的问题时，可以将$\omega$推广为复数$s=\sigma+i\omega$，根据含参变量积分的求导法则，这样的积分变换可以对$s$求导，从而是全纯函数。这个积分变换就是\textbf{双边拉普拉斯变换}：
\begin{definition}[双边拉普拉斯变换]
    设函数$f$局部可积，$\exists a,b\in\mathbb{R},a<b$（我们允许$a=-\infty$和$b=\infty$），使得$f(t)e^{-at}$和$f(t)e^{-bt}$均绝对可积，则对$\text{Re}\ s\in[a,b]$，$f$的双边拉普拉斯变换定义为
    \[\mathcal{L}f(s)=\int_{-\infty}^{\infty}f(t)e^{-st}\,dt\]
\end{definition}
“局部可积”即$f$在任意有限区间上可积，这个条件是为了保证在添加适当的收敛因子$e^{-st}$后，拉普拉斯积分收敛，从而拉普拉斯变换有定义。

在$\sigma>0$时，这个收敛因子会使得$t\to -\infty$时$|e^{-st}|=e^{-\sigma t}$快速增长，从而对所变换的函数提出很高的要。实际上，更多时候我们仅使用\textbf{单边拉普拉斯变换}，定义如下\cite{folland}：
\begin{definition}[单边拉普拉斯变换]
    记\[\mathcal{E}=\left\{f:[0,\infty)\to\mathbb{C}\left|f\in PC[0,\infty),\exists C>0,a\in\mathbb{R},|f(t)|<Ce^{at},\forall t\geq 0\right.\right\}\]
    其中$PC[0,\infty)$表示$[0,\infty)$上的分段连续函数。
    对$f\in\mathcal{E}$，其拉普拉斯变换定义为
    \[\mathcal{L} f(s)=\int_{0}^{\infty}f(t)e^{-st}\,dt,\quad s=\sigma+i\omega\]
    其中$s$的实部$\sigma$必须满足$\sigma>a$，将它称为拉普拉斯变换的\textbf{收敛域}，直线$\sigma=a$称为\textbf{收敛轴}。\\
    如果$f(t)$是时域信号，$\mathcal{L} f(s)$称为\textbf{复频域信号}。
    我们仍记$\mathcal{L} f(s)$为$F(s)$或$\hat{f}(s)$（在涉及傅里叶变换时，我们会避免使用它们或加以说明），并记$f\overset{\mathcal{L} }{\longleftrightarrow} F(s)$。
\end{definition}
在$\mathcal{E} $的定义中我们对$f$的定义域做了要求，但实际上只要$f$是因果信号（见\ref{sub:term_in_ODE}，$f(t)=f(t)u(t)$），就可以认为$f\in\mathcal{E}$，后文中不会特意区分$f$的定义域。

在$\mathcal{E} $上定义拉普拉斯变换，是因为对于$f\in\mathcal{E} $，当$\sigma>a$时，给出拉普拉斯变换的积分是绝对收敛的：
\begin{align*}
    \int_0^{\infty}|f(t)e^{-st}|\,dt\leq \int_0^{\infty}Ce^{at}e^{-\sigma t}\,dt=\frac{C}{\sigma-a}<\infty
\end{align*}
因此在导数存在的情况下可以交换积分与求导的次序，从而$\mathcal{L} f(s)$是$\sigma>a$上的全纯函数：
\begin{align*}
    \frac{d}{ds}\mathcal{L} f(s)&=\frac{d}{ds}\int_0^{\infty}f(t)e^{-st}\,dt\\
    &=\int_0^{\infty}f(t)\frac{\partial}{\partial s}(e^{-st})\,dt\\
    &=-\int_0^{\infty}tf(t)e^{-st}\,dt\\
    &=-\mathcal{L} [tf(t)](s)
\end{align*}
这正是拉普拉斯变换的复频域微分性质。

根据全纯函数的唯一延拓性，如果$\mathcal{L} f(s)$可以延拓至$\sigma\leq a$的一些区域，则延拓是唯一的，尽管这时积分不一定存在，我们也认为延拓所得的定义域更大的函数是$f$的拉普拉斯变换。
\begin{example}[多项式的拉普拉斯变换]
    设$f(t)=t^\nu(\nu\geq 0)$，则$f\in\mathcal{E} $，且
    \begin{align*}
        \mathcal{L} f(s)&=\int_0^{\infty}t^\nu e^{-st}\,dt\\
        &=\frac{1}{s^{\nu+1}}\int_0^{\infty}x^\nu e^{-x}\,dx&(x=st)\\
        &=\frac{\Gamma(\nu+1)}{s^{\nu+1}},\quad \sigma>0
    \end{align*}
尽管积分只在$\sigma>0$时收敛，但$\mathcal{L} f(s)$可以延拓为$\mathbb{C}\backslash\{0\}$上的全纯函数。
\begin{remark}
    其实，这个公式对实部大于$-1$的$\nu$都成立。尽管$-1<\text{Re}\ \nu<0$时，$f(t)=t^\nu$\\
    在$t=0$处无界，但由于
\[\left|\int_{0}^{1}t^{\nu}e^{-st}\,dt\right|\leq \int_0^1 t^\nu\,dt=\frac{1}{\nu+1},\sigma>0\]
\[\left|\int_{1}^{\infty}t^{\nu}e^{-st}\,dt\right|\leq \int_1^\infty e^{-\sigma t}\,dt=\frac{e^{-\sigma}}{\sigma},\sigma>0\]
其拉普拉斯变换是存在的。因此，我们可以认为$t^\nu\in\mathcal{E},\text{Re}\ \nu>-1$.
\end{remark}
\end{example}

在$\mathcal{E} $中，卷积总是良定义的：
\begin{proposition}[$\mathcal{E} $中的卷积]
    设$f,g\in\mathcal{E} $，则它们的卷积为
    \[(f*g)(t)=\begin{cases}
    0                   & \text{if } t<0 \\
    \int_0^t f(x)g(t-x)\,dx & \text{if } t\geq 0
    \end{cases}\]
\end{proposition}
这是因为$x\geq 0,t-x\geq 0$时，$f(x),g(t-x)$才不恒为0，这相当于积分区间为$[0,t]$。

\subsection{拉普拉斯变换的运算性质}\label{sub:laplace_operation}

\begin{proposition}[拉普拉斯变换的性质]
    设$f,g\in\mathcal{E} $，$a,b\in\mathbb{C}$，则：\begin{itemize}
        \item 线性：在$f,g$的公共收敛域内，有\[\mathcal{L} [af(t)+bg(t)](s)=a\mathcal{L} f(s)+b\mathcal{L} g(s)\]
        \item 时移：\[\mathcal{L} [f(t-t_0)u(t-t_0)](s)=e^{-s t_0}\mathcal{L} f(s)\]
        \item 频移：\[\mathcal{L} [e^{a t}f(t)](s)=\mathcal{L} f(s-a)\]
        \item 伸缩：设$a>0$，则\[\mathcal{L} [f(at)](s)=\frac{1}{a}\mathcal{L} f\left(\frac{s}{a}\right)\]
        \item 时域微分：设$f\in C^1[0,\infty),f'\in\mathcal{E} $，则\[\mathcal{L} [f'(t)](s)=s\mathcal{L} f(s)-f(0)\]
        $f'(t)$在0处的定义为$f$在0处的右导数：$$f'(0):=\lim_{h\to 0+}\dfrac{f(h)-f(0)}{h}$$
        注意我们必须要求$f$是连续的，否则微积分基本定理需要分段使用，会使公式更加复杂。得到时域微分性质至少应该要求$f$是连续且分段光滑的。
        \item 复频域微分：\[\mathcal{L} [t f(t)](s)=-\frac{d}{ds}\mathcal{L} f(s)\]
        \item 时域积分：\[\mathcal{L} \left[\int_0^t f(x)\,dx\right](s)=\frac{1}{s}\mathcal{L} f(s)\]
        \item 复频域积分：设$\dfrac{f(t)}{t}\in\mathcal{E} $，则\[\mathcal{L} \left[\frac{f(t)}{t}\right](s)=\int_s^{\infty}\mathcal{L}f(x)\,dx\]
        此处积分路径为复平面上满足$Im(s)=\omega$有界的任意从$s$到无穷远处的路径
    \end{itemize}
\end{proposition}
\begin{remark}
    很明显，时域微分性质和复频域微分性质都可以对更高阶的导数进行推广，其中，时域微分性质推广为\begin{align*}
\mathcal{L} [f^{(n)}(t)](s)&=s^n\mathcal{L} f(s)-\sum_{k=0}^{n-1}s^{n-1-k}f^{(k)}(0)\\
&=s^n\mathcal{L} f(s)-s^{n-1}f(0)-s^{n-2}f'(0)-\cdots -f^{(n-1)}(0)
\end{align*}
\end{remark}
\begin{proof}
    1.线性性：直接得自积分的线性性。\\
    2.时移：\begin{align*}
        \mathcal{L} [f(t-t_0)u(t-t_0)](s)&=\int_0^{\infty}f(t-t_0)u(t-t_0)e^{-st}\,dt\\
        &=\int_{t_0}^{\infty}f(t-t_0)e^{-st}\,dt\\
        &=e^{-s t_0}\int_0^{\infty}f(x)e^{-s x}\,dx&( x=t-t_0)\\
        &=e^{-s t_0}\mathcal{L} f(s)
    \end{align*}
    3.频移：\begin{align*}
        \mathcal{L} [e^{a t}f(t)](s)=\int_0^{\infty}e^{a t}f(t)e^{-st}\,dt=\int_0^{\infty}f(t)e^{-(s-a)t}\,dt=\mathcal{L} f(s-a)
    \end{align*}
    4.伸缩：\begin{align*}
        \mathcal{L} [f(at)](s)&=\int_0^{\infty}f(at)e^{-st}\,dt\\
        &=\int_0^{\infty}f(x)e^{-\frac{s}{a}x}\frac{1}{a}\,dx&(x=at)\\
        &=\frac{1}{a}\mathcal{L} f\left(\frac{s}{a}\right)
    \end{align*}
    5.时域微分：\begin{align*}
        \mathcal{L} [f'(t)](s)&=\int_0^{\infty}f'(t)e^{-st}\,dt\\
        &=\evalat{\left(f(t)e^{-st}\right)}{0}{\infty}+\int_0^{\infty}sf(t)e^{-st}\,dt\\
        &=s\mathcal{L} f(s)-f(0)
    \end{align*}
    6.复频域微分：已经在本节前面证明过。\\
    7.时域积分：利用时域微分性质，有
    \begin{align*}
        \mathcal{L} \left[\int_0^t f(x)\,dx\right](s)=\frac{1}{s}\mathcal{L} \left[\frac{d}{dt}\left(\int_0^t f(x)\,dx\right)\right](s)=\frac{1}{s}\mathcal{L} f(s)
    \end{align*}
    8.复频域积分：利用复频域的微分性质，有
    \begin{align*}
        \frac{d}{ds}\mathcal{L} \left[\frac{f(t)}{t}\right](s)&=-\mathcal{L} f(s)\\
        \mathcal{L} \left[\frac{f(t)}{t}\right](s)&=\int_s^{\infty}\mathcal{L}f(x)\,dx
    \end{align*}
\end{proof}

\begin{theorem}[卷积定理]
    设$f,g\in\mathcal{E} $，则
    \[\mathcal{L} [(f*g)(t)](s)=\mathcal{L} f(s)\cdot \mathcal{L} g(s)\]
\end{theorem}
\begin{proof}
与前面傅里叶变换的卷积定理证明类似：
    \begin{align*}
        \mathcal{L} [(f*g)(t)](s)&=\int_0^{\infty}(f*g)(t)e^{-st}\,dt\\
        &=\int_0^{\infty}\left(\int_0^t f(x)g(t-x)\,dx\right)e^{-st}\,dt\\
        &=\int_0^{\infty}\int_0^{\infty}f(x)g(t-x)u(t-x)e^{-st}\,dx\,dt\\
        &=\int_0^{\infty}f(x)\left(\int_x^{\infty}g(t-x)e^{-st}\,dt\right)\,dx\\
        &=\int_0^{\infty}f(x)e^{-sx}\left(\int_0^{\infty}g(y)e^{-sy}\,dy\right)\,dx&(y=t-x)\\
        &=\mathcal{L} f(s)\cdot \mathcal{L} g(s)
    \end{align*}
\end{proof}

以上所有性质的证明都与傅里叶变换类似，实际上我们不需要做这种重复性的证明工作。给定$s=\sigma+i\omega$，令$\tilde{f}(t)=f(t)e^{-\sigma t}$，则$\mathcal{L} f(s)=\mathcal{F} \tilde{f}(\omega)$，只要$\tilde{f}\in L^1(\mathbb{R} )$，就可以将傅里叶变换的性质直接应用到拉普拉斯变换上。由于我们在$\mathcal{E} $中要求了$f(t)$的分段连续性，在收敛域$\sigma>a$内，$\tilde{f}(t)$总是属于$L^1(\mathbb{R})$的。下面给出一个例子：
%\begin{example}[时移性质]
%    设$f\in\mathcal{E} ,t_0>0$，令$\tilde{f}(t)=f(t)e^{-\sigma t}$，则
%    \begin{align*}
%        \mathcal{L}[f(t-t_0)u(t-t_0)](s)&=\mathcal{F} \left[\tilde{f}(t-t_0)u(t-t_0)\right](\omega)\\
%        &=e^{-i\omega t_0}\mathcal{F} \tilde{f}(\omega)\\
%        &=e^{-s t_0}\mathcal{L} f(s)
%    \end{align*}
%\end{example}
\begin{example}[卷积定理]
设$f,g\in\mathcal{E} $，令$\tilde{f}(t)=f(t)e^{-\sigma t}, \tilde{g}(t)=g(t)e^{-\sigma t}$，注意到\begin{align*}
    (\tilde{f}*\tilde{g})(t)&=\int_{-\infty}^{\infty}\tilde{f}(x)\tilde{g}(t-x)\,dx\\
    &=\int_0^{t}f(x)e^{-\sigma x}g(t-x)e^{-\sigma (t-x)}\,dx\\
    &=e^{-\sigma t}\int_0^{t}f(x)g(t-x)\,dx\\
    &=e^{-\sigma t}(f*g)(t)
\end{align*}
因此有
    \begin{align*}
        \mathcal{L} \left[f*g\right](s)=\mathcal{F} \left[f*g(t)e^{-\sigma t}\right](\omega)=\mathcal{F} \left[\tilde{f}*\tilde{g}\right](\omega)=\mathcal{F} \tilde{f}(\omega)\cdot \mathcal{F} \tilde{g}(\omega)=\mathcal{L} f(s)\cdot \mathcal{L} g(s)
    \end{align*}
\end{example}
其余的证明，请读者自行完成。

\subsection{常用函数的拉普拉斯变换}\label{sub:ordinary_laplace}

\begin{example}[指数多项式]
    设$f(t)=t^\nu e^{a t}u(t),\text{Re}\ \nu>-1$，利用拉普拉斯变换的频移性质，有
    \begin{align*}
        \mathcal{L} f(s)&=\mathcal{L}\left[t^\nu e^{a t}u(t)\right](s)\\
        &=\mathcal{L} \left[t^\nu u(t)\right](s-a)\\
        &=\frac{\Gamma(\nu+1)}{(s-a)^{\nu+1}},\sigma>a
    \end{align*}
    根据有理函数的理论，任意真分式函数都可以表示为若干个此类函数的线性组合，因此可以说$f$是指数多项式等价于$\mathcal{L} f$是真分式函数
\end{example}

\begin{example}[正弦、余弦函数]
    首先，$\cos(\omega_0 t),\sin(\omega_0 t)\in\mathcal{E}$，因为$$\forall a>0,|\cos(\omega_0 t)|,|\sin(\omega_0 t)|<e^{a t}$$
    下面给出两种求解方法。\\
    方法一：利用欧拉公式化归为指数函数：
    \begin{align*}
        \mathcal{L}[\cos(\omega_0 t)](s)&=\mathcal{L}[\cos(\omega_0 t)u(t)](s)\\
        &=\frac{1}{2}\mathcal{L} [e^{i\omega_0 t}u(t)](s)+\frac{1}{2}\mathcal{L} [e^{-i\omega_0 t}u(t)](s)\\
        &=\frac{1}{2}\left(\frac{1}{s-i\omega_0}+\frac{1}{s+i\omega_0}\right)\\
        &=\frac{s}{s^2+\omega_0^2},\sigma>0
    \end{align*}
    \begin{align*}
        \mathcal{L}[\sin(\omega_0 t)](s)&=\mathcal{L} [\sin(\omega_0 t)u(t)](s)\\
        &=\frac{1}{2i}\mathcal{L} [e^{i\omega_0 t}u(t)](s)-\frac{1}{2i}\mathcal{L} [e^{-i\omega_0 t}u(t)](s)\\
        &=\frac{1}{2i}\left(\frac{1}{s-i\omega_0}-\frac{1}{s+i\omega_0}\right)\\
        &=\frac{\omega_0}{s^2+\omega_0^2},\sigma>0
    \end{align*}
    方法二：利用微分性质：
    \begin{align*}
        -a^2\mathcal{L}[\cos(\omega_0 t)](s)&=\mathcal{L} [\cos''(\omega_0 t)](s)\\
        &=s^2\mathcal{L} [\cos(\omega_0 t)](s)-s\cos(0)-\cos'(0)\\
        &=s^2\mathcal{L} [\cos(\omega_0 t)](s)-s
    \end{align*}
    因此\[\mathcal{L} [\cos(\omega_0 t)](s)=\frac{s}{s^2+\omega_0^2}\]
    同理，有\[\mathcal{L} [\sin(\omega_0 t)](s)=\frac{\omega_0}{s^2+\omega_0^2}\]
\end{example}

\begin{example}[双曲函数]
    因为
    \[\sinh(\omega_0 t)=\frac{e^{\omega_0 t}-e^{-\omega_0 t}}{2},\cosh(\omega_0 t)=\frac{e^{\omega_0 t}+e^{-\omega_0 t}}{2}\]
    所以
    \begin{align*}
        \mathcal{L} \left[\sinh(\omega_0 t)\right](s)&=\frac{1}{2}\mathcal{L} \left[e^{\omega_0 t}\right](s)-\frac{1}{2}\mathcal{L} \left[e^{-\omega_0 t}\right](s)\\
        &=\frac{1}{2}\left(\frac{1}{s-\omega_0}-\frac{1}{s+\omega_0}\right)\\
        &=\frac{\omega_0}{s^2-\omega_0^2},\sigma>|\omega_0|
    \end{align*}
    \begin{align*}
        \mathcal{L} \left[\cosh(\omega_0 t)\right](s)&=\frac{1}{2}\mathcal{L} \left[e^{\omega_0 t}\right](s)+\frac{1}{2}\mathcal{L} \left[e^{-\omega_0 t}\right](s)\\
        &=\frac{1}{2}\left(\frac{1}{s-\omega_0}+\frac{1}{s+\omega_0}\right)\\
        &=\frac{s}{s^2-\omega_0^2},\sigma>|\omega_0|
    \end{align*}
\end{example}

\begin{example}[采样函数]
    首先，因为$\dfrac{\sin(\omega_0 t)}{t}$有界，所以$\dfrac{\sin(\omega_0 t)}{t}\in\mathcal{E}$。

    结合正弦函数的拉普拉斯变换和拉普拉斯变换的复频域积分性质，有
    \begin{align*}
        \mathcal{L} \left[\frac{\sin(\omega_0 t)}{t}\right](s)&=\int_s^{\infty}\mathcal{L}[\sin(\omega_0 t)](x)\,dx\\
        &=\int_s^{\infty}\frac{\omega_0}{x^2+\omega_0^2}\,dx\\
        &=\evalat{\arctan\frac{x}{\omega_0}}{s}{\infty}\\
        &=\frac{\pi}{2}-\arctan\frac{s}{\omega_0}\\
        &=\arctan\left(\frac{\omega_0}{s}\right),\sigma>0
    \end{align*}
\end{example}

\begin{example}[正弦积分函数]
    $$\frac{\sin(\omega_0 t)}{t}\leq Ce^{a t},a>0\implies \text{Si}(\omega_0 t)\leq \frac{C}{a}e^{a t}\implies \text{Si}(\omega_0 t)\in\mathcal{E}$$
    利用正弦函数的拉普拉斯变换和拉普拉斯变换的时域积分性质，有
    \begin{align*}
        \mathcal{L} [\text{Si}(\omega_0 t)](s)&=\mathcal{L} \left[\int_0^{\omega_0 t} \frac{\sin(x)}{x}\,dx\right](s)\\
        &=\mathcal{L} \left[\int_0^{t} \frac{\sin(\omega_0 x)}{x}\,dx\right](s)\\
        &=\frac{1}{s}\mathcal{L} \left[\frac{\sin(\omega_0 t)}{t}\right](s)\\
        &=\frac{1}{s}\arctan\left(\frac{\omega_0}{s}\right),\sigma>0
    \end{align*}    
\end{example}

\subsection{拉普拉斯变换的级数求法}\label{sub:laplace_by_series}
我们知道，多项式的拉普拉斯变换都可以通过$$\mathcal{L} [t^n](s)=\dfrac{\Gamma(n+1)}{s^{n+1}}$$来计算，那么对于一些可以展开为幂级数的函数，不难想到逐项求拉普拉斯变换，下面讨论这种操作的适用范围。在此之前，我们先介绍一个引理：
\begin{lemma}
    设$f\in\mathcal{E} ,|f(t)|\leq Ce^{at}$，则\begin{itemize}
        \item $\forall x>a,\mathcal{L} f(x+iy)\to 0,|y|\to\infty$
        \item $\forall y,\mathcal{L} f(x+iy)\to 0,x\to\infty$
    \end{itemize}
\end{lemma}
\begin{proof}
    1.令$g(t)=f(t)e^{-x t}$，则$|g(t)|\leq Ce^{-(x-a)t}$，因此$g\in L^1(\mathbb{R} )$，根据Riemann-Lebesgue引理，有
    \[\mathcal{L} f(x+iy)=\mathcal{F} g(y)\to 0,|y|\to\infty\]
    2.利用海涅归并原理，任取实部趋于无穷的序列$\{z_n\}$，满足$\mathcal{L} f(z_n)$存在（这要求$\text{Re}\ z>a$），我们要证明序列$\mathcal{L} f(z_n)\to 0$。由控制收敛定理，有
    \begin{align*}
        &\int_{0}^{\infty}|f(t)e^{-z_n t}|\,dt\leq \int_0^{\infty}Ce^{at}e^{-Re(z_n) t}\,dt=C\int_0^{\infty}e^{-(Re(z_n)-a)t}\,dt=\frac{C}{\text{Re}\ z_n-a}<\infty\\
        &\lim_{n\to\infty}\mathcal{L} f(z_n)=\lim_{n\to\infty}\int_0^{\infty}f(t)e^{-z_n t}\,dt=\int_0^{\infty}\lim_{n\to\infty}f(t)e^{-z_n t}\,dt=0
    \end{align*}
\end{proof}

\begin{theorem}[拉普拉斯变换的级数求法]
    设$f\in\mathcal{E} $，且在$[0,\infty)$上有幂级数展开
    \[f(t)=\sum_{n=0}^{\infty}a_n t^n\]
    如果存在$\omega_0>0$，使得级数
    \[\sum_{n=0}^{\infty}|a_n|\frac{\Gamma(n+1)}{\omega_0^{n}}\]
    收敛，则在$\sigma>\omega_0$时，级数
    \[\sum_{n=0}^{\infty}a_n \frac{\Gamma(n+1)}{s^{n+1}}\]
    收敛且等于$\mathcal{L} f(s)$，即$f$的拉普拉斯变换可以通过对其幂级数求拉普拉斯变换得到。
\end{theorem}
\begin{proof}
    由条件知级数$\sum_{n=0}^{\infty}a_n \frac{\Gamma(n+1)}{s^{n+1}}$在$\sigma>\omega_0$时绝对收敛、内闭一致收敛，因此只需证明其和函数等于$\mathcal{L} f(s)$。拉普拉斯变换是一种积分变换，我们需要将求和与积分交换，可以考虑使用控制收敛定理。由于
    \begin{align*}
        &|a_n \Gamma(n+1)\omega_0^{-n}|\to 0, n\to\infty\\
        \implies &|a_n|\leq C\frac{\omega_0^{n}}{\Gamma(n+1)}\\
        \implies &|f(t)|\leq \sum_{n=0}^{\infty}|a_n|t^n\leq C\sum_{n=0}^{\infty}\frac{(\omega_0 t)^{n}}{\Gamma(n+1)}=Ce^{\omega_0 t}\\
        \implies &\forall s,\text{Re}\ s=\omega_0+\phi>\omega_0,|f(t)e^{-s t}|\leq Ce^{-\phi t}
    \end{align*}
    控制收敛定理的条件成立，换序即证。
\end{proof}

一般地，对于幂次不是整数的情况，可以推广以上结论：
\begin{corollary}*
   设$f\in\mathcal{E} $，且在$[0,\infty)$上有广义幂级数展开
   \[f(t)=\sum_{n=0}^{\infty}a_n t^{n+\alpha}\]
   其中$0\leq\alpha<1$，如果存在$\omega_0>0$，使得级数
   \[\sum_{n=0}^{\infty}|a_n|\frac{\Gamma(n+\alpha+1)}{\omega_0^{n}}\]
   收敛，则在$\sigma>\omega_0$时，级数
   \[\sum_{n=0}^{\infty}a_n \frac{\Gamma(n+\alpha+1)}{s^{n+\alpha+1}}\]
   收敛且等于$\mathcal{L} f(s)$，即$f$的拉普拉斯变换可以通过对其广义幂级数求拉普拉斯变换得到。
\end{corollary}

\section{拉普拉斯逆变换}\label{sec:Laplace_Inverse}

\subsection{两种拉普拉斯反演公式}\label{sub:laplace_inversion}
我们仍然令$\tilde{f}(t)=f(t)e^{-\sigma t}$，从而将傅里叶反演公式推广到拉普拉斯反演公式：
\begin{theorem}[拉普拉斯反演公式]
    设$f\in\mathcal{E}\cap PS[0,\infty) $，则
    \[f(t)=\frac{1}{2\pi i}\lim_{r\to\infty}\int_{b-ir}^{b +ir}\mathcal{L} f(s)e^{st}\,ds\]
    其中$b>a$，$a$为$f$的拉普拉斯变换的收敛域下界。
\end{theorem}
\begin{remark}
    严格来说，我们只能得到
    \[\frac{f(t-)+f(t+)}{2}=\frac{1}{2\pi i}\lim_{r\to\infty}\int_{b-ir}^{b +ir}\mathcal{L} f(s)e^{st}\,ds\]
    不过，我们仍不关心不连续点处的值，因此后文中将直接使用上面的结论。要求分段光滑是为了保证傅里叶反演公式成立，在\ref{sub:fourier_inversion}中，对应我们给出的第二个版本的傅里叶反演公式（定理A.2.6.）。读者也可参考其他版本的傅里叶反演公式来替换对$f$和$\mathcal{L} f$的要求，从而得到不同版本的拉普拉斯反演公式。
\end{remark}
\begin{remark}
    这里的积分\[\lim_{r\to\infty}\int_{b-ir}^{b +ir}\mathcal{L} f(s)e^{st}\,ds\]
    应该理解为沿着复平面上的直线$\text{Re}\ z=b$从$b-i\infty$到$b+i\infty$的复线积分。由于全纯函数的路径无关性，我们也可以选择其他路径，甚至可以添加一些路径，再使用留数定理计算拉普拉斯逆变换，见本节后续的讨论。
\end{remark}
\begin{proof}
    \begin{align*}
        \frac{1}{2\pi i}\lim_{r\to\infty}\int_{b-ir}^{b +ir}\mathcal{L} f(s)e^{st}\,ds&=\frac{1}{2\pi i}\lim_{r\to\infty}\int_{-ir}^{ir}\mathcal{L} f(b +i\omega)e^{(b +i\omega)t}i\,d\omega\\
        &=\frac{e^{b t}}{2\pi}\lim_{r\to\infty}\int_{-r}^{r}\mathcal{F} \tilde{f}(\omega)e^{i\omega t}\,d\omega\\
        &=e^{b t}\tilde{f}(t)=f(t)
    \end{align*}
\end{proof}

通过这个定理可以看出，拉普拉斯逆变换一定能还原出$f(t)$（在不考虑间断点函数值的意义下），因此拉普拉斯变换是双射。

但是，以上证明已经假定了$F(s)=\mathcal{L} f(s)$是某个函数$f\in\mathcal{E} $的拉普拉斯变换。从另一个角度出发，假设有一个在右半平面$\text{Re}\ s>a$上全纯的函数$F(s)$，就需要考虑它是否是某个函数的拉普拉斯变换，以及如何求出这个函数。为此，我们给出以下定理\cite{distribution}：
\begin{theorem}[*拉普拉斯反演公式]
    设$F(s)$在$\text{Re}\ s>a$上全纯，且满足：
    \[|F(s)|\leq C|s|^{-\alpha},\alpha>1,\forall \text{Re}\ s>a\]
    则$\forall b>a$，函数
    \[f(t)=\frac{1}{2\pi i}\lim_{r\to\infty}\int_{b-ir}^{b +ir}F(s)e^{st}\,ds\]
    属于$\mathcal{E} $，且$F(s)=\mathcal{L} f(s),\forall \text{Re}\ s>a$。
\end{theorem}
\begin{remark}
    这里的条件$\alpha>1$保证了$F(b+i\omega)\in L^1(\mathbb{R})$（作为$\omega$的函数），尽管$b=0$时，
    $$|s|^{-\alpha}=\dfrac{1}{|b+i\omega|^{\alpha}}=\frac{1}{\omega^{\alpha}}\notin L^1(\mathbb{R})$$
    这是因为$F$是全纯函数，在$\omega=0$处不会出现奇点。换言之，我们给出了$F$“尾部”的估计。事实上，$\alpha>\dfrac{1}{2}$即可保证定理成立，但这样证明会非常复杂\cite{folland}。
\end{remark}
\begin{proof}
    首先，我们证明由积分$\dfrac{1}{2\pi i}\lim_{r\to\infty}\int_{b-ir}^{b +ir}F(s)e^{st}\,ds$定义的函数$f(t)$是良定义的。一方面，由于$|F(s)|\leq C|s|^{-\alpha}$，有
    \[\left|\lim_{r\to\infty}\int_{b -ir}^{b +ir}F(s)e^{st}\,ds\right|=\left|\int_{-\infty}^{\infty}F(b+i\omega)e^{(b+i\omega)t}i\,d\omega\right|\leq e^{b t}\int_{-\infty}^{\infty}|F(b+i\omega)|\,d\omega<\infty\]

    另一方面，我们验证$$f_b(t)=\frac{1}{2\pi i}\lim_{r\to\infty}\int_{b-ir}^{b +ir}F(s)e^{st}\,ds$$与$b$无关。设$b_1,b_2>a$，选择以$b_1\pm ir,b_2\pm ir$为顶点的矩形围道$C_r$，则由于$|F(s)|\leq C|s|^{-\alpha}$，矩形顶边、底边的积分趋于0，而$F(s)$在$\text{Re}\ s>a$上全纯，由柯西积分定理知$\int_{C_r}F(s)e^{st}\,ds=0$，因此$f_{b_1}(t)=f_{b_2}(t)$。

    注意到以上证明并不依赖于$t$的取值，极限过程$\lim_{r\to\infty}$对$t\in\mathbb{R}$是内闭一致收敛的，因此可以由被积函数$F(s)e^{st}$的连续性推出$f(t)$的连续性。

    接下来，我们证明$f(t)\in\mathcal{E} $。一方面，$f$是因果的：$\forall t<0$，取$b>0$，并取围道如图5.1：
        \begin{figure}[H]
        \centering
        \includegraphics[width=0.6\textwidth]{contour2}
        \caption{拉普拉斯逆变换的围道}
    \end{figure}
    其中$\gamma_1$为$b+ir$到$b -ir$的直线段，$\gamma_2$为以原点为圆心，$b -ir$到$b+ir$的圆弧，半径$R=\sqrt{b^2+r^2}$。由柯西积分定理，有
    \[\int_{\gamma_1+\gamma_2}F(s)e^{st}\,ds=0\]
    对$\gamma_2$，有
    \[\left|\int_{\gamma_2}F(s)e^{st}\,ds\right|\leq \int_{\gamma_2}|F(s)||e^{st}|\,|ds|\leq C\int_{\gamma_2}|s|^{-\alpha}e^{b t}\,|ds|\leq C|R|^{-\alpha}\cdot \pi R\to 0,r\to\infty\]
    
    因此$$f(t)=\dfrac{1}{2\pi i}\lim_{r\to\infty}\int_{\gamma_1}F(s)e^{st}\,ds=0,t<0$$

    另一方面，取$b>a$，有
    \begin{align*}
        |f(t)|=\left|\frac{1}{2\pi i}\lim_{r\to\infty}\int_{b -ir}^{b +ir}F(s)e^{st}\,ds\right|\leq \frac{e^{b t}}{2\pi}\int_{-\infty}^{\infty}|F(b+i\omega)|\,d\omega=k e^{b t},k\text{为常数}
    \end{align*}

    又因为我们已经证明了$f$的连续性，所以$f\in\mathcal{E} $。

    最后，我们证明$F(s)=\mathcal{L} f(s),\forall \text{Re}\ s>a$。上一步中，$\forall b>a$，我们都能找到常数$k$使得$|f(t)|\leq k e^{b t}$，因此可以取$b'\in(a,b)$，使得$|f(t)e^{-bt}|\leq k'e^{(b'-b)t}$，从而$f(t)e^{-bt}\in L^1(\mathbb{R})$。根据$f$的定义，有
    \begin{align*}
        f(t)e^{-b t}=\frac{1}{2\pi}\lim_{r\to\infty}\int_{-r}^{r}F(b+i\omega)e^{i\omega t}\,d\omega
        =\mathcal{F}^{-1} [F(b+i\omega)](t)
    \end{align*}
    我们已经证明过$f$连续和$F(b+i\omega)\in L^1(\mathbb{R})$，因此可以使用傅里叶反演公式（见\ref{sub:fourier_inversion}的定理A.2.5.），得到
    \begin{align*}
        F(b+i\omega)&=\mathcal{F} [f(t)e^{-b t}](\omega)\\
        &=\int_{-\infty}^{\infty}f(t)e^{-b t}e^{-i\omega t}\,dt\\
        &=\int_{0}^{\infty}f(t)e^{-(b+i\omega) t}\,dt\\
        &=\mathcal{L} f(b+i\omega)
    \end{align*}
\end{proof}

\subsection{真分式函数的拉普拉斯逆变换}\label{sub:frac_laplace_inverse}
\begin{example}[真分式函数]
    我们知道，真分式函数的拉普拉斯逆变换是指数多项式的线性组合。这里给出一个例子：设$F(s)=\dfrac{2s+5}{s^2+3s+2}$，则
    \begin{align*}
        F(s)&=\frac{2s+5}{(s+1)(s+2)}\\
        &=\frac{3}{s+1}-\frac{1}{s+2}
    \end{align*}
    因此
    \[\mathcal{L}^{-1} F(s)=3e^{-t}-e^{-2t}\]
\end{example}

一般地，真分式函数可以通过部分分式展开法来计算拉普拉斯逆变换。根据代数基本定理，任意多项式在复数域上必有根，并且实系数多项式的非实根成共轭复数对出现，因此多项式可以分解为若干个一次因式的乘积，如果在实数范围内做因式分解，则共轭复根对应的一次因式可以合并为一个二次因式。进一步，任意真分式函数都可以表示为若干个部分分式的和\cite{zorich}\cite{xinjiang}：
\begin{theorem}[部分分式展开定理]
    设\begin{align*}
    F(s)=\frac{P(s)}{Q(s)}=\frac{P(s)}{(s-r_1)^{m_1}\cdots (s-r_k)^{m_k}(s^2+a_1 s+b+1)^{n_1}\cdots (s^2+a_l s+b_l f)^{n_l}}
    \end{align*}
其中$degP<degQ$，$r_i,i=1,2,\cdots,k$为$Q(s)$的实根，$s^2+a_1 s+b_1,\cdots,s^2+a_l s+b_l$为$Q(s)$的不可约二次因式，则$F(s)$可以展开为部分分式的和：
\begin{align*}
    F(s)&=\frac{A_{11}}{s-r_1}+\frac{A_{12}}{(s-r_1)^2}+\cdots +\frac{A_{1m_1}}{(s-r_1)^{m_1}}\\
    &+\frac{B_{11}s+C_{11}}{s^2+as+b}+\frac{B_{12}s+C_{12}}{(s^2+as+b)^2}+\cdots +\frac{B_{1n_1}s+C_{1n_1}}{(s^2+as+b)^{n_1}}\\
    &+\cdots \\
    &+\frac{B_{l1}s+C_{l1}}{s^2+es+f}+\frac{B_{l2}s+C_{l2}}{(s^2+es+f)^2}+\cdots +\frac{B_{ln_l}s+C_{ln_l}}{(s^2+es+f)^{n_l}}
\end{align*}
\end{theorem}
这个命题表明，分母多项式中，一次因式的若干次幂在分解式中对应其各幂次的线性组合，而二次因式在分解式中其分子为一次多项式。

下面介绍两种求解部分分式展开的系数的方法。

\noindent \textbf{法一：待定系数法}

按照以上命题给出的展开式形式设未知数，将展开式通分，然后与原式的分子比较系数，得到一个线性方程组，解出各未知数即可。
\begin{example}
    设\[F(s)=\frac{2s+5}{s^2+3s+2}\]
    则
    \begin{align*}
        F(s)&=\frac{A}{s+1}+\frac{B}{s+2}\\
        &=\frac{A(s+2)+B(s+1)}{(s+1)(s+2)}\\
        &=\frac{(A+B)s+(2A+B)}{(s+1)(s+2)}
    \end{align*}
    比较系数，有
    \[\begin{cases}
        A+B=2\\
        2A+B=5
    \end{cases}\implies \begin{cases}
        A=3\\
        B=-1
    \end{cases}\]
    因此\[F(s)=\frac{3}{s+1}-\frac{1}{s+2}\]
\end{example}

\noindent \textbf{法二：取极限法}（又称为赫维赛德掩盖法）

按照以上命题给出的展开式形式设未知数，\begin{itemize}
    \item 对于一次因式最高次幂$(s-r)^m$的系数，将等式两边同时乘以$(s-r)^m$，然后令$s\to r$，即可解出最高次幂的系数；
    \item 对于一次因式次高次幂的系数，将等式两边同时乘以$(s-r)^{m-1}$，然后对$s$求导，再令$s\to r$，即可解出次高次幂的系数；也可以先约去已经求出的最高次幂项，再乘以$(s-r)^{m-1}$并令$s\to r$，依此类推
    \item 二次因式的处理类似，因为可以在复数范围内做因式分解（也可以对比正余弦函数的拉普拉斯变换，配平方得到二次不可约因式的拉普拉斯逆变换，但这样做远不如留数定理方便）
\end{itemize}

\begin{example}
    设\[F(s)=\frac{1}{(s+1)^2(s+2)(s^2+1)}\]
    则
    \begin{align*}
        F(s)&=\frac{A_1}{s+1}+\frac{A_2}{(s+1)^2}+\frac{B}{s+2}+\frac{C s+D}{s^2+1}
    \end{align*}
    两边同时乘以$(s+1)^2$，令$s=-1$，有
    \[A_2=\frac{1}{(-1+2)(-1^2+1)}=1\]
    同理$B=\frac{1}{3}$。约去$1/(s+1)^2$项后，两边同时乘以$(s+1)$，令$s=-1$，有
    \[A_1=\lim_{s\to -1}(s+1)\left[F(s)-\frac{1}{(s+1)^2}\right]=\lim_{s\to -1}\frac{(s+1)^2}{(s+2)(s^2+1)}=\frac{1}{2}\]
    两边同时乘以$(s^2+1)$，令$s=i$，有
    \[C i+D=\lim_{s\to i}(s-i)F(s)=\lim_{s\to i}\frac{(s-i)}{(s+1)^2(s+2)(s^2+1)}=-\frac{i}{5}\]
    令$s=-i$，有
    \[-C i+D=\lim_{s\to -i}(s+i)F(s)=\lim_{s\to -i}\frac{(s+i)}{(s+1)^2(s+2)(s^2+1)}=\frac{i}{5}\]
    解得$C=-\frac{1}{5},D=0$，因此
    \[F(s)=\frac{1/2}{s+1}+\frac{1}{(s+1)^2}+\frac{1/3}{s+2}+\frac{-\frac{1}{5}s}{s^2+1}\]
\end{example}

进行部分分式展开后，真分式函数就化为若干个分母为一次因式、二次因式的分式函数之和，这样，容易通过指数多项式和三角函数的拉普拉斯变换公式，以及拉普拉斯变换的时移性质计算出拉普拉斯逆变换。下面给出一个例子：
\begin{example}[部分分式展开法求拉普拉斯逆变换]
    设\[F(s)=\frac{1}{(s+1)^2(s+2)(s^2+1)}\]
    在上例中，我们已经得到：
    \[F(s)=\frac{1/2}{s+1}+\frac{1}{(s+1)^2}+\frac{1/3}{s+2}+\frac{-\frac{1}{5}s}{s^2+1}\]
    因此
    \[f(t)=\mathcal{L}^{-1}F(s)=\frac{1}{2}e^{-t}+te^{-t}+\frac{1}{3}e^{-2t}-\frac{1}{5}\cos t\]
\end{example}

\subsection{使用留数定理计算拉普拉斯逆变换}\label{sub:residue_laplace_inverse}
本小节介绍使用留数定理计算拉普拉斯逆变换的方法。一般地，我们选择由$b\pm ir,-r\pm ir$组成的矩形围道，其中$b>0$需保证$F(s)$在$\text{Re}\ s>b$上全纯（因此在$r\to\infty$时极点全部位于围道内），见下方左图：
\begin{figure}[H]
    \centering
    \includegraphics[width=0.6\textwidth]{contour}
    \caption{拉普拉斯逆变换的围道}
\end{figure}
\begin{example}[真分式函数，留数定理方法]
    设\[F(s)=\frac{2s+5}{s^2+3s+2}\]
    $\Gamma_r$为上方左图所示的矩形围道，$b>0$，我们来论证当$r\to\infty$时，另三条线段上的积分趋于0，从而
    \begin{align*}
        f(t)&=\mathcal{L}^{-1} F(s)\\
        &=\frac{1}{2\pi i}\lim_{r\to\infty}\int_{b -ir}^{b +ir}F(s)e^{st}\,ds\\
        &=\frac{1}{2\pi i}\lim_{r\to\infty}\oint_{\Gamma_r}F(s)e^{st}\,ds
    \end{align*}

    当$t>0$时，对于矩形的上边（下边同理），有
    \begin{align*}
        \left|\int_{top}F(s)e^{st}i\,ds\right|&\leq \sup_{x\leq b}|F(x+ir)e^{(x+ir)t}|\int_{-\infty}^{b}e^{xt}\,dx\\
        &\leq \frac{e^{bt}}{t}\sup_{x\leq b}|F(x+ir)|
    \end{align*}
    在前面的引理中，我们已经证明了$|F(x+ir)|\to 0,|r|\to\infty$，因此上边的积分趋于0。对于矩形的左边，$|e^{st}|=e^{-rt}$，以指数函数的速度衰减至0，积分当然趋于0。

    当$t<0$时，$e^{st}$在$\text{Re}\ s$充分大时有较小的模值，因此我们可以使用上面右图中的围道来论证$f(t)=0$。而$t=0$的值则不需要考虑。
    
    根据留数定理，有
    \begin{align*}
        f(t)&=\sum \text{Res}[F(s)e^{st},s_k]\\
        &=\text{Res}\left[\frac{2s+5}{(s+1)(s+2)}e^{st},-1\right]+\text{Res}\left[\frac{2s+5}{(s+1)(s+2)}e^{st},-2\right]\\
        &=\lim_{s\to -1}(s+1)\frac{2s+5}{(s+1)(s+2)}e^{st}+\lim_{s\to -2}(s+2)\frac{2s+5}{(s+1)(s+2)}e^{st}\\
        &=3e^{-t}-e^{-2t}
    \end{align*}
\end{example}

最后，我们再给出一个计算有无穷多极点的函数拉普拉斯逆变换的例子\cite{folland}。
\begin{example}*
    设\[F(s)=\frac{1}{s^2}-\frac{\pi}{s\sinh(\pi s)}\]
    则$F(s)$在$s=ni,n\in\mathbb{Z}\backslash\{0\}$处有简单极点，而0是一个可去奇点：\[F(s)=\frac{\sinh(\pi s)-\pi s}{s^2 \sinh(\pi s)}=\frac{[(\pi s)+(\pi^3s^3/3!)+\cdots]-\pi s}{s^2 \cdot(\pi s)}=\frac{\pi^2}{3},s\to 0\]

    我们使用与上面左图类似的围道$\Gamma_r$（$b>0$）来计算拉普拉斯逆变换，但这里需要选取$r=N+0.5,N\in\mathbb{N} $以保证所有围道上被积函数的全纯性。

    我们有\[\sinh\pi\left[x\pm i\left(N+\frac{1}{2}\right)\right]=\pm(-1)^N i\cosh\pi x,\left|F\left(x\pm i\left(N+\frac{1}{2}\right)\right)\right|\leq \frac{1}{N^2}+\frac{\pi}{N\cosh x}\]
    因此可以用类似上例的方法论证当$N\to\infty$时，围道的其余三条边上的积分趋于0。

    在$in(n\in\mathbb{Z}\backslash\{0\})$处，留数为
    \begin{align*}
        \text{Res}[F(s)e^{st},in]&=\lim_{s\to in}(s-in)F(s)e^{st}\\
        &=\lim_{s\to in}\frac{e^{st}}{s}\cdot\frac{-\pi(s-in)}{\sinh(\pi s)}\\
        &=\lim_{s\to in}\frac{e^{int}}{in}\cdot\frac{-1}{\cosh(\pi in)}\\
        &=\frac{(-1)^{n+1}e^{int}}{in}
    \end{align*}
    其中$\cosh(\pi in)=\cos(n\pi)=(-1)^n$。由留数定理，有
    \begin{align*}
        f(t)&=\mathcal{L}^{-1} F(s)\\
        &=\frac{1}{2\pi i}\lim_{N\to\infty}\oint_{\Gamma_{N+0.5}}F(s)e^{st}\,ds\\
        &=\sum_{n\in\mathbb{Z}\backslash\{0\}}\text{Res}[F(s)e^{st},in]\\
        &=\sum_{n\in\mathbb{Z}\backslash\{0\}}\frac{(-1)^{n+1}e^{int}}{in}\\
        &=2\sum_{n=1}^{\infty}\frac{(-1)^{n+1}}{n}\sin(nt)
    \end{align*}
    它是锯齿波信号$f(t)=-t,t\in(-\pi,\pi)$的周期化延拓的傅里叶级数展开。
\end{example}

\section{拉普拉斯变换的收敛域}\label{Convergence}

\subsection{收敛横坐标}\label{sub:converge_abscissa}
我们在定义拉普拉斯变换时，曾要求$|f(t)|\leq C e^{at}$，这样拉普拉斯积分$\mathcal{L} f(s)=\int_{0}^{\infty}f(t)e^{-st}\,dt$在\\$\text{Re}\ s>a$上收敛，但是我们不知道这个收敛域是否是最精确的。本节就来讨论拉普拉斯变换收敛域的问题，并由此给出一些由拉普拉斯变换分析时域性质的方法。

\begin{definition}[收敛横坐标]
    \quad\\
    \textbf{收敛横坐标}为使得拉普拉斯积分$\mathcal{L} f(s)=\int_{0}^{\infty}f(t)e^{-st}\,dt$最大收敛域的收敛轴实部（横坐标）$\sigma_c$，使得$\mathcal{L} f(s)$恰好在$\text{Re}\ s>\sigma_c$上收敛，而在$\text{Re}\ s<\sigma_c$上发散，即
    \[\sigma_c=\inf\{a\in\mathbb{R}|\mathcal{L} f(s)\text{在}\text{Re}\ s>a\text{上收敛}\}\]
\end{definition}

为了寻找收敛横坐标，我们有两种思路：
\begin{itemize}
    \item 从时域出发，分析$|f(t)|$的增长速率；
    \item 从复频域出发，已知$F(s)$在$\text{Re}\ s>a$上是$f$的拉普拉斯变换，讨论它在更大的区域上是否也是$f$的拉普拉斯变换。
\end{itemize}

首先来看思路一。由于$f\in\mathcal{E} $，在有限区间上的表现不会影响拉普拉斯积分的收敛性，因此我们只需考虑$t\to\infty$时$f$的增长速率。仿照等价无穷大量，我们用$|f(t)|\sim C e^{a t}$表示$|f(t)|$与$C e^{a t}$在$t\to\infty$时具有相同增长速率，即
\[|f(t)|\sim C e^{a t}\iff \lim_{t\to\infty}\frac{|f(t)|}{C e^{a t}}=1\]
则\begin{align*}
    |f(t)|\sim C e^{a t}\iff ln|f(t)|\sim ln C +a t\iff\frac{ln|f(t)|}{t}\sim a +\frac{ln C}{t}=a
\end{align*}

但是，我们很容易构造这样一个反例来说明这个方法并不总是有效。考虑$f(t)=e^{t\sin t}$，则极限
$$\lim_{t\to\infty}\frac{ln|f(t)|}{t}=\lim_{t\to\infty}\sin t$$
不存在，但很明显$\mathcal{L} f(s)$在$\text{Re}\ s>1$上收敛。对照这个反例改进这一方法，得到：
\begin{theorem}
    设$f\in\mathcal{E} $，则收敛横坐标可由以下公式得到：
    \[\sigma_c=\varlimsup_{t\to\infty}\frac{ln|f(t)|}{t}\]
\end{theorem}
\begin{proof}
    \[\sigma_c=\varlimsup_{t\to\infty}\frac{ln|f(t)|}{t}\iff \forall \epsilon>0,\exists T>0,\text{s.t.}\forall t>T,\frac{ln|f(t)|}{t}<\sigma_c+\epsilon\]
    因此$t$充分大时，$|f(t)|<e^{(\sigma_c+\epsilon)t}$，从而$\mathcal{L} f(s)$在$\text{Re}\ s>\sigma_c+\epsilon$上收敛，$\epsilon$任意，故$\mathcal{L} f(s)$在$\text{Re}\ s>\sigma_c$上收敛。

    另一方面，如果$\exists a' <\sigma_c$，使得$\mathcal{L} f(s)$在$\text{Re}\ s>a'$上收敛，则$\mathcal{L} f(s)$在$\frac{a'+\sigma_c}{2}$上收敛，因此
    \[\int_{0}^{\infty}|f(t)|e^{-\frac{a'+\sigma_c}{2}t}\,dt<\infty\]
    由此可知，$|f(t)|e^{-\frac{a'+\sigma_c}{2}t}\to 0,t\to\infty$，即$t$充分大时，$|f(t)|<e^{\frac{a'+\sigma_c}{2}t}$，从而
    \[\varlimsup_{t\to\infty}\frac{ln|f(t)|}{t}\leq \frac{a'+\sigma_c}{2}<\sigma_c\]
\end{proof}

其实，以上的定理和证明对$\varlimsup_{t\to\infty}\dfrac{ln|f(t)|}{t}=\pm\infty$的情形也是成立的，它们分别对应$\mathcal{L} f(s)$无定义和$\mathcal{L} f(s)$为整函数的情形。

下面来看思路二。设$\mathcal{L} f(s)$在$\text{Re}\ s>a$上良定义且等于$F(s)$，我们讨论$F(s)$在更大的区域$\text{Re}\ s>a'(a'<a)$上是否也是$f$的拉普拉斯变换。我们在上一节的定理5.3.2.中处理过类似的情况，因此我们先来看$F(s)$满足这一定理的条件时的情形。

\begin{theorem}
    设$F(s)$是某个函数$f\in\mathcal{E} $的拉普拉斯变换，且
    $$|F(s)|\leq C|s|^{-\alpha},\alpha>1,\forall \text{Re}\ s>a'$$
    令
    \[\sigma_s=\sup\left\{\text{Re}\ s_j\in\mathbb{C}\left|s_j\text{为}F(s)\text{的奇点}\right.\right\}\]
    则有$\sigma_c=\sigma_s$。
\end{theorem}
\begin{proof}
    一方面，$\sigma_c\geq\sigma_s$。$\mathcal{L} f(s)$在$\text{Re}\ s<\sigma_s$上当然是发散的，因为$F(s)$在$\text{Re}\ s=\sigma_s$上有奇点。

    另一方面，$\sigma_c\leq\sigma_s$。用反证法。假设$\sigma_c>\sigma_s$，则在带状区域$\sigma_s<\text{Re}\ s\leq\sigma_c$上，$F(s)$满足定理5.3.2.的条件，它可以做拉普拉斯逆变换，得到唯一的时域函数，由于拉普拉斯逆变换
    $$\frac{1}{2\pi i}\lim_{r\to\infty}\int_{b-ir}^{b+ir}F(s)e^{st}\,ds$$
    不依赖于$b$的选取，该时域函数必然就是$f(t)$，从而$\mathcal{L} f(s)=F(s)$在$\text{Re}\ s>\sigma_s$上成立，矛盾。
\end{proof}

然而，很多函数不满足以上定理的条件，例如
$$f(t)=e^{at},a\in\mathbb{R}^*,F(s)=\dfrac{1}{s-a}$$
（尽管对这类函数我们可以直接验证$\sigma_c=\sigma_s=a$）。下面给出一个类似的定理\cite{Laplace_Transform}，以说明我们的目标结论$\sigma_c=\sigma_s$的适用范围是相当大的，这样，我们就有很大的把握来通过$F(s)$的奇点直接分析$f(t)$的收敛横坐标。
\begin{theorem}
    设$F(s)$是某个函数$f\in\mathcal{E} $的拉普拉斯变换，且$f(t)$单调，仍然定义\[\sigma_s=\sup\left\{\text{Re}\ s_j\in\mathbb{C}\left|s_j\text{为}F(s)\text{的奇点}\right.\right\}\]
    则有$\sigma_c=\sigma_s$。
\end{theorem}
\begin{proof}
    一方面，我们已经说明$\sigma_c\geq\sigma_s$。

    另一方面，$\sigma_c\leq\sigma_s$。用反证法，假设$\sigma_c>\sigma_s$，任取$b>\sigma_c$，由于$F(s)$在$\text{Re}\ s>\sigma_s$上全纯，可以将它展开为$b$处的泰勒级数：
    \[F(s)=\sum_{n=0}^{\infty}\frac{F^{(n)}(b)}{n!}(s-b)^n,\text{Re}\ s>\sigma_s\]
    并且该级数的收敛半径至少为$b-\sigma_s$，因此在以下区域中，
    $$D(b,b-\sigma_s)=\{s\in\mathbb{C}||s-b|<b-\sigma_s\}$$
    该级数绝对收敛、内闭一致收敛。
    \begin{figure}[H]
        \centering
        \includegraphics[width=0.5\textwidth]{sigma_c}
        \caption{收敛域示意图}
    \end{figure}
    容易验证$f(t)(-t)^n e^{-b t}$在$[0,\infty)$上的积分一致收敛，根据含参变量反常积分积分的求导法则，有
    \[F^{(n)}(b)=\int_{0}^{\infty}f(t)(-t)^n e^{-b t}\,dt\]
    
    考虑截断积分
    \begin{align*}
        \int_{0}^{R}f(t)e^{-a t}\,dt&=\int_{0}^{R}f(t)e^{-b t}\sum_{n=0}^{\infty}\frac{(b-a)^n}{n!}t^n\,dt
    \end{align*}
    
    由$\sum_{n=0}^{\infty}\dfrac{(b-a)^n}{n!}t^n\,dt$在$[0,R]$上一致收敛，可交换求和与积分次序，得到
    \begin{align*}
        \int_{0}^{R}f(t)e^{-a t}\,dt&=\sum_{n=0}^{\infty}\frac{(b-a)^n}{n!}\int_{0}^{R}f(t)t^n e^{-b t}\,dt
    \end{align*}
    
    由于$f(t)$单调，不妨设$f(t)\geq 0$（可以考虑$g(t)=-f(t)$，$f(t)$单调递增，剩余的工作只是处理$u(t)$），而$b>a$，级数的每一项都是非负的。由单调收敛定理，有
    \begin{align*}
        \lim_{R\to\infty}\int_{0}^{R}f(t)e^{-a t}\,dt&=\lim_{R\to\infty}\sum_{n=0}^{\infty}\frac{(b-a)^n}{n!}\int_{0}^{R}f(t)t^n e^{-b t}\,dt\\
        &=\sum_{n=0}^{\infty}\frac{(b-a)^n}{n!}\int_{0}^{\infty}f(t)t^n e^{-b t}\,dt\\
        &=\sum_{n=0}^{\infty}\frac{(b-a)^n}{n!}F^{(n)}(b)=F(a)
    \end{align*}
    即$\mathcal{L} f(a)=F(a)$收敛，从而在$\text{Re}\ s=a$上$\mathcal{L} f$也收敛：\begin{align*}
        |\mathcal{L} f(a+i\omega)|&=\left|\int_{0}^{\infty}f(t)e^{-(a+i\omega) t}\,dt\right|\\
        &\leq \int_{0}^{\infty}\left|f(t)e^{-a t}\right|\,dt\\
        &=\int_{0}^{\infty}f(t)e^{-a t}\,dt&\left(f(t)\geq 0\right)\\
        &=\mathcal{L}f(a)<\infty
    \end{align*}
    由唯一延拓定理，$\mathcal{L} f(s)=F(s)$在$\text{Re}\ s>a$上成立。

    由$a$的任意性，我们证明了$\mathcal{L} f(s)=F(s)$在$\text{Re}\ s>\sigma_s$上成立，矛盾。
\end{proof}

为了说明定理的条件不能被去掉，我们给出以下反例\cite{Laplace_Transform}：
\begin{example}
    考虑函数
    \[f(t)=\frac{\sin(e^t)}{e^t}\]
    带入前文中的公式可得$\sigma_c=-1$。但是它的拉普拉斯变换为
    \begin{align*}
        F(s)&=\int_{0}^{\infty}\frac{\sin(e^t)}{e^t}e^{-s t}\,dt\\
        &=\int_{1}^{\infty}\frac{\sin u}{u^{s+1}}\,du&(u=e^t)\\
        &=-\evalat{\frac{\cos(u)}{u^{s+1}}}{1}{\infty}+\int_{1}^{\infty}\cos(u)\,d\frac{1}{u^{s+1}}\\
        &=\cos(1)-(s+1)\int_{1}^{\infty}\frac{\cos(u)}{u^{s+2}}\,du
    \end{align*}
    由A-D判别法可知，最后一行的积分在$\text{Re}\ s>-2$上收敛，因此$F(s)$可全纯延拓至$\text{Re}\ s>-2$，进一步，多次分部积分后，可以发现$F(s)$能够延拓为整函数。
\end{example}

总之，对于相当大范围的函数，我们可以\textbf{通过分析其拉普拉斯变换的奇点来确定收敛横坐标}$\sigma_c$，从而确定拉普拉斯变换的最大收敛域。在前面我们已经证明：$$f\in\mathcal{E}\implies \sigma_c=\varlimsup_{t\to\infty}\frac{ln|f(t)|}{t}$$
因此我们可以\textbf{通过分析拉普拉斯变换的奇点来确定$f(t)$的增长速率}，也可以\textbf{通过分析$f(t)$的增长速率来确定拉普拉斯变换的奇点位置}。

\subsection{系统的稳定性}\label{sub:stability_of_system}
基于以上结论，我们可以使用拉普拉斯变换分析系统的\textbf{稳定性}。在\ref{sub:concepts_of_system}中曾介绍，系统的稳定性是指：
\begin{definition}
    如果一个系统在激励信号有界时，响应也是有界的，则称该系统是稳定系统。
\end{definition}

对于线性时不变系统，稳定性有充要条件：
\begin{proposition}[稳定性的时域判据]
    设线性时不变系统的冲激响应为$h(t)$，则系统稳定的充分必要条件是$\int_{-\infty}^{\infty}|h(t)|\,dt<\infty$。
\end{proposition}
\begin{proof}
    一方面，对于有界输入$|e(t)|<M$，有
    \begin{align*}
        |r(t)|&=\left|\int_{-\infty}^{\infty}h(\tau)e(t-\tau)\,d\tau\right|\\
        &\leq \int_{-\infty}^{\infty}|h(\tau)||e(t-\tau)|\,d\tau\\
        &<M\int_{-\infty}^{\infty}|h(\tau)|\,d\tau<\infty
    \end{align*}
    因此输出有界。

    另一方面，设$h(t)$不绝对可积，取有界激励信号$e(t)=\text{sgn}(h(-t))$，则
    \begin{align*}
        |r(0)|&=\left|\int_{-\infty}^{\infty}h(\tau)e(-\tau)\,d\tau\right|\\
        &=\left|\int_{-\infty}^{\infty}h(\tau)\text{sgn}(h(\tau))\,d\tau\right|\\
        &=\int_{-\infty}^{\infty}|h(\tau)|\,d\tau=\infty
    \end{align*}
    输出无界。
\end{proof}

下面使用拉普拉斯变换来分析系统的稳定性。对因果的线性时不变系统，我们定义
\begin{definition}[系统函数]
    设$h\in\mathcal{E} $是线性时不变系统的冲激响应，则系统函数定义为
    $$H(s)=\frac{R(s)}{E(s)}=\mathcal{L} h(s)$$
    如果虚轴$\text{Re}\ s=0$在$H(s)$的收敛域内，则$H(i\omega)$与第四章中定义的频率响应一致。
\end{definition}
对$r(t)=h(t)*e(t)$两边同时进行拉普拉斯变换，有
\[\mathcal{L} r(s)=\mathcal{L} h(s)\mathcal{L} e(s),\text{即}R(s)=H(s)E(s)\]

\begin{proposition}[稳定性的复频域判据]
    设因果线性时不变系统的冲激响应为$h(t)\in\mathcal{E}$，系统函数为$H(s)=\mathcal{L} h(s)$，则稳定性的充分必要条件是$H(s)$的所有奇点均位于复平面的左半平面$\text{Re}\ s<0$上。
\end{proposition}
\begin{proof}
    奇点在左半平面意味着单位冲激响应的增长速度至多相当于$e^{-\alpha t}( \alpha>0)$，从而单位冲激响应绝对可积，系统稳定；反之，奇点在右半平面或虚轴上意味着单位冲激响应增长速度至少相当于$e^{\alpha t}(\alpha\geq0)$，从而单位冲激响应不绝对可积，系统不稳定。
\end{proof}
\begin{definition}
    根据单位冲激响应的拉普拉斯变换的奇点位置，将因果线性时不变系统分为三类：
    \begin{itemize}
        \item \textbf{稳定系统}：所有奇点均位于左半平面上；
        \item \textbf{临界稳定系统}：至少有一个奇点位于虚轴上，且其余奇点均位于左半平面上；
        \item \textbf{不稳定系统}：至少有一个奇点位于右半平面上。
    \end{itemize}
\end{definition}

\subsection{初值定理与终值定理}\label{sub:initial_and_final_value}
本小节介绍\textbf{初值定理}和\textbf{终值定理}，它们可以通过拉普拉斯变换直接得到函数在$t=0$和$t\to\infty$时的极限值，而不需要求出函数的显式表达式。
\begin{theorem}[初值定理]
    设$f\in PS[0,\infty),f,f'\in\mathcal{E},F(s)=\mathcal{L} f(s)$，则
    \[f(0)=\lim_{\text{Re}\ s\to\infty}sF(s)\]
\end{theorem}
这表明系统的高频响应对应时域的瞬时的初始行为。
\begin{proof}
    由拉普拉斯变换的时域微分性质，有
    \[sF(s)=s\mathcal{L} f(s)=\mathcal{L} f'(s)+f(0)\]
    取极限$\text{Re}\ s\to\infty$，有
    \[\lim_{\text{Re}\ s\to\infty}sF(s)=\lim_{\text{Re}\ s\to\infty}\mathcal{L} f'(s)+f(0)=\lim_{\text{Re}\ s\to\infty}\int_{0}^{\infty}f'(t)e^{-st}\,dt+f(0)\]
    由于$f'\in\mathcal{E} $，在$\text{Re}\ s$充分大时时，$f'(t)e^{-st}\leq C e^{-\epsilon t},\epsilon$为一充分小正数。由控制收敛定理，有
    \[\lim_{\text{Re}\ s\to\infty}\int_{0}^{\infty}f'(t)e^{-st}\,dt=\int_{0}^{\infty}\lim_{\text{Re}\ s\to\infty}f'(t)e^{-st}\,dt=0\]
    从而\[f(0)=\lim_{\text{Re}\ s\to\infty}sF(s)\]
\end{proof}

\begin{theorem}[终值定理]
    设$f\in\mathcal{E} $，$F(s)=\mathcal{L} f(s)$在$s=0$处有简单极点，且其余奇点均位于左半平面$\text{Re}\ s<0$上，则
    \[\lim_{t\to\infty}f(t)=\lim_{s\to 0}sF(s)\]
\end{theorem}
这表明系统的低频响应对应时域的稳态行为。
\begin{remark}
多数文献中，这个定理的允许$s=0$不是奇点，但由于$\sigma_s<0$时，多数情况下有$\sigma_c<0$，从而$f(t)\to 0$，因此这里我们只考虑非平凡情形。此外高阶极点对应的$\lim_{t\to\infty}f(t)=\infty$同样可以用以下方法证明。
\end{remark}
\begin{proof}
    考虑$F(s)$在$s=0$处的洛朗级数展开：
    \[F(s)=\sum_{n=-1}^{\infty}a_n s^n=\frac{a_{-1}}{s}+G(s),a_{-m}\neq 0\]
    其中$G(s)$在$s=0$的邻域内全纯，因此也在包含虚轴的某个右半平面$\text{Re}\ s>-\epsilon$上全纯，其拉普拉斯逆变换$g(t)$满足$g(t)\to 0,t\to\infty$，因此有\begin{align*}
        \lim_{s\to 0}sF(s)&=\lim_{s\to 0}\left(a_{-1}+sG(s)\right)=a_{-1}
    \end{align*}
    时域上，\begin{align*}
        f(t)&=\mathcal{L}^{-1} F(s)=\mathcal{L}^{-1}\left(\frac{a_{-1}}{s}\right)+\mathcal{L}^{-1} G(s)=a_{-1}u(t)+g(t)\to a_{-1},t\to\infty
    \end{align*}
    于是$\lim_{t\to\infty}f(t)=a_{-1}=\lim_{s\to 0}sF(s)$。
\end{proof}

%\subsection{在双边拉普拉斯变换中的应用}\label{sub:bilateral_laplace}
%本小节对\ref{sub:introduction_of_laplace}中提到的双边拉普拉斯变换的收敛域进行简单讨论，以便后面与z变换进行比较。双边拉普拉斯变换具有一些与单边拉普拉斯变换不同的性质（尤其是时域微分性质），但这不是本书的重点，读者可以仿照单边拉普拉斯变换自行推导它们。如有需要，读者可以暂时跳过本小节，在阅读\ref{sub:relation_z_laplace}时再回过头来阅读。

%回忆双边拉普拉斯变换的定义：
%\begin{definition}[双边拉普拉斯变换]
%    设函数$f$局部可积，$\exists a,b\in\mathbb{R},a<b$（我们允许$a=-\infty$和$b=\infty$），使得$f(t)e^{-at}$和$f(t)e^{-bt}$均绝对可积，则对$\text{Re}\ s\in[a,b]$，$f$的双边拉普拉斯变换定义为
%    \[\mathcal{L}f(s)=\int_{-\infty}^{\infty}f(t)e^{-st}\,dt\]
%\end{definition}

%为了确定$a,b$的取值范围，我们可以拆分双边拉普拉斯积分，并仿照单边拉普拉斯变换的收敛域分析方法，分别讨论$t\to\infty$和$t\to-\infty$时$f(t)$的增长速率：
%\[\mathcal{L}f(s)=\int_{-\infty}^{0}f(t)e^{-st}\,dt+\int_{0}^{\infty}f(t)e^{-st}\,dt\]
%\begin{definition}[收敛横坐标]
%    \quad\\
%    \textbf{收敛横坐标}为使得拉普拉斯积分$\mathcal{L}f(s)=\int_{-\infty}^{\infty}f(t)e^{-st}\,dt$最大收敛域的收敛轴实部（横坐标）$\sigma_{c}^-,\sigma_{c}^+$，使得$\mathcal{L}f(s)$恰好在$\text{Re}\ s\in(\sigma_{c}^-,\sigma_{c}^+)$上收敛，而在$\text{Re}\ s<\sigma_{c}^-$和$\text{Re}\ s>\sigma_{c}^+$上发散，即
%    \[\sigma_{c}^-=\sup\{a\in\mathbb{R}|\mathcal{L} _b f(s)\text{在}\text{Re}\ s\in(a,a+\epsilon)\text{上收敛}\}\]
%    \[\sigma_c^+=\inf\{b\in\mathbb{R}|\mathcal{L} _b f(s)\text{在}\text{Re}\ s\in(b-\epsilon,b)\text{上收敛}\}\]
%   这里要求$\text{Re}\ s\in(a,a+\epsilon)$和$\text{Re}\ s\in(b-\epsilon,b)$是为了处理收敛域为带状域的情况。
%\end{definition}
%要使$\int_{0}^{\infty}f(t)e^{-st}\,dt$收敛，自然要求
%\[\text{Re}\ s>\varlimsup_{t\to\infty}\frac{ln|f(t)|}{t}\]
%因此可以看出$\sigma_c^-=\varlimsup_{t\to\infty}\frac{ln|f(t)|}{t}$。对于$\int_{-\infty}^{0}f(t)e^{-st}\,dt$，记
%\[|f(t)|\sim C e^{b t}\iff \lim_{t\to -\infty}\frac{|f(t)|}{C e^{bt}}=1\]
%则有
%\[|f(t)|\sim C e^{b t}\iff ln|f(t)|\sim b t + ln C\iff \frac{|f(t)|}{t}\sim b+\frac{ln C}{t}=b\]
%这时有
%$$\text{Re}\ s=b-\epsilon,\int_{-\infty}^{0}f(t)e^{-st}\,dt\leq\int_{-\infty}^{0}C e^{\epsilon t}\,dt<\infty$$
%因此可以看出$\sigma_c^+=\varliminf_{t\to -\infty}\dfrac{ln|f(t)|}{t}$（可以带入$f(t)=e^{-t\sin t}$验证这里必须取下极限）。

%综上所述，我们得到：\begin{theorem}
%    设函数$f$局部可积，则其双边拉普拉斯变换的收敛横坐标可由以下公式得到：
%    \[\sigma_{c}^-=\varlimsup_{t\to\infty}\frac{ln|f(t)|}{t},\sigma_{c}^+=\varliminf_{t\to -\infty}\frac{ln|f(t)|}{t}\]
%\end{theorem}

%与单边拉普拉斯变换一样，我们允许$\sigma_{c}^-,\sigma_{c}^+=\pm\infty$。如果$\sigma_{c}^-=-\infty,\sigma_c^+=\infty$，则$\mathcal{L} _b f(s)$为整函数；如果$\sigma_{c}^-\geq\sigma_c^+$，则$\mathcal{L} _b f(s)$无定义。

%特别地，我们指出：\begin{itemize}
%    \item 如果$f(t)=0,t<0$，则$\sigma_{c}^-=-\infty$，双边拉普拉斯变换退化为单边拉普拉斯变换；
%    \item 如果$f(t)=0,t>0$，则$\sigma_{c}^+=\infty$；
%    \item 如果$f$紧支，则$\sigma_{c}^-=-\infty,\sigma_c^+=\infty$，双边拉普拉斯变换为整函数。
%    \item 如果$f(t)$在$t\to\pm\infty$时均与$e^{a t}$表现类似，其双边拉普拉斯变换的收敛域为空集。除了前面三条中讨论的情况，典型的具有非空收敛域的例子如$f(t)=e^{-|t|}$，其双边拉普拉斯变换的收敛域为$\text{Re}\ s\in(-1,1)$。
%\end{itemize}

%不难发现，双边拉普拉斯变换的收敛性分析与洛朗级数有着诸多相似之处，我们将在\ref{sub:relation_z_laplace}中讨论这一点。

\section{系统的复频域分析}\label{sec:Complex_Freq_Analysis}

\subsection{拉普拉斯变换的改进}\label{sub:improvement_of_laplace}

由于$f\in\mathcal{E}$对函数增长速度的要求是相当低的（作为反例，$e^{t^2}\notin\mathcal{E}$），我们只需要单独处理$\delta$分布，而不需要重新构建一整套分布的理论\footnote{希望深入了解分布及其拉普拉斯变换的读者，可以参考\cite{Laplace_Distribution}。\cite{distribution}讨论这个话题时，采用了与本书类似的处理方法，这实际上不是拉普拉斯变换的分布理论。}。仍考虑将拉普拉斯变换化归为傅里叶变换，即
\[\mathcal{L} f(s)=\mathcal{F} [f(t)e^{-\sigma t}](\omega),s=\sigma+i\omega\]
这里$\mathcal{F} [f(t)e^{-\sigma t}](\omega)$实际上依赖于两个变量$\sigma,\omega$，但我们只写出$\omega$，并将$\sigma$视为一个参数\cite{distribution}。这样一来，我们就可以将拉普拉斯变换推广到$\delta$分布上（为了避免变量符号的问题，我们将变量统一地用$x$表示）：
\begin{align*}
    \left\langle \mathcal{L}\delta,\phi\right\rangle=\left\langle e^{-\sigma x}\delta,\mathcal{F} \varphi\right\rangle=\left\langle \delta,e^{-\sigma x}\mathcal{F} \varphi\right\rangle=\mathcal{F}\varphi(0)=\int_{-\infty}^{\infty}\varphi(t)\,dt=\left\langle \mathds{1},\varphi\right\rangle
\end{align*}
其中$\mathds{1}$表示恒为1的函数。我们知道，多项式的拉普拉斯变换是真分式函数，而如果将$\delta$分布也纳入考虑，则可以得到任意有理函数。

用同样的方法，我们还可以得到$\delta$的平移和导数的拉普拉斯变换：
\begin{align*}
    \left\langle \mathcal{L}\delta_a,\varphi\right\rangle&=\left\langle e^{-\sigma x}\delta_a,\mathcal{F} \varphi\right\rangle\\
    &=e^{-\sigma a}\mathcal{F}\varphi(a)\\
    &=\int_{-\infty}^{\infty}\varphi(t)e^{-s a}\,dt\\
    &=\left\langle e^{-s a},\varphi\right\rangle
\end{align*}
\begin{align*}
    \left\langle \mathcal{L}\left[\delta'\right],\varphi\right\rangle&=\left\langle e^{-\sigma x}\delta',\mathcal{F} \varphi\right\rangle\\
    &=-\left\langle \delta,\left(e^{-\sigma x}\mathcal{F} \varphi\right)'\right\rangle\\
    &=-\left\langle \delta,-\sigma e^{-\sigma x}\mathcal{F} \varphi + e^{-\sigma x}(\mathcal{F} \varphi)'\right\rangle\\
    &=\left\langle \delta,\sigma e^{-\sigma x}\mathcal{F} \varphi + i\omega e^{-\sigma x}\mathcal{F} \varphi\right\rangle\\
    &=(\sigma + i\omega)\mathcal{F} \varphi(0)\\
    &=\left\langle s,\varphi\right\rangle
\end{align*}
因此我们得到：
\begin{proposition}
    设$a\in\mathbb{R}$，则$\mathcal{L} \delta_a=e^{-s a}$；$\mathcal{L} \left[\delta'\right]=s$，进一步可得$\mathcal{L} \left[\delta^{(n)}\right]=s^n$。
\end{proposition}

看上去，$\delta(0)=\infty,\mathcal{L} \delta'=\mathcal{L} \delta-\infty$，而$\delta_a$在$a<0$时非因果，但$\delta$应作为一个分布来理解，因此以上结果与我们之前所定义的拉普拉斯变换并不矛盾。

不过，我们可以通过另一种方式，几乎完全避开分布的问题。在本节中，我们将（单边）拉普拉斯变换的定义修改为：
\begin{definition}[拉普拉斯变换，改进版]
    设函数$f$局部可积，且$\exists a\in\mathbb{R}$，使得$f(t)e^{-at}$绝对可积，则对$\text{Re}\ s\in[a,\infty)$，$f$的拉普拉斯变换定义为
    \[\mathcal{L} f(s)=\int_{0-}^{\infty}f(t)e^{-st}\,dt\]
\end{definition}
这里，积分限中的“0-”的含义是：
\[\mathcal{L} f(s)=\lim_{M\to 0-}\int_{M}^{\infty}f(t)e^{-st}\,dt=\int_{0-}^{\infty}f(t)e^{-st}\,dt\]

在这种定义下，拉普拉斯变换的各种运算性质仍成立，但两个性质略有差别：
\begin{proposition}[改进的拉普拉斯变换的性质]
    设$f\in C^1[0,\infty),f'$局部可积，且$\exists a\in\mathbb{R}$，使得$f(t)e^{-at}$绝对可积，则对$\text{Re}\ s\in[a,\infty)$，有：
    \begin{itemize}
        \item 时域微分性质：\[\mathcal{L} [f'](s)=s\mathcal{L} f(s)-f(0-)\]
        \item 初值定理：$$f(0-)=\lim_{\text{Re}\ s\to\infty}sF(s)$$
    \end{itemize}
\end{proposition}
\begin{proof}
    \begin{align*}
        \mathcal{L} [f'](s)&=\int_{0-}^{\infty}f'(t)e^{-st}\,dt\\
        &=\evalat{f(t)e^{-st}}{0-}{\infty}+\int_{0-}^{\infty}f(t)se^{-st}\,dt\\
        &=s\mathcal{L} f(s)-f(0-)
    \end{align*}
    对于初值定理，只要在\ref{sub:initial_and_final_value}给出的证明中使用这个时域微分性质即可。
\end{proof}

形式上，$u(0-)=\delta(0-)=0$，自然得到
\begin{align*}
    \mathcal{L} u(s)=\frac{1}{s}&\implies\mathcal{L} \delta(s)=s\mathcal{L} u(s)-u(0-)=\mathds{1}\\
    &\implies\mathcal{L} \delta'(s)=s\mathcal{L} \delta(s)-\delta(0-)=s
\end{align*}

$\delta$的各阶导数同理。这样，分布理论处理的问题仅仅在于$\delta_a(a<0)$，但我们很少用到这个分布。

可以看到，这样的定义方式帮助我们避开了$u(t)$跳变的问题和$\delta(0)=\infty$的问题，同时积分下限为“0-”排除了$f$在$(-\infty,0)$上的行为对拉普拉斯变换的影响，仅仅是拉普拉斯变换的改进，而没有对任何性质产生本质影响。另外，这样的定义方式有助于我们讨论微分方程描述的系统的起始状态，下一小节就来讨论这个问题。

\subsection{常系数线性微分方程}\label{sub:laplace_ODE}
拉普拉斯变换是处理常系数线性微分方程的有力工具。数学上，将微分方程中的函数在某一点的各阶导数值称为\textbf{初始条件}，即（以$t=0$为例）：
\[r(0)=r_0,r'(0)=r'_0,\cdots,r^{(n-1)}(0)=r^{(n-1)}_0\]
这时只需要经典的拉普拉斯变换就可以处理带初始条件的微分方程了（我们称这样的问题为\textbf{初值问题}）。在函数连续可微的情况下，起始状态、初始状态和初始条件三个概念是等价的。但是，在信号与系统中，由于我们对激励的建模是允许它进行跳变的，引入起始状态、初始状态更为方便，而改进后的拉普拉斯变换很好地适配了这种需求——一般地，我们会给出系统的起始状态，而初始状态则要依赖于激励的选取。

根据拉普拉斯变换的时域微分性质：
\[\mathcal{L}\left[f^{(n)}(t)\right](s)=s^n\mathcal{L} f(s)-s^{n-1}f(0-)-s^{n-2}f'(0-)-\cdots -f^{(n-1)}(0-)\]
可以将常系数线性微分方程转化为代数方程，还能够一并处理起始状态。我们先提出一个一般的解法，再通过一个具体的例子来展示拉普拉斯变换的威力。

考虑常系数线性微分方程
\[a_n r^{(n)}(t)+a_{n-1}r^{(n-1)}(t)+\cdots +a_1 r'(t)+a_0 r(t)=e(t)\]
其中$f,r\in\mathcal{E} $，并且给定初始状态：
\[r(0-)=c_0,r'(0-)=c_1,\cdots,r^{(n-1)}(0-)=c_{n-1}\]
记$\mathcal{L} r(s)=R(s),\mathcal{L} e(s)=E(s)$，则对方程两边进行拉普拉斯变换，有
\begin{align*}
    &a_n\left(s^n R(s)-s^{n-1}c_0 -s^{n-2}c_1 -\cdots -c_{n-1}\right)\\
    &+a_{n-1}\left(s^{n-1} R(s)-s^{n-2}c_0 -s^{n-3}c_1 -\cdots -c_{n-2}\right)\\
    &+\cdots +a_1\left(s R(s)-c_0\right)+a_0 R(s)=E(s)
\end{align*}
整理得
\[P(s)R(s)=E(s)+Q(s)\]
其中\begin{align*}
P(s)&=a_n s^n +a_{n-1} s^{n-1}+\cdots +a_1 s+a_0\\
Q(s)&=a_n\left(s^{n-1}c_0 +s^{n-2}c_1 +\cdots +c_{n-1}\right)+a_{n-1}\left(s^{n-2}c_0 +s^{n-3}c_1 +\cdots +c_{n-2}\right)+\cdots +a_1 c_0
\end{align*}
因此
\[R(s)=\frac{E(s)}{P(s)}+\frac{Q(s)}{P(s)}=R_{zs}(s)+R_{zi}(s)\]
现在，微分方程问题就转化为求$R(s)$的拉普拉斯逆变换的问题，并且可以求出系统函数
\[H(s)=\frac{R_{zs}(s)}{E(s)}=\frac{1}{P(s)}\]
与\ref{sub:fundamental_solution}类似，常系数线性微分方程所描述的系统作为一个线性时不变系统，其零状态响应的求解也可以归结为单位脉冲响应，即基本解的求解。现在，我们找到了一种新的、更为方便的求解方法，即先由拉普拉斯变换求得系统函数在做拉普拉斯逆变换。

\begin{example}[常系数线性微分方程]
    设系统由如下微分方程描述：
    \[r''(t)+3r'(t)+2r(t)=e'(t)+3e(t)\]
    初始状态为$r(0-)=1,r'(0-)=2$。求系统函数$H(s)$及单位阶跃响应$g(t)$。\\
    解：对方程两边进行拉普拉斯变换，有（注意$e(0-)=u(0-)=0$）
    \begin{align*}
        \left(s^2 R(s)-s-2\right)+3\left(s R(s)-1\right)+2 R(s)=sE(s)+3E(s)
    \end{align*}
    整理得
    \[R(s)=\frac{(s+3)E(s)+s+5}{s^2+3s+2}\]
    因此系统函数为
    \[H(s)=\frac{R_{zs}(s)}{E(s)}=\frac{s+3}{s^2+3s+2}=\frac{2}{s+1}-\frac{1}{s+2}\]
    做拉普拉斯反变换得到（零状态）单位脉冲响应：
    \begin{align*}
        h(t)=\mathcal{L}^{-1} \left[\frac{1}{s+1}+\frac{1}{s+2}\right](t)=(2e^{-t}-e^{-2t})u(t)
    \end{align*}
    积分得到零状态响应：
    \begin{align*}
    r_{zs}(t)=\int_0^{t}h(x)\,dx=(1.5-2e^{-t}+0.5e^{-2t})u(t)
    \end{align*}
    对于零输入响应，有
    \begin{align*}
        R_{zi}(s)=\frac{s+5}{s^2+3s+2}=\frac{4}{s+1}-\frac{3}{s+2}
    \end{align*}
    反变换即得$$r_{zi}(t)=(4e^{-t}-3e^{-2t})u(t)$$
    实际上，零输入响应并不是因果的，但由于单边拉普拉斯变换自动舍弃了负半轴的信息，我们只能得到$t\geq 0$时的信号情况。不难看出$r_{zi}(t)=4e^{-t}-3e^{-2t},t<0$。

    我们一般不考虑$t<0$的情况，而直接将全响应写为
    $$r(t)=r_{zs}(t)+r_{zi}(t)=(1.5+2e^{-t}-2.5e^{-2t})u(t)$$

    此外，也可以用$\mathcal{L} u(s)=1/s$直接计算单位阶跃响应得全响应：
    \begin{align*}
        R(s)&=\frac{s+3}{s(s^2+3s+2)}+\frac{s+5}{s^2+3s+2}\\
        &=\frac{1.5}{s}+\frac{2}{s+1}-\frac{2.5}{s+2}
    \end{align*}
    反变换即得$r(t)=(1.5+2e^{-t}-2.5e^{-2t})u(t)$。
\end{example}

\subsection{动态电路的复频域分析}\label{sub:laplace_circuit}

本小节介绍动态电路的复频域分析方法。与\ref{sub:freq_response}节类似，对描述线性元件的微分方程做拉普拉斯变换，即可得到它们的复频域模型：
\begin{example}
    描述电容的方程为：
    \[i(t)=C\frac{dv(t)}{dt}\]
    对其做拉普拉斯变换，得到
    \[I(s)=C\left(sV(s)-v(0-)\right)\]
    由于$v(0-)$未必为0，不能直接用阻抗$1/sC$来描述电容，需要引入电容的起始电压源模型：
    \[V(s)=\frac{1}{sC}I(s)+\frac{v(0-)}{s}\]
    \begin{center}
        \begin{circuitikz}[american, scale=0.8, transform shape]
            \draw (0,0) to[short, o-] (1,0)
            to[C=$1/sC$] (3.5,0)
            to[V=$v(0-)/s$] (6,0)
            to[short, -o] (7,0);
        \end{circuitikz}
    \end{center}
    描述电感的方程为：
    \[v(t)=L\frac{di(t)}{dt}\]
    对其做拉普拉斯变换，得到
    \[V(s)=L\left(sI(s)-i(0-)\right)\]
    引入电感的起始电流源模型：
    \begin{center}
        \begin{circuitikz}[american, scale=0.8, transform shape]
            \draw (0,0) to[short, o-] (1,0)
            to[L=$sL$] (3.5,0)
            to[I=$Li(0-)$] (6,0)
            to[short, -o] (7,0);
        \end{circuitikz}
    \end{center}
    在零状态条件下，起始电压源/电流源均为0，可以直接使用阻抗模型。
\end{example}

作为一个例子，我们使用复频域分析的方法来处理一个二阶动态电路：
\begin{example}[二阶动态电路]
    设电路如下图所示，起始状态为0，$t=0$时刻开关闭合，求电流$i(t)$。
    \begin{center}
        \begin{circuitikz}[american]
            \draw (0,0) to[V=$E$] (0,3)
            to[closing switch] (2.5,3)
            to[L=$L$, i=$i(t)$] (5,3)
            to[C=$C$] (5,0)
            to[R=$R$] (0,0);
        \end{circuitikz}
    \end{center}
    解：采用复频域模型：
    \begin{center}
        \begin{circuitikz}[american]
            \draw (0,0) to[V=$E/s$] (0,3)
            to[short] (2.5,3)
            to[L=$sL$, i=$I(s)$] (5,3)
            to[C=$1/sC$] (5,0)
            to[R=$R$] (0,0);
        \end{circuitikz}
    \end{center}
    由基尔霍夫电压定律，有
    \[\frac{E}{s}=I(s)\left(R+sL+\frac{1}{sC}\right)\]
    因此
    \[I(s)=\frac{E}{s\left(R+sL+\frac{1}{sC}\right)}=\frac{E}{Ls^2+Rs+\frac{1}{C}}\]
    引入参数
    \[\alpha=\frac{R}{2L},\omega_0=\frac{1}{\sqrt{LC}}\]
    则
    \[I(s)=\frac{E/L}{s^2+2\alpha s+\omega_0^2}=\frac{E/L}{(s+\alpha)^2+\omega_0^2-\alpha^2}\]
    \ding{172}设$\alpha>\omega_0$，即$R^2-4L/C>0$，则
    \[I(s)=\frac{E/L}{(s-r_1)(s-r_2)}\]
    其中$$r_1=\frac{-R+\sqrt{R^2-4L/C}}{2L}=-\alpha+\beta,r_2=\frac{-R-\sqrt{R^2-4L/C}}{2L}=-\alpha-\beta,\beta=\frac{\sqrt{R^2-4L/C}}{2L}$$
    做拉普拉斯逆变换，得到
    \[i(t)=\frac{E}{L(r_1-r_2)}\left(e^{r_1 t}-e^{r_2 t}\right)u(t)=\frac{E}{2L\beta}\left[e^{(-\alpha+\beta) t}-e^{(-\alpha-\beta) t}\right]u(t)\]
    系统处于\textbf{过阻尼状态}，电流为两项指数衰减的叠加，缓慢无振荡地回到平衡位置。\\
    \ding{173}设$\alpha=\omega_0$，即$R^2-4L/C=0$，则
    \[I(s)=\frac{E}{L}\cdot\frac{1}{(s+\alpha)^2}\]
    做拉普拉斯逆变换，得到
    \[i(t)=\frac{E}{L}te^{-\alpha t}u(t)\]
    系统处于\textbf{临界阻尼状态}，电流快速无振荡地回到平衡位置。\\
    \ding{174}设$\alpha<\omega_0$，即$R^2-4L/C<0$，则
    \[I(s)=\frac{E}{L}\cdot\frac{1}{(s+\alpha)^2+\beta^2}\]
    做拉普拉斯逆变换，得到
    \[i(t)=\frac{E}{L\beta}e^{-\alpha t}\sin(\beta t)u(t)\]
    系统处于\textbf{欠阻尼状态}，电流以衰减振荡的形式缓慢回到平衡位置。
    \begin{figure}[H]
        \centering
        \includegraphics[width=0.8\textwidth]{damp}
        \caption{不同阻尼状态下的电流响应}
    \end{figure}
\end{example}

%\subsection{零极点图与频率响应特性}\label{sub:zero_pole_characteristics}

\subsection{系统流图与梅森增益公式}\label{sub:mason_gain_formula}

系统的\textbf{信号流图}(signal flow graph)由香农在1942年发明，后经梅森(J.E. Mason)推广完善，成为分析线性时不变系统的有力工具，因此又称为\textbf{梅森信号流图}(Mason signal flow graph)。

\begin{definition}
信号流图是一种有向图，其节点表示系统的变量（输入、输出或中间变量），有向边表示变量之间的线性关系，边上的权值表示线性关系的系数。信号流图可以直观地反映系统的结构特性，并且可以通过图论的方法来分析系统的传递函数。

信号流图相关术语汇总如下：\begin{itemize}
    \item \textbf{节点}：表示系统的输入/输出或中间变量，分为\textbf{输入节点（源点）}、\textbf{输出节点（阱点）}和\textbf{混合节点}；
    \item \textbf{支路}：连接两个节点的有向边，表示系统，边上的权值为系统函数，又称\textbf{增益}；
    \item \textbf{通路}：沿支路方向连接的节点序列，其中，不自交的通路称为\textbf{开通路}，从源点到阱点的开通路称为\textbf{前向通路}。将通路上各支路增益之积称为\textbf{通路增益}；
    \item \textbf{环路/闭通路}：起点和终点相同且不自交的通路。将环路上各支路增益之积称为\textbf{环路增益}；
    \item \textbf{不接触环路}：没有公共节点的两环路称为不接触环路；
\end{itemize}
\end{definition}

\begin{example}[信号流图]
    设$X_1,X_2$为输入节点，$Y_1,Y_2$为输出节点，其他节点为混合节点。
    \begin{figure}[H]
        \centering
        \begin{tikzpicture}[auto, >=Stealth, node distance=1.8cm, every node/.style={font=\small}]
            % node styles: hollow smaller circles
            \tikzset{
                signode/.style={circle, draw, minimum size=2mm, inner sep=0pt, line width=0.6pt},
                lab/.style={font=\small}
            }
            % nodes (empty hollow circles)
            \node[signode] (x1) {};
            \node[signode, below=1.2cm of x1] (x2) {};
            \node[signode, right=2.2cm of x1] (m1) {};
            \node[signode, right=2.2cm of x2] (m2) {};
            \node[signode, right=2.2cm of m1] (y1) {};
            \node[signode, right=2.2cm of m2] (y2) {};
            % external labels (placed to avoid overlap)
            \node[lab, left=1mm of x1] {$X_1$};
            \node[lab, left=1mm of x2] {$X_2$};
            \node[lab, right=1mm of y1] {$Y_1$};
            \node[lab, right=1mm of y2] {$Y_2$};
            % forward path gains use H_i, feedback/return gains use G_j
            \draw[->] (x1) to node[midway, above,  inner sep=1pt] {$H_1$} (m1);
            \draw[->] (x2) to node[midway, below,  inner sep=1pt] {$H_2$} (m1);
            \draw[->] (m1) to node[midway, above,  inner sep=1pt] {$H_3$} (y1);
            \draw[->] (m2) to node[midway, below,  inner sep=1pt] {$H_4$} (y2);
            % adjusted label positions for G_5 and G_6 to avoid overlap
            \draw[->] (m1) to[bend right=8] node[midway, right,xshift=6pt, yshift=4pt,  inner sep=1pt] {$G_5$} (m2);
            \draw[->] (m2) to[bend right=22] node[midway, left, xshift=-6pt,yshift=-4pt,  inner sep=1pt] {$G_6$} (m1);
            \draw[->] (m1) edge[loop above, looseness=50] node[  inner sep=1pt] {$L_1$} (m1);
        \end{tikzpicture}
    \end{figure}
    记上、下两个混合节点对应的中间变量分别为$M_1,M_2$，则
    \begin{align*}
        M_1&=H_1 X_1+H_2 X_2+L_1 M_1+G_5 M_2\\
        M_2&=G_6 M_1\\
        Y_1&=H_3 M_1\\
        Y_2&=H_4 M_2
    \end{align*}
    这是一个以$M_1,M_2,Y_1,Y_2$为未知数的线性方程组，可以解得\begin{align*}
        M_1&=\frac{H_1 X_1+H_2 X_2}{1-L_1-G_5 G_6}\\
        M_2&=\frac{G_6 (H_1 X_1+H_2 X_2)}{1-L_1-G_5 G_6}\\
        Y_1&=\frac{H_3 (H_1 X_1+H_2 X_2)}{1-L_1-G_5 G_6}\\
        Y_2&=\frac{H_4 G_6 (H_1 X_1+H_2 X_2)}{1-L_1-G_5 G_6}
    \end{align*}
\end{example}

信号流图是一种有向图，$n$个节点的信号流图可以通过$n$阶的\textbf{邻接矩阵}$A$来表示，其元素$a_{ij}$表示从节点$j$到节点$i$的支路增益，如果没有支路连接这两个节点，则$a_{ij}=0$。显然，信号流图可由其邻接矩阵唯一表示，但邻接矩阵中会有一些冗余的行和列。我们通过一个例子来说明这一点。

\begin{example}
    上例中，节点依次为$X_1,X_2,M_1,M_2,Y_1,Y_2$，则对应的邻接矩阵为
    \[A= \begin{bmatrix}
        0 & 0 & 0 & 0 & 0 & 0 \\
        0 & 0 & 0 & 0 & 0 & 0 \\
        H_1 & H_2 & L_1 & G_5 & 0 & 0 \\
        0 & 0 & G_6 & 0 & 0 & 0 \\
        0 & 0 & H_3 & 0 & 0 & 0 \\
        0 & 0 & 0 & H_4 & 0 & 0
    \end{bmatrix}\]
    在信号流图的语境下，源点对应的行和阱点对应的列均为0。有冗余的行和列，不是我们希望看到的。

    事实上，我们仅仅需要中间节点对应的邻接矩阵。由于响应$Y_1,Y_2$直接取自中间节点，只需要求解$M_1,M_2$，就可获取系统的全部信息。将信号流图表示为一个线性方程组：
    \[\begin{bmatrix}
        M_1 \\
        M_2
    \end{bmatrix}=
    \begin{bmatrix}
        L_1 & G_5\\
        G_6 & 0
    \end{bmatrix}
    \begin{bmatrix}
        M_1 \\
        M_2
    \end{bmatrix}+\begin{bmatrix}
        H_1 X_1 + H_2 X_2 \\
        0
    \end{bmatrix},\text{即}\mathbf{M}=A\mathbf{M}+\mathbf{X}\]
    其中$$A=\begin{bmatrix}
        L_1 & G_5\\
        G_6 & 0
    \end{bmatrix}\text{为中间节点的邻接矩阵},\mathbf{M}=\begin{bmatrix}
        M_1 \\
        M_2
    \end{bmatrix},\mathbf{X}=\begin{bmatrix}
        H_1 X_1 + H_2 X_2 \\
        0
    \end{bmatrix}$$
    整理得\[\begin{bmatrix}
        H_1 X_1 + H_2 X_2 \\
        0
    \end{bmatrix}=\begin{bmatrix}
        1 -L_1 & -G_5\\
        -G_6 & 1
    \end{bmatrix}\begin{bmatrix}
        M_1 \\
        M_2
    \end{bmatrix},\text{即}\mathbf{X}=(I-A)\mathbf{M}\]
    只要矩阵\[S=I-A=\begin{bmatrix}
        1 -L_1 & -G_5\\
        -G_6 & 1
    \end{bmatrix}\]
    可逆，就可以求解出$M_1,M_2$，我们将这个矩阵称为\textbf{系统矩阵}(system matrix)，而将$A$称为\textbf{增益矩阵}。系统矩阵的行列式称为\textbf{特征行列式}，记为$\Delta$。在本例中，有\begin{align*}
        \Delta&=\begin{vmatrix}
        1 -L_1 & -G_5 \\
        -G_6 & 1
    \end{vmatrix}=1-L_1-G_5 G_6
    \end{align*}
    要使系统稳定，必须有$\Delta=1-L_1-G_5 G_6\neq 0$，否则$M_1,M_2,Y_1,Y_2\to\infty$。
\end{example}

现在来考虑更一般的情况：对于有n个中间节点$M_1,M_2,\cdots,M_n$的系统，不妨设激励接入的节点为$M_1$（否则可用叠加原理单独分析各个激励），则系统对应的线性方程组为\begin{align*}
    M_1&=a_{11} M_1 + a_{12} M_2 + \cdots + a_{1n} M_n + X\\
    M_2&=a_{21} M_1 + a_{22} M_2 + \cdots + a_{2n} M_n\\
    &\vdots\\
    M_n&=a_{n1} M_1 + a_{n2} M_2 + \cdots + a_{nn} M_n
\end{align*}
写成矩阵形式为
\[\mathbf{M}=A\mathbf{M}+\mathbf{X}\]
其中$$\mathbf{M}=\begin{bmatrix}
    M_1 \\
    M_2 \\
    \vdots \\
    M_n
\end{bmatrix},\mathbf{X}=\begin{bmatrix}
    X \\
    0 \\
    \vdots \\
    0
\end{bmatrix}$$
在系统矩阵$S=I-A$可逆时，有
\[\mathbf{M}=(I-A)^{-1}\mathbf{X}=S^{-1}\mathbf{X}\]
因此中间节点$M_i$可由以下公式计算：\[M_i=\frac{S^*_{1i}}{\Delta} X\]
其中$\Delta=|S|$为特征行列式，$S^*_{1i}$为系统矩阵$S$的去掉第1行、第i列所得的代数余子式。输出节点的响应是中间节点线性组合。以$M_n$为输出为例，我们可以写出\textbf{梅森增益公式}(Mason gain formula)：
\begin{theorem}[梅森增益公式]
    设系统有$n$个中间节点$M_1,M_2,\cdots,M_n$，激励$X$接入节点$M_1$，响应$Y$取自节点$M_n$，则
    \[H=\frac{Y}{X}=(S^{-1})_{1n}=\frac{S^*_{n1}}{\Delta}\]
    其中$(S^{-1})_{1n}$为系统矩阵$S$的逆矩阵的第1行第$n$列元素，$\Delta=|S|$为特征行列式，$S^*_{n1}$为系统矩阵$S$的去掉第$n$行、第1列所得的代数余子式。
\end{theorem}

根据行列式的图论展开的几何意义，梅森增益公式又可以写成如下形式：
\begin{theorem}[梅森增益公式，图论形式]
    设系统有$n$个中间节点$M_1,M_2,\cdots,M_n$，激励$X$接入节点$M_1$，响应$Y$取自节点$M_n$，则
    \[H=\frac{Y}{X}=\frac{\sum_{k}g_k\Delta_k}{\Delta}\]
    其中$g_k$为从源点到阱点的第$k$条前向通路增益，$\Delta_k$为去掉与第$k$条前向通路接触的所有环路后的特征行列式。

    特征行列式可由以下公式计算：
    $$\Delta=1-\sum_a L_a+\sum_{b,c}L_b L_c-\sum_{d,e,f}L_d L_e L_f+\cdots$$
    其中$\sum_a L_a$表示所有环路增益之和，$\sum_{b,c}L_b L_c$表示所有两两不接触环路增益的乘积之和，$\sum_{d,e,f}L_d L_e L_f$表示所有三者互不接触环路增益的乘积之和，依此类推。
\end{theorem}

下面来解释为什么行列式展开具有几何意义。首先，根据行列式的公式：
\[\det S=\sum_{\sigma\in S_n}\text{sgn}(\sigma)\prod_{i=1}^{n}s_{i,\sigma(i)}\]
其中$S_n$为所有$n$个元素的排列组成的集合，$\text{sgn}(\sigma)$为排列$\sigma$的符号。对于$S=I-A$，对角元为$s_{ii}=1-a_{ii}$，非对角元为$s_{ij}=-a_{ij}$。

我们知道，每个置换都可以分解为不相交循环的乘积，例如，$\sigma(1)=3,\sigma(3)=4,\sigma(4)=1,\sigma(2)=5,\sigma(5)=2$可以表示为$\sigma=(1\ 3\ 4)(2\ 5)$，对应中间节点组成的环路$M_1\to M_3\to M_4\to M_1$和$M_2\to M_5\to M_2$。因此，行列式的每一项$\prod_{i=1}^{n}s_{i,\sigma(i)}$都可以看作是由若干个不接触环路增益的乘积。如果环路中出现不动点$\sigma(i)=i$，则对应的$s_{ii}=1-a_{ii}$中的1，表示该节点不参与任何环路；如果考虑自环，则对应$-a_{ii}$。

其次，考虑正负号的问题。对于k-循环，它对$\text{sgn}(\sigma)$的贡献为$(-1)^{k-1}$，而每个增益对应一个$-a_{ij}$，因此k-循环对行列式的贡献为$(-1)^{k-1}(-1)^k=-1$。因此，$l$个互不接触的环路增益之积的符号应为$(-1)^l$。
\begin{example}
    考虑具有六个中间节点的信号流图，我们来计算$\sigma=(1)(2)(3\ 4\ 5\ 6)$对应的行列式项：
    \[\text{sgn}(\sigma)\prod_{i=1}^{6}s_{i,\sigma(i)}=s_{1,1}s_{2,2}s_{3,4}s_{4,5}s_{5,6}s_{6,3}=(1-a_{11})(1-a_{22})a_{34}a_{45}a_{56}a_{63}\]
    将因式$(1-a_{11})(1-a_{22})$展开，得到
    \[a_{34}a_{45}a_{56}a_{63}-a_{11}\cdot a_{34}a_{45}a_{56}a_{63}-a_{22}\cdot a_{34}a_{45}a_{56}a_{63}+a_{11}\cdot a_{22}\cdot a_{34}a_{45}a_{56}a_{63}\]
    记环路$L:M_3\to M_4\to M_5\to M_6\to M_3$，这四项分别对应以下四种情况：\begin{itemize}
        \item 不考虑节点$M_1,M_2$的自环，仅考虑环路L，符号为$-1$；
        \item 不考虑节点$M_2$的自环，考虑节点$M_1$的自环以及环路L，符号为$+1$；
        \item 不考虑节点$M_1$的自环，考虑节点$M_2$的自环以及环路L，符号为$+1$；
        \item 考虑节点$M_1,M_2$的自环以及环路L，符号为$-1$。
    \end{itemize}
\end{example}

最后，对于代数余子式$S^*_{n1}=\sum_{k}g_k\Delta_k$，我们考虑将$S$按第$n$行展开：
\[\det S=\Delta=\sum_{j=1}^{n}s_{nj}S^*_{nj}\]
这样，$S^*_{n1}$就对应$s_{n1}$的系数。行列式公式中某一项包含$s_{n1}$，说明置换$\sigma$中有$\sigma(1)=n$，即环路包含$M_1\to M_n$。将该环路的其余部分补全，就得到了一条从$M_1$到$M_n$的前向通路，其前向通路增益为$g_k$。去掉与该环路接触的节点后，剩下的部分正好对应$\Delta_k$。

注意，如果原图中不含有$M_1\to M_n$的支路，则$s_{n1}=0$，此时我们只好假想有一条“增益为0”的支路连接$M_1$和$M_n$，才能看出代数余子式的几何意义。因此，在梅森增益公式中，我们总是需要将前向通路考虑进来，而不管是否存在$M_1\to M_n$的支路。

\begin{example}
    考虑具有4个中间节点的信号流图，其增益矩阵为
    \[A=\begin{bmatrix}
        0 & a_{12} & 0 & 0 \\
        a_{21} & 0 & a_{23} & a_{24} \\
        0 & 0 & 0 & a_{34} \\
        0 & 0 & 0 & 0
    \end{bmatrix}\]
    系统矩阵为
    \[S=\begin{bmatrix}
        1 & s_{12} & 0 & 0 \\
        s_{21} & 1 & s_{23} & s_{24} \\
        0 & 0 & 1 & s_{34} \\
        0 & 0 & 0 & 1
    \end{bmatrix}\]
    可以看出其系统流图为：
    \begin{figure}[H]
        \centering
        \begin{tikzpicture}[auto, >=Stealth, node distance=2.2cm]
            % 节点（2mm空心小圆）
            \node[circle, draw, minimum size=2mm, inner sep=0pt, line width=0.6pt] (M1) {};
            \node[circle, draw, minimum size=2mm, inner sep=0pt, line width=0.6pt, right=of M1] (M2) {};
            \node[circle, draw, minimum size=2mm, inner sep=0pt, line width=0.6pt, right=of M2] (M3) {};
            \node[circle, draw, minimum size=2mm, inner sep=0pt, line width=0.6pt, right=of M3] (M4) {};
            % 节点标记，避免重叠
            \node[font=\small, below=3pt of M1] {$M_1$};
            \node[font=\small, below=3pt of M2] {$M_2$};
            \node[font=\small, below=3pt of M3] {$M_3$};
            \node[font=\small, below=3pt of M4] {$M_4$};
            % 边
            \draw[->] (M1) -- node[midway, above] {$a_{12}$} (M2);
            \draw[->] (M2) -- node[midway, above] {$a_{23}$} (M3);
            % a_{24}弯曲到M4
            \draw[->] (M2) to[out=-30,in=210,looseness=1.2] node[below right=1pt and -2pt, font=\small] {$a_{24}$} (M4);
            \draw[->] (M3) -- node[midway, above] {$a_{34}$} (M4);
            % a_{21}反馈支路弯曲
            \draw[->] (M2) to[out=150,in=30,looseness=1.3] node[above left=1pt and -2pt, font=\small] {$a_{21}$} (M1);
        \end{tikzpicture}
    \end{figure}
    这个系统并没有$M_4\to M_1$的支路，但我们假想有支路$a_{41}=-s_{41}=0$，这样就产生了环路$M_1\to M_2\to M_3\to M_4\to M_1$和$M_1\to M_2\to M_4\to M_1$，前向通路增益分别为$g_1=a_{12}a_{23}a_{34}$和$g_2=a_{12}a_{24}$。

    计算特征行列式：原图中有环路$M_1\to M_2\to M_1$，环路增益为$L_1=a_{12}a_{21}$，特征行列式为$\Delta=1-L_1=1-a_{12}a_{21}$；对于两条前向通路，去掉所涉及的节点后不再有回路，因此$\Delta_1=\Delta_2=1$。根据梅森增益公式，有
    \[H=\frac{Y}{X}=\frac{g_1\Delta_1+g_2\Delta_2}{\Delta}=\frac{a_{12}a_{23}a_{34}+a_{12}a_{24}}{1-a_{12}a_{21}}\]
\end{example}

一般来说，我们直接用计算机分析信号流图表示的复杂系统，但在一些特定的信号流图中，使用几何意义更为方便。

\begin{example}[单入单出信号流图]
    系统的信号流图如图所示：
    \begin{figure}[H]
        \centering
        \begin{tikzpicture}[auto, >=Stealth, node distance=1.8cm, every node/.style={font=\small}]
            \tikzset{signode/.style={circle, draw, minimum size=2mm, inner sep=0pt, line width=0.6pt}, lab/.style={font=\small}}
            % nodes
            \node[signode] (X) {};
            \node[signode, right=2.2cm of X] (m1) {};
            \node[signode, below=1.2cm of m1,xshift=24mm] (m2) {};
            \node[signode, right=2.4cm of m1, yshift=12mm] (m3) {};
            \node[signode, right=2.2cm of m3] (Y) {}; 
            % labels
            \node[lab,left=1mm of X] {$X$};
            \node[lab,right=1mm of Y] {$Y$};
            \node[lab, above=0.5mm of m1] {$M_1$};
            \node[lab, below=0.5mm of m2] {$M_2$};
            \node[lab, above=0.5mm of m3] {$M_3$};
            % input connects only to m1 with unit gain
            \draw[->] (X) to node[midway, above, inner sep=1pt] {$1$} (m1);
            % output is taken from m3 with unit gain
            \draw[->] (m3) to node[midway, above, inner sep=1pt] {$1$} (Y);
            % complete directed subgraph among m1..m3 (H_ij for forward, G_ij for feedback)
            \draw[->] (m1) to[bend left=18] node[midway, above, inner sep=1pt] {$H_{12}$} (m2);
            \draw[->] (m2) to[bend left=18] node[midway, below, inner sep=1pt] {$G_{21}$} (m1);
            \draw[->] (m1) to[bend left=18] node[midway, above, inner sep=1pt,xshift=-6pt] {$H_{13}$} (m3);
            \draw[->] (m3) to[bend left=18] node[midway, below, inner sep=1pt,xshift=6pt] {$G_{31}$} (m1);
            \draw[->] (m2) to[bend left=18] node[midway, above, inner sep=1pt] {$H_{23}$} (m3);
            \draw[->] (m3) to[bend left=18] node[midway, below, inner sep=1pt] {$G_{32}$} (m2);
        \end{tikzpicture}
    \end{figure}
    \ding{172}使用矩阵进行分析：系统矩阵为
    \[\begin{bmatrix}
        1 & -G_{21} & -G_{31} \\
        -H_{12} & 1 & -G_{32} \\
        -H_{13} & -H_{23} & 1
    \end{bmatrix}\]
    特征行列式为
    $$\Delta=\begin{vmatrix}
        1 & -G_{21} & -G_{31} \\
        -H_{12} & 1 & -G_{32} \\
        -H_{13} & -H_{23} & 1
    \end{vmatrix}=1-G_{21}H_{12}-G_{31}H_{13}-G_{32}H_{23}-G_{21}G_{32}H_{13}-G_{31}H_{23}H_{12}$$
    在$\Delta\neq 0$时，系统矩阵可逆，其逆矩阵为\begin{align*}
        S^{-1}=\frac{1}{\Delta}\begin{bmatrix}
            1-G_{32}H_{23} & G_{21}+G_{31}H_{23} & G_{31}+G_{21}G_{32} \\
            H_{12}+H_{13}G_{32} & 1-G_{31}H_{13} & G_{32}+G_{31}H_{12} \\
            H_{13}+H_{12}H_{23} & H_{23}+G_{21}H_{13} & 1-G_{21}H_{12}
        \end{bmatrix}
    \end{align*}
    输出为$Y=M_3=\frac{1}{\Delta}(H_{13}+H_{12}H_{23})X$，因此系统增益为
    \[H=\frac{Y}{X}=\frac{H_{13}+H_{12}H_{23}}{\Delta}=\frac{H_{13}+H_{12}H_{23}}{1-G_{21}H_{12}-G_{31}H_{13}-G_{32}H_{23}-G_{21}G_{32}H_{13}-G_{31}H_{23}H_{12}}\]

    \ding{173}使用梅森增益公式的几何意义：图中共有五个环路，分别为\begin{align*}
        L_1&:M_1\to M_2\to M_1,\text{增益}L_1=G_{21}H_{12}\\
        L_2&:M_1\to M_3\to M_1,\text{增益}L_2=G_{31}H_{13}\\
        L_3&:M_2\to M_3\to M_2,\text{增益}L_3=G_{32}H_{23}\\
        L_4&:M_1\to M_2\to M_3\to M_1,\text{增益}L_4=G_{21}G_{32}H_{13}\\
        L_5&:M_1\to M_3\to M_2\to M_1,\text{增益}L_5=G_{31}H_{23}H_{12}
    \end{align*}
    这五个环路两两相交，因此特征行列式为
    \[\Delta=1-(L_1+L_2+L_3+L_4+L_5)=1-G_{21}H_{12}-G_{31}H_{13}-G_{32}H_{23}-G_{21}G_{32}H_{13}-G_{31}H_{23}H_{12}\]
    前向通路共有两条，增益分别为$g_1=H_{13}$和$g_2=H_{12}H_{23}$，去掉前向通路中的节点后没有环路，因此$\Delta_1=\Delta_2=1$。根据梅森增益公式，有
    \[H=\frac{g_1\Delta_1+g_2\Delta_2}{\Delta}=\frac{H_{13}+H_{12}H_{23}}{1-G_{21}H_{12}-G_{31}H_{13}-G_{32}H_{23}-G_{21}G_{32}H_{13}-G_{31}H_{23}H_{12}}\]
\end{example}

\chapter{离散时间变换}

\section{z变换}\label{sec:z_Transform}

\subsection{z变换的引出}\label{sub:inteoduction_of_z}
中学数学中处理递推数列的一种经典方法是使用生成函数，将数列转化为形式幂级数，从而利用级数的性质来分析数列。z变换可以看作生成函数的推广，它将数列推广为离散时间信号,将形式幂级数推广为洛朗级数（我们将在\ref{sub:meromorphic_function}中详细讨论这个洛朗级数的收敛域），从而可以利用复变函数的理论来分析离散时间信号与离散系统。
\begin{definition}[z变换]
    将离散时间信号$x[n]$的z变换记为$X(z)$或$\mathcal{Z} x(z)$，它的定义为
    \[X(z)=\mathcal{Z} x[n]=\sum_{n=-\infty}^{\infty}x[n]z^{-n},z\in\mathbb{C}\]
    我们记$x[n]\overset{\mathcal{Z} }{\longleftrightarrow}X(z)$。
\end{definition}
作为一个洛朗级数，z变换所得函数$X(z)$的收敛域应为一个圆环$\mathcal{A}_0(r,R)$，在圆环内级数是绝对收敛、内闭一致收敛的。根据圆环上全纯函数的洛朗级数的存在性和唯一性，洛朗级数与离散信号一一对应，因此可以使用上面的记号$x[n]\overset{\mathcal{Z} }{\longleftrightarrow}X(z)$。

下面给出一些常用离散信号的z变换作为例子：
\begin{example}[单位脉冲序列的z变换]
    设$x[n]=\delta[n-k],k\in\mathbb{Z}$，则
    \[X(z)=\sum_{n=-\infty}^{\infty}\delta[n-k]z^{-n}=z^{-k},z\in\mathbb{C}\backslash\{0\}\]
\end{example}
\begin{example}[单位阶跃序列的z变换]
    设$x[n]=u[n]$，则
    \[X(z)=\sum_{n=0}^{\infty}z^{-n}=\frac{1}{1-z^{-1}}=\frac{z}{z-1},|z|>1\]
\end{example}
\begin{example}[指数序列的z变换]
    设$x[n]=a^n u[n],a\in\mathbb{C}$，则
    \[X(z)=\sum_{n=0}^{\infty}a^n z^{-n}=\frac{1}{1-a z^{-1}}=\frac{z}{z-a},|z|>|a|\]
\end{example}
\begin{example}[单边余弦序列的z变换]
    \begin{align*}
        \mathcal{Z} \left[\cos(\Omega n)u[n]\right]&=\frac{1}{2}\left(\mathcal{Z} \left[e^{i\Omega n}u[n]\right]+\mathcal{Z} \left[e^{-i\Omega n}u[n]\right]\right)\\
        &=\frac{1}{2}\left(\frac{z}{z-e^{i\Omega}}+\frac{z}{z-e^{-i\Omega}}\right)\\
        &=\frac{z(z-\cos\Omega)}{z^2-2z\cos\Omega+1},|z|>1
    \end{align*}
\end{example}
\begin{example}[单边正弦序列的z变换]
    \begin{align*}
        \mathcal{Z} \left[\sin(\Omega n)u[n]\right]&=\frac{1}{2i}\left(\mathcal{Z} \left[e^{i\Omega n}u[n]\right]-\mathcal{Z} \left[e^{-i\Omega n}u[n]\right]\right)\\
        &=\frac{1}{2i}\left(\frac{z}{z-e^{i\Omega}}-\frac{z}{z-e^{-i\Omega}}\right)\\
        &=\frac{z\sin\Omega}{z^2-2z\cos\Omega+1},|z|>1
    \end{align*}
\end{example}

根据\ref{sub:laurant_series}中介绍的洛朗级数理论，z变换的收敛域为一个环状区域：
\begin{definition}[z变换的收敛域]
    设离散时间信号$x[n]$的z变换为$X(z)=\sum_{n=-\infty}^{\infty}x[n]z^{-n}$，则其\textbf{收敛域}(region of convergence, ROC)定义为
    \[\text{ROC}=\left\{z\in\mathbb{C} \left|r<|z|<R\right.\right\}\]
    其中
    \[r=\varlimsup_{n\to\infty}|x[-n]|^{\frac{1}{n}},R=\left(\varlimsup_{n\to\infty}|x[n]|^{\frac{1}{n}}\right)^{-1}\]
\end{definition}
以上定义对于$r=0$或$R=\infty$或$r\geq R$的退化情况同样适用。特别地，我们指出：
\begin{itemize}
    \item 若 \( x[n] = 0,\ n < 0 \)，则 \( r = 0 \)，双边 z 变换退化为单边 z 变换；
    \item 若 \( x[n] = 0,\ n > 0 \)，则 \( R = \infty \)；
    \item 若 \( x[n] \) 是有限长序列，则 \( r = 0,\ R = \infty \)，z 变换在整个复平面（除 \( z = 0 \) 和 \( z = \infty \) 外）解析；
    \item 若 \( |x[n]| \) 在 \( n \to \pm \infty \) 时分别以 \( |a|^n \) 的速率增长，则其双边 z 变换的收敛域可能为空。除了前面三种情况外，典型的非空收敛域例子如 \( x[n] = \alpha^{|n|} \)（\( |\alpha| < 1 \)），其收敛域为
     \[|\alpha| < |z| < \dfrac{1}{|\alpha|} \]
\end{itemize}

和洛朗级数一样，更常用的确定收敛域的方法是分析$X(z)$的奇点位置。在z变换中，我们需要结合信号特征确定收敛域的范围。
\begin{definition}
    \textbf{左边信号（反因果信号）}：$x[n]=0,n\geq 0$，或$x[n]=x[n]u[-n-1]$；\\
    \textbf{右边信号（因果信号）}：$x[n]=0,n<0$，或$x[n]=x[n]u[n]$；\\
    \textbf{双边信号}：既不是左边信号，也不是右边信号。
\end{definition}

下面的例子展示了同一个z变换在不同类型信号下的不同收敛域。
\begin{example}[收敛域的确定]
    设$$X(z)=\frac{1}{1-z}+\frac{1}{2z-1}$$
    在离散信号$x[n]$分别是左边、右边和双边信号时，求$x[n]$及其收敛域。\\
    解：$X(z)$的奇点为$z=1,1/2$。\\
    \ding{172}设$x[n]$为左边信号，$X(z)$只有正幂次项，则收敛域为$|z|<1/2$。
    \begin{align*}
        X(z)=&\frac{1}{1-z}+\frac{1}{2z-1}\\
        =&\frac{1}{1-z}-\frac{1}{1-2z}\\
        =&\sum_{n=0}^{\infty}z^{n}-\sum_{n=0}^{\infty}\left(2z\right)^{n}\\
        =&\sum_{n=0}^{\infty}\left(1-2^{n}\right)z^{n}
    \end{align*}
    因此$x[n]=(1-2^{n})u[-n-1]$。\\
    \ding{173}设$x[n]$为右边信号，$X(z)$只有负幂次项，则收敛域为$|z|>1$。
    \begin{align*}
        X(z)=&-\frac{1/z}{1-1/z}+\frac{1/2z}{1-1/2z}\\
        =&-\sum_{n=1}^{\infty}z^{-n}+\sum_{n=1}^{\infty}\left(2z\right)^{-n}\\
        =&\sum_{n=1}^{\infty}\left(2^{-n}-1\right)z^{-n}
    \end{align*}
    因此$x[n]=(2^{-n}-1)u[n]$。\\
    \ding{174}设$x[n]$为双边信号，则收敛域为$1/2<|z|<1$。 
    \begin{align*}
        X(z)=&\frac{1}{1-z}+\frac{1/2z}{1-1/2z}\\
        =&\sum_{n=0}^{\infty}z^{n}-\sum_{n=1}^{\infty}\left(2z\right)^{-n}\\
        =&\sum_{n=0}^{\infty}z^{n}+\sum_{n=-\infty}^{-1}\left(2^{-n}-1\right)z^{n}
    \end{align*}
    因此$x[n]=u[n]+(2^{-n}-1)u[-n-1]$。
\end{example}
可以看到，同一个复变函数在不同的域上展开，对应不同的表达式，并且在不同类型的收敛域上对应不同类型的信号，其共性是可以用奇点位置判断收敛域。

上例实际上展示了一种求逆z变换的方法，即将$X(z)$做幂级数展开，然后根据幂级数的系数确定$x[n]$。更一般地，$X(z)$是一个真分式函数时，可以通过部分分式分解将$X(z)$表示为若干简单分式之和，然后对每个简单分式进行类似上例的幂级数展开，从而得到$x[n]$。这种方法在实际应用中非常常见，我们将在\ref{sub:z_inverse}中详细介绍。

\subsection{z变换的运算性质}\label{sub:z_operation}
\begin{proposition}[z变换的运算性质]
    设$x[n],y[n]$的z变换分别为$X(z),Y(z)$，则有：
    \begin{itemize}
        \item 线性：在$X(z)$与$Y(z)$共同的收敛域内，$a x[n]+b y[n]\xleftrightarrow{\mathcal{Z}} a X(z)+b Y(z)$
        \item 移位：$x[n-n_0]\xleftrightarrow{\mathcal{Z}} z^{-n_0}X(z)$
        \item 共轭：$\overline{x[n]}\xleftrightarrow{\mathcal{Z}} \overline{X(\overline{z})}$
        \item 指数加权：$a^{n} x[n]\xleftrightarrow{\mathcal{Z}} X\left(\dfrac{z}{a}\right)(z\neq 0)$，收敛域变为$|a|r<|z|<|a|R$
        \item 反转：$x[-n]\xleftrightarrow{\mathcal{Z}} X\left(\dfrac{1}{z}\right)$
        \item 升采样：$x[n/L]\xleftrightarrow{\mathcal{Z}} X\left(z^{L}\right)$，收敛域变为$r^{1/L}<|z|<R^{1/L}$
        \item 降采样：$x[nM]\xleftrightarrow{\mathcal{Z}} \dfrac{1}{M}\sum_{k=0}^{M-1}X\left(z^{\frac{1}{M}}e^{-i\frac{2\pi}{M}k}\right)$，收敛域为$r^{M}<|z|<R^{M}$
        \item z域微分：$n x[n]\xleftrightarrow{\mathcal{Z}} -z\dfrac{dX(z)}{dz}$
    \end{itemize}
\end{proposition}
\begin{proof}
    我们仅给出后两条性质的证明。\\
    1.降采样：
    \begin{align*}
        \mathcal{Z}\left[x[nM]\right]=\sum_{n=-\infty}^{\infty}x[nM]z^{-n}=\sum_{m=nM}x[m]z^{-m/M}\quad(m=nM)
    \end{align*}
    为了处理$m$只能取$n$的整数倍的情况，我们引入\textbf{选择函数}：
    \[\shah_M[n]=\frac{1}{M}\sum_{k=0}^{M-1}e^{i\frac{2\pi}{M}kn}=\begin{cases}
        1 & \text{if }m=nM\\
        0 & \text{otherwise}
    \end{cases}\]
    可以利用等比数列求和公式验证上述结论。带入上式并交换求和次序，得到
    \begin{align*}
        \mathcal{Z}\left[x[nM]\right]&=\sum_{m=-\infty}^{\infty}x[m]z^{-m/M}\shah_M[m]\\
        &=\frac{1}{M}\sum_{k=0}^{M-1}\sum_{m=-\infty}^{\infty}x[m]\left(z^{\frac{1}{M}}e^{-i\frac{2\pi}{M}k}\right)^{-m}\\
        &=\frac{1}{M}\sum_{k=0}^{M-1}X\left(z^{\frac{1}{M}}e^{-i\frac{2\pi}{M}k}\right)
    \end{align*}
    对每个$X\left(z^{\frac{1}{M}}e^{-i\frac{2\pi}{M}k}\right)$，收敛域为
    \[r<\left|z^{\frac{1}{M}}e^{-i\frac{2\pi}{M}k}\right|< R\iff r^{M}<|z|<R^{M}\]
    2.z域微分：在洛朗级数的收敛域内，级数时内闭一致收敛的，因此可以逐项求导，即
    \begin{align*}
        -z\frac{dX(z)}{dz}=-z\frac{d}{dz}\left(\sum_{n=-\infty}^{\infty}x[n]z^{-n}\right)=-z\sum_{n=-\infty}^{\infty}x[n](-n)z^{-n-1}=\sum_{n=-\infty}^{\infty}n x[n]z^{-n}
    \end{align*}
\end{proof}

此外，对于离散信号，定义\cite{signal_systems}：
\begin{definition}[卷积和]
    设$x[n],y[n]$为离散信号，则它们的\textbf{卷积和}定义为
    \[(x*y)[n]=\sum_{k=-\infty}^{\infty}x[k]y[n-k]\]
\end{definition}
类似连续信号的卷积定理，有：
\begin{proposition}[卷积和定理]
    在$X(z)$与$Y(z)$共同的收敛域内，有
    \[x[n]*y[n]\xleftrightarrow{\mathcal{Z}} X(z)Y(z)\]
\end{proposition}
%z域卷积定理
\begin{proof}
    在$X(z)$与$Y(z)$共同的收敛域内，有
    \begin{align*}
        \mathcal{Z} \left[x[n]*y[n]\right]&=\sum_{n=-\infty}^{\infty}\left(\sum_{k=-\infty}^{\infty}x[k]y[n-k]\right)z^{-n}\\
        &=\sum_{k=-\infty}^{\infty}x[k]z^{-k}\sum_{m=-\infty}^{\infty}y[m]z^{-m}\quad(m=n-k)\\
        &=X(z)Y(z)
    \end{align*}
\end{proof}

一般而言，离散信号在做线性组合或卷积和时，其z变换的收敛域为各信号z变换收敛域的交集，但如果涉及到零极点的抵消，则收敛域可能会扩大。
\begin{example}[收敛域的扩张]
    设$x_1[n]=a^{n}u[n],x_2[n]=\delta[n]-a^{n}u[n]$，则
    \begin{align*}
        X_1(z)&=\sum_{n=0}^{\infty}a^{n}z^{-n}=\frac{z}{z-a},|z|>|a|\\
        X_2(z)&=1-\sum_{n=0}^{\infty}a^{n}z^{-n}=1-\frac{z}{z-a}=\frac{a}{a-z},|z|>|a|
    \end{align*}
    但是$x[n]=x_1[n]+x_2[n]=\delta[n]$，其z变换为$X(z)=1$，收敛域为$\mathbb{C}$。\\
    设$y_1[n]=\delta[n]-a\delta[n-1],y_2[n]=a^{n}u[n-1]$，则
    \begin{align*}
        Y_1(z)&=1-a z^{-1},z\in\mathbb{C}\backslash\{0\}\\
        Y_2(z)&=\sum_{n=1}^{\infty}a^{n}z^{-n}=\frac{1}{1-a z^{-1}},|z|>|a|
    \end{align*}
    但是\begin{align*}
        y[n]=\left(y_1*y_2\right)[n]&=\sum_{k=-\infty}^{\infty}y_1[k]y_2[n-k]\\
        &=y_2[n]-a y_2[n-1]\\
        &=a^{n}u[n-1]-a^{n}u[n-2]\\
        &=\delta[n]
    \end{align*}
    其z变换为$Y(z)=1$，收敛域为$\mathbb{C}$。
\end{example}

\section{亚纯函数与逆z变换}\label{sec:Inverse_z_Transform}

\subsection{亚纯函数}\label{sub:meromorphic_function}
逆z变换即由$X(z)$求$x[n]$，根据洛朗级数展开的唯一性，容易想到有两种常用的方法：
\begin{itemize}
    \item 将$X(z)$展开为洛朗级数，直接读取系数；
    \item 利用留数的计算公式，$z^{n-1} X(z)=\sum_{m=-\infty}^{\infty} x[m] z^{n-m-1}$在$z=0$处的留数即为$x[n]$
\end{itemize}

在前面的例子6.1.6.中，我们已经展示了前一种方法，可以看出，在完成部分分式展开之后，这个方法是非常有效的。但是，在$X(z)$收敛域不同的情况下展开，我们得到了三种洛朗级数，这似乎与洛朗级数的唯一性矛盾；在$x[n]$为右边信号的情况下，展开式的负幂次项构成级数，$z=0$为本性奇点，这与原信号在$z=0$处全纯的结果矛盾。实际上，这是因为在收敛域不是$|z|<1/2$的情况下，我们将分式$1/(2z-1)$展开为负幂次项级数时，是在做$z=\infty$处的洛朗展开，这样展开得到的洛朗级数不能用来判定$z=0$处的奇点类型。

为了说明这个问题，我们需要引入亚纯函数的概念\cite{Function_Theory}：
\begin{definition}[亚纯函数]
    设$U\subset\mathbb{C}$为开集，$S\subset U$没有极限点，函数$f:U\backslash S\to\mathbb{C}$称为\textbf{亚纯函数}，如果$f$在$U\backslash S$内全纯，且在$S$中没有本性奇点。
\end{definition}

亚纯函数是全纯函数的推广，它允许孤立极点和可去奇点的存在。如果将开集$U\subset \mathbb{C}$上的全纯函数集视为环$\mathcal{O} (U)$，则亚纯函数集构成$\mathcal{O} (U)$的分式域$\text{Frac}(\mathcal{O} (U))$，记为$\mathcal{M} (U)$。

对扩展复平面$\hat{\mathbb{C}}=\mathbb{C}\cup\{\infty\}$，标准的做法是通过球极投影将扩展平面同胚映射至单位球，即黎曼球面，采用球面拓扑来定义扩展复平面的拓扑。本书不详细讲述这一点，感兴趣的读者请自行阅读复变函数的教材。简单来说，对于无穷远点，我们定义：
\begin{definition}[无穷远点的邻域]
    无穷远点$\infty$的邻域定义为
    \[U(\infty)=\left\{\left.z\in\hat{\mathbb{C}} \right||z|>R\right\}\cup\{\infty\},R>0\]
    $\infty$是集合$S\cup\{\infty\}$的极限点当且仅当$S$中存在点列$\{z_n\}$，使得$\lim_{n\to\infty}|z_n|=\infty$。
\end{definition}
基于以上定义，我们可以给出扩展复平面上的亚纯函数定义：
\begin{definition}[扩展复平面上的亚纯函数]
    设$U\subset\hat{\mathbb{C}}$为开集，$S\subset U$没有极限点，函数$f:U\backslash S\to\hat{\mathbb{C}}$称为\textbf{亚纯函数}(meromorphic functions)，如果$f$在$U\backslash S$内全纯，且在$S$中没有本性奇点。
\end{definition}
\begin{example}
    对于有理函数$f(z)=\dfrac{P(z)}{Q(z)}$，其中$P(z),Q(z)$为多项式，$f(z)$在$\hat{\mathbb{C}}$上亚纯。其中，如果$\text{deg}P\leq\text{deg}Q$，则$f(z)$在$\infty$处有可去奇点；如果$\text{deg}P>\text{deg}Q$，则$f(z)$在$\infty$处有$\text{deg}P-\text{deg}Q$阶极点。
\end{example}
我们不加证明地给出以下结论\cite{Function_Theory}：
\begin{claim}
    扩充复平面$\hat{\mathbb{C}}$上，亚纯函数一定是有理函数。
\end{claim}
因此，扩充复平面上的亚纯函数与有理函数是等价的概念。同一集合上，全纯函数是亚纯函数的子集，扩充复平面上亚纯函数的独特性质，可以理解为多数整函数在$\infty$处有本性奇点，下面很快会给出一个例子。

$f(z)$在$\infty$处的性质是通过$f(1/z)$在$z=0$处的性质来研究的：
\begin{definition}[无穷远点的奇点类型]
    定义$g(z)=f(1/z)$，则$f$在$\infty$处的奇点类型定义为$g$在$0$处的奇点类型，即：
    \begin{itemize}
        \item 若$f(1/z)$在$z=0$处有可去奇点，则称$f$在$\infty$处有可去奇点；
        \item 若$f(1/z)$在$z=0$处有极点，则称$f$在$\infty$处有极点；
        \item 若$f(1/z)$在$z=0$处有本性奇点，则称$f$在$\infty$处有本性奇点。
    \end{itemize}
\end{definition}

\begin{example}
    函数$f(z)=e^{z}$在$\mathbb{C}$上全纯。考察$f(z)$在$\infty$处的性质，
    \[f(1/z)=e^{1/z}=\sum_{n=0}^{\infty}\frac{1}{n!}z^{-n}\]
    该级数有无穷多个负幂次项，因此$e^{z}$在$\infty$处有本性奇点，它不是扩充复平面上的亚纯函数。
\end{example}

我们称$g(z)$在$0$处的洛朗展开为$f(z)$在$\infty$处的洛朗展开，奇点类型可通过洛朗展开判断：
\begin{definition}[无穷远点的洛朗展开与奇点类型]
    设$g(z)$在$z=0$处的洛朗展开为
    \[g(z)=\sum_{n=-\infty}^{\infty}c_n z^{n}\]
    $g(z)$在$z=0$处的奇点类型定义与\ref{sub:laurant_series}中一致。代回$f(z)=g(1/z)$，则$f(z)$在$\infty$处的洛朗展开为
    \[f(z)=\sum_{n=-\infty}^{\infty}c_n z^{-n}\]
    因此，$f(z)$在$\infty$处的奇点类型为：
    \begin{itemize}
        \item 如果$c_n=0,\forall n<0$，，即级数无正幂次项，则$f(z)$在$\infty$处有可去奇点；
        \item 如果$\exists m\in\mathbb{N}_+$，使得$c_{-1}=c_{-2}=\cdots =c_{-m}=0,c_{-(m+1)}\neq 0$，即级数正幂次项有限，则$f(z)$在$\infty$处有极点；
        \item 如果$c_n\neq 0$对无穷多个负整数$n$成立，即级数正幂次项无限，则$f(z)$在$\infty$处有本性奇点。
    \end{itemize}
\end{definition}

需要注意，无穷远点的留数并不是$c_{-1}$，留数定义的根据在于围道积分后非0。取充分大的\textbf{顺时针}圆周$C^-_R:t\mapsto Re^{-it},t\in[0,2\pi]$为围道，使得$C^-_R$外只有$\infty$一个极点（可行性由奇点孤立保证），则$\text{Ind}_{C^-_R}(\infty)=1$\footnote{学过球极投影的读者可以更好地理解这一点：在黎曼球面上，如果两点位于位于围道两侧（例如这里的无穷远点与有限极点），计算环绕数时，曲线的正向是相反的。}，根据留数定理，有
$$\text{Res}(f,\infty)=\dfrac{1}{2\pi i}\oint_{C^-_R}f(z)\,dz$$
尽管现在要把$f$展开为$\infty$处的洛朗级数，但在做积分时我们仅仅切换了围道的定向，保留下来的是$f$在$\infty$处的展开式中$1/z$的系数的相反数，即$-c_{1}$。

在以上积分中，做变量代换$$w=1/zdz=-\dfrac{1}{w^2}dw$$
由于$R$充分大，围道变为逆时针的$C_{1/R}:t\mapsto \dfrac{1}{R}e^{-it},t\in[0,2\pi]$内只有$z=0$一个极点（可行性仍由奇点孤立保证），于是
\[\text{Res}(f,\infty)=\frac{1}{2\pi i}\oint_{C_{1/R}}f(1/w)\frac{-1}{w^2}dw=-\text{Res}\left(f(1/w)/w^2,0\right)\]
因此我们得到：
\begin{proposition}[无穷远点的留数]
    设$f(z)$在$\infty$处有孤立奇点，则$f(z)$在$\infty$处的留数为$f$在$\infty$处的展开式中$1/z$的系数的相反数$-c_{1}$，它可以用以下公式计算：
    \[\text{Res}(f,\infty)=-\text{Res}\left(\frac{f(1/z)}{z^2},0\right)\]
\end{proposition}

现在也就不难理解为什么上一节的例子6.1.6中，在不同收敛域上展开的洛朗级数会有不同的形式，并且在某些收敛域上无法判定$z=0$处的奇点类型了——在$|z|>1/2$的收敛域上，我们其实是将$1/(2z-1)$展开为$z=\infty$处的洛朗级数，这个级数只能说明$1/(2z-1)$在$\infty$处为可去奇点，而不能用于判断$z=0$处的奇点类型。

\subsection{逆z变换}\label{sub:z_inverse}
经验上，在做逆z变换时，我们更多地使用洛朗级数展开，直接对比系数的方法，这种方法还可以处理本性奇点的情况。
\begin{example}
    设$X(z)=e^{1/z}$，求$x[n]$。\\
    解：$X(z)$在$z=0$处有本性奇点，因此不能使用留数计算（注意我们获得留数计算公式的方法，是将洛朗级数乘以$z^{n-1}$，从而化为泰勒级数）。但它的展开式很容易获得：
    \[X(z)=\sum_{k=0}^{\infty}\frac{1}{k!}z^{-k}\]
    因此$x[n]=\frac{1}{n!}u[-n-1]$。可以验证其收敛域为$\hat{\mathbb{C}}\backslash\{0\}$，并且在$\infty$处展开与上式一致（在没有$0$以外的奇点时，这是必然的，因为同一收敛域上的洛朗级数展开唯一）。
\end{example}

如果$X(z)$是亚纯函数，计算留数仍然是一个有效的方法，因为要将有理函数展开为部分分式的计算量可能比较大（见\ref{sub:frac_laplace_inverse}）。在$X(z)z^{n-1}=\sum_{m=-\infty}^{\infty}x[m]z^{n-m-1}$中，对比$1/z$项系数，就得到使用该公式计算右边信号的逆z变换公式：
\begin{claim}
    设右边离散信号$x[n]$的z变换为$X(z)$，则有
    \[x[n]=-\text{Res}\left(X(z)z^{n-1},\infty\right)=\text{Res}\left(\frac{X(1/z)}{z^{n+1}},0\right)\]
\end{claim}

要使用$\text{Res}\left(\dfrac{X(1/z)}{z^{n+1}}\right)$计算是非常繁琐的，我们一般会使用留数定理将问题转化为其他极点的留数计算。注意我们并不打算算出复线积分，留数定理是从一些极点到另一些极点的桥梁.
\begin{example}
    设右边信号$x[n]$的z变换为
    \[X(z)=\frac{z^2}{(z-1)^3},\text{ROC}:|z|>1\]
    求$x[n]$。\\
    解：$X(z)$在$\infty$处有极点，因此可以使用留数定理：
    \begin{align*}
        x[n]=-\text{Res}\left(X(z)z^{n-1},\infty\right)=-\frac{1}{2\pi i}\oint_{C^-_R}X(z)z^{n-1}\,dz
    \end{align*}
    其中$C^-_R$为以原点为中心、半径$R$充分大的\textbf{顺时针}圆周，使得$X(z)$的所有极点都在$C^-_R$内。顺时针是为了使它绕$\infty$的环绕数$\text{Ind}_{C^-_R}(\infty)=1$。由于$C^-_R$绕$z=1$的环绕数为$-1$，根据留数定理，有
    \begin{align*}
        -\oint_{C^-_R}X(z)z^{n-1}\,dz=\oint_{C_R}X(z)z^{n-1}\,dz=2\pi i \text{Res}\left(X(z)z^{n-1},1\right)
    \end{align*}
    现在问题转化为一个三阶极点的留数求解：
    \begin{align*}
        \text{Res}\left(X(z)z^{n-1},1\right)&=\lim_{z\to 1}\frac{1}{2!}\frac{d^2}{dz^2}\left[(z-1)^3\frac{z^{n+1}}{(z-1)^3}\right]\\
        &=\lim_{z\to 1}\frac{1}{2}\frac{d^2}{dz^2}z^{n+1}\\
        &=\frac{(n+1)n}{2}
    \end{align*}
    因此$$x[n]=-\text{Res}\left(X(z)z^{n-1},1\right)=-\frac{(n+1)n}{2}u[n]$$    
\end{example}

左边信号对应经典的泰勒级数情况，我们已经在前面说明，$x[n]=\text{Res}\left(X(z)z^{n-1},0\right)$。不过实际计算时，使用留数定理将高阶极点的留数转化为其他低阶极点的留数会更加方便。注意考虑围道外的点时，需要将$\infty$处的留数也计算进去。
\begin{example}
    设左边信号$x[n]$的z变换为
    \[X(z)=\frac{z^2}{(z-1)^3},\text{ROC}:|z|<1\]
    求$x[n]$。\\
    解：由留数定理：
    \[x[n]=\text{Res}\left(X(z)z^{n-1},0\right)=\frac{1}{2\pi i}\oint_{C_r}X(z)z^{n-1}\,dz\]
    其中$C_r$为以原点为中心、半径$r$充分小的逆时针圆周，使得$X(z)$的其他极点都在$C_r$外。在$n\geq -1$时，$X(z)z^{n-1}$在$z=0$处为可去奇点，留数为0；在$n<-1$时，$X(z)z^{n-1}$在$z=0$处有$-(n-1)$阶极点，我们将其转化为围道外的极点留数计算。由于$\text{Ind}_{C_r}(1)=\text{Ind}_{C_r}(\infty)=-1$，根据留数定理，有
    \[\oint_{C_r}X(z)z^{n-1}\,dz=-2\pi i \left[\text{Res}\left(X(z)z^{n-1},1\right)+\text{Res}\left(X(z)z^{n-1},\infty\right)\right]\]
    现在问题转化为两个极点的留数求解。前者与上例相同，后者可以使用无穷远点的留数计算公式：
    \begin{align*}
        \text{Res}\left(X(z)z^{n-1},\infty\right)&=-\text{Res}\left(\frac{X(1/z)}{z^{n+1}},0\right)=-\text{Res}\left(\frac{1}{(1-z)^3 z^{n-1}},0\right)
    \end{align*}
    在$n<-1$时，$\dfrac{1}{(1-z)^3 z^{n-1}}$在$z=0$处全纯，留数为0。因此，
    \begin{align*}
        x[n]&=-\left[\text{Res}\left(X(z)z^{n-1},1\right)+\text{Res}\left(X(z)z^{n-1},\infty\right)\right]=-\frac{(n+1)n}{2}u[-n-1]
    \end{align*}
    其实，由于$\text{deg}\ z^{n+1}\leq \text{deg}\ (z-1)^3$，$X(z)z^{n-1}$在$\infty$处为可去奇点，这种情况下可以直接断定无穷远点的留数为0。
\end{example}

总之，设离散信号$x[n]$的z变换为$X(z)$，则有：
\begin{itemize}
    \item 如果$x[n]$为左边信号，则
    \[x[n]=\text{Res}\left(X(z)z^{n-1},0\right)=\oint_{C_r}X(z)z^{n-1}\,dz\]
    \item 如果$x[n]$为右边信号，则
    \[x[n]=-\text{Res}\left(X(z)z^{n-1},\infty\right)=-\oint_{C^-_R}X(z)z^{n-1}\,dz=\oint_{C_R}X(z)z^{n-1}\,dz\]
\end{itemize}
如果能够对双边信号，取收敛域内的围道$C$，并证明
\[x[n]=\int_{C}X(z)z^{n-1}\,dz\]
则逆z变换的形式统一，这是一个非常漂亮的结果。

根据我们先前对双边信号的处理经验，可以想到，如果我们能够将$X(z)$拆成左边信号和右边信号的z变换之和，那么就可以分别计算它们的逆z变换，再将结果相加。对于我们最常遇到的有理函数，这总是可行的，因为理论上可以对部分分式展开式\textbf{分组通分}。
\begin{example}
    设双边信号的z变换为
    \[X(z)=\frac{1}{(z-1)^3(z-2)},\text{ROC}:1<|z|<2\]
    求$x[n]$。\\
    解：考虑将$X(z)$拆成左边信号和右边信号的z变换之和：
    \begin{align*}
        X(z)&=\frac{1}{(z-1)^3(z-2)}=\frac{A}{z-2}+\frac{B}{z-1}+\frac{C}{(z-1)^2}+\frac{D}{(z-1)^3}\\
        &=\frac{A}{z-2}+\frac{B(z-1)^2+C(z-1)+D}{(z-1)^3}\\
        &=\frac{A}{z-2}+\frac{B'z^2+C'Z+D'}{(z-1)^3}
    \end{align*}
    容易求得$A=1$，做减法并约去公因式$(z-2)$，即得分解式的另一部分：
    \[X(z)=\frac{1}{z-2}-\frac{z^2-z+1}{(z-1)^3}\]
    很明显，第一项对应左边信号，第二项对应右边信号。分别计算它们的逆z变换：
    \begin{align*}
        x_{left}[n]&=\text{Res}\left(\frac{z^{n-1}}{z-2},0\right)\\
        &=\frac{1}{2\pi i}\oint_{C_r}\frac{z^{n-1}}{z-2}\,dz\\
        &=-\text{Res}\left(\frac{z^{n-1}}{z-2},2\right)\\
        &=-2^{n-1}u[-n]\\
        x_{right}[n]&=-\text{Res}\left(-\frac{z^2-z+1}{(z-1)^3}z^{n-1},\infty\right)\\
        &=-\frac{1}{2\pi i}\oint_{C_R}\frac{z^2-z+1}{(z-1)^3}z^{n-1}\,dz\\
        &=-\left[\text{Res}\left(\frac{z^2-z+1}{(z-1)^3}z^{n-1},1\right)+\text{Res}\left(\frac{z^2-z+1}{(z-1)^3}z^{n-1},0\right)\right]\\
        &=-\lim_{z\to 1}\frac{1}{2}\frac{d^2}{dz^2}\left(z^{n+1}-z^{n}+z^{n-1}\right)-\delta[n]\\
        &=-\frac{n^2-n+2}{2}u[n]-\delta[n]\\
        &=-\frac{n^2-n+2}{2}u[n-1]
    \end{align*}
    因此
    \[x[n]=x_{left}[n]+x_{right}[n]=-2^{n-1}u[-n]-\frac{n^2-n+2}{2}u[n-1]\]
\end{example}

注意到上个例子中我们可以选取两条一样的围道，只要它处于收敛域内。由此我们可以总结出逆z变换的一般方法：
\begin{theorem}[逆z变换，留数定理方法]
    设离散信号$x[n]$的z变换为$X(z)\in\mathcal{M} \left(\hat{\mathbb{C}}\right)$，其收敛域为$r<|z|<R$，任取围道$C\subset\mathcal{A} _0(r,R)$，则有
    \[x[n]=\mathcal{Z} ^{-1}X[n]=\frac{1}{2\pi i}\oint_{C}X(z)z^{n-1}\,dz\]
\end{theorem}

注意$X(z)$亚纯实际上要求它是有理函数，这样，使用留数定理求逆z变换的方法就很好懂了，它的证明需要用到部分分式展开定理，形式较为复杂，这里不再赘述。围道的任意性是由柯西积分定理保证的，因为$X(z)$在$\mathcal{A} _0(r,R)$内全纯。

\subsection{z域卷积定理}\label{sub:z_convolution}
使用逆z变换公式，我们还可以得到\textbf{z域卷积定理}:
\begin{theorem}[z域卷积定理]
    设离散信号$x[n],y[n]$的z变换分别为$X(z),Y(z)$，收敛域分别为$\mathcal{A} _0(r_1,R_1),\mathcal{A} _0(r_2,R_2)$，则在$\mathcal{A} _0(r_1 r_2,R_1 R_2)$内取围道$C$，有
    \[x[n]y[n]\xleftrightarrow{\mathcal{Z}} \frac{1}{2\pi i}\oint_{C}X(\nu)Y\left(\frac{z}{\nu}\right)\nu^{-1}\,d\nu\]
\end{theorem}
\begin{proof}
    对于收敛域，可以用z变换的收敛域公式验证：
    \[r=\varlimsup_{n\to\infty}|x[-n]y[-n]|^{\frac{1}{n}}=\varlimsup_{n\to\infty}|x[-n]|^{\frac{1}{n}}\cdot\varlimsup_{n\to\infty}|y[-n]|^{\frac{1}{n}}=r_1 r_2\]
    \[R=\left(\varlimsup_{n\to\infty}|x[n]y[n]|^{\frac{1}{n}}\right)^{-1}=\left(\varlimsup_{n\to\infty}|x[n]|^{\frac{1}{n}}\right)^{-1}\cdot\left(\varlimsup_{n\to\infty}|y[n]|^{\frac{1}{n}}\right)^{-1}=R_1 R_2\]
    在$\mathcal{A} _0(r_1 r_2,R_1 R_2)$内取围道$C$，则对于任意$\nu\in C$，都有$\nu\in\mathcal{A} _0(r_1,R_1)$，且$z/\nu\in\mathcal{A} _0(r_2,R_2)$，因此$X(\nu),Y(z/\nu)$均全纯。由逆z变换公式，有
    \begin{align*}
        \oint_{C}X(\nu)Y\left(\frac{z}{\nu}\right)\nu^{-1}\,d\nu&=\oint_{C}\left(\sum_{m=-\infty}^{\infty}x[m]\nu^{-m}\right)\left(\sum_{k=-\infty}^{\infty}y[k]\left(\frac{z}{\nu}\right)^{-k}\right)\nu^{-1}\,d\nu\\
        &=\sum_{m=-\infty}^{\infty}\sum_{k=-\infty}^{\infty}x[m]y[k]z^{-k}\oint_{C}\nu^{-(m-k+1)}\,d\nu\\
        &=2\pi i \sum_{n=-\infty}^{\infty}x[n]y[n]z^{-n}
    \end{align*}
    积分与求和的交换是由收敛域内洛朗级数的内闭一致收敛性保证的。因此，
    \[x[n]y[n]\xleftrightarrow{\mathcal{Z}} \frac{1}{2\pi i}\oint_{C}X(\nu)Y\left(\frac{z}{\nu}\right)\nu^{-1}\,d\nu\]
\end{proof}

%\subsection{长除法}\label{sub:long_division}
%本小节来介绍另一种求逆z变换的方法——\textbf{长除法}。中学中我们仅使用它来做因式分解。它适用于$X(z)$为有理函数，且只需要求有限项的情况，我们通过一个例子来说明它的使用方法：
%\begin{example}
%    设右边信号$x[n]$的z变换为
%    \[X(z)=\frac{z}{z^2-2z+1},\text{ROC}:|z|>1\]
%    求$x[n]$的前五项$x[0],x[1], x[2], x[3], x[4]$。\\
%    解：将$X(z)$写成长除法的形式：
%    \[
%    \renewcommand\arraystretch{1.2}
%    \setlength{\arraycolsep}{1pt}
%    \begin{array}{rc rrrrrrrrr}
%    & & & & z^{-1} & +2z^{-2} & +3z^{-3} & +4z^{-4} & + \cdots \\
%    \cline{3-10}
%    z^2 - 2z + 1 & \big) & z & & & & & & & \\
%    & & z & -2 & +z^{-1} & & & & & \\
%    \cline{3-5}
%    & & & 2 & -z^{-1} & & & & & \\
%    & & & 2 & -4z^{-1} & +2z^{-2} & & & & \\
%    \cline{4-6}
%    & & & & 3z^{-1} & -2z^{-2} & & & & \\
%    & & & & 3z^{-1} & -6z^{-2} & +3z^{-3} & & & \\
%    \cline{5-7}
%    & & & & & 4z^{-2} & -3z^{-3} & & & \\
%    & & & & & 4z^{-2} & -8z^{-3} & +4z^{-4} & & \\
%    \cline{6-8}
%    & & & & & & 5z^{-3} & -4z^{-4}
%    \end{array}
%    \]
%    对照z变换的定义$X(z)=\sum_{n=-\infty}^{\infty}x[n]z^{-n}$，可得
%    \[x[0]=0,x[1]=1,x[2]=2,x[3]=3,x[4]=4,\cdots\]
%    可以猜想，$x[n]=n u[n]$。
%\end{example}

\section{离散时间傅里叶变换}\label{sec:DTFT}

\section{离散傅里叶变换}\label{sec:DFT}

\chapter{离散系统的变换域分析}

\section{离散系统的频率响应特性}\label{sec:Discrete_System_Freq_Response}

\section{离散系统的z域分析}\label{sec:Discrete_System_z_Analysis}

%因果性：收敛域包含$\infty$；稳定性：收敛域包含单位圆；对稳定+因果，收敛域包含$|z|\geq 1$
%差分方程

%\chapter{离散时间变换的算法}
%\section{离散余弦变换}\label{sec:DCT}

%\section{快速傅里叶变换}\label{sec:FFT}

%\section{压缩感知初步}\label{sec:Compress}

%\chapter{其他积分变换}

%\section{梅林变换}\label{sec:Mellin_Transform}

%\section{拉东变换}\label{sec:Radon_Transform}

%\section{离散余弦变换}\label{sec:DCT}

%\section{小波变换}\label{sec:Wavelet_Transform}
\appendix

\chapter{傅里叶变换补遗}
\section{傅里叶级数的渐进特性，吉布斯现象}\label{sec:Asymptotic_Behaviour}

\subsection{收敛速度的估计}\label{sub:converge_speed}
在用计算机模拟函数的傅里叶级数展开时，只能取有限项，自然要问计算到多少项时误差足够小，为此，我们不加证明地给出以下定理\cite{brad_osgood_ee261}：
\begin{theorem}
    设$f\in C^p(\mathbb{R} )(p\geq1)$是周期函数，其傅里叶系数为$c_k$，部分和
    \[S_N^f(t)=\sum_{k=-N}^{N}c_k e^{ik\omega t}\]
    在$\mathbb{R} $上逐点收敛、内闭一致收敛，且
    \[\max\left|f(t)-S_N^f(t)\right|<\frac{1}{N^{p-\frac{1}{2}}}\]
其中$C^p(\mathbb{R} )$表示p次连续可导的函数集。
\end{theorem}

\subsection{吉布斯现象}\label{sub:gibbs_phenomenon}
当$f(t)$不连续时，傅里叶级数的会在间断点处产生\textbf{吉布斯现象} (Gibbs' Phenomenon)：
\begin{definition}[吉布斯现象]
    部分和$S_N^f(t)$在间断点处总会\textbf{过冲}（在间断点两侧出现超过原函数的峰值），过冲幅度约为跳变幅度的9\%，并且$S_N^f(t)$会在间断点附近高频振荡
\end{definition}
\begin{example}
    对于跳变幅度为2、周期为$2\pi$的周期矩形脉冲信号
\[R(x) =
    \begin{cases}
        1  & \text{if } 0<x<\pi  \\
        -1 & \text{if } -\pi<x<0
    \end{cases}\]
其傅里叶级数的跳变值为1，$\varlimsup_{N \to \infty}S_N^R(t)=1.089490 \dots$。这是因为光滑的基函数很难逼近这种剧烈的局部变化，不得不用高频分量来补偿，高频分量带来了剧烈震动。
\end{example}
$\varlimsup_{N \to \infty}S_N^R(t)>1$并不意味着狄利克雷定理失效，因为定理给出的是逐点收敛：
\[\varlimsup_{N \to \infty}S_N^R(t)=\lim_{N \to \infty}\sup_{t\in \mathbb{R} }S_N^R(t)\neq \sup_{t\in\mathbb{R}}\lim_{N\to\infty}S_N^R(t)\]
使极限号与取上界号交换的一个充分条件是一致收敛，吉布斯现象表明，傅里叶级数在包含间断点的区间上不可能一致收敛。
\begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{gibbs}
    \caption{吉布斯现象示意图}
\end{figure}

为了直观地理解它，我们来看一个经典的例子：
\begin{example}
    \begin{align*}
    f_n(x)=
    \begin{cases}
        nx   & \text{if } 0<x\leq 1/n        \\
        2-nx & \text{if } 1/n<x<2/n \\
        0    & \text{otherwise}
    \end{cases}
\end{align*}
随n增大，$f(x)$逐点趋于0，因为对每一点$2/n$总能取到更小的值；但$f(x)$的最大值永远是1。
\end{example}

\subsection{狄利克雷核}\label{sub:dirichlet_kernel}
本小节引入狄利克雷核并介绍它的一些性质，并在下一小节用它来辅助我们对傅里叶级数收敛性的讨论。直接由狄利克雷条件证明收敛性是很困难的，并且需要更加专业的分析学工具，我们将给出更强的条件下的证明，并从这个更强的条件获得一些额外的性质。

研究傅里叶级数的渐进特性时，一个非常好用的工具是\textbf{狄利克雷核} (Dirichlet kernel)：
\begin{definition}[狄利克雷核]
    \[D_N(t)=\sum_{k=-N}^{N}e^{ik\omega t}=1+\sum_{k=1}^{N}\left(e^{ik\omega t}+e^{-ik\omega t}\right)=1+2\sum_{k=1}^{N}\cos(k\omega t)\]
    它是依赖于所研究函数的周期T的，但简便起见，在符号$D_N(t)$中不体现这一点。
\end{definition}

我们可以用等比数列求和或积化和差裂项的方法化简$D_N(t)$：
\begin{align*}
    D_N(t) & =\sum_{k=-N}^{N}e^{ik\omega t}=e^{-iN\omega t}\frac{1-e^{i(2N+1)\omega t}}{1-e^{i\omega t}}                  \\
           & =\frac{e^{i(N+1)\omega t}-e^{-iN\omega t}}{e^{i\omega t}-1}                                   \\
    D_N(t) & =1+\sum_{k=1}^{N}\left(e^{ik\omega t}+e^{-ik\omega t}\right)=1+2\sum_{k=1}^{N}\cos(k\omega t)           \\
           & =1+\frac{2}{\sin(\frac{\omega t}{2})}\sum_{k=1}^{N}\cos(k\omega t)\sin\left(\frac{\omega t}{2}\right)                   \\
           & =1+\frac{1}{\sin(\frac{\omega t}{2})}\sum_{k=1}^{N}\left(\sin\left((k+\frac{1}{2})\omega t\right)-\sin\left((k-\frac{1}{2})\omega t\right)\right) \\
           & =1+\frac{\sin\left((N+\frac{1}{2})\omega t\right)-\sin(\frac{\omega t}{2})}{\sin(\frac{\omega t}{2})}                     \\
           & =\frac{\sin\left((N+\frac{1}{2})\omega t\right)}{\sin(\frac{\omega t}{2})}
\end{align*}
这两种结果是相符的，读者可自行验证，并且可以从后一结果想象出狄利克雷核的函数图像，它被$\pm 1/\sin(\frac{\omega t}{2})$包络并高速振荡。函数图像如下。
\begin{figure}[H]
    \centering
    \includegraphics[width=0.5\textwidth]{Figure_3}
    \caption{狄利克雷核$D_N(t)$的函数图像}
\end{figure}

引入狄利克雷核后，就可以用以下恒等式研究傅里叶级数的部分和：
\begin{proposition}
    \[S_N^f(t)=\frac{1}{T}\int_{T}f(\tau)D_N(t-\tau)\,d\tau\]
\end{proposition}
\begin{proof}
    \begin{align*}
    S_N^f(t) & =\sum_{-N}^{N}c_k e^{ik\omega t}                                                                                \\
             & =\sum_{-N}^{N}\left(\frac{1}{T}\int_{T}f(\tau)e^{-k\omega \tau}\,d\tau\right) e^{ik\omega t}                    \\
             & =\frac{1}{T}\int_{T}f(\tau)\sum_{k=-N}^{N}e^{ik\omega (t-\tau)}\,d\tau                                          \\
             & =\frac{1}{T}\int_{T}f(\tau)D_N(t-\tau)\,d\tau                                                                   \\
             & =\frac{1}{T}\int_{T}f(t-\tau)D_N(\tau)\,d\tau                                                & (\tau\to t-\tau) \\
             & =\frac{1}{T}\int_{T}f(t+\tau)D_N(\tau)\,d\tau                                                & (\tau\to t+\tau)
\end{align*}
\end{proof}

在讨论傅里叶级数的收敛性前，先给出两个引理。第一个引理表明狄利克雷核在半周期上
积分值为$\frac{T}{2}$，在证明傅里叶级数的逐点收敛性时将用到它。
\begin{lemma}
    $$\int_{-\frac{T}{2}}^{0}D_N(t)\,dt=\int_{0}^{\frac{T}{2}}D_N(t)\,dt=\frac{T}{2}$$
\end{lemma}
\begin{proof}
    \begin{align*}
    D_N(t)&=1+2\sum_{k=1}^{N}\cos(k\omega t)\\
    \int_{0}^{\frac{T}{2}}D_N(t)\,dt & =\int_{0}^{\frac{T}{2}}\left(1+\sum_{k=1}^{N}\cos(k\omega t)\right)\,dt                              \\
                                     & =\frac{T}{2}+\sum_{k=1}^{N}\left.\frac{\sin(k\omega t)}{k\omega}\right|_{0}^{\frac{T}{2}} \\
                                     & =\frac{T}{2}+\frac{1}{\omega}\sum_{k=1}^{N}\frac{\sin(k\pi)}{k}=\frac{T}{2}               
\end{align*}
$D_N(t)$是偶函数，得证。
\end{proof}

\begin{lemma}[贝塞尔不等式]
设$ f\in L^2([0,T]),c_n=\dfrac{1}{T}\int_{T}f(t)e^{-ik\omega t}\,dt$，则
\begin{align*}
    \sum_{-\infty}^{\infty}|c_n|^2\leq \frac{1}{T}\int_{T}|f(t)|^2\,dt=\frac{1}{T}\|f\|_2^2
\end{align*}
\end{lemma}
它给出了傅里叶系数平方和的上界的估计。收敛级数的通项必收敛，所以由此可以看出$c_n\to 0,n\to\infty$.\\
\begin{proof}
    \begin{align*}
    \left|f(t)-\sum_{n=-N}^{N}c_n e^{in\omega t}\right|^2 & =\left(f(t)-\sum_{n=-N}^{N}c_n e^{in\omega t}\right)\left(f(t)-\sum_{n=-N}^{N}c_n e^{in\omega t}\right)^*                                       \\
                                               & =\left(f(t)-\sum_{n=-N}^{N}c_n e^{in\omega t}\right)\left(f^*(t)-\sum_{n=-N}^{N}c_n e^{-in\omega t}\right)                                      \\
                                               & =|f(t)|^2-\sum_{n=-N}^{N}\left(c_n^*f(t)e^{in\omega t}+c_n f^*(t)e^{-in\omega t}\right)+\sum_{m,n=-N}^{N}c_m c_n^*e^{i(m-n)\omega t}
\end{align*}
将上式在一个周期上积分，我们知道
\[\int_{T}f(t)e^{in\omega t}\,dt=Tc_n,\int_{T}e^{i(m-n)\omega t}\,dt=\begin{cases}
        0 & \text{if }m\neq n \\
        T & \text{if }m=n
    \end{cases}\]
故\begin{align*}
      & \int_{T}|f(t)|^2\,dt-\sum_{n=-N}^{N}\left(c_n^*\int_{T}f(t)e^{in\omega t}\,dt+c_n \int_{T}f^*(t)e^{-in\omega t}\,dt\right)+\sum_{m,n=-N}^{N}c_m c_n^*\int_{T}e^{i(m-n)\omega t}\,dt \\
    = & \int_{T}|f(t)|^2\,dt-T\sum_{n=-N}^{N}(c_n^* c_n+c_n c_n^*)+T\sum_{n=-N}^{N}c_n^* c_n                                                                                     \\
    = & \int_{T}|f(t)|^2\,dt-T\sum_{n=-N}^{N}|c_n|^2
\end{align*}
这是非负函数的积分，积分值非负，即\begin{align*}
    \sum_{-\infty}^{\infty}|c_n|^2\leq \frac{1}{T}\int_{T}|f(t)|^2\,dt<\infty
\end{align*}
\end{proof}

\subsection{分段光滑条件下的一致收敛性}\label{sub:uniform_converge}
直接由狄利克雷条件证明逐点收敛性需要很专业的分析学工具，但我们可以适当地加强狄利克雷条件，以得到更直观、简单的结论\cite{folland}。回忆\ref{sub:fourier_series_convergency}中对于分段光滑的定义：
\begin{definition}[分段光滑]
在区间$[a,b]$上，函数$f$称为\textbf{分段光滑} (piecewise smooth)，如果存在区间的划分$a=x_0<x_1<\dots <x_n=b$，使得在每个子区间$(x_{i-1},x_i)$上f可微，且区间端点处$f$的左右导数存在，记作$f\in PS[a,b]$。
\end{definition}
我们研究的多数函数是满足这样的性质的，并且我们将看到满足此条件会带来一些额外的性质。此时就可以相对简单地证明逐点收敛性：
\begin{theorem}[傅里叶级数的逐点收敛性]
    \[\lim_{N\to\infty}S_N^f(t_0)=\frac{f(t_0+)+f(t_0-)}{2}\]
\end{theorem}
\begin{proof}
\begin{align*}
    S_N^f(t_0)-\frac{f(t_0^+)+f(t_0^-)}{2} =&\frac{1}{T}\left(\int_{T}f(t_0-\tau)D_N(\tau)\,d\tau\right.\\
    &\left.-\int_{0}^{\frac{T}{2}}f(t_0^+)D_N(\tau)\,d\tau-\int_{-\frac{T}{2}}^{0}f(t_0^-)D_N(\tau)\,d\tau\right) \\
                                                                     =&\frac{1}{T}\left(\int_{0}^{\frac{T}{2}}(f(t_0-\tau)-f(t_0^+))D_N(\tau)\,d\tau\right.\\
                                                                     &+\left.\int_{-\frac{T}{2}}^{0}(f(t_0-\tau)-f(t_0^-))D_N(\tau)\,d\tau\right)         \\
    S_N^f(t_0)-\frac{f(t_0^+)+f(t_0^-)}{2}  =&\frac{1}{T}\int_{T}g(t)\left(e^{i(N+1)\omega t}-e^{iN\omega t}\right)\,dt                                                                                             
\end{align*}
其中\begin{align*}
g(t):=\begin{cases}
\dfrac{f(t_0+t)-f(t_0^-)}{e^{i\omega t}-1} & \text{if }-\frac{T}{2}<t_0<0 \\
\dfrac{f(t_0+t)-f(t_0^+)}{e^{i\omega t}-1} & \text{if }0<t_0<\frac{T}{2}
\end{cases}
\end{align*}                        
由洛必达法则，$t\to 0$时，\[\lim_{t\to 0^+}g(t)=\lim_{t\to 0^+}\frac{f(t_0+t)-f(t_0^+)}{e^{i\omega t}}=\lim_{t\to 0^+}\frac{f'(t_0+t)}{ie^{i\omega t}}=\lim_{t\to 0^+}\frac{f'(t_0^+)}{i}\]
$t\to 0^-$时同理。故g分段连续，当然是平方可积的，由贝塞尔不等式，
$g(t)$的傅里叶系数平方和收敛，通项趋于0，$S_N^f(t_0)-\left(f(t_0^+)+f(t_0^-)\right)/2=C_{-(N+1)}-C_N\to 0$
，得证。
\end{proof}

在分段光滑的条件下，容易得到$f'(t)$的傅里叶系数，注意微积分基本定理可以分区间使用：
\begin{proposition}[导函数的傅里叶系数]
    \begin{equation*}
    a'_n=n\omega b_n,b'_n=-n\omega a_n,c'_n=in\omega c_n
\end{equation*}
\end{proposition}
\begin{proof}
    以$c_n$为例：
\begin{align*}
    c'_n & =\frac{1}{T}\int_{T}f'(t)e^{-in\omega t}\,dt                                                         \\
         & =\frac{1}{T}\evalat{f(t)e^{-in\omega t}}{0}{T}+in\omega\int_{T}f(t)e^{-i\omega t}\,dt=in\omega c_n
\end{align*}
\end{proof}

f的原函数F的傅里叶系数同理，并且只要\textbf{分段连续}（见\ref{sub:fourier_series_convergency}）即可保证f可积，但是我们必须保证F是周期函数，这要求f的直流分量为0：
\[F(t+T)-F(t)=\int_{T}f(t)dt=Tc_0=0,c_0=0\]
此时，用刚刚得到的公式（2.16）就可直接得到F的傅里叶系数：
\begin{proposition}[原函数的傅里叶系数]
    \begin{equation*}
    A_n=\frac{a_n}{n\omega},B_n=\frac{b_n}{n\omega},C_n=\frac{c_n}{in\omega}
\end{equation*}
\end{proposition}

分段光滑还能够推出f的傅里叶级数\textbf{一致收敛}于f，从而可以逐项积分、逐项求导。回顾数学分析中的魏尔斯特拉斯M判别法\cite{zorich}\cite{xinjiang}：
\begin{theorem}[M判别法]
    对于函数项级数
$\sum_{n=1}^{\infty}f_n(x)$，如果存在正项级数$\sum_{n=1}^{\infty}M_n<\infty$
使得在区间E上$|f_n(x)|<M_n$，则$\sum_{n=1}^{\infty}f_n(x)$在E上绝对收敛且
一致收敛。
\end{theorem}
对于上述命题，只需证明$\sum_{n=1}^{\infty}|c_n|<\infty$.直接应用贝塞尔不等式是无效的，但可以通过一个小技巧完成证明：\begin{proof}
    记$c'_n$为$f'$的傅里叶系数，$c'_n =in\omega c_n$，
    \begin{align*}
    \sum_{n=-\infty}^{\infty}|c_n|=   |c_0|+\sum_{n\neq 0}\left| \frac{c'_n}{n}\right|\leq & |c_0|+\left(\sum_{n\neq 0}\frac{1}{n^2}\right)^{1/2}\left(\sum_{n\neq 0}|c'_n|^2\right)^{1/2}<\infty
\end{align*}
最后一步使用了柯西-施瓦兹不等式。
\end{proof}

请读者思考：我们探究了指数形式傅里叶级数收敛的条件，对于三角函数形式的傅里叶级数应该怎么办？

\section{分布的逼近，傅里叶反演公式}\label{sec:Approach}

\subsection{分布的逼近}\label{sub:approach}
在\ref{sub:shannon}中，我们对带限函数提出了公式：如果$\text{supp}\ \mathcal{F} f\subset[-\frac{T}{2},\frac{T}{2}]$，则有
\begin{equation*}
    f(t)=T\text{sinc}(Tt)*f(t)
\end{equation*}

如果希望对更一般的函数$f(x)$，找到一个函数$g(x)$，使得$f(x)=g*f(x)$，自然会想到狄拉克$\delta$分布，然而它是一个奇异分布，我们只能从形式上定义一个$\delta$函数。事实上，不存在$g,f*g=f,\forall f$，但很容易构造一个函数列$g_n$，使得$f*g_n\to f$\cite{folland}。回忆我们在\ref{sub:intuition_of_convolution}中提到的“平均化”卷积，设$g_a(x)=\frac{1}{2a}\chi_{[-a,a]}$，则$g_a*f$是$f$在区间$[x-a,x+a]$上的平均值，即$\frac{1}{2a}f*g_a(t)=\int_{x-a}^{x+a}f(x)\,dx$，若$f\in C(\mathbb{R})$，则$g_a*f\to f,a\to 0$。

一般地，我们考虑函数的缩放，设$g\in L^1(\mathbb{R})$，我们记
\[g_\lambda(x)=\frac{1}{\lambda}g\left(\frac{x}{\lambda}\right)\]
这类似于时域的伸缩在傅里叶变换下的表现，它是一种“保面积”的缩放，即：
\[\int_{-\infty}^{\infty}g_\lambda(x)\,dt=\int_{-\infty}^{\infty}g\left(\frac{y}{\lambda}\right)\,d\frac{y}{\lambda}=\int_{-\infty}^{\infty}g(y)\,dy\]
更一般地，我们给出接下来要频繁使用的引理：\begin{lemma}
\[\int_{a}^{b}g_\lambda(x)\,dx=\int_{a/\lambda}^{b/\lambda}g(y)\,dy\]
\end{lemma}
下面我们给出一个表述和证明有些类似于傅里叶级数收敛性的定理：
\begin{theorem}
    设$g\in L^1(\mathbb{R}),\int_{-\infty}^{\infty}g(x)\,dx=1$，并记$\alpha=\int_{-\infty}^{0}g(x)\,dx,\beta=\int_{0}^{\infty}g(x)\,dx$。假设$f\in PC(\mathbb{R})$，则当$g(x)$时限或$f(x)$有界时，$f*g(x)$良定义，并且
    \[\lim_{\lambda\to 0}f*g_\lambda(x)=\alpha f(x+)+\beta f(x-)\]
    特别地，如果$f(x)$在点$x$连续，则有$\lim_{\lambda\to 0}f*g_\lambda(x)=f(x)$；如果$f(x)$在某个闭区间$[a,b]$上连续，则以上极限是一致收敛于$f(x)$的。
\end{theorem}
\begin{proof}
以下证明中，我们需要使用$\epsilon-\delta$语言，暂时不用$\delta$表示狄拉克分布。
\begin{align*}
f*g_\lambda(x)-\alpha f(x+)-\beta f(x-)=\int_{-\infty}^{0}[f(x-y)-f(x+)]g_\lambda(y)\,dy+\int_{0}^{\infty}[f(x-y)-f(x-)]g_\lambda(y)\,dy
\end{align*}
我们希望证明在$\lambda$充分小时，以上两个积分也充分小。以$\int_{0}^{\infty}$为例，由于$f\in PC(\mathbb{R})$，存在$\delta>0$，使得当$|y|<\delta$时，$|f(x-y)-f(x-)|<\epsilon$。于是
\begin{align*}
    \left|\int_{0}^{\delta}[f(x-y)-f(x-)]g_\lambda(y)\,dy\right|
    <\epsilon\left|\int_{0}^{\delta}g_\lambda(y)\,dy\right|=\epsilon\left|\int_{0}^{\delta/\lambda}g(y)\,dy\right|\leq\epsilon\int_{0}^{\infty}|g(y)|\,dy
\end{align*}
我们用剩下的条件估计$\int_{\delta}^{\infty}[f(x-y)-f(x-)]g_\lambda(y)\,dy$。如果$g(x)$时限，设$supp\,g\subset[-T,T]$，则当$\lambda<\delta/T$时，$$y>\delta/\lambda>T\implies g(y)=0\implies\int_{\delta}^{\infty}[f(x-y)-f(x-)]g_\lambda(y)\,dy=\int_{\delta/\lambda}^{\infty}[f(x-\lambda y)-f(x-)]g(y)\,dy=0$$

如果$f(x)$有界，设$|f(x)|<M$，则
\begin{align*}
    \left|\int_{\delta}^{\infty}[f(x-y)-f(x-)]g_\lambda(y)\,dy\right|&\leq \int_{\delta}^{\infty}|f(x-y)-f(x-)||g_\lambda(y)|\,dy\\
    &\leq 2M\int_{\delta}^{\infty}|g_\lambda(y)|\,dy\\
    &=2M\int_{\delta/\lambda}^{\infty}|g(y)|\,dy
\end{align*}
$\int_{-\infty}^{\infty}|g(y)|\,dy<\infty$的必要条件是$\int_{\delta/\lambda}^{\infty}|g(y)|\,dy\to 0,\delta/\lambda\to\infty$，因此上式随$\lambda\to 0$趋于0。

最后，如果$f(x)$在闭区间$[a,b]$上连续，则它在该区间上一致连续，以上证明中的$\delta$与$x$无关，极限是一致收敛的。
\end{proof}
一种常用的函数列是高斯函数列，这里取一个积分值为1的特例：
\[G(x)=\frac{1}{\sqrt{\pi}}e^{-x^2},G_\lambda(x)=\frac{1}{\lambda\sqrt{\pi}}e^{-x^2/\lambda^2}\]
尽管用很多其他函数都可以逼近$\delta$分布，但高斯函数列有一系列非常好的性质：\begin{itemize}
    \item 高斯函数是偶函数，$\alpha=\beta=\frac{1}{2}$；
    \item 高斯函数是无限阶可导的。我们知道，卷积能够继承函数的可导性：$f*g'=f'*g=(f*g)'$，使用高斯函数做卷积，所得的函数光滑
    \item 高斯函数是施瓦兹函数，即$G_\lambda\in \mathcal{S}$
    \item 高斯函数的傅里叶变换仍是高斯函数，这使得傅里叶变换更容易计算
    \item 高斯函数$G_\lambda\in L^1(\mathbb{R})$并且是有界的，与任意$f\in PC(\mathbb{R})$卷积时，卷积积分良定义且趋向于$f$
\end{itemize}

作为以上定理的推论，可以得到一个非常好用的定理：\begin{corollary}[*魏尔斯特拉斯逼近定理]
    设$f\in C([a,b]),-\infty<a<b<\infty$，则$f$是某个多项式序列在$[a,b]$上的一致极限，即\[\forall \epsilon>0,\exists \text{多项式}P,\sup_{a\leq x\leq b}|f(x)-P(x)|<\epsilon\]
\end{corollary}
在处理分析问题时，类似分段光滑函数可由三角级数一致逼近，将连续函数用多项式一致逼近是一个很强大的工具。
\begin{proof}
    将$f$做连续延拓，使得$f\in C(\mathbb{R}),f(x)=0\ for\ x\in (-\infty,a-1]\cup[b+1,\infty)$，则$\lim_{\lambda\to 0}f*G_\lambda \rightrightarrows f,x\in[a,b]$，即$f*G_\lambda$在区间$[a,b]$上一致收敛到$f$。具体来说，
    \[\forall \epsilon>0,\exists \lambda>0,\sup_{a\leq x\leq b}\left|f(x)-\frac{1}{\lambda\sqrt{\pi}}\int_{a-1}^{b+1}e^{-(x-y)^2/\lambda^2}f(y)\,dy\right|<\frac{\epsilon}{2}\]
    考虑使用剩下的半个$\epsilon$，将右边的积分用多项式近似。我们知道，$e^{-t^2}$可以展开为泰勒级数，并且在$\mathbb{C}$上内闭一致收敛，即
    \[\sum_{n=0}^{N}\frac{t^n}{n!}\rightrightarrows e^{-t^2},N\to\infty\]
    具体来说，取$|f(x)|$的上界$M$（紧支连续函数一致连续，必有上界，见数学分析教材），存在$N$，使得
    \[\sup_{t\in[a-1,b+1]}\left|e^{-t^2}-\sum_{n=0}^{N}\frac{(-1)^n t^{2n}}{n!}\right|<\frac{\epsilon\sqrt{\pi}}{2M(b-a+2)}\]
    于是
    \[P(x)=\frac{1}{\lambda\sqrt{\pi}}\sum_{0}^{N}\int_{a-1}^{b+1}\frac{(-1)^n (x-y)^{2n}}{\lambda^{2n}n!}f(y)\,dy,\sup_{a\leq x\leq b}\left|f(x)-P(x)\right|<\epsilon\]
    我们还可以求出$P$的显式表达式：
    \[P(x)=\sum_{n=0}^{N}\sum_{k=0}^{2n}c_{kn}x^k,c_{kn}=\frac{(-1)^{k-n}C_{2n}^{k}}{\lambda^{2n+1}n!\sqrt{\pi}}\int_{a-1}^{b+1}y^{2n-k}f(y)\,dy\]
    使用其他光滑函数列逼近$\delta$分布也可以得到不同的多项式逼近，不过，绝大多数情况下我们并不需要计算出这个表达式，而是直接用多项式的一致逼近来获取函数的性质。
\end{proof}

\subsection{黎曼-勒贝格引理}\label{sub:riemman_lebesgue_lemma}
本小节来补充\ref{sub:introduction_of_fourier}中提到的\textbf{黎曼-勒贝格引理}的证明。
\begin{theorem}[黎曼-勒贝格引理]
    设$f\in L^1(\mathbb{R})$，则其傅里叶变换$\mathcal{F} f(x)\to 0,x\to\infty$。
\end{theorem}
我们给出一个基于阶梯函数逼近的证明，尽管现在不需要掌握它，但可以从这个证明体会到分析学中逼近技术的强大威力。
\begin{proof}
    首先假设$f$是阶梯函数，即$f(t)=\sum_{k=1}^{n}c_k \chi_{[a_k,b_k]}(t)$，我们知道：\lr{
        \mathcal{F} \chi_{[a,b]}(\xi)=\int_{a}^{b}e^{-2\pi i\xi t}\,dt=\frac{e^{-2\pi i\xi a}-e^{-2\pi i\xi b}}{2\pi i\xi}
    }{
        \mathcal{F} \chi_{[a,b]}(\omega)=\int_{a}^{b}e^{-i\omega t}\,dt=\frac{e^{-i\omega a}-e^{-i\omega b}}{i\omega}
    }
    分子是两个模值为1的数相减，分母趋于无穷，故$\mathcal{F} \chi_{[a,b]}(x)\to 0,x\to\infty$。由线性性，$\mathcal{F} f(x)\to 0,x\to\infty$。\\
    设$f\in L^1(\mathbb{R})$，则根据实变函数的理论，存在阶梯函数列$f_n$，使得$\|f-f_n\|_1\to 0,n\to\infty$。我们知道，
    \[|\mathcal{F} g(x)|\leq \int_{-\infty}^{\infty}|g(t)|\,dt=\|g\|_1<\infty,g\in L^1(\mathbb{R})\]
    因此，
    \[\sup_{x\in\mathbb{R}}|\mathcal{F} f(x)-\mathcal{F} f_n(x)|\leq \|f-f_n\|_1\to 0,n\to\infty\]
    即$\mathcal{F} f_n\rightrightarrows\mathcal{F} f,\forall x\in\mathbb{R}$，于是$\mathcal{F} f(x)\to 0,x\to\infty$，得证。
\end{proof}

\subsection{傅里叶反演公式}\label{sub:fourier_inversion}
\begin{theorem}[傅里叶反演公式]
    设$f\in L^1(\mathbb{R})\cap PC(\mathbb{R})$，则对于任意点$x$，都有
    \lr{
        &\frac{f(x+)+f(x-)}{2}\\
        =&\lim_{\lambda\to 0}\int_{-\infty}^{\infty}e^{2\pi i\xi x}\mathcal{F} f(\xi)e^{-\pi^2 \lambda^2 \xi^2}\,d\xi
    }{
        &\frac{f(x+)+f(x-)}{2}\\
        =&\lim_{\lambda\to 0}\frac{1}{2\pi}\int_{-\infty}^{\infty}e^{i\omega x}\mathcal{F} f(\omega)e^{-\lambda^2\omega^2/4}\,d\omega
    }
    如果还有$\mathcal{F} f(x)\in L^1(\mathbb{R})$，则有
    \lr{
        \frac{f(x+)+f(x-)}{2}=\int_{-\infty}^{\infty}e^{2\pi i\xi x}\mathcal{F} f(\xi)\,d\xi
    }{
        \frac{f(x+)+f(x-)}{2}=\frac{1}{2\pi}\int_{-\infty}^{\infty}e^{i\omega x}\mathcal{F} f(\omega)\,d\omega
    }
\end{theorem}
我们指出，$\mathcal{S} \subset L^1(\mathbb{R})\cap PC(\mathbb{R})$。

要说明傅里叶逆变换的确能够还原出时域函数，一种直接的想法是积分换序，即\lr{
    &\int_{-\infty}^{\infty}e^{2\pi i\xi x}\mathcal{F} f(\xi)\,d\xi\\
    =&\int_{-\infty}^{\infty}\left(\int_{-\infty}^{\infty}f(x)e^{-2\pi i\xi x}\,dx\right)e^{2\pi i\xi x}\,d\xi
}{
    &\frac{1}{2\pi}\int_{-\infty}^{\infty}e^{i\omega x}\mathcal{F} f(\omega)\,d\omega\\
    =&\frac{1}{2\pi}\int_{-\infty}^{\infty}\left(\int_{-\infty}^{\infty}f(x)e^{-i\omega x}\,dx\right)e^{i\omega x}\,d\omega
}
然而，\lr{
    \int_{-\infty}^{\infty}e^{2\pi i\xi (x-y)}\,d\xi
}{
    \int_{-\infty}^{\infty}e^{i\omega (x-y)}\,d\omega
}
两个积分是发散的，无法进行积分换序。我们可以使用“收敛因子”来处理这个问题，从信号处理的角度，这就是\textbf{加窗}(windowing)的手法，典型的\textbf{窗函数}(windowing function)如矩形窗（对应短时傅里叶变换）、三角窗和高斯窗（对应加博变换），更一般地还有\textbf{小波变换}(wavelet transform,WT)，见\ref{sec:Finite_Interval}。这里我们用高斯窗，仍记$G_\lambda(\xi)=\frac{1}{\lambda\sqrt{\pi}}e^{-\xi^2/\lambda^2}$，有\lr{
    \mathcal{F} G_\lambda(\xi)=e^{-\pi^2 \lambda^2 \xi^2}
}{
    \mathcal{F} G_\lambda(\omega)=e^{-\lambda^2 \omega^2/4}
}
下面的证明中将用到高斯函数的傅里叶逆变换，但我们可以不依赖于傅里叶反演公式而预先求出它，具体的做法可以参考\ref{sub:fourier_of_signal}中求傅里叶正变换的过程。
\begin{proof}
    考虑
\lr{
    &\int_{-\infty}^{\infty}e^{2\pi i\xi x}\mathcal{F} f(\xi)e^{-\pi^2\lambda^2 \xi^2}\,d\xi\\
    =&\int_{-\infty}^{\infty}\left(\int_{-\infty}^{\infty}f(x)e^{-2\pi i\xi x}\,dx\right)e^{2\pi i\xi x}e^{-\pi^2 \lambda^2 \xi^2}\,d\xi\\
    =&\int_{-\infty}^{\infty}f(x)\,dx\int_{-\infty}^{\infty}e^{2\pi i\xi (x-y)}e^{-\pi^2 \lambda^2 \xi^2}\,d\xi
}{
    &\frac{1}{2\pi}\int_{-\infty}^{\infty}e^{i\omega x}\mathcal{F} f(\omega)e^{-\lambda^2\omega^2/4}\,d\omega\\
    =&\frac{1}{2\pi}\int_{-\infty}^{\infty}\left(\int_{-\infty}^{\infty}f(x)e^{-i\omega x}\,dx\right)e^{i\omega x}e^{-\lambda^2\omega^2/4}\,d\omega\\
    =&\frac{1}{2\pi}\int_{-\infty}^{\infty}f(x)\,dx\int_{-\infty}^{\infty}e^{i\omega (x-y)}e^{-\lambda^2\omega^2/4}\,d\omega
}

以上过程利用了高斯函数的速降性质，保证了积分的绝对收敛性，从而可以进行积分换序。内层的积分恰为傅里叶变换：
\lr{
    &\int_{-\infty}^{\infty}e^{2\pi i\xi (x-y)}e^{-\pi^2 \lambda^2 \xi^2}\,d\xi\\
    =&\mathcal{F}^{-1}[e^{-\pi^2 \lambda^2 \xi^2}](x-y)\\
    =&\frac{1}{\sqrt{\pi}\lambda}e^{-(x-y)^2/\lambda^2}\\
    =&G_{\lambda}(x-y)
}{
    &\frac{1}{2\pi}\int_{-\infty}^{\infty}e^{i\omega (x-y)}e^{-\lambda^2\omega^2/4}\,d\omega\\
    =&\mathcal{F}^{-1}[e^{-\lambda^2\omega^2/4}](x-y)\\
    =&\frac{1}{\sqrt{\pi}\lambda}e^{-(x-y)^2/\lambda^2}\\
    =&G_{\lambda}(x-y)
}
于是我们得到
\lr{
    &\int_{-\infty}^{\infty}e^{2\pi i\xi x}\mathcal{F} f(\xi)e^{-\pi^2 \lambda^2 \xi^2}\,d\xi\\
    =&\int_{-\infty}^{\infty}f(y)G_{\lambda}(x-y)\,dy\\
    =&f*G_{\lambda}(x)
}{
    &\frac{1}{2\pi}\int_{-\infty}^{\infty}e^{i\omega x}\mathcal{F} f(\omega)e^{-\lambda^2\omega^2/4}\,d\omega\\
    =&\int_{-\infty}^{\infty}f(y)G_{\lambda}(x-y)\,dy\\
    =&f*G_{\lambda}(x)
}
我们知道，$\lim_{\lambda\to 0}f*G_{\lambda}(x)=\frac{f(x+)+f(x-)}{2}$，因此
\begin{lralign}
    &\lim_{\lambda\to 0}\int_{-\infty}^{\infty}e^{2\pi i\xi x}\mathcal{F} f(\xi)e^{-\pi^2 \lambda^2 \xi^2}\,d\xi=\frac{f(x+)+f(x-)}{2}
\switch
    &\lim_{\lambda\to 0}\frac{1}{2\pi}\int_{-\infty}^{\infty}e^{i\omega x}\mathcal{F} f(\omega)e^{-\lambda^2\omega^2/4}\,d\omega=\frac{f(x+)+f(x-)}{2}
\end{lralign}
现在，只需要证明$\lim_{\lambda\to 0}$与积分号可以交换顺序。我们有：\lr{
    \left|e^{2\pi i\xi x}\mathcal{F} f(\xi)e^{-\pi^2 \lambda^2 \xi^2}\right|\leq & |\mathcal{F} f(\xi)|\in L^1(\mathbb{R})
}{
    \left|\frac{1}{2\pi}e^{i\omega x}\mathcal{F} f(\omega)e^{-\lambda^2\omega^2/4}\right|\leq & \frac{1}{2\pi}|\mathcal{F} f(\omega)|\in L^1(\mathbb{R})
}   
因此可以使用控制收敛定理，得到
\lr{
    &\frac{f(x+)+f(x-)}{2}\\
    =&\lim_{\lambda\to 0}\int_{-\infty}^{\infty}e^{2\pi i\xi x}\mathcal{F} f(\xi)e^{-\pi^2 \lambda^2 \xi^2}\,d\xi\\
    =&\int_{-\infty}^{\infty}e^{2\pi i\xi x}\mathcal{F} f(\xi)\,d\xi
}{
    &\frac{f(x+)+f(x-)}{2}\\
    =&\lim_{\lambda\to 0}\frac{1}{2\pi}\int_{-\infty}^{\infty}e^{i\omega x}\mathcal{F} f(\omega)e^{-\lambda^2\omega^2/4}\,d\omega\\
    =&\frac{1}{2\pi}\int_{-\infty}^{\infty}e^{i\omega x}\mathcal{F} f(\omega)\,d\omega
}
\end{proof}
傅里叶反演公式还有一些其他的表述。例如，如果我们将窗函数换为矩形窗，则可得到：
\begin{theorem}[傅里叶反演公式]
    设$f\in L^1(\mathbb{R})\cap PS(\mathbb{R})$，则对于任意点$x$，都有
    \lr{
        &\frac{f(x+)+f(x-)}{2}\\
        =&\lim_{R\to \infty}\int_{-R}^{R}e^{2\pi i\xi x}\mathcal{F} f(\xi)\,d\xi
    }{
        &\frac{f(x+)+f(x-)}{2}\\
        =&\lim_{R\to \infty}\frac{1}{2\pi}\int_{-R}^{R}e^{i\omega x}\mathcal{F} f(\omega)\,d\omega
    }
\end{theorem}
等式右侧的积分与反常积分是有区别的，无穷限的反常积分要求积分上下限以二重极限的方式趋于无穷，而这里给出的是\textbf{主值意义下的积分}，即
\[\int_{-\infty}^{\infty}f(x)\,dx=\lim_{a\to-\infty,b\to\infty}\int_{a}^{b}f(x)\,dx\neq \lim_{R\to\infty}\int_{-R}^{R}f(x)\,dx=\text{p.v.}\int_{-\infty}^{\infty}f(x)\,dx\]
\begin{example}
    设$f(x)=x$，则$\int_{-\infty}^{\infty}f(x)\,dx$发散，但$\text{p.v.}\int_{-\infty}^{\infty}f(x)\,dx=0$
\end{example}
\begin{proof}
    我们有\lr{
        \int_{-R}^{R}e^{2\pi i\xi x}\,d\xi=&\frac{e^{2\pi i R x}-e^{-2\pi i R x}}{2\pi i x}\\
        =&\frac{\sin(2\pi R x)}{\pi x}
    }{
        \frac{1}{2\pi}\int_{-R}^{R}e^{i\omega x}\,d\omega=&\frac{e^{i R x}-e^{-i R x}}{i x}\\
        =&\frac{\sin(R x)}{\pi x}
    }
    以及\[\int_{-\infty}^{0}\frac{\sin(ax)}{\pi x}\,dx=\int_{0}^{\infty}\frac{\sin(ax)}{\pi x}\,dx=\frac{1}{2}\]
    因此
\begin{lralign}
    &\int_{-R}^{R}e^{2\pi i\xi x}\mathcal{F} f(\xi)\,d\xi\\
    =&\int_{-\infty}^{\infty}f(y)\,dy\int_{-R}^{R}e^{2\pi i\xi (x-y)}\,d\xi\\
    =&\int_{-\infty}^{\infty}f(y)\frac{\sin(2\pi R (x-y))}{\pi (x-y)}\,dy\\
    =&f*\left(\frac{\sin(2\pi R x)}{\pi x}\right)
\switch
    &\frac{1}{2\pi}\int_{-R}^{R}e^{i\omega x}\mathcal{F} f(\omega)\,d\omega\\
    =&\int_{-\infty}^{\infty}f(y)\,dy\frac{1}{2\pi}\int_{-R}^{R}e^{i\omega (x-y)}\,d\omega\\
    =&\int_{-\infty}^{\infty}f(y)\frac{\sin(R (x-y))}{\pi (x-y)}\,dy\\
    =&f*\left(\frac{\sin(R x)}{\pi x}\right)
\end{lralign}
但是，由于$\text{sinc}\notin L^1(\mathbb{R})$，无法保证$\lim_{R\to \infty} f(x)*\text{sinc}(R x)=f(x)$，因此需要条件$f\in L^1(\mathbb{R})\cup PS(\mathbb{R})$，做更细致的估计：
\lr{
    &\int_{-R}^{R}e^{2\pi i\xi x}\mathcal{F} f(\xi)\,d\xi-\frac{f(x+)+f(x-)}{2}\\
    =&\int_{-\infty}^{\infty}f(y)\frac{\sin(2\pi R (x-y))}{\pi (x-y)}\,dy-\frac{f(x+)+f(x-)}{2}\\
    =&\int_{-\infty}^{\infty}f(x-y)\frac{\sin(2\pi R y)}{\pi y}\,dy-\frac{f(x+)+f(x-)}{2}\\
    =&\int_{-\infty}^{0}[f(x-y)-f(x+)]\frac{\sin(2\pi R y)}{\pi y}\,dy\\
    &+\int_{0}^{\infty}[f(x-y)-f(x-)]\frac{\sin(2\pi R y)}{\pi y}\,dy
}{
    &\frac{1}{2\pi}\int_{-R}^{R}e^{i\omega x}\mathcal{F} f(\omega)\,d\omega-\frac{f(x+)+f(x-)}{2}\\
    =&\int_{-\infty}^{\infty}f(y)\frac{\sin(R (x-y))}{\pi (x-y)}\,dy-\frac{f(x+)+f(x-)}{2}\\
    =&\int_{-\infty}^{\infty}f(x-y)\frac{\sin(R y)}{\pi y}\,dy-\frac{f(x+)+f(x-)}{2}\\
    =&\int_{-\infty}^{0}[f(x-y)-f(x+)]\frac{\sin(R y)}{\pi y}\,dy\\
    &+\int_{0}^{\infty}[f(x-y)-f(x-)]\frac{\sin(R y)}{\pi y}\,dy
}
我们需要证明当$R\to\infty$时，以上两个积分都趋于0。以$\int_{0}^{\infty}$为例，仍然考虑分段估计：$\int_{0}^{\infty}=\int_{0}^{K}+\int_{K}^{\infty}$，取$K\geq 1$，有
\lr{
    &\left|\int_{K}^{\infty}\frac{\sin(2\pi Ry)}{\pi y}f(x-y)\,dy\right|\\
    \leq & \int_{K}^{\infty}\left|\frac{\sin(2\pi Ry)}{\pi y}\right| |f(x-y)|\,dy\\
    \leq & \int_{K}^{\infty}|f(x-y)|\,dy\\
    &\int_{K}^{\infty}\frac{\sin(2\pi Ry)}{\pi y}f(x-)\,dy\\
    = & f(x-)\int_{RK}^{\infty}\frac{\sin(2\pi Ry)}{\pi y}\,dy
}{
    &\left|\int_{K}^{\infty}\frac{\sin(R y)}{\pi y}f(x-y)\,dy\right|\\
    \leq & \int_{K}^{\infty}\left|\frac{\sin(R y)}{\pi y}\right| |f(x-y)|\,dy\\
    \leq & \int_{K}^{\infty}|f(x-y)|\,dy\\
    &\int_{K}^{\infty}\frac{\sin(R y)}{\pi y}f(x-)\,dy\\
    = & f(x-)\int_{RK}^{\infty}\frac{\sin(R y)}{\pi y}\,dy
}
取$K$充分大，则以上两积分都是收敛的无穷限积分的尾部，从而是趋于0的。

对于$\int_{0}^{K}$部分，定义\begin{align*}
    g(y)=\begin{cases}
    \dfrac{f(x-y)-f(x-)}{\pi y},&y\in [0,K]\\
    0,&\text{otherwise}
    \end{cases}
\end{align*}
则\begin{lralign}
    &\int_{0}^{K}[f(x-y)-f(x-)]\frac{\sin(2\pi R y)}{\pi y}\,dy\\
    &=\int_{0}^{K}g(y)\frac{e^{2\pi i Ry}-e^{-2\pi iR y}}{2i}\,dy\\
    &=\frac{1}{2i}[\mathcal{F} g(-R)-\mathcal{F} g(R)]
\switch
    &\int_{0}^{K}[f(x-y)-f(x-)]\frac{\sin(R y)}{\pi y}\,dy\\
    &=\int_{0}^{K}g(y)\frac{e^{i R y}-e^{-i R y}}{2i}\,dy\\
    &=\frac{1}{2i}[\mathcal{F} g(-R)-\mathcal{F} g(R)]
\end{lralign}
由于$f\in PS(\mathbb{R}),g\in PC(\mathbb{R}^*),g(0+)=f'(x-)$，有$g\in L^1(\mathbb{R})$，根据黎曼-勒贝格引理，$\mathcal{F} g(\pm R)\to 0,R\to\infty$，故$$\int_{0}^{K}[f(x-y)-f(x-)]\dfrac{\sin(R y)}{\pi y}\,dy\to 0,R\to\infty$$
得证。
\end{proof}

此外，还有一种类似的的傅里叶反演公式，我们仅仅给出其表述\cite{folland}：
\begin{theorem}[傅里叶反演公式]
    设$f\in L^1(\mathbb{R})$，则
    \lr{
        &\frac{f(x+)+f(x-)}{2}\\
        =&\lim_{\lambda\to 0}\int_{-\infty}^{\infty}e^{2\pi i\xi x}\mathcal{F} f(\xi)e^{-\pi^2 \lambda^2 \xi^2}\,d\xi,a.e.
    }{
        &\frac{f(x+)+f(x-)}{2}\\
        =&\lim_{\lambda\to 0}\frac{1}{2\pi}\int_{-\infty}^{\infty}e^{i\omega x}\mathcal{F} f(\omega)e^{-\lambda^2\omega^2/4}\,d\omega,a.e.
    }
    a.e.表示几乎处处成立，即在勒贝格测度为0的集合以外，上式都是成立的。
\end{theorem}

\section{施瓦兹函数类，时限与带限}\label{sec:Schwartz_Functions}

\subsection{施瓦兹函数在傅里叶变换下的封闭性}\label{sub:fourier_close}
在\ref{sub:schwartz}中，我们介绍了施瓦兹函数类及其对偶空间分布，并直接假定了施瓦兹函数类在傅里叶变换下的封闭性。这一小节将填补这个逻辑漏洞，并介绍施瓦兹函数类的一些其他好处。由于不涉及具体的计算，简洁起见，我们将在本节使用角频率$\omega$。

首先，可以根据施瓦兹函数类的定义\[\mathcal{S} =\left\{\varphi\in C^{\infty}(\mathbb{R} )\left|\lim_{|x|\to\infty}|x|^m\varphi^{(n)}(x)=0,\forall m,n\in\mathbb{N} \right.\right\}\]给出它们在$|x|\to\infty$时的估计，从而施瓦兹函数$\varphi$必满足$\int_{-\infty}^{\infty}|\varphi^{(n)}(x)|\,dx<\infty,n\in\mathbb{N}$，即施瓦兹函数类是$L^1(\mathbb{R} )$的子集，于是\begin{align*}
    \int_{-\infty}^{\infty}\varphi(t)e^{-i\omega t}\,dt&\leq \int_{-\infty}^{\infty}|\varphi(t)||e^{-i\omega t}|\,dt\\
    &=\int_{-\infty}^{\infty}|\varphi(t)|\,dt<\infty
\end{align*}
即施瓦兹函数的傅里叶变换是良定义的，傅里叶逆变换同理。

显然，施瓦兹函数在求导运算下是封闭的，即$\varphi\in\mathcal{S}\implies \varphi'\in\mathcal{S}$，并且乘以$x$的运算也是封闭的，即$\varphi\in\mathcal{S}\implies x\varphi\in\mathcal{S}$。利用这两个性质，可以证明施瓦兹函数类在傅里叶变换下的封闭性：
\begin{theorem}[施瓦兹函数类在傅里叶变换下的封闭性]
    设$\varphi\in\mathcal{S}$，则$\mathcal{F} \varphi,\mathcal{F} ^{-1} \varphi\in\mathcal{S}$。
\end{theorem}
\begin{proof}
    只需证明$\lim_{|\omega|\to\infty}|\omega|^m \mathcal{F} \varphi^{(n)}(\omega)=0,\forall m,n\in\mathbb{N}$。由傅里叶变换的微分性质（见\ref{sub:general_distributions}），
    \begin{align*}
    \mathcal{F} [\varphi'](\omega)&=i\omega \mathcal{F} \varphi(\omega)\\
    \mathcal{F} [\varphi^{(n)}](\omega)&=(i\omega)^n \mathcal{F} \varphi(\omega)
\end{align*}
根据黎曼-勒贝格引理（见\ref{sub:riemman_lebesgue_lemma}），\[\varphi^{(n)}\in L^1(\mathbb{R})\implies\lim_{|\omega|\to\infty}\mathcal{F}\left[ \varphi^{(n)}(\omega)\right]=0\]
即\[\lim_{|\omega|\to\infty}(i\omega)^n \mathcal{F} \varphi(\omega)\to 0\]
故$\mathcal{F} \varphi(\omega)\in\mathcal{S} $，同理可证明$\mathcal{F}^{-1} \varphi(\omega)\in\mathcal{S} $。
\end{proof}

\subsection{时限与带限的关系}\label{sub:time_freq_limit}
我们来验证，紧支函数的傅里叶变换不再是紧支函数，从而一开始介绍的$\mathcal{C} $在傅里叶变换下不封闭。事实上，非零函数不可能既时限，又带限，即：\begin{theorem}
设$f\in L^1(\mathbb{R}),f\neq 0$，如果$f$在时域上紧支，则其傅里叶变换$\mathcal{F} f(\omega)$不可能在频域上紧支，反之亦然。
    
\end{theorem}

\begin{proof}
我们假设$\text{supp}\ f\in[-T/2,T/2],\text{supp}\ \mathcal{F} f\in[-\Omega/2,\Omega/2]$，证明$f=0$。

\textbf{法一}：
\begin{align*}
    f(t)&=\frac{1}{2\pi}\int_{-\infty}^{\infty}\mathcal{F} f(\omega)e^{i\omega t}\,d\omega\\
    &=\frac{1}{2\pi}\int_{-\Omega/2}^{\Omega/2}\mathcal{F} f(\omega)e^{i\omega t}\,d\omega
\end{align*}
由于$\text{supp}\ f\in[-T/2,T/2]$，所以$f(t)$在$|t|>T/2$时恒为0，故\[\int_{-\Omega/2}^{\Omega/2}\mathcal{F} f(\omega)e^{i\omega t}\,d\omega=0,\forall |t|>T/2\]
对以上恒等式两边同时求n阶导数，得到\[\int_{-\Omega/2}^{\Omega/2}(i\omega)^n \mathcal{F} f(\omega)e^{i\omega t}\,d\omega=0,\forall |t|>T/2\]
取定$t_0>T/2$，有\begin{align*}
    f(t)=&\frac{1}{2\pi}\int_{-\Omega/2}^{\Omega/2}\mathcal{F} f(\omega)e^{i\omega t_0}e^{i\omega (t-t_0)}\,d\omega
\end{align*}
将$e^{i\omega (t-t_0)}$展开成幂级数：\begin{align*}
    e^{i\omega (t-t_0)}=&\sum_{n=0}^{\infty}\frac{(i\omega (t-t_0))^n}{n!}
\end{align*}
则该幂级数在$\mathbb{R}$上收敛且内闭一致收敛，特别地，在有限区间$[-\Omega/2,\Omega/2]$上一致收敛，因此可以将求和与积分换序，得到\begin{align*}
    f(t)=&\frac{1}{2\pi}\int_{-\Omega/2}^{\Omega/2}\mathcal{F} f(\omega)e^{i\omega t_0}\sum_{n=0}^{\infty}\frac{(i\omega (t-t_0))^n}{n!}\,d\omega\\
    =&\frac{1}{2\pi}\sum_{n=0}^{\infty}\frac{((t-t_0))^n}{n!}\int_{-\Omega/2}^{\Omega/2}(i\omega)^n \mathcal{F} f(\omega)e^{i\omega t_0}\,d\omega=0
\end{align*}
这表明只有恒零函数才能做到时域、频域均紧支。

\textbf{法二}：利用解析延拓的唯一性。设$\text{supp}\ f\in[-T/2,T/2]$，则\begin{align*}
    \mathcal{F} f(\omega)&=\int_{-\infty}^{\infty}f(t)e^{-i\omega t}\,dt\\
    &=\int_{-T/2}^{T/2}f(t)e^{-i\omega t}\,dt
\end{align*}
这是一个可导的实变函数，可以将其做全纯延拓。我们在\ref{sub:introduction_of_laplace}中已经介绍过拉普拉斯变换，不过那时使用的是单边拉普拉斯变换，这里为了涵盖$\text{supp}\ f\in[-T/2,T/2]$的情形，我们使用双边拉普拉斯变换：
\begin{align*}
    F(s)=\int_{-\infty}^{\infty}f(t)e^{-st}\,dt=\int_{-T/2}^{T/2}f(t)e^{-st}\,dt,F(i\omega)=\mathcal{F} f(\omega)
\end{align*}
它同样具备全纯性。由于积分区间有限，$f\in\mathcal{C} $光滑，以上积分总是存在的，并且可以对$s$求导，从而也是全纯的：\[F'(s)=-\int_{-T/2}^{T/2}tf(t)e^{-st}\,dt\]
即$F(s)$是整函数。但是，$F(s)=0,\forall s=i\omega,|\omega|> \Omega/2$，由唯一延拓定理，$F(s)=0,\forall s\in\mathbb{C}$，因此$f(t)=0$。
\end{proof}

%时域频域“带宽”积，海森堡不确定性原理
必须指出，实际应用中我们总是考虑时域、频域都近似紧支的函数，指出时限、带限不共存，只是理论需要。事实上，时域上的“宽度”与频域上的“宽度”之积存在一个下界，这一点从\ref{sub:fourier_operation_properties}中提出的伸缩定理就可以看出：
\lr{
    \mathcal{F} [f(at)](\xi)=\frac{1}{|a|}\mathcal{F} f\left(\frac{\xi}{a}\right)
}{
    \mathcal{F} [f(at)](\omega)=\frac{1}{|a|}\mathcal{F} f\left(\frac{\omega}{a}\right)
}
随着$a$的增大，时域函数$f(at)$变得越来越集中，而频域函数$\mathcal{F} f\left(\frac{x}{a}\right)$则变得越来越分散，反之亦然。
我们可以用方差来定量描述这一关系。
\begin{theorem}
    时域信号、频域信号的方差之积满足不等式
    \[\sigma(f)\sigma(F)\geq \frac{1}{4\pi}\]
    其中$f\in L^1(\mathbb{R} )\cap L^2(\mathbb{R} )$，$F(\xi)=\int_{-\infty}^{\infty}f(t)e^{-2\pi i\xi t}\,dt$，$\sigma(f),\sigma(F)$分别为$f,F$的方差。
\end{theorem}
物理规律中许多现象都可以归结为这一数学事实，例如著名的\textbf{海森堡不确定性原理} (Heisenberg's uncertainty principle)\footnote{尽管广义的不确定性原理应该归结为算符或矩阵的不对易，但由于动量空间波函数是位置空间波函数的傅里叶变换，以上结果的确能够证明$\sigma_x \sigma_p\geq\frac{\hbar}{2}$}。读者可以自行验证，以上不等式取等于高斯函数。
\begin{proof}
    我们首先验证，$|f|^2$与$|F|^2$作为某个随机变量的概率密度函数是良定义的，从而其方差是良定义的。根据普朗歇尔定理（见\ref{sub:fourier_operation_properties}），\lr{
    \int_{-\infty}^{\infty}|f(t)|^2\,dt=\int_{-\infty}^{\infty}|\mathcal{F} f(\xi)|^2\,d\xi
}{
    \int_{-\infty}^{\infty}|f(t)|^2\,dt=\frac{1}{2\pi}\int_{-\infty}^{\infty}|\mathcal{F} f(\omega)|^2\,d\omega
}
    要使它们都是概率密度函数，我们就需要把$|f|^2,|F|^2$归一化，在频率形式的傅里叶变换下，这是自动成立的，而如果使用角频率来做傅里叶变换，则需要引入额外的归一化系数，因此下面仅使用频率。

    我们知道，如果随机变量$X$的概率密度函数为$f(x)$，并且其方差有定义（二阶中心矩存在），则方差为$\sigma^2=\int_{-\infty}^{\infty}(x-\mu)^2 f(x)\,dx$，其中$\mu=\int_{-\infty}^{\infty}x f(x)\,dx$为数学期望。
    
    我们假设$f$和$F$的数学期望为0，否则可以通过时移、频移定理将它调整为0，而不影响另一个域上信号的模值；又假设\[\int_{-\infty}^{\infty}t^2|f(t)|^2\,dt<\infty,\int_{-\infty}^{\infty}\xi^2|F(\xi)|^2\,d\xi<\infty\]
    即方差存在，则\begin{align*}
    4\pi^2 \sigma^2(f)\sigma^2(F)&=4\pi^2 \int_{-\infty}^{\infty}t^2|f(t)|^2\,dt\int_{-\infty}^{\infty}\xi^2|F(\xi)|^2\,d\xi\\
    &=\int_{-\infty}^{\infty}t^2|f(t)|^2\,dt\int_{-\infty}^{\infty}|2\pi i\xi F(\xi)|^2\,d\xi\\
    &=\int_{-\infty}^{\infty}t^2|f(t)|^2\,dt\int_{-\infty}^{\infty}\left| \mathcal{F} [f'(t)](\xi)\right|^2\,d\xi&\text{(时域微分性质)}\\
    &=\int_{-\infty}^{\infty}t^2|f(t)|^2\,dt\int_{-\infty}^{\infty}| f'(t)|^2\,dt&\text{(普朗歇尔定理)}\\
    &\geq \left(\int_{-\infty}^{\infty}|tf(t)||f'(t)|\,dt\right)^2&\text{(柯西-施瓦兹不等式)}\\
    &=\frac{1}{4}\int_{-\infty}^{\infty}|f(t)|^2\,dt^2&\text{(分部积分)}\\
    &=\frac{1}{4}&\text{(归一化)}
    \end{align*}
    因此，$\sigma(f)\sigma(F)\geq \frac{1}{4\pi}$，得证。
\end{proof}

使用方差的定义可以轻松地得到一个有用的不等式，它给出了一种基于方差估计函数集中程度的方法，这就是\textbf{切比雪夫不等式} (Chebyshev's inequality)：
\begin{theorem}[切比雪夫不等式]
    设$f\in L^2(\mathbb{R} )$，则对于任意$a>0$，都有
    \[\int_{|t|\geq a}|f(t)|^2\,dt\leq \frac{1}{a^2}\int_{-\infty}^{\infty}t^2|f(t)|^2\,dt\]
    在概率论中它的表述是：设随机变量$X$的数学期望为$\mu$，方差为$\sigma^2$，则对于任意$k>0$，都有\[P(|X-\mu|\geq a)\leq \frac{\sigma^2}{a^2}\]
\end{theorem}
\begin{proof}
    由于$a>0$，有
    \begin{align*}
    \int_{|t|\geq a}|f(t)|^2\,dt&=\int_{|t|\geq a}\frac{t^2}{t^2}|f(t)|^2\,dt\\
    &\leq \frac{1}{a^2}\int_{|t|\geq a}t^2|f(t)|^2\,dt\\
    &\leq \frac{1}{a^2}\int_{-\infty}^{\infty}t^2|f(t)|^2\,dt
\end{align*}
\end{proof}

\begin{example}
    取$a=2\sigma(f)$，则有\[\int_{|t|\geq 2\sigma(f)}|f(t)|^2\,dt\leq \frac{1}{4}\]
即$f$在区间$[-2\sigma(f),2\sigma(f)]$之外的能量不超过总能量的$1/4$。
\end{example}
可见，前面证明的$\sigma_f \sigma_F\geq 1/4\pi$又可以表述为时域上的“宽度”与频域上的“宽度”之积有下界，由此可以定义信号的时宽、带宽积：
\begin{definition}[时宽-带宽积]
    设$f\in L^1(\mathbb{R} )\cap L^2(\mathbb{R} )$，$F(\xi)=\int_{-\infty}^{\infty}f(t)e^{-2\pi i\xi t}\,dt$，且它们的方差存在，则$f$的\textbf{时宽}(time width)和\textbf{带宽}(bandwidth)定义分别为
    \[T=2\sigma(f),B=2\sigma(F)\]
    它们的乘积称为\textbf{时宽-带宽积} (time-bandwidth product)：
    \[TB(f)=4\sigma(f)\sigma(F)\]
\end{definition}

我们也可以根据时域、频域函数的半高宽或$1/20$高宽（1dB带宽）来估计它们的集中程度。

\subsection{*傅里叶变换的连续性}\label{sub:fourier_continuous}
施瓦兹函数类的另一个好处在于，它不仅保证了傅里叶变换下的封闭性，还使得傅里叶变换$\mathcal{F} :\mathcal{S} \to \mathcal{S} $是一个\textbf{线性拓扑自同构}，具体来说，这要求\begin{itemize}
    \item $\mathcal{F} $是线性的
    \item $\mathcal{F} $是双射（我们已经找到逆映射$\mathcal{F} ^{-1} $）
    \item $\mathcal{F} $及其逆映射$\mathcal{F} ^{-1} $均为连续映射。
\end{itemize}
我们已经证明过$\mathcal{F}$是线性的双射，下面来说明连续性。为此，我们需要给施瓦兹函数类赋予一个拓扑结构。尽管$\mathcal{S}\in L^1(\mathbb{R} )$，但$L^p$空间的范数并不能很好地刻画施瓦兹函数类的性质，因此我们需要引入一族\textbf{半范数} (seminorm)：
\begin{definition}[*施瓦兹函数类的半范数]
    对于$m,n\in\mathbb{N} $，定义施瓦兹函数类上的半范数
    \[\left\|\varphi\right\|_{m,n}=\sup_{x\in\mathbb{R} }|x|^m\left|\varphi^{(n)}(x)\right|\]
\end{definition}
在这个范数下$\mathcal{S} $构成\textbf{弗雷歇空间} (Fréchet space)，依范数收敛此时应该理解为：
\begin{definition}[*施瓦兹函数类中的收敛]
    设$\{\varphi_k\}\subset\mathcal{S} $，如果对于任意$m,n\in\mathbb{N} $，都有
    \[\lim_{k\to\infty}\left\|\varphi_k-\varphi\right\|_{m,n}=0\]
    则称$\varphi_k$在施瓦兹函数类中（依范数）收敛于$\varphi$，记为$\varphi_k\to \varphi$。
\end{definition}
有了这些定义，我们就可以说明傅里叶变换及其逆映射的连续性：
\begin{theorem}[*$\mathcal{S} $上傅里叶变换的连续性]
    设$\varphi_k\to \varphi$，则$\mathcal{F} \varphi_k\to \mathcal{F} \varphi$。
\end{theorem}
\begin{proof}
    不妨设$\varphi=\mathcal{F} \varphi=0$。由傅里叶变换的微分性质（见\ref{sub:general_distributions}），
    \begin{align*}
    \mathcal{F}\left[\left((-it)^n\varphi_k\right)^{(m)}\right](\omega)&=(i\omega)^m \mathcal{F}\left[(-it)^n \varphi_k\right](\omega)\\
    &=(i\omega)^m (\mathcal{F} \varphi_k)^{(n)}(\omega)\\
    \|\mathcal{F} \varphi_k\|_{m,n}&=\sup_{\omega\in\mathbb{R} }|\omega|^m\left|(\mathcal{F} \varphi_k)^{(n)}(\omega)\right|\\
    &=\sup_{\omega\in\mathbb{R} }\left|\mathcal{F}\left[((-it)^n \varphi_k)^{(m)}\right](\omega)\right|
\end{align*}
令$\phi_k=\left((-it)^n \varphi_k\right)^{(m)}\in\mathcal{S} $，则
\begin{align*}
    \|\mathcal{F} \varphi_k\|_{m,n}&=\sup_{\omega\in\mathbb{R} }\left|\mathcal{F} \phi_k(\omega)\right|\leq \int_{-\infty}^{\infty}|\phi_k(t)|\,dt
\end{align*}
问题转化为证明\[\int_{-\infty}^{\infty}|\phi_k(t)|\,dt\to 0\]
考虑利用$\varphi_k\in\mathcal{S} ,\|\varphi_k\|_{m,n}\to 0,\forall m,n\in\mathbb{N}$给出$|\phi_k(t)|$的估计。利用莱布尼兹求导法则，有：
\begin{align*}
    |\phi_k(t)|&=\left|\left((-it)^n \varphi_k\right)^{(m)}(t)\right|\\
&=\left|\sum_{j=0}^{m}\binom{m}{j}(t^n)^{(j)}\varphi_k^{(m-j)}(t)\right|\\
    &\leq \sum_{j=0}^{\min(m,n)}\binom{m}{j}\frac{n!}{(n-j)!}|t|^{n-j}\left|\varphi_k^{(m-j)}(t)\right|
\end{align*}
由于$\|\varphi_k\|_{n-j+2,m-j}\to 0$，有：$\forall \epsilon>0,\exists N\in\mathbb{N},k>N\implies \|\varphi_k\|_{n-j+2,m-j}<\epsilon$，于是
\begin{align*}
    |\phi_k(t)|&\leq \sum_{j=0}^{\min(m,n)}\binom{m}{j}\frac{n!}{(n-j)!}\frac{\|\varphi_k\|_{n-j+2,m-j}}{|t|^2}\\
    &<\frac{C\epsilon}{|t|^2},C=\sum_{j=0}^{\min(m,n)}\binom{m}{j}\frac{n!}{(n-j)!}
\end{align*}
因此有\begin{align*}
    \int_{|t|\geq 1}|\phi_k(t)|\,dt&\leq \int_{|t|\geq 1}\frac{C\epsilon}{|t|^2}\,dt\\
    &=2C\epsilon\int_{1}^{\infty}\frac{1}{t^2}\,dt=2C\epsilon
\end{align*}
而在$|t|<1$时，\begin{align*}
    \sum_{j=0}^{\min(m,n)}\binom{m}{j}\frac{n!}{(n-j)!}|t|^{n-j}\left|\varphi_k^{(m-j)}(t)\right|&\leq \sum_{j=0}^{\min(m,n)}\binom{m}{j}\frac{n!}{(n-j)!}\|\varphi_k\|_{0,m-j}\\
    &\leq C'\max_{0\leq j\leq \min(m,n)}\|\varphi_k\|_{0,m-j}<\epsilon
\end{align*}
即$\phi_k$一致收敛于0，因此有
\[\int_{|t|<1}|\phi_k(t)|\,dt\to 0\]
综上，\[0\leq\|\mathcal{F} \varphi_k\|_{m,n}\leq\int_{-\infty}^{\infty}|\phi_k(t)|\,dt\to 0\]
根据夹逼定理，$\|\mathcal{F} \varphi_k\|_{m,n}\to 0$，得证。傅里叶逆变换同理。
\end{proof}

其实，如果我们考虑$L^1(\mathbb{R})\cap L^2(\mathbb{R})$中傅里叶变换的连续性，可以得到类似的结论，但证明要简单得多，因为$L^1(\mathbb{R})\cap L^2(\mathbb{R})$中有普朗歇尔定理（见\ref{sub:fourier_operation_properties}）。
\begin{theorem}[$L^1(\mathbb{R})\cap L^2(\mathbb{R})$上傅里叶变换的连续性]
    设$f_k$在$L^2$范数下收敛到$f$，则$\mathcal{F} f_k$在$L^2$范数下收敛到$\mathcal{F} f$。
\end{theorem}
\begin{remark}
    尽管$L^1(\mathbb{R})\cap L^2(\mathbb{R})$是比$\mathcal{S} $更大的空间，但这个定理也有一定的局限性：其一，依$L^2$范数收敛不能保证依半范数收敛，即证得的收敛性会减弱；其二，$L^1(\mathbb{R})\cap L^2(\mathbb{R})$并不是傅里叶变换下的封闭空间，因此我们无法保证傅里叶逆变换的连续性。
\end{remark}
\begin{proof}
    由普朗歇尔定理，有
    \lr{
    \left\|\mathcal{F} f_k-\mathcal{F} f\right\|_2^2&=\int_{-\infty}^{\infty}\left|\mathcal{F} f_k(\xi)-\mathcal{F} f(\xi)\right|^2\,d\xi\\
    &=\int_{-\infty}^{\infty}\left|f_k(t)-f(t)\right|^2\,dt\\
    &=\left\|f_k-f\right\|_2^2
    }{
    \left\|\mathcal{F} f_k-\mathcal{F} f\right\|_2^2&=\int_{-\infty}^{\infty}\left|\mathcal{F} f_k(\omega)-\mathcal{F} f(\omega)\right|^2\,d\omega\\
    &=2\pi\int_{-\infty}^{\infty}\left|f_k(t)-f(t)\right|^2\,dt\\
    &=2\pi\left\|f_k-f\right\|_2^2
    }
    因此，$\left\|f_k-f\right\|_2\to 0\Rightarrow \left\|\mathcal{F} f_k-\mathcal{F} f\right\|_2\to 0$，得证。
\end{proof}

另外，在弱收敛的意义下，傅里叶变换同样是$\mathcal{T} =\mathcal{S} ' $上的线性拓扑自同构。在\ref{sub:operation_of_distribution}中，我们已经证明过分布的傅里叶变换的连续性：\begin{theorem}[$\mathcal{T}$上傅里叶变换的连续性]
    设$T_k\to T$，则$\mathcal{F} T_k\to \mathcal{F} T$。
\end{theorem}

\chapter{公式}

\section{傅里叶级数}

\noindent 1.\underline{傅里叶级数}

周期为T的函数f，三角函数形式的展开式为
\begin{align*}
    f(t) & =\frac{a_0}{2}+\sum_{k = 1}^{\infty} a_k \cos(k\omega t)+b_k\sin(k\omega t) \\
         & =\frac{c_0}{2}+\sum_{k = 1}^{\infty} c_k\cos(k\omega t+\varphi _k)
\end{align*}
其中
\[a_k=\frac{2}{T}\int_T f(t)\cos(k\omega t)\,dt\]
\[b_k=\frac{2}{T}\int_T f(t)\sin(k\omega t)\,dt\]
\[c_k=\sqrt{a_k^2+b_k^2}\]

指数函数形式的展开式为
\[f(t)=\sum_{k = 0}^{\infty}  c_k e^{ik\omega t} ,c_k=\frac{a_k-ib_k}{2},c_{-k}=\frac{a_k+ib_k}{2}=c_k^*,k\in \mathbb{N}\]

\noindent 2.\underline{特殊情况下的傅里叶级数}

对于偶函数，
\[f(t)=\frac{a_0}{2}+\sum_{k = 1}^{\infty} a_k\cos(k\omega t)\]
其中
\[a_k=\frac{4}{T}\int_{0}^{\frac{T}{2}} f(t)\cos(k\omega t)\,dt\]
\[b_k=0\]
对于奇函数，
\[f(t)=\sum_{k = 1}^{\infty} b_k\sin(k\omega t)\]
其中
\[a_k=0\]
\[b_k=\frac{4}{T}\int_{0}^{\frac{T}{2}} f(t)\sin(k\omega t)\,dt\]
对于奇谐函数，$f\left(t+\frac{T}{2}\right)=-f(t)$,
\begin{align*}
    a_k=\begin{cases}
        0,&\text{if }k\text{为偶数}\\
        \frac{4}{T}\int_{0}^{T/2}f(t)\cos(k\omega t)\,dt,&\text{if }k\text{为奇数}
    \end{cases}
\end{align*}
\begin{align*}
    b_k=\begin{cases}
        0,&\text{if }k\text{为偶数}\\
        \frac{4}{T}\int_{0}^{T/2}f(t)\sin(k\omega t)\,dt,&\text{if }k\text{为奇数}
    \end{cases}
\end{align*}

\noindent 3.\underline{帕塞瓦尔定理/瑞利恒等式}
\[P=\frac{1}{T}\int_{T}|f(t)|^2\,dt=\sum_{k=1}^{\infty}c_k^2=a_0^2+\frac{1}{2}\sum_{k=1}^{\infty}(a_k^2+b_k^2)\]

\section{傅里叶变换}

\noindent 1. \underline{傅里叶变换}：
\lr{
    \mathcal{F} f(\xi)=\int_{-\infty}^{\infty}f(t)e^{-2\pi i\xi t}\,dt
}{
    \mathcal{F} f(\omega)=\int_{-\infty}^{\infty}f(t)e^{-i\omega t}\,dt
}
傅里叶逆变换：\lr{
    f(t)=\int_{-\infty}^{\infty}\mathcal{F} f(\xi)e^{2\pi i\xi t}\,d\xi
}{
    f(t)=\frac{1}{2\pi}\int_{-\infty}^{\infty}\mathcal{F} f(\omega)e^{i\omega t}\,d\omega
}
傅里叶反演公式：\lr{
    f=\mathcal{F} ^{-1}\mathcal{F} f=\mathcal{F} \mathcal{F} ^{-1}f
}{
    f=\mathcal{F} ^{-1}\mathcal{F} f=\mathcal{F}\mathcal{F} ^{-1} f
}

\noindent 2.\underline{常用信号及其傅里叶变换}
\begin{itemize}
    \item 矩形函数及采样函数：
    \lr{
        &\chi_{[-T/2,T/2]}(t)\overset{\mathcal{F} }{\longleftrightarrow}T\text{sinc}(T\xi)\\
        &\text{sinc}(Tt)\overset{\mathcal{F} }{\longleftrightarrow}\frac{1}{T}\chi_{[-T/2,T/2]}(\xi)
    }{
        &\text{Sa}(Tt)\overset{\mathcal{F} }{\longleftrightarrow} \frac{\pi}{T}\chi_{[-T,T]}(\omega)\\
        &\text{Sa}(Tt)\overset{\mathcal{F} }{\longleftrightarrow} \frac{\pi}{T}\chi_{[-T,T]}(\omega)
    }
    \item 高斯函数 $G(t)=\frac{1}{\sqrt{2\pi}\sigma}e^{-\frac{t^2}{2\sigma^2}}$
    \lr{
        G(t)\overset{\mathcal{F} }{\longleftrightarrow}e^{-2\pi\sigma^2\xi^2}
    }{
        G(t)\overset{\mathcal{F} }{\longleftrightarrow}e^{-\frac{\sigma^2\omega^2}{2}}
    }
    \item 单边指数函数$f(t)=e^{-at}u(t)$和双边指数函数$g(t)=f(t)+f(-t)$
    \lr{
        &f(t)\overset{\mathcal{F} }{\longleftrightarrow}\frac{1}{a+2\pi i\xi}\\
        &g(t)\overset{\mathcal{F} }{\longleftrightarrow}\frac{2a}{a^2+4\pi^2\xi^2}
    }{
        &f(t)\overset{\mathcal{F} }{\longleftrightarrow}\frac{1}{a+i\omega}\\
        &g(t)\overset{\mathcal{F} }{\longleftrightarrow}\frac{2a}{a^2+\omega^2}
    }
    
\end{itemize}

\noindent 3.\underline{常用分布及其傅里叶变换}
\begin{itemize}
    \item $\delta$分布和$\mathds{1}$分布
    \begin{lralign}
        &\delta\overset{\mathcal{F} }{\longleftrightarrow}\mathds{1}\\
        &\delta_a\overset{\mathcal{F} }{\longleftrightarrow}e^{-2\pi ia\xi}\\
        &\mathds{1}\overset{\mathcal{F} }{\longleftrightarrow}\delta\\
        &e^{2\pi iat}\overset{\mathcal{F} }{\longleftrightarrow}\delta_{a}
    \switch
        &\delta\overset{\mathcal{F} }{\longleftrightarrow}\mathds{1}\\
        &\delta_a\overset{\mathcal{F} }{\longleftrightarrow}e^{-ia\omega}\\
        &\mathds{1}\overset{\mathcal{F} }{\longleftrightarrow}2\pi\delta\\
        &e^{iat}\overset{\mathcal{F} }{\longleftrightarrow}2\pi\delta_{a}
    \end{lralign}
    \item 正弦函数和余弦函数
    \lr{
        &\cos(2\pi at)\overset{\mathcal{F} }{\longleftrightarrow}\frac{1}{2}(\delta_a+\delta_{-a})\\
        &\sin(2\pi at)\overset{\mathcal{F} }{\longleftrightarrow}\frac{1}{2i}(\delta_a-\delta_{-a})
    }{
        &\cos(at)\overset{\mathcal{F} }{\longleftrightarrow}\pi(\delta_a+\delta_{-a})\\
        &\sin(at)\overset{\mathcal{F} }{\longleftrightarrow}-i\pi(\delta_a-\delta_{-a})
    }
    \item 符号函数、单位阶跃函数和多项式
    \lr{
        &sgn(t)\overset{\mathcal{F} }{\longleftrightarrow}\frac{1}{\pi i\xi}\\
        &u(t)\overset{\mathcal{F} }{\longleftrightarrow}\frac{1}{2}\left(\delta+\frac{1}{\pi i\xi}\right)\\
        &\frac{1}{t}\overset{\mathcal{F} }{\longleftrightarrow}-\pi isgn(\xi)\\
        &t^n\overset{\mathcal{F} }{\longleftrightarrow}\left(\frac{i}{2\pi}\right)^n\delta^{(n)}
    }{
        &sgn(t)\overset{\mathcal{F} }{\longleftrightarrow}\frac{2}{i\omega}\\
        &u(t)\overset{\mathcal{F} }{\longleftrightarrow}\pi\delta+\frac{1}{i\omega}\\
        &\frac{1}{t}\overset{\mathcal{F} }{\longleftrightarrow}-\pi isgn(\omega)\\
        &t^n\overset{\mathcal{F} }{\longleftrightarrow}2\pi i^n\delta^{(n)}
    }
\end{itemize}

\noindent 4.\underline{傅里叶变换的性质}：设\[f\overset{\mathcal{F} }{\longleftrightarrow}F\]
\begin{itemize}
    \item \textbf{对偶性}：\lr{
        &F^- =\mathcal{F} ^{-1}f\\
              &\mathcal{F}F=f^-\\
              &f\text{是实信号}\implies F^-=\overline{F}
          }{
            &F^- =2\pi\mathcal{F} ^{-1}f\\
              &\mathcal{F}F=2\pi f^-\\
              &f\text{是实信号}\implies F^-=\overline{F}
            }
    \item \textbf{对称性}：F与f奇偶性相同；f是实函数时，如果f还是偶函数，则F也是实函数，
          如果f还是奇函数，则F是纯虚函数
    \item \textbf{线性性}：$\forall f,g\in L^1(\mathbb{R}),\mathcal{F} (af+bg)=a\mathcal{F} f+b\mathcal{F} g$，即$\mathcal{F} $是线性算子
    \item \textbf{平移定理}：\lr{
          &f(t-b)\overset{\mathcal{F} }{\longleftrightarrow}e^{-2\pi i \xi b}F(\xi)\\
          &f(t)e^{2\pi i \xi t}\overset{\mathcal{F} }{\longleftrightarrow}F(\xi-b)
          }{
          &f(t-b)\overset{\mathcal{F} }{\longleftrightarrow}e^{-i\omega b}F(\omega)\\
          &f(t)e^{ibt}\overset{\mathcal{F} }{\longleftrightarrow}F(\omega-b)
          }
    \item \textbf{伸缩定理}：\lr{
              f(at)\overset{\mathcal{F} }{\longleftrightarrow}\frac{1}{|a|}F\left(\frac{\xi}{a}\right)
          }{
              f(at)\overset{\mathcal{F} }{\longleftrightarrow}\frac{1}{|a|}F\left(\frac{\omega}{a}\right)
          }
    \item \textbf{微分性质}：\lr{
              &f'\overset{\mathcal{F} }{\longleftrightarrow}2\pi i\xi F(\xi)\\
              &2\pi itf\overset{\mathcal{F} }{\longleftrightarrow}-F'(\xi)\\
              &\text{即}tf\overset{\mathcal{F} }{\longleftrightarrow}\frac{i}{2\pi}F'(\xi)
          }{
              &f'\overset{\mathcal{F} }{\longleftrightarrow}i\omega F(\omega)\\
              &itf(t)\overset{\mathcal{F} }{\longleftrightarrow}-F'(\omega)\\
              &\text{即}tf\overset{\mathcal{F} }{\longleftrightarrow}iF'(\omega)
          }
    \item \textbf{帕塞瓦尔恒等式/普朗歇尔定理}：\lr{
    \int_{-\infty}^{\infty}|f(t)|^2\,dt=\int_{-\infty}^{\infty}|\mathcal{F} f(\xi)|^2\,d\xi
}{
    \int_{-\infty}^{\infty}|f(t)|^2\,dt=\frac{1}{2\pi}\int_{-\infty}^{\infty}|\mathcal{F} f(\omega)|^2\,d\omega
}
\end{itemize}

\noindent 5.\underline{卷积}

函数f,g的卷积为
\begin{equation*}
    (f*g)(x)=\int_{-\infty}^{\infty}f(y)g(x-y)\,dy
\end{equation*}
设$f\overset{\mathcal{F} }{\longleftrightarrow}F,g\overset{\mathcal{F} }{\longleftrightarrow}G$,
\textbf{卷积定理}：
\lr{
    \mathcal{F} (f*g)(\xi)=F(\xi)G(\xi)\\
    \mathcal{F} (fg)(\xi)=(F*G)(\xi)
}{
    \mathcal{F} (f*g)(\omega)=F(\omega)G(\omega)\\
    \mathcal{F} (fg)(\omega)=\frac{1}{2\pi}(F*G)(\omega)
}
$\delta$的卷积性质：\lr{
    &\mathcal{F} (f*\delta)(\xi)=F(\xi)\\
    &f(t)=(f*\delta)(t)=\int_{-\infty}^{\infty}f(x)\delta(t-x)\,dx\\
    &f*\delta_a=\tau_a f
}{
    &\mathcal{F} (f*\delta)(\omega)=F(\omega)\\
    &f(t)=(f*\delta)(t)=\int_{-\infty}^{\infty}f(x)\delta(t-x)\,dx\\
    &f*\delta_a=\tau_a f
}
卷积的性质：\begin{align*}
    &(f*g)'=f'*g=f*g'\\
    &(f^-)*(g^-)=(f*g)^-\\
    &(\tau_b f)*g=\tau_b(f*g)=f*(\tau_b g)\\
    &(\sigma_a f)*(\sigma_a g)=\frac{1}{|a|}\sigma_a(f*g)\\
    &\int_{\mathbb{R}}f*g=\int_{\mathbb{R}}f\cdot\int_{\mathbb{R}}g
\end{align*}

\noindent 6.\underline{相关函数}

$f,g\in L^2(\mathbb{R})$的\textbf{互相关}定义为
\[(f\star g)(x)=\int_{-\infty}^{\infty}f(y)\overline{g(x+y)}\,dy\]
互相关的性质：\begin{itemize}
    \item $(f\star g) =f^-* \overline{g}=\overline{(g\star f)^-}$，如果$f,g$都是实信号，则$f\star g = (g\star f)^- =f^- *g=(f*g^-)^-$.
    \item $\mathcal{F} (f\star g) =\mathcal{F} f\overline{\mathcal{F} g}$，特别地，
          $\mathcal{F} (f\star f) =|\mathcal{F} f|^2$，这是\textbf{维纳-辛钦定理}(Wiener-Khinchin theorem)
    \item $f\star (\tau_b g)=\tau_{b} (f\star g)=(\tau_{-b}f)\star g$
    \item $(f\star g)\leq\|f\|\|g\|$，特别地，$(f\star f)(x)\leq (f\star f)(0)=\|f\|^2$
\end{itemize}

\noindent 7.\underline{作用于分布的算子及其性质}
\begin{align*}
    &\left\langle \mathcal{F} T,\varphi\right\rangle=\left\langle T,\mathcal{F} \varphi\right\rangle,\left\langle \mathcal{F} ^{-1}T,\varphi\right\rangle=\left\langle T,\mathcal{F} ^{-1}\varphi\right\rangle\\
    &\left\langle T',\varphi\right\rangle=-\left\langle T,\varphi'\right\rangle,\left\langle gT,\varphi\right\rangle=\left\langle T,g\varphi\right\rangle\\
    &\left\langle \overline{T},\varphi\right\rangle=\overline{\left\langle T,\overline{\varphi}\right\rangle},\left\langle T^-,\varphi\right\rangle=\left\langle T,\varphi^-\right\rangle\\
    &\left\langle \tau_b T,\varphi\right\rangle=\left\langle T,\tau_{-b}\varphi\right\rangle,\left\langle \sigma_a T,\varphi\right\rangle=\left\langle T,\frac{1}{|a|}\sigma_{1/a}\varphi\right\rangle\\
    &\left\langle g*T,\varphi\right\rangle=\left\langle T,g^- *\varphi\right\rangle,\left\langle S*T,\varphi\right\rangle=\left\langle S(y),\left\langle T(x),\varphi(x+y)\right\rangle\right\rangle
\end{align*}
分布的傅里叶变换与经典情况的区别与联系：T是实分布\textbf{不能}推出
$\mathcal{F} T^-=\overline{\mathcal{F} T}$，分布与分布的卷积的结合律未必成
立，此外的性质都与经典情况一致。

\section{拉普拉斯变换}

\printbibliography[heading=bibintoc, title={参考文献}]

\end{document}